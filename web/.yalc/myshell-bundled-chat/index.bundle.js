"use strict";var e=require("react/jsx-runtime"),t=require("lucide-react"),s=require("next-intl"),a=require("react"),n=require("zustand"),l=require("zustand-computed"),r=require("clsx"),i=require("next-themes"),o=require("next/dynamic"),c=require("react-use"),d=require("next/navigation"),u=require("@chakra-ui/react"),m=require("next/image"),p=require("react-textarea-autosize"),f=require("framer-motion"),h=require("usehooks-ts");require("swiper/css");var g=require("dayjs");require("file-saver");var v=require("ismobilejs"),x=require("uuid");require("viem");var b=require("lodash-es"),E=require("react-dropzone"),_=require("@virtuoso.dev/message-list"),w=require("class-variance-authority"),T=require("@radix-ui/react-checkbox");require("@/styles/md-viewer.scss");var N=require("isomorphic-dompurify"),y=require("react-markdown"),C=require("rehype-external-links"),S=require("rehype-katex"),j=require("rehype-raw"),I=require("remark-breaks"),O=require("remark-gfm"),A=require("remark-math"),M=require("mermaid"),P=require("react-syntax-highlighter");require("katex/dist/katex.min.css");var L=require("@radix-ui/react-context-menu"),k=require("@hookform/resolvers"),R=require("react-hook-form"),D=require("zod"),U=require("@radix-ui/react-slot"),F=require("@radix-ui/react-label"),B=require("react-swipeable"),G=require("@/components/rewards-center/reward-redemption/components/redemption-success-modal/assets/images/reward-success-bg.png"),z=require("@radix-ui/react-dialog"),Y=require("dayjs/plugin/duration"),H=require("react-fast-compare"),V=require("hammerjs"),$=require("react-select"),W=require("tailwind-merge"),K=require("axios"),q=require("rxjs"),Q=require("viem/chains"),X=require("immer");require("react-dom");var J=require("vaul"),Z=require("rc-image"),ee=require("@radix-ui/react-separator"),te=require("@radix-ui/react-tooltip"),se=require("@radix-ui/react-popover"),ae=require("react-hot-toast"),ne=require("next/script"),le=require("next/link"),re=require("qrcode"),ie=require("@radix-ui/react-dropdown-menu"),oe=require("compressorjs"),ce=require("@/common/assets/images/workshop/BotDetailBg.png"),de=require("react-cropper");require("cropperjs/dist/cropper.css");var ue=require("lottie-web"),me=require("@monaco-editor/react"),pe=require("json-source-map"),fe=require("json5"),he=require("jsonpath-plus");function ge(e){return e&&e.__esModule?e:{default:e}}function ve(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(s){if("default"!==s){var a=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:function(){return e[s]}})}})),t.default=e,Object.freeze(t)}var xe,be,Ee,_e,we,Te,Ne,ye,Ce,Se,je,Ie,Oe,Ae,Me,Pe,Le,ke,Re,De,Ue,Fe=ve(a),Be=ge(l),Ge=ge(r),ze=ge(o),Ye=ge(m),He=ge(p),Ve=ge(g),$e=ge(v),We=ve(T),Ke=ge(y),qe=ge(C),Qe=ge(S),Xe=ge(j),Je=ge(I),Ze=ge(O),et=ge(A),tt=ge(M),st=ge(P),at=ve(L),nt=ve(F),lt=ge(G),rt=ve(z),it=ge(Y),ot=ge(H),ct=ge(V),dt=ge($),ut=ge(K),mt=ge(Z),pt=ve(ee),ft=ve(te),ht=ve(se),gt=ge(ne),vt=ge(le),xt=ge(re),bt=ve(ie),Et=ge(oe),_t=ge(ce),wt=ge(de),Tt=ge(ue),Nt=ge(me),yt=ge(pe),Ct=ge(fe);!function(e){e[e.CONVERSATION_SCENARIO_UNSPECIFIED=0]="CONVERSATION_SCENARIO_UNSPECIFIED",e[e.CONVERSATION_SCENARIO_WEB_FOR_TESTS=2]="CONVERSATION_SCENARIO_WEB_FOR_TESTS",e[e.CONVERSATION_SCENARIO_IMMERSION_WEB_CHAT=3]="CONVERSATION_SCENARIO_IMMERSION_WEB_CHAT",e[e.CONVERSATION_SCENARIO_WEB_CHAT_NORMAL=4]="CONVERSATION_SCENARIO_WEB_CHAT_NORMAL",e[e.CONVERSATION_SCENARIO_BOT_GENERATION=9]="CONVERSATION_SCENARIO_BOT_GENERATION"}(xe||(xe={})),function(e){e.UNSPECIFIED="JOB_TYPE_UNSPECIFIED",e.BOT_CREATE="JOB_TYPE_BOT_CREATE",e.BOT_UPDATE_PROMPT="JOB_TYPE_BOT_UPDATE_PROMPT",e.IMAGE_GEN_REQUEST="JOB_TYPE_GENERATION_IMAGE_REQUEST",e.COMP_GEN_REQUEST="JOB_TYPE_GENERATION_COMPONENT_REQUEST",e.LEPTON_INNER_GEN_QUEUE="JOB_TYPE_GENERATION_LEPTON_INNER_QUEUE",e.WIDGET_AUTO_PROMPT="JOB_TYPE_WIDGET_AUTO_PROMPT",e.WIDGET_VOICE_CLONE="JOB_TYPE_WIDGET_VOICE_CLONE",e.RUNNING_ASYNC_STATE_MACHINE="JOB_TYPE_RUNNING_ASYNC_STATE_MACHINE"}(be||(be={})),function(e){e.WAITING="JOB_STATUS_WAITING",e.DOING="JOB_STATUS_DOING",e.DONE="JOB_STATUS_DONE",e.FAILED="JOB_STATUS_FAILED",e.CANCELED="JOB_STATUS_CANCELED"}(Ee||(Ee={})),function(e){e.UNKNOWN="EMBED_OBJ_STATUS_UNSPECIFIED",e.PENDING="EMBED_OBJ_STATUS_PENDING",e.PROCESSING="EMBED_OBJ_STATUS_PROCESSING",e.DONE="EMBED_OBJ_STATUS_DONE",e.ERROR="EMBED_OBJ_STATUS_ERROR",e.DELETED="EMBED_OBJ_STATUS_DELETED",e.QUEUEING="EMBED_OBJ_STATUS_QUEUEING"}(_e||(_e={})),function(e){e.UNKNOWN="MESSAGE_METADATA_TYPE_UNSPECIFIED",e.IMAGE="MESSAGE_METADATA_TYPE_IMAGE_FILE",e.DOC="MESSAGE_METADATA_TYPE_TEXT_FILE",e.AUDIO="MESSAGE_METADATA_TYPE_AUDIO_FILE",e.VIDEO="MESSAGE_METADATA_TYPE_VIDEO_FILE",e.TEXT_CONTENT="MESSAGE_METADATA_TYPE_TEXT_CONTENT",e.AUDIO_CONTENT="MESSAGE_METADATA_TYPE_USER_AUDIO",e.ALL="MESSAGE_METADATA_TYPE_ALL_FILE"}(we||(we={})),function(e){e.NORMAL="Normal",e.LIKED="Liked",e.DISLIKE="Dislike"}(Te||(Te={})),function(e){e.UNSPECIFIED="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_UNSPECIFIED",e.AUTO="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_AUTO",e.EN="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_EN",e.ZH="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_ZH",e.JA="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_JA",e.RU="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_RU",e.ES="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_ES",e.KO="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_KO"}(Ne||(Ne={})),function(e){e.UNSPECIFIED="BOT_CHAT_SETTING_AUDIO_SPEED_UNSPECIFIED",e.ZERO_POINT_FIVE="BOT_CHAT_SETTING_AUDIO_SPEED_ZERO_POINT_FIVE",e.ZERO_POINT_SEVEN_FIVE="BOT_CHAT_SETTING_AUDIO_SPEED_ZERO_POINT_SEVEN_FIVE",e.ONE="BOT_CHAT_SETTING_AUDIO_SPEED_ONE",e.ONE_POINT_TWENTY_FIVE="BOT_CHAT_SETTING_AUDIO_SPEED_ONE_POINT_TWENTY_FIVE",e.ONE_POINT_FIVE="BOT_CHAT_SETTING_AUDIO_SPEED_ONE_POINT_FIVE"}(ye||(ye={})),exports.MenuFunctionEnum=void 0,(Ce=exports.MenuFunctionEnum||(exports.MenuFunctionEnum={}))[Ce.REMOVE_FROM_LIST=0]="REMOVE_FROM_LIST",Ce[Ce.SHARE=1]="SHARE",Ce[Ce.CLEAR_MEMORY=2]="CLEAR_MEMORY",Ce[Ce.CLEAR_HISTORY=3]="CLEAR_HISTORY",function(e){e.Like="Like",e.Dislike="Dislike",e.Copy_Message="Copy Message",e.Select_Text="Select Text",e.Stop_Generating="Stop Generating",e.Regenerate="Regenerate",e.Edit="Edit",e.Translate="Translate",e.Show_Text="Show Text",e.Download_Voice="Download Voice",e.Share="Share",e.Delete="Delete",e.Remove_Dislike="Remove Dislike",e.Regenerate_Voice="Regenerate Voice",e.Feedback="Feedback",e.Save_Image="Save Image",e.Copy_Image="Copy Image",e.Copy_Image_Link="Copy Image Link",e.Publish_To_Gallery="Publish to Gallery",e.Divider="Divider"}(Se||(Se={})),function(e){e.UNSPECIFIED="RUNNING_ERROR_TYPE_UNSPECIFIED",e.ENGINE_ERROR="RUNNING_ERROR_TYPE_ENGINE_ERROR",e.INNER_COMPONENT_ERROR="RUNNING_ERROR_TYPE_INNER_COMPONENT_ERROR",e.ENERGY_INSUFFICIANT="RUNNING_ERROR_TYPE_ENERGY_INSUFFICIANT",e.LLM_TOKEN_TOO_LONG="RUNNING_ERROR_TYPE_LLM_TOKEN_TOO_LONG"}(je||(je={})),function(e){e.UNSPECIFIED="MESSAGE_STATUS_UNSPECIFIED",e.PENDING="PENDING",e.PROCESSING="PROCESSING",e.DONE="DONE",e.ERROR="ERROR",e.DELETED="DELETED",e.CANCELED="CANCELED"}(Ie||(Ie={})),function(e){e.UNSPECIFIED="IMAGE_GEN_MESSAGE_TYPE_UNSPECIFIED",e.SIMPLE="IMAGE_GEN_MESSAGE_TYPE_SIMPLE_MESSAGE",e.COMMAND="IMAGE_GEN_MESSAGE_TYPE_COMMAND_MESSAGE",e.PANEL="IMAGE_GEN_MESSAGE_TYPE_PANEL_MESSAGE",e.REGEN="IMAGE_GEN_MESSAGE_TYPE_REGENERATE_MESSAGE",e.VARIATION="IMAGE_GEN_MESSAGE_TYPE_VARIATION_MESSAGE",e.UPSCALE="IMAGE_GEN_MESSAGE_TYPE_UPSCALE_MESSAGE",e.GIF="IMAGE_GEN_MESSAGE_TYPE_SIMPLE_GIF"}(Oe||(Oe={})),function(e){e.JUMP_LINK="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_JUMP_LINK",e.POP_UP_FORM="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_POP_UP_FORM",e.INTERACTION="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_INTERACTION",e.CLIPBOARD="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_CLIPBOARD"}(Ae||(Ae={})),function(e){e.AUDIO="MESSAGE_METADATA_TYPE_AUDIO_FILE",e.IMAGE="MESSAGE_METADATA_TYPE_IMAGE_FILE",e.APPLICATION="MESSAGE_METADATA_TYPE_TEXT_FILE",e.VIDEO="MESSAGE_METADATA_TYPE_VIDEO_FILE",e.ALL="MESSAGE_METADATA_TYPE_ALL_FILE"}(Me||(Me={})),function(e){e.ROW="BOT_MESSAGE_COMPONENTS_TYPE_ROW",e.BUTTON="BOT_MESSAGE_COMPONENTS_TYPE_BUTTON",e.CONTAINER="BOT_MESSAGE_COMPONENTS_TYPE_CONTAINER"}(Pe||(Pe={})),function(e){e.LEFT="BOT_MESSAGE_COMPONENTS_BUTTON_CONTENT_DIRECTION_LEFT",e.RIGHT="BOT_MESSAGE_COMPONENTS_BUTTON_CONTENT_DIRECTION_RIGHT"}(Le||(Le={})),function(e){e.JUMP_LINK="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_JUMP_LINK",e.POP_UP_FORM="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_POP_UP_FORM",e.INTERACTION="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_INTERACTION",e.CLIPBOARD="MESSAGE_COMPONENTS_BUTTON_ACTION_TYPE_CLIPBOARD"}(ke||(ke={})),function(e){e.TEXT="BOT_MESSAGE_COMPONENTS_BUTTON_ACTION_INTERACTION_INPUT_DISPLAY_TYPE_TEXT",e.SLASH_COMMAND="BOT_MESSAGE_COMPONENTS_BUTTON_ACTION_INTERACTION_INPUT_DISPLAY_TYPE_SLASH_COMMAND",e.NOTHING="BOT_MESSAGE_COMPONENTS_BUTTON_ACTION_INTERACTION_INPUT_DISPLAY_TYPE_NOTHING"}(Re||(Re={})),function(e){e.BOT_IM_COMPONENT_INPUT_TYPE_UNSPECIFIED="BOT_IM_COMPONENT_INPUT_TYPE_UNSPECIFIED",e.BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR",e.BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX="BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX",e.BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR",e.BOT_IM_COMPONENT_INPUT_TYPE_CODE_EDITOR="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR"}(De||(De={})),function(e){e.MESSAGE_METADATA_TYPE_UNSPECIFIED="MESSAGE_METADATA_TYPE_UNSPECIFIED",e.MESSAGE_METADATA_TYPE_IMAGE_FILE="MESSAGE_METADATA_TYPE_IMAGE_FILE",e.MESSAGE_METADATA_TYPE_TEXT_FILE="MESSAGE_METADATA_TYPE_TEXT_FILE",e.MESSAGE_METADATA_TYPE_ALL_FILE="MESSAGE_METADATA_TYPE_ALL_FILE",e.MESSAGE_METADATA_TYPE_AUDIO_FILE="MESSAGE_METADATA_TYPE_AUDIO_FILE",e.MESSAGE_METADATA_TYPE_VIDEO_FILE="MESSAGE_METADATA_TYPE_VIDEO_FILE",e.MESSAGE_METADATA_TYPE_TEXT_CONTENT="MESSAGE_METADATA_TYPE_TEXT_CONTENT",e.MESSAGE_METADATA_TYPE_USER_AUDIO="MESSAGE_METADATA_TYPE_USER_AUDIO",e.MESSAGE_METADATA_TYPE_COMPONENT_INPUT="MESSAGE_METADATA_TYPE_COMPONENT_INPUT",e.MESSAGE_METADATA_TYPE_ASYNC_JOB_INFO="MESSAGE_METADATA_TYPE_ASYNC_JOB_INFO"}(Ue||(Ue={}));const St=()=>{},jt=a.createContext({type:"bot",entityInfo:{id:"",name:"",energyPerChat:0,pinned:!1},readonly:!1,interactionDisabled:!1,textDisabled:!1,audioDisabled:!1,uploadDisabled:!1,visitorInteroperable:!0,showInteractionCostEnergy:!0,showChatSetting:!0,chatSettingDisabled:!0,menuDisabled:!1,menuFunctions:[],getList:async()=>[],updateChatSetting:St,partialUpdateDetail:St,setEnergyInfo:St,showPin:!0,atBottom:!1,setAtBottom:St,imgGenerator:!1,showReplyName:!1,forceToLogin:!1,terminatable:!0,messageShareAvailable:!0,feedbackAvailable:!0,showMockReply:!0}),It=()=>{},Ot=async()=>{},At=a.createContext({messageList:[],messageToDisplay:It,exceptionsForTextDisplay:{},addTextDisplayException:It,sending:!1,interacting:!1,showTerminate:!1,scrollToBottom:0,setDraftMessage:It,sendTextMessage:It,sendAudioMessage:Ot,sendButtonInteractionMessage:Ot,errorMessageRetry:Ot,terminate:It,hasMore:!1,gettingHistory:!1,initializingHistory:!1,messageInited:!1,getHistoryMessage:async()=>[],markAsRead:Ot,appendMessages:It,mixMessages:It,updateMessage:It,deleteSpecifiedMessageId:It,partialUpdateMessage:It,translate:It,playingAudio:"",playNext:It,enQueue:It,clearQueue:It,dragMaskVisible:!1,editorMode:"NORMAL",setEditorMode:It,inputMode:"TEXT",setInputMode:It,share:{idSet:new Set,add:It,remove:It,clear:It,allChecked:!1,checkAllHandler:It},file:{uploadedFiles:[],uploadFiles:It,deleteFile:It},questions:[],scrolled:!0,setScrolled:It});function Mt({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const Pt=Fe.forwardRef(Mt);function Lt({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const kt=Fe.forwardRef(Lt);function Rt({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const Dt=Fe.forwardRef(Rt);var Ut,Ft,Bt;!function(e){e.LAST_SEASON="lastSeason",e.LANGUAGE="language",e.SHOW_NSFW="showNsfw",e.FLAG_ICON_REWARD="flagIconReward",e.FLAG_ICON_FORUM="flagIconForum",e.FLAG_LLM_MODEL_CONFIG="flagLlmModelConfig",e.FLAG_NSFW_CONFIRMED="flagNsfwConfirmed",e.FLAG_ETH_LINEA_TRANSFERRED="flagEthLineaTransferred",e.DEDUCTION_CONFIRMED="flagDeductionConfirmed",e.FLAG_COMPLETED_OPBNB_CHAIN_TASK="flagCompletedOpBnbChainTask",e.FLAG_SILENT_PERIOD_CONFIRMED="flagSilentPeriodConfirmed",e.FLAG_stake_earn_VIEWED="flagSubscribingEarnViewed",e.FLAG_SHARE_KEY_EARN_POPUP_CONFIRMED="flagShareKeyEarnPopupConfirmed",e.TIME_ZONE="timezone",e.NOTIFICATION="receiveAutoPush",e.FLAG_TAG_NOTICE="flagTagNotice",e.FLAG_USET_FIRST_PUBLISH_GALLERY="flagUserFirstPublishGallery",e.FLAG_USET_FIRST_VISIT_GALLERY="flagUserFirstVisitGallery"}(Ut||(Ut={})),function(e){e[e.YES=1]="YES",e[e.NO=2]="NO"}(Ft||(Ft={})),function(e){e[e.INIT=0]="INIT",e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(Bt||(Bt={}));const Gt=Object.keys({zh:"简体中文","zh-tw":"繁體中文",en:"English",jp:"日本語",es:"Español",ru:"Русский",ko:"한국어"});var zt,Yt,Ht,Vt,$t,Wt,Kt;!function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.TYPE_NORMAL="TYPE_NORMAL",e.TYPE_PREMIUM="TYPE_PREMIUM",e.TYPE_GENESIS_WITH_GENESIS_CARD="TYPE_GENESIS_WITH_GENESIS_CARD",e.TYPE_GENESIS_WITH_PASS_CARD="TYPE_GENESIS_WITH_PASS_CARD"}(zt||(zt={})),exports.UserSourceEnum=void 0,(Yt=exports.UserSourceEnum||(exports.UserSourceEnum={})).APKPURE_BANNER="apkpure_banner",Yt.MYSHELL="myshell",Yt.VISITOR="visitor",exports.FollowStatus=void 0,(Ht=exports.FollowStatus||(exports.FollowStatus={})).FOLLOW_STATUS_UNSPECIFIED="FOLLOW_STATUS_UNSPECIFIED",Ht.FOLLOWED="FOLLOWED",Ht.NOT_FOLLOWED="NOT_FOLLOWED",Ht.NOT_AVAILABLE="NOT_AVAILABLE",exports.LoginType=void 0,(Vt=exports.LoginType||(exports.LoginType={})).LOGIN_TYPE_UNSPECIFIED="LOGIN_TYPE_UNSPECIFIED",Vt.LOGIN_TYPE_EMAIL="LOGIN_TYPE_EMAIL",Vt.LOGIN_TYPE_GOOGLE="LOGIN_TYPE_GOOGLE",Vt.LOGIN_TYPE_APPLE="LOGIN_TYPE_APPLE",Vt.LOGIN_TYPE_FACEBOOK="LOGIN_TYPE_FACEBOOK",Vt.LOGIN_TYPE_PUBLIC_ADDRESS="LOGIN_TYPE_PUBLIC_ADDRESS",function(e){e.BIND_TYPE_UNSPECIFIED="BIND_TYPE_UNSPECIFIED",e.BIND_TYPE_EVM_ADDRESS="BIND_TYPE_EVM_ADDRESS",e.BIND_TYPE_TWITTER="BIND_TYPE_TWITTER",e.BIND_TYPE_DISCORD="BIND_TYPE_DISCORD",e.BIND_TYPE_TG="BIND_TYPE_TG"}($t||($t={})),function(e){e.Privy="Privy",e.Particle="Particle",e.Other="Other"}(Wt||(Wt={})),function(e){e.CreatorPass="CreatorPass",e.MYSOUL="MYSOUL",e.ETH="ETH_MAINNET",e.ETH_MYSHELL="ETH_MYSHELL",e.BNB_OP="BNB_OP",e.BNB_BSC="BNB_BSC",e.testETH="testETH",e.HER="HER",e.PIC="PIC",e.LLM="LLM",e.SD="SD",e.TTS="TTS",e.USDC="USDC",e.USDT="USDT",e.BNB_USDC="BNB_USDC"}(Kt||(Kt={}));const qt=process.env.NEXT_PUBLIC_API_URL;process.env.NEXT_PUBLIC_WS_API_URL,process.env.NEXT_PUBLIC_PARTICLE_PROJECT_ID,process.env.NEXT_PUBLIC_PARTICLE_APP_ID,process.env.NEXT_PUBLIC_PARTICLE_CLIENT_ID,process.env.NEXT_PUBLIC_WC_PROJECT_ID,process.env.NEXT_PUBLIC_PRIVY_APP_ID;const Qt="https://www.myshellstatic.com/";process.env.NEXT_PUBLIC_HTML2IMAGE_URL,process.env.NEXT_PUBLIC_TG_BOT_NAME,process.env.NEXT_PUBLIC_DISCORD_CLIENT_ID,process.env.NEXT_PUBLIC_DISCORD_REDIRECT_URL,process.env.NEXT_PUBLIC_TWITTER_CLIENT_ID,process.env.NEXT_PUBLIC_TWITTER_REDIRECT_URL,process.env.NEXT_PUBLIC_TWITTER_CODE_CHALLENGE,process.env.NEXT_PUBLIC_DISABLE_GA,process.env.NEXT_PUBLIC_DISABLE_ADS,process.env.NEXT_PUBLIC_DATAFLUX_RUM_ID,process.env.NEXT_PUBLIC_DISABLE_DATAFLUX_RUM,process.env.NEXT_PUBLIC_DATAFLUX_RUM_ORIGIN,process.env.NEXT_PUBLIC_CAPTCHA_ID,process.env.NEXT_PUBLIC_UPDATE_REPORT_ADDRESS,process.env.NEXT_PUBLIC_DISABLE_SENSORS_TRACK,process.env.NEXT_PUBLIC_DISABLE_ANALYTICS,process.env.NEXT_PUBLIC_SALT,process.env.NEXT_PUBLIC_APP_URL,process.env.NEXT_PUBLIC_SENSORS_URL;const Xt=process.env.NEXT_PUBLIC_NETEASE_ENGINE_APP_ID;process.env.NEXT_PUBLIC_WEB3_API_URL,process.env.NEXT_PUBLIC_CONTRACT_ADDRESS_STAKING,process.env.NEXT_PUBLIC_SENSORS_ABTEST,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_VAPID_KEY,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_APIKEY,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_AUTHDOMAIN,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_PROJECTID,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_STORAGEBUCKET,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_MESSAGINGSENDERID,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_APPID,process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_MEASUREMENTID;const Jt=process.env.NEXT_PUBLIC_TRANSLATOR_BOT_ID,Zt=process.env.NEXT_PUBLIC_VIRTUOSO_MESSAGE_LIST_LICENSE;var es,ts,ss;!function(e){e.RUNNING_ERROR_TYPE_UNSPECIFIED="RUNNING_ERROR_TYPE_UNSPECIFIED",e.RUNNING_ERROR_TYPE_ENGINE_ERROR="RUNNING_ERROR_TYPE_ENGINE_ERROR",e.RUNNING_ERROR_TYPE_INNER_COMPONENT_ERROR="RUNNING_ERROR_TYPE_INNER_COMPONENT_ERROR",e.RUNNING_ERROR_TYPE_ENERGY_INSUFFICIANT="RUNNING_ERROR_TYPE_ENERGY_INSUFFICIANT",e.RUNNING_ERROR_TYPE_LLM_TOKEN_TOO_LONG="RUNNING_ERROR_TYPE_LLM_TOKEN_TOO_LONG"}(es||(es={})),function(e){e.DONE="DONE",e.PROCESSING="PROCESSING",e.ERROR="ERROR"}(ts||(ts={})),function(e){e.AUTH_FAIL="auth_fail",e.MSG_ERROR="message_error",e.MSG_SENT="message_sent",e.REPLY_MSG_CREATED="reply_message_created",e.MSG_UPDATED="message_updated",e.MSG_TEXT_STREAM="text_stream",e.MSG_AUDIO_STREAM="audio_stream",e.MSG_REPLIED="message_replied",e.MSG_TRANSLATED="message_translated",e.TRANSLATION_STREAM="translation_stream",e.ENERGY_INFO="energy_info",e.NO_ENOUGH_ENERGY="no_enough_energy",e.EXCEPTION="exception",e.RESET_MEMORY="reset_memory",e.BOT_PROMPT_UPDATED="bot_prompt_updated",e.CONNECTED_TO_DISCORD="connected_to_discord",e.CONNECTED_TO_TWITTER="connected_to_twitter",e.NEED_VERIFY_CAPTCHA="need_verify_captcha",e.VOICE_CALL_END="voice_call_end",e.CHAT_LOGIN_POPUP="chat_login_popup"}(ss||(ss={}));var as;function ns(e){return rs(e)&&(e||"").trim()?e.startsWith("http")?e:`${Qt}${e}`:e}function ls(){return"undefined"!=typeof window}function rs(e){return"string"==typeof e||e instanceof String}function is(e){return null==e||void 0===e}function os(){return x.v4()}function cs(e){if(isNaN(e)||e===1/0)return"";return function(e){const t=Math.floor(e/60),s=e%60;return`${(t<10&&t>0?"0":"")+t}:${s<10?"0":""}${s}`}(Math.floor(e))}function ds(e){const t=e.split(".");return t.length>1?t[t.length-1].toLowerCase():""}function us(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}!function(e){e.UNSPECIFIED="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_UNSPECIFIED",e.AUTO="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_AUTO",e.EN="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_EN",e.ZH="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_ZH",e.JA="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_JA",e.RU="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_RU",e.ES="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_ES",e.KO="BOT_CHAT_SETTING_SPEAKING_LANGUAGE_KO"}(as||(as={}));const ms=(e,t)=>{if(!e||!t)return 0;const s=e/t;return s>=1?1:s},ps=e=>e.reduce(((e,t)=>e+t),0);const fs=new class{constructor(){}getIsNewUser(){const e=localStorage.getItem("userId");return"1"===localStorage.getItem(`isnew-${e}`)}setIsNewUser(e){const t=localStorage.getItem("userId");localStorage.setItem(`isnew-${t}`,e?"1":"0")}getIsKol(){return"1"===localStorage.getItem("kol")}setIsKol(e){localStorage.setItem("kol",e?"1":"0")}setHasVisitedAIpp(e){localStorage.setItem("isFirstToAIpp",e.toString())}getHasVisitedAIpp(){return localStorage.getItem("isFirstToAIpp")||void 0}setIsViewedHowToPlay(e){localStorage.setItem("isViewedHowToPlay",e.toString())}getIsViewedHowToPlay(){return localStorage.getItem("isViewedHowToPlay")||void 0}getLoginMethod(){return localStorage.getItem("loginMethod")}getPrivyToken(){return localStorage.getItem("privy:token")}getInviteCode(){return localStorage.getItem("inviteCode")}setInviteCode(e){e?localStorage.setItem("inviteCode",e):localStorage.removeItem("inviteCode")}getPageSearch(e){return sessionStorage.getItem(`${e}-searchparams`)}setPageSearch(e,t){t?sessionStorage.setItem(`${e}-searchparams`,t):sessionStorage.removeItem(`${e}-searchparams`)}getSharingCode(){return localStorage.getItem("sharingCode")}setSharingCode(e){e?localStorage.setItem("sharingCode",e):localStorage.removeItem("sharingCode")}getSharingBotCode(){return localStorage.getItem("sharingBotCode")}setSharingBotCode(e){e?localStorage.setItem("sharingBotCode",e):localStorage.removeItem("sharingBotCode")}getSharingBotId(){return localStorage.getItem("sharingBotId")}setSharingBotId(e){e?localStorage.setItem("sharingBotId",e):localStorage.removeItem("sharingBotId")}getAnonymousId(){return localStorage.getItem("mix_sc_anonymous_id")}setAnonymousId(e){e?localStorage.setItem("mix_sc_anonymous_id",e):null===localStorage||void 0===localStorage||localStorage.removeItem("mix_sc_anonymous_id")}getSCDeviceId(){return localStorage.getItem("mix_sc_device_id")}setSCDeviceId(e){e?localStorage.setItem("mix_sc_device_id",e):null===localStorage||void 0===localStorage||localStorage.removeItem("mix_sc_device_id")}getPublicAddress(){return localStorage.getItem("publicAddress")||null}setPublicAddress(e){is(e)?localStorage.removeItem("publicAddress"):localStorage.setItem("publicAddress",`${e}`)}setShareWidgetLink(e){e?localStorage.setItem("shareWidgetLink",e):localStorage.removeItem("shareWidgetLink")}getShareWidgetLink(){var e;return null!==(e=localStorage.getItem("shareWidgetLink"))&&void 0!==e?e:void 0}setInviteInfo(e){return localStorage.setItem("inviteLink",e)}getInviteInfo(){var e;return null!==(e=localStorage.getItem("inviteLink"))&&void 0!==e?e:void 0}removeInviteInfo(){localStorage.removeItem("inviteLink")}setTgGuid(e){localStorage.setItem("tgGuid",e)}getTgGuid(){var e;return null!==(e=localStorage.getItem("tgGuid"))&&void 0!==e?e:void 0}setAutoEnhanced(e){localStorage.setItem("autoEnhanced",e)}getAutoEnhanced(){var e;return null!==(e=localStorage.getItem("autoEnhanced"))&&void 0!==e?e:void 0}setTryAdvanced(e){localStorage.setItem("tryAdvanced",e)}getTryAdvanced(){var e;return null!==(e=localStorage.getItem("tryAdvanced"))&&void 0!==e?e:void 0}setHasPrivyMarquee(e){const t=localStorage.getItem("userId");localStorage.setItem(`hasPrivyMarquee-${t}`,e)}getHasPrivyMarquee(){var e;const t=localStorage.getItem("userId");return null!==(e=localStorage.getItem(`hasPrivyMarquee-${t}`))&&void 0!==e?e:void 0}setUserGuide(e){const t=localStorage.getItem("userId");localStorage.setItem(`userGuide-${t}`,e)}getChatDrivered(){var e;return null!==(e=localStorage.getItem("handleOpenDrivered"))&&void 0!==e?e:void 0}setChatDrivered(e){localStorage.setItem("handleOpenDrivered",e)}getUserGuide(){var e;const t=localStorage.getItem("userId");return null!==(e=localStorage.getItem(`userGuide-${t}`))&&void 0!==e?e:void 0}clearTgGuid(){localStorage.removeItem("tgGuid")}clearInvitationData(){this.removeInviteInfo(),localStorage.removeItem("inviteCode"),localStorage.removeItem("sharingBotCode"),localStorage.removeItem("sharingBotUid"),localStorage.removeItem("sharingBotId"),localStorage.removeItem("sharingCode")}setBlockChainTransactionCalled(e,t,s){let a={};const n=this.getBlockChainTransactionCalled();n&&(a=Object.assign({},JSON.parse(n))),a[`${e}`]={step:t,expireTimeStamp:s},localStorage.setItem("blockChainTransactionCalled",JSON.stringify(a))}clearBlockChainTransactionCalled(e){let t={};const s=this.getBlockChainTransactionCalled();s&&(t=Object.assign({},JSON.parse(s))),delete t[`${e}`],localStorage.setItem("blockChainTransactionCalled",JSON.stringify(t))}getBlockChainTransactionCalled(){return localStorage.getItem("blockChainTransactionCalled")}setBlockChainGuruStep(e,t){let s={};const a=this.getBlockChainGuruStep();a&&(s=Object.assign({},JSON.parse(a))),s[e]=`${t}`,localStorage.setItem("blockChainGuruStep",JSON.stringify(s))}getBlockChainGuruStep(){return localStorage.getItem("blockChainGuruStep")}setBlockChainGuruHash(e,t){let s={};const a=this.getBlockChainGuruHash();a&&(s=Object.assign({},JSON.parse(a))),s[`${e}`]=t,localStorage.setItem("blockChainGuruHash",JSON.stringify(s))}clearBlockChainGuruHash(e){let t={};const s=this.getBlockChainGuruHash();s&&(t=Object.assign({},JSON.parse(s))),delete t[`${e}`],localStorage.setItem("blockChainGuruHash",JSON.stringify(t))}getBlockChainGuruHash(){return localStorage.getItem("blockChainGuruHash")}getLoginPopup(){return localStorage.getItem("loginPopup")}setLoginPopup(e){e?localStorage.setItem("loginPopup",e):localStorage.removeItem("loginPopup")}setTheme(e){localStorage.setItem("theme",e)}getTheme(){return localStorage.getItem("theme")}setWidgetTransactionDisplaySet(e){return localStorage.setItem("widgetTransactionDisplaySet",JSON.stringify(Array.from(e)))}getWidgetTextInputMap(){const e=localStorage.getItem("widgetTextInputMap");return is(e)?{}:JSON.parse(e)}removeTextInputMap(){localStorage.removeItem("textInputMap")}removeWidgetTextInputMap(){localStorage.removeItem("widgetTextInputMap")}setCreateDraft(e,t){null===e&&localStorage.removeItem(`createDraft${t}`),localStorage.setItem(`createDraft${t}`,JSON.stringify(e))}getCreateDraft(e){const t=localStorage.getItem(`createDraft${e}`);return is(t)?null:JSON.parse(t)}setDontShow2FA(e){localStorage.setItem("DontShow2FA",JSON.stringify(e))}getDontShow2FA(){const e=localStorage.getItem("DontShow2FA");return!is(e)&&JSON.parse(e)}getToken(){return localStorage.getItem("token")}setToken(e){e?localStorage.setItem("token",e):localStorage.removeItem("token")}clearAll(){const e=localStorage.getItem("userId");this.clearInvitationData(),localStorage.removeItem("publicAddress"),localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("selected_bot_id"),localStorage.removeItem("selected_ugc_bot_id"),localStorage.removeItem(`filterValues_${e}`),localStorage.removeItem(`childTagsObj_${e}`),localStorage.removeItem("sharingCode"),localStorage.removeItem("loginMethod")}};const hs={set language(e){if(!ls())throw new Error("Not support server-side call");window.$global.locale=e},get language(){if(!ls())throw new Error("Not support server-side call");return window.$global.locale},get visitorId(){if(!ls())throw new Error("Not support server-side call");return window.$global.visitorId?window.$global.visitorId:os()},get userId(){if(!ls())throw new Error("Not support server-side call");return window.$global.userId},set userId(e){if(!ls())throw new Error("Not support server-side call");window.$global.userId=e},get isLogin(){if(!ls())throw new Error("Not support server-side call");return window.$global.isLogin},set isLogin(e){if(!ls())throw new Error("Not support server-side call");window.$global.isLogin=e}};function gs(e){if("challenge"===e){const e=window.location.href,t=hs.userId,s=hs.visitorId,a=t?`userId=${t}`:`visitorId=${s}`,n=`${window.location.origin}/cf-captcha?originHref=${e}&${a}`;window.location.href=n}}const vs={events:{},dispatch(e,t){this.events[e]&&this.events[e].forEach((e=>e(t)))},subscribe(e,t,s){this.events[e]||(this.events[e]=[]);let a=t;s&&(a=s=>{t(s),this.unSubscribe(e)}),this.events[e].push(a)},unSubscribe(e,t){t?this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t))):delete this.events[e]}},xs=n.createStore((e=>({modalProps:{},openModal:t=>e({modalProps:Object.assign(Object.assign({},t),{onOk:s=>{var a;null===(a=t.onOk)||void 0===a||a.call(t,s),e({modalProps:{}})},onCancel:()=>{var s;null===(s=t.onCancel)||void 0===s||s.call(t),e({modalProps:{open:!1}})}})})}))).getState().openModal,bs={"/v1/shell_coins/exchange_shell_coin_with_season_points":"Redemption","/v1/shell_coins/exchange_shell_coin_with_badges":"Redemption","/v1/season/task/claim":"ClaimTask","/v1/season/task/claim_all_last_season_points":"ClaimTask","/v1/season/task/claim_all":"ClaimTask","/v2/season/task/claim_all":"ClaimTask","/v1/bot/chat/send_message":"SendMessage","/v2/season/reward/redeem":"Redemption","/v1/season/reward/auto_redeem_and_use_season_pass_if_needed":"ClaimPremiumCard"};var Es,_s;process.env.NEXT_PUBLIC_BSC_EXPLORE_URL,process.env.NEXT_PUBLIC_SHOW_BNB_USDC_BALANCE,process.env.NEXT_PUBLIC_SHOW_USDT_BALANCE,"production"===process.env.NEXT_PUBLIC_ENV?Q.bsc.id:Q.bscTestnet.id,function(e){e.Ethereum="Ethereum",e.BSC="BSC",e.OpBNB="opBNB",e.MyShell_Mainnet="MyShell Mainnet",e.MyShell_Testnet="MyShell Testnet",e.Base="Base",e.USDC="Ethereum",e.USDT="Ethereum"}(Es||(Es={})),function(e){e.Metamask="Metamask",e.OKX="OKX Web3 Wallet",e.WalletConnect="Wallet Connect",e.BSC="Binance Web3 Wallet",e.RABBY="Rabby Wallet"}(_s||(_s={})),Q.mainnet.id,Es.Ethereum,Q.bsc.id,Es.BSC,Q.bscTestnet.id,Es.BSC,Q.opBNB.id,Es.OpBNB,Es.Ethereum,Es.BSC,Es.OpBNB,Es.MyShell_Mainnet,Es.MyShell_Testnet,Es.Ethereum,ns("image/web3/20241022/eth.svg"),Es.BSC,ns("image/web3/20241022/bnb.svg"),Es.OpBNB,ns("image/web3/20241022/bnb.svg"),Es.MyShell_Mainnet,ns("image/web3/20241022/myshell_mainnet.svg"),Es.MyShell_Testnet,ns("image/web3/20241022/myshell_mainnet.svg"),Es.Base,ns("image/web3/20241022/base.svg");const ws="sensors_event_queue";const Ts=new class{constructor(){}addToQueue(e,t){const s=this.getQueue();s.push({eventName:e,eventProps:t}),this.saveQueue(s)}getQueue(){try{const e=localStorage.getItem(ws);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to parse queue from localStorage:",e),[]}}saveQueue(e){try{localStorage.setItem(ws,JSON.stringify(e))}catch(e){console.error("Failed to save queue to localStorage:",e)}}processNext(){const e=this.getQueue(),t=e.shift();return this.saveQueue(e),t}};const Ns=new class{constructor(){}track(e,t){var s,a;console.log("sensors track",e,t),(null===(s=null===window||void 0===window?void 0:window.sensors)||void 0===s?void 0:s.track)?null===(a=null===window||void 0===window?void 0:window.sensors)||void 0===a||a.track(e,Object.assign({},t||{})):Ts.addToQueue(e,t)}setOnceProfile(e){null===window||void 0===window||window.sensors.setOnceProfile(Object.assign({},e||{}))}setProfile(e){null===window||void 0===window||window.sensors.setProfile(Object.assign({},e||{}))}login(e){null===window||void 0===window||window.sensors.login(e)}};ls()&&(window.standaloneSensors=Ns);var ys=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Cs={en:"en",zh:"zh-CN","zh-tw":"zh-TW",es:"es",jp:"ja",ru:"ru",ko:"ko"},Ss=`${qt}`,js=async e=>{var t,s,a,n;const{isGoLang:l,allowAnonymous:r,withMyShellSecurityToken:i,serverContext:o}=e,c={};if(l&&(c["myshell-service-name"]="organics-api"),ls()&&!r&&!hs.isLogin){const{visitorId:e}=hs;e&&(c["visitor-id"]=e);const t=os().replace(/-/g,"");let s=fs.getSCDeviceId();if(s)s&&s.trim()&&(c["sc-cookie-id"]=s);else{const e=fs.getAnonymousId();e?s=e:(fs.setAnonymousId(t),s=t),c["sc-device-id"]=s}}if(ls()&&i)try{const e=await(async()=>{null==Ns||Ns.track("ReadyForYiDunToken");const e=(new Date).valueOf();try{const t=createNEGuardian({appId:Xt,timeout:1e4}),{code:s,token:a}=await t.getToken(),n=(new Date).valueOf()-e;if(null==Ns||Ns.track("ObtainYiDunToken",{result:200===s||201===s,time_spent:n}),200===s||201===s)return a;throw new Error("getNeteaseEngineToken Error")}catch(t){const s=(new Date).valueOf()-e;throw null==Ns||Ns.track("ObtainYiDunToken",{result:!1,time_spent:s}),console.error(t),new Error("getNeteaseEngineToken Error")}})();c["myshell-security-token"]=e}catch(e){}if(!ls()){if(c["x-call-from"]="myshell-ssr",!c.Authorization){const e=null===(s=null===(t=null==o?void 0:o.cookies)||void 0===t?void 0:t.get("ms_token"))||void 0===s?void 0:s.value;e&&(c.Authorization=`Bearer ${e}`)}c.Authorization||(c["sc-device-id"]||(c["sc-device-id"]="node-server"),c["visitor-id"]||(c["visitor-id"]=null===(a=null==o?void 0:o.headers)||void 0===a?void 0:a.get("x-visitor")))}c.platform="web",c.version="1.0.0";const d=(ls()?hs.language:null===(n=null==o?void 0:o.headers)||void 0===n?void 0:n.get("x-locale"))||"en";return c["Accept-Language"]=Cs[d],c["myshell-client-version"]="v1.6.4",c.timestamp=function(e){const t=(e-e%10)/10;let s=!1,a=0,n=t;for(;n;){const e=n%10;a+=(s?5:2)*e,n=(n-e)/10,s=!s}return 10*t+a%10}((new Date).getTime()),c},Is=async(e,t)=>{var s,a,n,l,r,i;const o=`${Ss}${e}`,{body:c,adapter:d,isGoLang:u,hideErrorToast:m,withMyShellSecurityToken:p,allowAnonymous:f,timeout:h,serverContext:g,params:v,signal:x,headers:b}=t,E=ys(t,["body","adapter","isGoLang","hideErrorToast","withMyShellSecurityToken","allowAnonymous","timeout","serverContext","params","signal","headers"]),_=(null==t?void 0:t.params)?`${o}${v}`:`${o}`,w=c?c instanceof FormData?{body:c}:{body:JSON.stringify(c)}:{},T=await js({isGoLang:u,withMyShellSecurityToken:p,allowAnonymous:f,serverContext:g}),N=Object.assign(Object.assign({},b||(c&&c instanceof FormData?{}:{"Content-Type":"application/json"})),T),y=h||("undefined"!=typeof window?15e3:5e3),C=new AbortController,S=x||(y?C.signal:void 0);let j;try{y&&setTimeout((()=>C.abort()),y),j=await fetch(_,Object.assign(Object.assign(Object.assign({},w),E),{headers:N,credentials:"include",signal:S,cache:"no-store"}));const s=j.headers.get("content-type"),a=j.headers.get("content-disposition"),n=!s||-1===s.indexOf("application/json")&&-1===s.indexOf("text/plain")?-1!==(null==a?void 0:a.indexOf("attachment"))?await j.blob():j:await j.json();if(j.status>=200&&j.status<300){if("undefined"!=typeof window){const e=fs.getToken(),t=j.headers.get("refreshed-auth-token");t&&t!==e&&fs.setToken(t)}return{success:!0,data:"function"==typeof d?d(n):n}}if(400===j.status&&"ERROR_REASON_SAFETY_NEED_VERIFY_CAPTCHA"===n.reason)return ls()&&await new Promise((t=>xs({open:!0,onOk:()=>t(),triggerScene:bs[e]}))),await Is(e,t);if(400!==j.status||m){if(429===j.status&&ls()){const{Message:e}=await Promise.resolve().then((function(){return Xl}));e.error({content:"request.error.rateLimit",translateInToast:!0,id:"request-429"})}if(403===j.status&&ls()){gs(j.headers.get("cf-mitigated"))}throw 401===j.status&&ls()&&vs.dispatch("Unauthorized",null),{status:j.status,data:n}}if(ls()){const{Message:e}=await Promise.resolve().then((function(){return Xl}));e.error({content:n.message,translateInToast:!0,id:"request-400"})}throw{status:j.status,data:Object.assign(Object.assign({},n),{reason:"request-400"}),message:n.message}}catch(e){const t=JSON.stringify({url:_,message:(null==e?void 0:e.message)?null==e?void 0:e.message:e,status:null==j?void 0:j.status,requestId:null===(s=null==j?void 0:j.headers)||void 0===s?void 0:s.get("organics-request-id"),headers:N,vid:ls()?hs.visitorId:null===(a=null==g?void 0:g.headers)||void 0===a?void 0:a.get("x-visitor"),reason:null==e?void 0:e.reason,cookie:null===(n=null==g?void 0:g.cookies)||void 0===n?void 0:n.toString()});console.error(t);let o=(null==e?void 0:e.message)||e;return(null==e?void 0:e.data)&&(o=Array.isArray(null==e?void 0:e.data.message)?e.data.message.join("; "):e.data.message),{success:!1,msg:o,reason:(null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.reason)||(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.message),metadata:null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.metadata,status:e.status}}},Os={get:async(e,t)=>Is(e,Object.assign(Object.assign({},t),{method:"GET"})),post:async(e,t)=>Is(e,Object.assign(Object.assign({},t),{method:"POST"})),put:async(e,t)=>Is(e,Object.assign(Object.assign({},t),{method:"PUT"})),patch:async(e,t)=>Is(e,Object.assign(Object.assign({},t),{method:"PATCH"})),delete:async(e,t)=>Is(e,Object.assign(Object.assign({},t),{method:"DELETE"}))},As=`${qt}`,Ms=ut.default.create({baseURL:As});const Ps=(e,t,s)=>{const a=ut.default.CancelToken.source(),n=e;return q.from(async function(e){const t=await js({isGoLang:null==e?void 0:e.isGoLang,allowAnonymous:null==e?void 0:e.allowAnonymous,withMyShellSecurityToken:null==e?void 0:e.withMyShellSecurityToken});return{timeout:(null==e?void 0:e.timeout)||15e3,headers:Object.assign({"Content-Type":"application/json"},t),withCredentials:!0}}(s)).pipe(q.mergeMap((e=>Ls(Ms.post(`${n}`,t,Object.assign({cancelToken:a.token},e)),a))))},Ls=(e,t,s)=>new q.Observable((s=>(e.then((e=>{s.next(e)})).catch((e=>{ut.default.isCancel(e)||s.error(e)})).finally((()=>{s.complete()})),()=>{t.cancel()}))).pipe(q.mergeMap((e=>ks(e))),q.catchError((e=>Rs(e)))),ks=(e,t)=>{var s;if(e.status>=K.HttpStatusCode.Ok&&e.status<K.HttpStatusCode.MultipleChoices){const t=fs.getToken(),a=null===(s=null==e?void 0:e.headers)||void 0===s?void 0:s["refreshed-auth-token"];return a&&a!==t&&fs.setToken(a),q.of(e.data)}return q.throwError((()=>e))},Rs=(e,t)=>{var s,a;if(e.message=JSON.stringify({url:null===(s=null==e?void 0:e.config)||void 0===s?void 0:s.url,message:null==e?void 0:e.message,headers:null==e?void 0:e.config.headers,response:null==e?void 0:e.response}),null===(a=null==e?void 0:e.response)||void 0===a?void 0:a.status){const{status:t,headers:s}=e.response,{data:a}=e.response;if(t<K.HttpStatusCode.Ok);else if(t===K.HttpStatusCode.Ok)null==a||a.message;else if(t>K.HttpStatusCode.Ok&&t<K.HttpStatusCode.MultipleChoices);else if(t===K.HttpStatusCode.BadRequest)console.log(a),(null==a?void 0:a.message)&&(Array.isArray(a.message)?a.message.join("; "):a.message);else if(t===K.HttpStatusCode.Unauthorized)vs.dispatch("Unauthorized",null);else if(t>K.HttpStatusCode.BadRequest&&t<K.HttpStatusCode.InternalServerError)if(t===K.HttpStatusCode.TooManyRequests);else if(t===K.HttpStatusCode.Forbidden){gs(s["cf-mitigated"])}}return q.throwError((()=>e))};var Ds=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function Us(e,t){const{userId:s,name:a,nameTag:n}=e||{};return Os.post("/v1/user/get_info",{body:Object.assign(Object.assign(Object.assign({},s&&{userId:s}),a&&{name:decodeURIComponent(a)}),n&&{nameTag:decodeURIComponent(n)}),isGoLang:!0,adapter:e=>{var t,s,a,n;const l=e.userDetail||{},r=(null==l?void 0:l.summary)||{},i=r.membershipInfo||{};return{avatar:r.avatar,email:r.email,id:r.id,isGenesisPasscard:i.type===zt.TYPE_GENESIS_WITH_GENESIS_CARD,isNftAvatar:r.isNftAvatar,isPasscard:i.type===zt.TYPE_GENESIS_WITH_PASS_CARD,level:i.type===zt.TYPE_GENESIS_WITH_GENESIS_CARD||i.type===zt.TYPE_GENESIS_WITH_PASS_CARD?3:i.type===zt.TYPE_PREMIUM?2:1,name:r.name,nameTag:r.nameTag,createdDate:r.userCreatedAt?Ve.default(Number(r.userCreatedAt)).format("YYYY-MM-DDTHH:mm:ssZ"):void 0,createdTime:r.userCreatedAt?Ve.default(Number(r.userCreatedAt)).format("YYYY-MM-DD HH:mm:ss.SSS"):void 0,publicAddress:r.publicAddress,source:r.userSource,hasParticleAccount:l.hasParticleAccount,privateBotLimit:i.privateBotLimit,publicBotLimit:i.publicBotLimit,premiumInfo:{level:null===(t=i.premiumInfo)||void 0===t?void 0:t.level,totalExp:null===(s=i.premiumInfo)||void 0===s?void 0:s.totalExp,nextLevelNeedExp:null===(a=i.premiumInfo)||void 0===a?void 0:a.nextLevelNeedExp,currentLevelExp:null===(n=i.premiumInfo)||void 0===n?void 0:n.currentLevelExp},canPublishNewBot:l.canPublishNewBot,connectInfo:l.connectInfo,followedCount:r.followedCount,fansCount:r.fansCount,hasFollowed:r.hasFollowed,followStatus:r.followStatus,description:r.description,backgroundUrl:r.backgroundUrl,loginCredential:l.loginCredential,loginType:l.loginType,publicKey:l.publicKey}},serverContext:t})}function Fs(e,t){return Os.post("/v1/shell_coins/list_account_orders",{body:{listRequest:{pageToken:e,pageSize:t}},isGoLang:!0})}function Bs(e){return Os.post("/v1/widget/list_user_public_widgets",{body:{userId:e},isGoLang:!0,adapter:e=>({widgets:e.widgets.map((e=>{var t,s;return Object.assign(Object.assign({},e),{imComponent:Object.assign(Object.assign({},e.imComponent),{componentsInput:null===(s=null===(t=e.imComponent)||void 0===t?void 0:t.componentsInput)||void 0===s?void 0:s.map((e=>{var t,s;let a="",n="",l=[];const r={};let i=[];switch(e.type){case"BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD":a="upload",i=e.supportedFileTypes;break;case"BOT_IM_COMPONENT_INPUT_TYPE_AUDIO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_AUDIO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_VIDEO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_IMAGE_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_TEXT_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT":a="textarea",n=e.stringDefault;break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR":a="select",n=e.textSelectorDefault,l=null===(t=e.textSelectorAllOf)||void 0===t?void 0:t.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT":a=e.hasNumberLimitation?"numberSlider":"numberInput",n=e.numberDefault,r.maxLength=e.numberMax,r.minLength=e.numberMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT":a=e.hasIntegerLimitation?"interSlider":"interInput",n=e.integerDefault,r.maxLength=e.integerMax,r.minLength=e.integerMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX":a="checkbox",n=e.booleanDefault;break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR":a="numberSelect",n=e.numberSelectorDefault,l=null===(s=e.numberSelectorAllOf)||void 0===s?void 0:s.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_CODE_EDITOR":a="codeEditor",n=e.stringDefault}return Object.assign(Object.assign({},e),{id:e.fieldName,serverType:e.type,props:r,rules:r,type:a,defaultValue:n,options:l,supportedFileTypes:i})}))})})}))})})}function Gs(e){return Os.post("/v1/user/update_user_settings",{isGoLang:!0,body:{settings:Array.isArray(e)?e:[e]}})}function zs({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const Ys=Fe.forwardRef(zs);function Hs({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const Vs=Fe.forwardRef(Hs);function $s({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Ws=Fe.forwardRef($s);function Ks({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const qs=Fe.forwardRef(Ks);function Qs({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const Xs=Fe.forwardRef(Qs);function Js({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15"}))}const Zs=Fe.forwardRef(Js);function ea({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const ta=Fe.forwardRef(ea);function sa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const aa=Fe.forwardRef(sa);function na({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const la=Fe.forwardRef(na);function ra({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ia=Fe.forwardRef(ra);function oa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const ca=Fe.forwardRef(oa);function da({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const ua=Fe.forwardRef(da);function ma({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const pa=Fe.forwardRef(ma);function fa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const ha=Fe.forwardRef(fa);function ga({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const va=Fe.forwardRef(ga);function xa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const ba=Fe.forwardRef(xa);function Ea({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const _a=Fe.forwardRef(Ea);function wa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Ta=Fe.forwardRef(wa);function Na({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const ya=Fe.forwardRef(Na);function Ca({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.498 15.25H4.372c-1.026 0-1.945-.694-2.054-1.715a12.137 12.137 0 0 1-.068-1.285c0-2.848.992-5.464 2.649-7.521C5.287 4.247 5.886 4 6.504 4h4.016a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23h1.294M7.498 15.25c.618 0 .991.724.725 1.282A7.471 7.471 0 0 0 7.5 19.75 2.25 2.25 0 0 0 9.75 22a.75.75 0 0 0 .75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 0 0 2.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384m-10.253 1.5H9.7m8.075-9.75c.01.05.027.1.05.148.593 1.2.925 2.55.925 3.977 0 1.487-.36 2.89-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398-.306.774-1.086 1.227-1.918 1.227h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 0 0 .303-.54"}))}const Sa=Fe.forwardRef(Ca);function ja({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const Ia=Fe.forwardRef(ja);function Oa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"}))}const Aa=Fe.forwardRef(Oa);function Ma({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM13.5 10.5h-6"}))}const Pa=Fe.forwardRef(Ma);function La({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607ZM10.5 7.5v6m3-3h-6"}))}const ka=Fe.forwardRef(La);function Ra({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const Da=Fe.forwardRef(Ra);function Ua({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 12H6"}))}const Fa=Fe.forwardRef(Ua);function Ba({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"}))}const Ga=Fe.forwardRef(Ba);function za({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))}const Ya=Fe.forwardRef(za);function Ha({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const Va=Fe.forwardRef(Ha);function $a({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const Wa=Fe.forwardRef($a);function Ka({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const qa=Fe.forwardRef(Ka);function Qa({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Xa=Fe.forwardRef(Qa);function Ja({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m6-6H6"}))}const Za=Fe.forwardRef(Ja);function en({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const tn=Fe.forwardRef(en);function sn({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const an=Fe.forwardRef(sn);function nn({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ln=Fe.forwardRef(nn);function rn({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const on=Fe.forwardRef(rn);function cn({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"}))}const dn=Fe.forwardRef(cn);function un({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"}))}const mn=Fe.forwardRef(un);function pn(...e){return W.twMerge(r.clsx(e))}function fn(e,t){return e.length>t?e.substring(0,t)+"...":e}const hn=new Map,gn=e=>{const t=hn.get(e);return t?Object.fromEntries(Object.entries(t.stores).map((([e,t])=>[e,t.getState()]))):{}},vn=(e,t={})=>(s,a,n)=>{const{enabled:l,anonymousActionType:r,store:i,...o}=t;let c;try{c=(null==l||l)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(e){}if(!c)return l&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(s,a,n);const{connection:d,...u}=((e,t,s)=>{if(void 0===e)return{type:"untracked",connection:t.connect(s)};const a=hn.get(s.name);if(a)return{type:"tracked",store:e,...a};const n={connection:t.connect(s),stores:{}};return hn.set(s.name,n),{type:"tracked",store:e,...n}})(i,c,o);let m=!0;n.setState=(e,t,l)=>{const c=s(e,t);if(!m)return c;const u=void 0===l?{type:r||"anonymous"}:"string"==typeof l?{type:l}:l;return void 0===i?(null==d||d.send(u,a()),c):(null==d||d.send({...u,type:`${i}/${u.type}`},{...gn(o.name),[i]:n.getState()}),c)};const p=(...e)=>{const t=m;m=!1,s(...e),m=t},f=e(n.setState,a,n);if("untracked"===u.type?null==d||d.init(f):(u.stores[u.store]=n,null==d||d.init(Object.fromEntries(Object.entries(u.stores).map((([e,t])=>[e,e===u.store?f:t.getState()]))))),n.dispatchFromDevtools&&"function"==typeof n.dispatch){let e=!1;const t=n.dispatch;n.dispatch=(...s)=>{"__setState"!==s[0].type||e||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),e=!0),t(...s)}}return d.subscribe((e=>{var t;switch(e.type){case"ACTION":return"string"!=typeof e.payload?void console.error("[zustand devtools middleware] Unsupported action format"):xn(e.payload,(e=>{if("__setState"!==e.type)n.dispatchFromDevtools&&"function"==typeof n.dispatch&&n.dispatch(e);else{if(void 0===i)return void p(e.state);1!==Object.keys(e.state).length&&console.error('\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using \'store\' option in devtools(), the \'state\' should have only one key, which is a value of \'store\' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }\n                    ');const t=e.state[i];if(null==t)return;JSON.stringify(n.getState())!==JSON.stringify(t)&&p(t)}}));case"DISPATCH":switch(e.payload.type){case"RESET":return p(f),void 0===i?null==d?void 0:d.init(n.getState()):null==d?void 0:d.init(gn(o.name));case"COMMIT":return void 0===i?void(null==d||d.init(n.getState())):null==d?void 0:d.init(gn(o.name));case"ROLLBACK":return xn(e.state,(e=>{if(void 0===i)return p(e),void(null==d||d.init(n.getState()));p(e[i]),null==d||d.init(gn(o.name))}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return xn(e.state,(e=>{void 0!==i?JSON.stringify(n.getState())!==JSON.stringify(e[i])&&p(e[i]):p(e)}));case"IMPORT_STATE":{const{nextLiftedState:s}=e.payload,a=null==(t=s.computedStates.slice(-1)[0])?void 0:t.state;if(!a)return;return p(void 0===i?a:a[i]),void(null==d||d.send(null,s))}case"PAUSE_RECORDING":return m=!m}return}})),f},xn=(e,t)=>{let s;try{s=JSON.parse(e)}catch(e){console.error("[zustand devtools middleware] Could not parse the received json",e)}void 0!==s&&t(s)};function bn(e,t){let s;try{s=e()}catch(e){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),n=null!=(t=s.getItem(e))?t:null;return n instanceof Promise?n.then(a):a(n)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const En=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>En(e)(s),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>En(t)(e)}}},_n=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?(console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),((e,t)=>(s,a,n)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},r=!1;const i=new Set,o=new Set;let c;try{c=l.getStorage()}catch(e){}if(!c)return e(((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),s(...e)}),a,n);const d=En(l.serialize),u=()=>{const e=l.partialize({...a()});let t;const s=d({state:e,version:l.version}).then((e=>c.setItem(l.name,e))).catch((e=>{t=e}));if(t)throw t;return s},m=n.setState;n.setState=(e,t)=>{m(e,t),u()};const p=e(((...e)=>{s(...e),u()}),a,n);let f;const h=()=>{var e;if(!c)return;r=!1,i.forEach((e=>e(a())));const t=(null==(e=l.onRehydrateStorage)?void 0:e.call(l,a()))||void 0;return En(c.getItem.bind(c))(l.name).then((e=>{if(e)return l.deserialize(e)})).then((e=>{if(e){if("number"!=typeof e.version||e.version===l.version)return e.state;if(l.migrate)return l.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}})).then((e=>{var t;return f=l.merge(e,null!=(t=a())?t:p),s(f,!0),u()})).then((()=>{null==t||t(f,void 0),r=!0,o.forEach((e=>e(f)))})).catch((e=>{null==t||t(void 0,e)}))};return n.persist={setOptions:e=>{l={...l,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>h(),hasHydrated:()=>r,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},h(),f||p})(e,t)):((e,t)=>(s,a,n)=>{let l={storage:bn((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},r=!1;const i=new Set,o=new Set;let c=l.storage;if(!c)return e(((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),s(...e)}),a,n);const d=()=>{const e=l.partialize({...a()});return c.setItem(l.name,{state:e,version:l.version})},u=n.setState;n.setState=(e,t)=>{u(e,t),d()};const m=e(((...e)=>{s(...e),d()}),a,n);let p;n.getInitialState=()=>m;const f=()=>{var e,t;if(!c)return;r=!1,i.forEach((e=>{var t;return e(null!=(t=a())?t:m)}));const n=(null==(t=l.onRehydrateStorage)?void 0:t.call(l,null!=(e=a())?e:m))||void 0;return En(c.getItem.bind(c))(l.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===l.version)return e.state;if(l.migrate)return l.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}})).then((e=>{var t;return p=l.merge(e,null!=(t=a())?t:m),s(p,!0),d()})).then((()=>{null==n||n(p,void 0),p=a(),r=!0,o.forEach((e=>e(p)))})).catch((e=>{null==n||n(void 0,e)}))};return n.persist={setOptions:e=>{l={...l,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>f(),hasHydrated:()=>r,onHydrate:e=>(i.add(e),()=>{i.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},l.skipHydration||f(),p||m})(e,t),wn=e=>(t,s,a)=>(a.setState=(e,s,...a)=>{const n="function"==typeof e?X.produce(e):e;return t(n,s,...a)},e(a.setState,s,a)),Tn={isMobile:!1,isFirstLoad:!0,isToInviteArea:!1,isOpenLoginModal:!1,isOpenLevelBenefitModal:!1,cantCloseLogin:!1,guiding:!1,isOpenInviteCodeModal:!1,showChatBotRecommend:!1,inviteCodeStep:1,loadingCount:0,createAutoPromptTaskResult:null,noEnergyWithUsablePropModalVisible:!1,onboarding:!1,sumUnread:0},Nn=e=>({isGlobalLoading:e.loadingCount>0});var yn,Cn,Sn,jn,In,On,An,Mn,Pn;!function(e){e.SEASON_TASK_TYPE_UNSPECIFIED="SEASON_TASK_TYPE_UNSPECIFIED",e.SEASON_TASK_TYPE_DAILY_MESSAGE="SEASON_TASK_TYPE_DAILY_MESSAGE",e.SEASON_TASK_TYPE_DC_INTERACTION="SEASON_TASK_TYPE_DC_INTERACTION",e.SEASON_TASK_TYPE_BLOCKCHAIN_INTERACTION="SEASON_TASK_TYPE_BLOCKCHAIN_INTERACTION",e.SEASON_TASK_TYPE_USE_VOICE_VIDEO="SEASON_TASK_TYPE_USE_VOICE_VIDEO",e.SEASON_TASK_TYPE_CREATE_BOT="SEASON_TASK_TYPE_CREATE_BOT",e.SEASON_TASK_TYPE_USE_VOICE_CLONE="SEASON_TASK_TYPE_USE_VOICE_CLONE",e.SEASON_TASK_TYPE_USE_AUTO_PROMPT="SEASON_TASK_TYPE_USE_AUTO_PROMPT",e.SEASON_TASK_TYPE_TALK_TO_GPT4_BOT="SEASON_TASK_TYPE_TALK_TO_GPT4_BOT",e.SEASON_TASK_TYPE_TALK_TO_BOTS="SEASON_TASK_TYPE_TALK_TO_BOTS",e.SEASON_TASK_TALK_TO_BOT_WITH_TAG="SEASON_TASK_TALK_TO_BOT_WITH_TAG",e.SEASON_TASK_TYPE_BOT_MASTER="SEASON_TASK_TYPE_BOT_MASTER",e.SEASON_TASK_TYPE_MODEL_MASTER="SEASON_TASK_TYPE_MODEL_MASTER",e.SEASON_TASK_TYPE_INVITEE_MESSAGE_LV1="SEASON_TASK_TYPE_INVITEE_MESSAGE_LV1",e.SEASON_TASK_TYPE_INVITEE_MESSAGE_LV2="SEASON_TASK_TYPE_INVITEE_MESSAGE_LV2",e.SEASON_TASK_TYPE_FANS_KEY="SEASON_TASK_TYPE_FANS_KEY",e.SEASON_TASK_TYPE_STAKING_EXPERIENCE="SEASON_TASK_TYPE_STAKING_EXPERIENCE",e.SEASON_TASK_TYPE_EXPERIENCE_IMAGE_BOTS="SEASON_TASK_TYPE_EXPERIENCE_IMAGE_BOTS",e.SEASON_TASK_TYPE_PUBLIC_VOICE_INCOME="SEASON_TASK_TYPE_PUBLIC_VOICE_INCOME",e.SEASON_TASK_TYPE_BIND_DC_ACCOUNT="SEASON_TASK_TYPE_BIND_DC_ACCOUNT",e.SEASON_TASK_TYPE_PATRON_BADGE="SEASON_TASK_TYPE_PATRON_BADGE",e.SEASON_TASK_TYPE_TWEET_SHARE="SEASON_TASK_TYPE_TWEET_SHARE",e.SEASON_TASK_TYPE_SOCIAL_MEDIA_SHARE="SEASON_TASK_TYPE_SOCIAL_MEDIA_SHARE",e.SEASON_TASK_TOP_CURVE_HOLDERS_DAILY_INCOME="SEASON_TASK_TOP_CURVE_HOLDERS_DAILY_INCOME",e.SEASON_TASK_TYPE_LUCKY_STAR="SEASON_TASK_TYPE_LUCKY_STAR",e.SEASON_TASK_TYPE_CURVE_PROFIT_SHARE="SEASON_TASK_TYPE_CURVE_PROFIT_SHARE",e.SEASON_TASK_TYPE_JACKPOT="SEASON_TASK_TYPE_JACKPOT",e.SEASON_TASK_TYPE_FOLLOW_MYSHELL_SHARE_TWEET="SEASON_TASK_TYPE_FOLLOW_MYSHELL_SHARE_TWEET",e.SEASON_TASK_TYPE_TRADING_NOVICE="SEASON_TASK_TYPE_TRADING_NOVICE",e.SEASON_TASK_TYPE_TRADING_MAESTRO="SEASON_TASK_TYPE_TRADING_MAESTRO",e.SEASON_TASK_TYPE_MARKET_CAP_CLIMBER="SEASON_TASK_TYPE_MARKET_CAP_CLIMBER",e.SEASON_TASK_TYPE_MARKET_CAP_CRAFTER="SEASON_TASK_TYPE_MARKET_CAP_CRAFTER",e.SEASON_TASK_TYPE_AIPP_ADVOCATE="SEASON_TASK_TYPE_AIPP_ADVOCATE",e.SEASON_TASK_TYPE_KOL_INVITEE_INTERACTION="SEASON_TASK_TYPE_KOL_INVITEE_INTERACTION"}(yn||(yn={})),function(e){e.SEASON_TASK_ITEM_STATUS_UNSPECIFIED="SEASON_TASK_ITEM_STATUS_UNSPECIFIED",e.SEASON_TASK_ITEM_STATUS_IN_PROGRESS="SEASON_TASK_ITEM_STATUS_IN_PROGRESS",e.SEASON_TASK_ITEM_STATUS_PRE_CLAIMABLE="SEASON_TASK_ITEM_STATUS_PRE_CLAIMABLE",e.SEASON_TASK_ITEM_STATUS_CLAIMABLE="SEASON_TASK_ITEM_STATUS_CLAIMABLE",e.SEASON_TASK_ITEM_STATUS_CLAIMED="SEASON_TASK_ITEM_STATUS_CLAIMED",e.SEASON_TASK_ITEM_STATUS_UNAVAILABLE="SEASON_TASK_ITEM_STATUS_UNAVAILABLE",e.SEASON_TASK_ITEM_STATUS_MONTHLY_LIMIT_REACHED="SEASON_TASK_ITEM_STATUS_MONTHLY_LIMIT_REACHED"}(Cn||(Cn={})),function(e){e.standardBattlePass="standardBattlePass",e.genesisPass="genesisPass",e.seasonBadge="seasonBadge",e.energyPack="energyPack",e.shellCoin="shellCoin"}(Sn||(Sn={})),function(e){e.BACKPACK_ITEM_STATUS_UNSPECIFIED="BACKPACK_ITEM_STATUS_UNSPECIFIED",e.BACKPACK_ITEM_STATUS_COMING_SOON="BACKPACK_ITEM_STATUS_COMING_SOON",e.BACKPACK_ITEM_STATUS_DISABLED="BACKPACK_ITEM_STATUS_DISABLED"}(jn||(jn={})),function(e){e.BACKPACK_ITEM_STATUS_UNSPECIFIED="BACKPACK_ITEM_STATUS_UNSPECIFIED",e.BACKPACK_ITEM_STATUS_COMING_SOON="BACKPACK_ITEM_STATUS_COMING_SOON",e.BACKPACK_ITEM_STATUS_DISABLED="BACKPACK_ITEM_STATUS_DISABLED"}(In||(In={})),function(e){e.ORDER_SOURCE_TYPE_UNSPECIFIED="ORDER_SOURCE_TYPE_UNSPECIFIED",e.ORDER_SOURCE_TYPE_SEASON_POINT_EXCHANGE="ORDER_SOURCE_TYPE_SEASON_POINT_EXCHANGE",e.ORDER_SOURCE_TYPE_BADGE_EXCHANGE="ORDER_SOURCE_TYPE_BADGE_EXCHANGE",e.ORDER_SOURCE_TYPE_BUY_SHARE_KEY="ORDER_SOURCE_TYPE_BUY_SHARE_KEY",e.ORDER_SOURCE_TYPE_SELL_SHARE_KEY="ORDER_SOURCE_TYPE_SELL_SHARE_KEY"}(On||(On={})),function(e){e.ORDER_STATUS_UNSPECIFIED="ORDER_STATUS_UNSPECIFIED",e.ORDER_STATUS_WAITING_PAY="ORDER_STATUS_WAITING_PAY",e.ORDER_STATUS_PAID="ORDER_STATUS_PAID",e.ORDER_STATUS_CANCELED="ORDER_STATUS_CANCELED"}(An||(An={})),function(e){e.SEASON_STATUS_UNSPECIFIED="SEASON_STATUS_UNSPECIFIED",e.SEASON_STATUS_ON_GOING="SEASON_STATUS_ON_GOING",e.SEASON_STATUS_PREPARING_FOR_REWARDS="SEASON_STATUS_PREPARING_FOR_REWARDS",e.SEASON_STATUS_REWARDS_REDEMPTION="SEASON_STATUS_REWARDS_REDEMPTION",e.SEASON_STATUS_FINISHED="SEASON_STATUS_FINISHED"}(Mn||(Mn={})),function(e){e.USER_POINT_TYPE_GENERAL="USER_POINT_TYPE_GENERAL",e.USER_POINT_TYPE_ADVOCATOR="USER_POINT_TYPE_ADVOCATOR",e.USER_POINT_TYPE_CREATOR="USER_POINT_TYPE_CREATOR",e.USER_POINT_TYPE_INVESTOR="USER_POINT_TYPE_INVESTOR"}(Pn||(Pn={}));const Ln={seasons:null,seasonIndex:0,taskList:[],newlyPropsCount:0,points:[],claimedPoints:0,exchangePoints:[],myProps:[],deductionPoints:null,seasonPassUseSuccessModalVisible:!1,holdBadges:[],txHash:void 0,blockChainInteractionState:"not_start",rewardList:[],rewardQuerying:!0,myPropsQuerying:!0},kn=n.create()(Be.default(wn(vn((e=>Object.assign(Object.assign({},Ln),{setUnclaimedPoints(t){e({unclaimedPoints:t},!1,"setUnclaimedPoints")},setExchangePoints(t){e({exchangePoints:t},!1,"setExchangePoints")},setSeasons(t,s){e({seasons:[t,s]},!1,"setSeasons")},setSeasonIndex(t){e({seasonIndex:t},!1,"setSeasonIndex")},setTaskList(t){e({taskList:t},!1,"setTaskList")},setPoints(t,s=!1){e({points:t},!1,"setPoints")},clearClaimedPoints(){e({claimedPoints:0},!1,"clearClaimedPoints")},setMyProps(t){e({myProps:t},!1,"setMyProps")},setNewlyPropsCount(t){e({newlyPropsCount:t},!1,"setNewlyPropsCount")},setDeductionPoints(t){e({deductionPoints:t},!1,"setDeductionPoints")},setSeasonPassUseSuccessModalVisible(t){e({seasonPassUseSuccessModalVisible:t},!1,"setSeasonPassUseSuccessModalVisible")},setHoldBadges(t){e((e=>{e.holdBadges=t}),!1,"setHoldBadges")},setTxHash(t){e({txHash:t},!1,"setTxHash")},setBlockChainInteractionState(t){e({blockChainInteractionState:t},!1,"setBlockChainInteractionState")},setRewardList(t){e({rewardList:t},!1,"setRewardList")},setRewardQuerying(t){e({rewardQuerying:t},!1,"setRewardQuering")},setMyPropsQuerying(t){e({myPropsQuerying:t},!1,"setMyPropsQuerying")}})),{store:"task"})),(e=>{var t,s,a,n,l,r,i,o,c,d,u,m,p,f,h,g,v;return{seasonId:e.seasons?null===(t=e.seasons[e.seasonIndex])||void 0===t?void 0:t.id:null,seasonName:e.seasons?null===(s=e.seasons[e.seasonIndex])||void 0===s?void 0:s.name:null,isBeta:e.seasons?null===(a=e.seasons[e.seasonIndex])||void 0===a?void 0:a.isBate:null,seasonBanners:e.seasons?[null===(n=e.seasons[e.seasonIndex])||void 0===n?void 0:n.bannerPcLight,null===(l=e.seasons[e.seasonIndex])||void 0===l?void 0:l.bannerPcDark,null===(r=e.seasons[e.seasonIndex])||void 0===r?void 0:r.bannerMobileLight,null===(i=e.seasons[e.seasonIndex])||void 0===i?void 0:i.bannerMobileDark]:null,seasonStartDate:e.seasons&&null!==(c=null===(o=e.seasons[e.seasonIndex])||void 0===o?void 0:o.startDate)&&void 0!==c?c:null,seasonEndDate:e.seasons&&null!==(u=null===(d=e.seasons[e.seasonIndex])||void 0===d?void 0:d.endDate)&&void 0!==u?u:null,claimableStartDate:e.seasons&&null!==(p=null===(m=e.seasons[e.seasonIndex])||void 0===m?void 0:m.claimableStart)&&void 0!==p?p:null,claimableEndDate:e.seasons&&null!==(h=null===(f=e.seasons[e.seasonIndex])||void 0===f?void 0:f.claimableEnd)&&void 0!==h?h:null,silentPeriodEndDate:e.seasons&&null!==(v=null===(g=e.seasons[e.seasonIndex])||void 0===g?void 0:g.silentPeriodEnd)&&void 0!==v?v:null,hasClaimableTask:e.taskList.some((e=>e.status===Cn.SEASON_TASK_ITEM_STATUS_CLAIMABLE)),seasonPoints:Array.isArray(e.points)?e.points[e.seasonIndex]:void 0}}))),Rn={user:null,inviteCode:"",invitationCount:0,validInvitationCount:0,tgValidInvitationCount:0,inviteLink:"",retriveEnergySuccess:!1,energy:0,dailyEnergy:0,isEnergyOverflow:!1,tgInfo:null,connectedAccounts:null,userSettingsInfo:[{name:Ut.FLAG_ICON_REWARD,value:"1"},{name:Ut.FLAG_ICON_FORUM,value:"1"},{name:Ut.FLAG_TAG_NOTICE,value:"1"},{name:Ut.FLAG_USET_FIRST_PUBLISH_GALLERY,value:"1"},{name:Ut.FLAG_USET_FIRST_VISIT_GALLERY,value:"1"},{name:Ut.FLAG_LLM_MODEL_CONFIG,value:"1"},{name:Ut.SHOW_NSFW,value:"0"},{name:Ut.FLAG_NSFW_CONFIRMED,value:"0"},{name:Ut.LAST_SEASON,value:"0"},{name:Ut.FLAG_stake_earn_VIEWED,value:"1"},{name:Ut.FLAG_SHARE_KEY_EARN_POPUP_CONFIRMED,value:"0"},{name:Ut.NOTIFICATION,value:"0"}],rewardsCenterVisited:!1,forumVisited:!1,tagNoticeVisited:!1,flagUserFirstPublishGallery:!1,flagUserFirstVisitGallery:!1,modelConfigClicked:!1,showNsfw:Bt.INIT,nsfwConfirmed:!1,nsfwSwitch:!0,isLogin:!1,shellCoins:null,frozenShellCoins:null,loginMethod:void 0,language:"en",loginPopVisible:!1},Dn=e=>{var t,s,a,n;return{isVisitor:e.isLogin&&(null===(t=e.user)||void 0===t?void 0:t.source)!==exports.UserSourceEnum.VISITOR?Ft.NO:Ft.YES,userId:null===(s=e.user)||void 0===s?void 0:s.id,premiumInfo:e.user?e.user.premiumInfo:{level:0,totalExp:0,nextLevelNeedExp:0,currentLevelExp:5},isEnergyOverflow:e.energy>e.dailyEnergy,rewardsCenterVisited:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_ICON_REWARD&&"1"===e.value)),forumVisited:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_ICON_FORUM&&"1"===e.value)),tagNoticeVisited:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_TAG_NOTICE&&"1"===e.value)),flagUserFirstPublishGallery:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_USET_FIRST_PUBLISH_GALLERY&&"1"===e.value)),flagUserFirstVisitGallery:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_USET_FIRST_VISIT_GALLERY&&"1"===e.value)),modelConfigClicked:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_LLM_MODEL_CONFIG)),nsfwConfirmed:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_NSFW_CONFIRMED&&"1"===e.value)),blockChainGuruTaskOnceCompleted:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_COMPLETED_OPBNB_CHAIN_TASK&&"1"===e.value)),silentPeriodConfirmed:e.userSettingsInfo.find((e=>e.name===Ut.FLAG_SILENT_PERIOD_CONFIRMED))?e.userSettingsInfo.some((e=>{var t;return e.name===Ut.FLAG_SILENT_PERIOD_CONFIRMED&&e.value!==(null===(t=kn.getState().seasons)||void 0===t?void 0:t[1].id)})):null,deductionConfirmed:e.userSettingsInfo.find((({name:e})=>"flagDeductionConfirmed"===e))?e.userSettingsInfo.some((e=>{var t;return e.name===Ut.DEDUCTION_CONFIRMED&&e.value!==(null===(t=kn.getState().seasons)||void 0===t?void 0:t[1].id)})):null,subscribingEarnViewed:e.userSettingsInfo.some((e=>e.name===Ut.FLAG_stake_earn_VIEWED&&"1"===e.value)),nsfwSwitch:e.nsfwSwitch,timezone:null===(a=e.userSettingsInfo.find((e=>e.name===Ut.TIME_ZONE)))||void 0===a?void 0:a.value,notification:"1"===(null===(n=e.userSettingsInfo.find((e=>e.name===Ut.NOTIFICATION)))||void 0===n?void 0:n.value)}};function Un(e){return Os.post("/v1/bot/chat/set_message_handled",{body:{msgId:e},isGoLang:!0})}function Fn(e){return Os.post("/v1/bot/chat/remove_bot_from_chat_list",{body:{botId:e},isGoLang:!0})}const Bn=new Map;async function Gn(e){if(!Bn.has(e)){const t=await function(e){return Os.post("/v1/bot/shared/generate_bot_shared_code",{body:{botId:e},isGoLang:!0})}(e);t.success&&t.data.code&&Bn.set(e,t.data.code)}return Bn.get(e)}function zn(e){return Os.post("/v1/bot/im/media_file_metadata",{body:e,isGoLang:!0}).then((e=>null==e?void 0:e.data))}X.enableMapSet();const Yn={inputType:"text",lastInputType:"text",multiBotMap:{},multiPublishMap:{},selectedDeleteChatList:[],playingAudio:null,audioQueue:[],sending:!1,copyText:"",chatBodyType:"",fileUpload:{uploading:null,filesMap:{},deletedList:[],alert:{},dragModal:!1},errorMsgList:{},hasUnRead:!1},Hn=n.create()(wn(vn(((...e)=>Object.assign({},(e=>Object.assign(Object.assign({},Yn),{multiBotMap:{},setInputType(t){e((e=>{["share","delete","publish"].includes(t)&&["audio","text"].includes(e.inputType)?e.lastInputType=e.inputType:e.lastInputType=t,e.inputType=t}),!1,"setInputType")},setMessageHandled({botId:t,msgId:s}){e((e=>{Un(s);const a=e.multiBotMap[String(t)].chatDic.get(s);e.multiBotMap[String(t)].chatDic.set(s,Object.assign(Object.assign({},a),{handled:!0})),e.multiBotMap[String(t)].chatList=[...e.multiBotMap[String(t)].chatDic.values()]}),!1,"setMessageHandled")},setMultiPublishMap(t,s){e((e=>{e.multiPublishMap[t]?delete e.multiPublishMap[t]:e.multiPublishMap[t]=s}),!1,"setMultiPublishMap")},clearMultiPublishMap(){e((e=>{e.multiPublishMap={}}),!1,"clearMultiPublishMap")},pushAudioIdToQueue(t){e((e=>{e.audioQueue.push(t),e.audioQueue=Array.from(new Set(e.audioQueue))}),!1,"pushAudioIdToQueue")},setErrorMsg(t,s){e((e=>{e.errorMsgList||(e.errorMsgList={}),e.errorMsgList[t]=s}),!0,"setErrorMsg")},removePlayedAudio(t){e((e=>{e.audioQueue=e.audioQueue.filter((e=>e!==t))}),!1,"removePlayedAudio")},clearAudioQueue(){e((e=>{e.audioQueue=[],e.playingAudio=null}),!1,"clearAudioQueue")},changePlayingAudio(t){e((e=>{e.playingAudio=null!=t?t:null}),!1,"changePlayingAudio")},setChatBodyType(t){e((e=>{e.chatBodyType=t}),!1,"setChatBodyType")},setHasUnRead(t){e((e=>{e.hasUnRead=t}),!1,"setHasUnRead")},setFileAlert(t){e((e=>{console.log(t),e.fileUpload.alert=t}))},showDragModal(t){e((e=>{e.fileUpload.dragModal=t}))}}))(...e))),{store:"chat"})));as.AUTO,X.enableMapSet();const Vn={updatingBotList:!1,botList:[],botLastMessageMap:new Map,selectedBotList:[],tagList:[],ugcBotList:[],ownUgcBotList:[],selectedUgcBotId:"",activeType:"all",name:"",pageToken:"0",dataPush:!1,filters:null,checkedFiltersSet:new Set,isFromLandingPage:!1,kolInfo:null,recommend:{banners:[],list:[]},tagFilters:[],searchList:[],botChatSettingMap:new Map,homeData:null,includeTagIds:[]},$n=()=>{if("undefined"!=typeof window){return!!new URLSearchParams(window.location.search).get("apkpure_vid")}return!1};var Wn,Kn,qn,Qn,Xn,Jn,Zn,el;n.create()(Be.default(wn(vn((e=>Object.assign(Object.assign({},Vn),{isFromLandingPage:$n(),setUpdatingBotList(t){e({updatingBotList:t},!1,"setUpdatingBotList")},setBotList(t){e({botList:t},!1,"setBotList")},setOwnUgcBotList(t){e({ownUgcBotList:t},!1,"setOwnUgcBotList")},setSelectedUgcBotId(t){e({selectedUgcBotId:t},!1,"setSelectedUgcBotId"),t?localStorage.setItem("selected_ugc_bot_id",t):localStorage.removeItem("selected_ugc_bot_id")},batchSetBotLastMessage(t){e((e=>{for(const s of t)if(s.lastMessage){const t=Object.assign(Object.assign({},s.lastMessage),{createdDate:new Date(s.lastMessage.createdDate).getTime()});e.botLastMessageMap.set(String(s.id),t)}}))},setBotLastMessage(t,s){e((e=>{if(s){const a=Object.assign(Object.assign({},s),{createdDate:new Date(s.createdDate||Number(s.createdDateUnix)).getTime()});e.botLastMessageMap.set(t,a);const n=e.botList.find((e=>e.id===t));if(n){const s=e.botList.filter((e=>e.id!==t));if(n.pinned)e.botList=[n,...s];else{const t=s.filter((e=>e.pinned)),a=s.filter((e=>!e.pinned));e.botList=[...t,n,...a]}}}else e.botLastMessageMap.delete(t)}),!1,"setBotLastMessage")},reset(){e(Vn,!1,"reset")},setKolInfo(t){e({kolInfo:t},!1,"setKolInfo")},setRecommend(t){e({recommend:t},!1,"setRecommend")},setTagFilters(t){e({tagFilters:t},!1,"setTagFilters")},setSearchList(t){e({searchList:t},!1,"setSearchList")},setHomeData(t){e({homeData:t},!1,"setHomeData")},setPageToken(t){e({pageToken:t},!1,"setPageToken")},setDataPush(t){e({dataPush:t},!1,"setDataPush")},setActiveType(t){e({activeType:t},!1,"setActiveType")},setBotChatSetting(t,s){e((e=>{e.botChatSettingMap.set(t,s)}),!1,"setBotChatSetting")},clearBotChatSetting(){e((e=>{e.botChatSettingMap.clear()}),!1,"clearBotChatSetting")},updateBotEnergyPerChat(t,s,a){e((e=>{const n=e.botList.find((e=>e.id==t));(null==n?void 0:n.energyPerChat)&&(n.energyPerChat=s),(null==n?void 0:n.llmModel)&&(n.llmModel.energyPerLevelByPass=a)}),!1,"updateBotEnergyPerChat")},setSSECtrl(t){e({sseCtrl:t},!1,"setSSECtrl")}})),{store:"bot"})),(e=>({sumUnReadMessageCount:e.botList.reduce(((e,t)=>e+t.unreadMessageCount),0)})))),function(e){e.TYPE_NORMAL_TITLE="TYPE_NORMAL_TITLE",e.TYPE_SLIDER="TYPE_SLIDER",e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED"}(Wn||(Wn={})),function(e){e.MEDIA_TYPE_VIDEO="MEDIA_TYPE_VIDEO",e.MEDIA_TYPE_IMAGE="MEDIA_TYPE_IMAGE",e.MEDIA_TYPE_UNSPECIFIED="MEDIA_TYPE_UNSPECIFIED"}(Kn||(Kn={})),function(e){e.STATUS_UNSPECIFIED="STATUS_UNSPECIFIED",e.STATUS_PUBLIC="STATUS_PUBLIC",e.STATUS_PRIVATE="STATUS_PRIVATE"}(qn||(qn={})),function(e){e.BOT_CHAT_PANEL_TYPE_UNSPECIFIED="BOT_CHAT_PANEL_TYPE_UNSPECIFIED",e.BOT_CHAT_PANEL_TYPE_IM="BOT_CHAT_PANEL_TYPE_IM",e.BOT_CHAT_PANEL_TYPE_IMAGE_GEN="BOT_CHAT_PANEL_TYPE_IMAGE_GEN",e.BOT_CHAT_PANEL_TYPE_COMPONENT="BOT_CHAT_PANEL_TYPE_COMPONENT"}(Qn||(Qn={})),function(e){e.BOT_IM_SLASH_PARAM_TYPE_UNSPECIFIED="BOT_IM_SLASH_PARAM_TYPE_UNSPECIFIED",e.BOT_IM_SLASH_PARAM_TYPE_NUMBER="BOT_IM_SLASH_PARAM_TYPE_NUMBER",e.BOT_IM_SLASH_PARAM_TYPE_STRING="BOT_IM_SLASH_PARAM_TYPE_STRING"}(Xn||(Xn={})),function(e){e.MESSAGE_METADATA_TYPE_UNSPECIFIED="MESSAGE_METADATA_TYPE_UNSPECIFIED",e.MESSAGE_METADATA_TYPE_IMAGE_FILE="MESSAGE_METADATA_TYPE_IMAGE_FILE",e.MESSAGE_METADATA_TYPE_TEXT_FILE="MESSAGE_METADATA_TYPE_TEXT_FILE",e.MESSAGE_METADATA_TYPE_ALL_FILE="MESSAGE_METADATA_TYPE_ALL_FILE",e.MESSAGE_METADATA_TYPE_AUDIO_FILE="MESSAGE_METADATA_TYPE_AUDIO_FILE",e.MESSAGE_METADATA_TYPE_VIDEO_FILE="MESSAGE_METADATA_TYPE_VIDEO_FILE",e.MESSAGE_METADATA_TYPE_TEXT_CONTENT="MESSAGE_METADATA_TYPE_TEXT_CONTENT",e.MESSAGE_METADATA_TYPE_USER_AUDIO="MESSAGE_METADATA_TYPE_USER_AUDIO",e.MESSAGE_METADATA_TYPE_COMPONENT_INPUT="MESSAGE_METADATA_TYPE_COMPONENT_INPUT",e.MESSAGE_METADATA_TYPE_ASYNC_JOB_INFO="MESSAGE_METADATA_TYPE_ASYNC_JOB_INFO"}(Jn||(Jn={})),function(e){e.BOT_IM_COMPONENT_INPUT_TYPE_UNSPECIFIED="BOT_IM_COMPONENT_INPUT_TYPE_UNSPECIFIED",e.BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR="BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR",e.BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT="BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT",e.BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX="BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX",e.BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR",e.BOT_IM_COMPONENT_INPUT_TYPE_CODE_EDITOR="BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR"}(Zn||(Zn={})),function(e){e.WIDGET_CHAT_CALLER_TYPE_UNSPECFIED="WIDGET_CHAT_CALLER_TYPE_UNSPECFIED",e.WIDGET_CHAT_CALLER_TYPE_PROMPT="WIDGET_CHAT_CALLER_TYPE_PROMPT",e.WIDGET_CHAT_CALLER_TYPE_VOICE="WIDGET_CHAT_CALLER_TYPE_VOICE",e.WIDGET_CHAT_CALLER_TYPE_COMPONENT="WIDGET_CHAT_CALLER_TYPE_COMPONENT"}(el||(el={}));const tl=new Map;async function sl(e){if(!tl.has(e)){const t=await function(e){return Os.post("/v1/shared/generate_shared_code",{body:{bizId:e,bizType:"BIZ_TYPE_WIDGET"},isGoLang:!0})}(e);t.success&&t.data&&tl.set(e,t.data.code)}return tl.get(e)}function al(e){return Os.post("/v1/widget/chat/remove_widget_from_chat_list",{body:{widgetId:e},isGoLang:!0})}var nl,ll,rl,il,ol,cl;!function(e){e.DEPLOY_STATUS_UNKNOWN="DEPLOY_STATUS_UNKNOWN",e.DEPLOY_STATUS_IGNORE="DEPLOY_STATUS_IGNORE",e.DEPLOY_STATUS_REQUIRE_DEPLOY="DEPLOY_STATUS_REQUIRE_DEPLOY",e.DEPLOY_STATUS_IN_PROGRESS="DEPLOY_STATUS_IN_PROGRESS",e.DEPLOY_STATUS_COMPLETED="DEPLOY_STATUS_COMPLETED",e.DEPLOY_STATUS_FAILED="DEPLOY_STATUS_FAILED",e.ERROR_REASON_INTERNAL_SERVER_ERROR="ERROR_REASON_INTERNAL_SERVER_ERROR"}(nl||(nl={})),function(e){e.SCENARIO_BOT_PHOTO="SCENARIO_BOT_PHOTO",e.SCENARIO_BOT_REPLY_TTS_VOICE="SCENARIO_BOT_REPLY_TTS_VOICE",e.SCENARIO_USER_BOT_CHAT_VOICE="SCENARIO_USER_BOT_CHAT_VOICE",e.SCENARIO_USER_AVATAR="SCENARIO_USER_AVATAR",e.SCENARIO_USER_BACKGROUND="SCENARIO_USER_BACKGROUND",e.SCENARIO_BOT_VOICE="SCENARIO_BOT_VOICE",e.SCENARIO_BOT_LOGO="SCENARIO_BOT_LOGO",e.SCENARIO_BOT_VOICE_SAMPLE_AUDIO="SCENARIO_BOT_VOICE_SAMPLE_AUDIO",e.SCENARIO_BOT_VOICE_LOGO="SCENARIO_BOT_VOICE_LOGO",e.SCENARIO_IM_CHAT="SCENARIO_IM_CHAT",e.SCENARIO_CURVE_COMMENT="SCENARIO_CURVE_COMMENT"}(ll||(ll={})),function(e){e.PNG="CONTENT_TYPE_IMAGE_PNG",e.JPEG="CONTENT_TYPE_IMAGE_JPEG",e.JPG="CONTENT_TYPE_IMAGE_JPG",e.APNG="CONTENT_TYPE_IMAGE_APNG",e.GIF="CONTENT_TYPE_IMAGE_GIF",e.TIFF="CONTENT_TYPE_IMAGE_TIFF",e.TIF="CONTENT_TYPE_IMAGE_TIFF",e.BMP="CONTENT_TYPE_IMAGE_BMP",e.MP3="CONTENT_TYPE_MP3",e.WAV="CONTENT_TYPE_AUDIO_WAV",e.OGG="CONTENT_TYPE_AUDIO_OGG",e.FLAC="CONTENT_TYPE_AUDIO_FLAC",e.APE="CONTENT_TYPE_AUDIO_APE",e.WMA="CONTENT_TYPE_AUDIO_WMA",e.TXT="CONTENT_TYPE_TEXT_TXT",e.DOC="CONTENT_TYPE_TEXT_DOC",e.DOCX="CONTENT_TYPE_TEXT_DOCX",e.PDF="CONTENT_TYPE_TEXT_PDF",e.MARKDOWN="CONTENT_TYPE_TEXT_MARKDOWN",e.MD="CONTENT_TYPE_TEXT_MARKDOWN",e.RTF="CONTENT_TYPE_TEXT_RTF",e.MP4="CONTENT_TYPE_VIDEO_MP4",e.AVI="CONTENT_TYPE_VIDEO_AVI",e.MOV="CONTENT_TYPE_VIDEO_MOV",e.WMV="CONTENT_TYPE_VIDEO_WMV",e.FLV="CONTENT_TYPE_VIDEO_FLV",e.ALL="CONTENT_TYPE_ALL"}(rl||(rl={})),function(e){e.UNKNOWN="MESSAGE_METADATA_TYPE_UNSPECIFIED",e.IMAGE="MESSAGE_METADATA_TYPE_IMAGE_FILE",e.DOC="MESSAGE_METADATA_TYPE_TEXT_FILE",e.AUDIO="MESSAGE_METADATA_TYPE_AUDIO_FILE",e.VIDEO="MESSAGE_METADATA_TYPE_VIDEO_FILE",e.TEXT_CONTENT="MESSAGE_METADATA_TYPE_TEXT_CONTENT",e.AUDIO_CONTENT="MESSAGE_METADATA_TYPE_USER_AUDIO",e.ALL="MESSAGE_METADATA_TYPE_ALL_FILE"}(il||(il={})),function(e){e.UNKNOWN="EMBED_OBJ_STATUS_UNSPECIFIED",e.PENDING="EMBED_OBJ_STATUS_PENDING",e.PROCESSING="EMBED_OBJ_STATUS_PROCESSING",e.DONE="EMBED_OBJ_STATUS_DONE",e.ERROR="EMBED_OBJ_STATUS_ERROR",e.DELETED="EMBED_OBJ_STATUS_DELETED",e.QUEUEING="EMBED_OBJ_STATUS_QUEUEING"}(ol||(ol={})),function(e){e.BIZ_TYPE_FEATURE_PAGE="BIZ_TYPE_FEATURE_PAGE",e.BIZ_TYPE_BOT="BIZ_TYPE_BOT",e.BIZ_TYPE_WIDGET="BIZ_TYPE_WIDGET",e.BIZ_TYPE_UNSPECIFIED="BIZ_TYPE_UNSPECIFIED",e.BIZ_TYPE_FORUM_POST="BIZ_TYPE_FORUM_POST"}(cl||(cl={}));const dl=e=>e.replace(/[:/?#$&+=@%{}\[\]]/g,"");function ul(e){return Os.post("/v1/resource/get_put_object_pre_sign_url",{body:{fileInfo:e},isGoLang:!0})}async function ml({scenario:e,contentType:t,file:s,onProgress:a,cancelToken:n}){const l=await ul({scenario:e,contentType:t||rl.ALL,fileName:dl(s.name),contentLength:String(s.size)}),r=await new Promise(((e,t)=>{const r=new XMLHttpRequest;n&&n((()=>{r.abort()})),r.timeout=12e4,r.open("PUT",l.data.uploadUrl),r.setRequestHeader("expires",l.data.expiresAt),r.setRequestHeader("Content-Type",l.data.contentType),r.upload.onprogress=e=>{if(e.lengthComputable){const t=Math.round(100*e.loaded/e.total);a(t)}},r.onerror=()=>{t({success:!1,msg:"upload error",code:400})},r.onabort=()=>{t({success:!1,msg:"the request has been aborted"})},r.upload.onabort=()=>{t({success:!1,msg:"the request has been aborted"})},r.onload=()=>{200===r.status&&e({success:!0,msg:"upload success"})},r.ontimeout=e=>{t({success:!1,msg:"timeout"})},r.send(s)})).catch((e=>(console.error(e),{success:!1,msg:"something is wrong!",code:400})));return r.success?Object.assign(Object.assign({},l.data),{success:!0}):{objectKey:"",objectAccessUrl:"",success:!1,code:r.code}}const pl=e=>{let t=[],s=0;const a=async(e,a,n)=>{s++;const l=(async()=>e(...n))();a(l);try{await l}catch(e){}s--,t.length>0&&t.shift()()},n=(n,...l)=>new Promise((r=>{((n,l,r)=>{t.push(a.bind(void 0,n,l,r)),(async()=>{await Promise.resolve(),s<e&&t.length>0&&t.shift()()})()})(n,r,l)}));return Object.defineProperties(n,{activeCount:{get:()=>s},pendingCount:{get:()=>t.length},clearQueue:{value(){t=[]}}}),n};X.enableMapSet();const fl=pl(1),hl={languageList:[],ttsList:[],noCodeCheckPassed:!1,pendingVoiceIds:new Set,uncheckedSet:new Set,selectedTTSId:"",oriForm:null,currentForm:null,editNotSave:!1,ttsContentMap:new Map,widgetList:[],cardWidgetList:[],widgetFilters:[],widgetName:"",filterValues:{},widgetPageToken:"0",widgetDataPush:!1,gettingChatWidgetList:!1,chatWidgetHasMore:!1,chatWidgetPageToken:"0",sidebarWidgetList:null,gettingChatBotList:!1,sidebarMyBotList:null,sidebarToolboxList:null,draftBotIds:new Set,widgetStateMap:{},fileUpload:{uploading:null,filesMap:{},deletedList:[],alert:{},dragModal:!1},widgetErrorChatRecordList:[],widgetInputType:"text",lastWidgetInputType:"text",widgetSending:!1,selectedWidgetDeleteChatList:[],sentWidgetMsgIdList:new Set,widgetTextInputMap:{},childTagsObj:{},initializeScrolled:!1,poped:!1,newlyAdded:!1,widgetLastMessageMap:new Map,widgetDriverChatId:"",widgetStartJobIds:[],recommend:{banners:[],list:[]},tagFilters:[],searchList:[],deployInfoMap:{},deployCount:{currentCount:0,totalLimit:0}};n.create()(Be.default(wn(vn(((e,t)=>Object.assign(Object.assign({},hl),{setNoCodeCheckPassed(t){e({noCodeCheckPassed:t},!1,"setNoCodeCheckPassed")},setRecommend(t){e({recommend:t},!1,"setRecommend")},setTagFilters(t){e({tagFilters:t},!1,"setTagFilters")},setSearchList(t){e({searchList:t},!1,"setSearchList")},setCardWidgetList(t){e({cardWidgetList:t},!1,"setCardWidgetList")},setWidgetSearchList(t){e({widgetList:t},!1,"setWidgetSearchList")},setWidgetFilters(t){e({widgetFilters:t},!1,"setWidgetFilters")},setWidgetName(t){e({widgetName:t},!1,"setWidgetName")},setWidgetDataPush(t){e({widgetDataPush:t},!1,"setWidgetDataPush")},setLanguageList(t){e({languageList:t},!1,"setLanguageList")},setTTSList(t){e({ttsList:t},!1,"setTTSList")},removeItemFromUncheckedSet(t){e((e=>{e.uncheckedSet.delete(t)}),!1,"removeItemFromUncheckedSet")},setSelectedTTSId(t){e({selectedTTSId:t||""},!1,"`setSelected`TTSId")},setOriForm(t){e({oriForm:t||null},!1,"setOriForm")},setCurrentForm(t){e({currentForm:t||null},!1,"setCurrentForm")},setCurrentFormItem(t,s){e((e=>{e.currentForm[t]=s}),!1,"setCurrentFormItem")},setEditNotSave(){e((e=>{const t=e.oriForm||{},s=e.currentForm||{},a=Object.keys(t)||[];if(a.length<=0)return!1;e.editNotSave=!a.every((e=>{var a,n,l,r;return("string"==typeof(null==t?void 0:t[e])?null===(n=null===(a=null==t?void 0:t[e])||void 0===a?void 0:a.replaceAll("\r",""))||void 0===n?void 0:n.replaceAll("\n",""):null==t?void 0:t[e])==("string"==typeof(null==s?void 0:s[e])?null===(r=null===(l=null==s?void 0:s[e])||void 0===l?void 0:l.replaceAll("\r",""))||void 0===r?void 0:r.replaceAll("\n",""):null==s?void 0:s[e])}))}),!1,"setEditNotSave")},getTtsContent(e,s){const a=t().ttsContentMap.get(`${e}`);if(Array.isArray(a)){const e=a.find((e=>e.content===s));if(e)return e.voiceUrl}},setDraftBotIds(s){const a=t().draftBotIds,n="function"==typeof s?s(a):s;((e,t)=>{if(e===t)return!0;if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0})(a,n)||e((e=>{e.draftBotIds=n}))},async widgetUploadFiles(s,a,n){e((e=>{const t=e.fileUpload.filesMap[s]||[];if(n){const n=t.map((e=>e.id===a[0].id?a[0]:e));e.fileUpload.filesMap[s]=[...n]}else e.fileUpload.filesMap[s]=[...t,...a]}));for(const n of a)fl((async()=>{const{deletedList:a}=t().fileUpload;if(a.includes(n.id))return void e((e=>{e.fileUpload.deletedList=e.fileUpload.deletedList.filter((e=>e!==n.id))}));e((e=>{e.fileUpload.uploading=n}));const l=await ml({scenario:ll.SCENARIO_IM_CHAT,contentType:n.uiData.contentType,onProgress:t=>{e((e=>{e.fileUpload.uploading=Object.assign(Object.assign({},n),{progress:t})}))},file:n.file,cancelToken:t=>{e((e=>{const a=(e.fileUpload.filesMap[s]||[]).map((e=>e.id===n.id?Object.assign(Object.assign({},e),{cancelToken:{cancel:t}}):e));e.fileUpload.filesMap[s]=a}))}});t().fileUpload.deletedList.includes(n.id)?e((e=>{e.fileUpload.deletedList=e.fileUpload.deletedList.filter((e=>e!==n.id)),e.fileUpload.uploading=null})):e((e=>{0===fl.pendingCount&&(e.fileUpload.uploading=null);const{deletedList:t}=e.fileUpload;t.includes(n.id)&&(e.fileUpload.uploading=null);const a=(e.fileUpload.filesMap[s]||[]).map((e=>e.id===n.id?Object.assign(Object.assign({},e),{status:(null==l?void 0:l.objectAccessUrl)?"completed":"error",url:null==l?void 0:l.objectAccessUrl}):e));e.fileUpload.filesMap[s]=a}))}))},setInitializeScrolled(t){e((e=>{e.initializeScrolled=t}),!1,"setInitializeScrolled")},setPoped(t){e((e=>{e.poped=t}),!1,"setPoped")},setNewlyAdded(t){e((e=>{e.newlyAdded=t}),!1,"setNewlyAdded")},setWidgetFileAlert(t){e((e=>{e.fileUpload.alert=t}))},showWidgetDragModal(t){e((e=>{e.fileUpload.dragModal=t}))},async getDeployment(t){if(t.shell_agent_file_url)try{for(let a=0;a<3;a++){const a=await(s=t,Os.post("/v1/bot/workflow/get_deployment",{body:Object.assign(Object.assign({},s),{bot_id:s.bot_id}),isGoLang:!0}));if(a.success){e((e=>{b.set(e.deployInfoMap,[t.bot_id||"0",t.shell_agent_file_url],null==a?void 0:a.data)}));break}e((e=>{b.set(e.deployInfoMap,[t.bot_id||"0",t.shell_agent_file_url],{status:a.reason,msg:a.msg})}))}}catch(e){console.log("err: ",e)}var s},async getDeploymentCount(){try{for(let t=0;t<3;t++){const t=await Os.post("/v1/bot/workflow/count",{isGoLang:!0});if(t.success){e((e=>{e.deployCount=null==t?void 0:t.data}));break}}}catch(e){console.log("err: ",e)}}})),{store:"workshop"})),(e=>({workshopListInitialized:null!=e.sidebarMyBotList&&null!=e.sidebarWidgetList}))));const gl={searchList:[],tagFilters:{tagList:[],sortList:[]},postFullView:void 0,showPost:void 0,postDetail:{},postLoading:!0,setPostDetail:()=>{},setPostLoading:()=>{}};n.create()(Be.default(((e,t)=>Object.assign(Object.assign({},gl),{setSearchList:t=>{e({searchList:t})},setTagFilters:t=>{e({tagFilters:t})},setPostFullView:t=>{e({postFullView:t})},setShowPost:t=>{e({showPost:t})},setPostDetail:t=>{e({postDetail:t})},setPostLoading:t=>{e({postLoading:t})}})),(e=>({history:[]}))));const vl=a.createContext(void 0),xl=e=>{const t=a.useContext(vl);if(!t)throw new Error("globalStoreContext must be used within globalStoreProvider");return n.useStore(t,e)};var bl=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const El=ht.Root,_l=ht.Trigger,wl=Fe.forwardRef(((t,s)=>{var{className:a,align:n="center",variant:l="default",side:r="top",sideOffset:i=4,alignOffset:o=0,showArrow:c=!0,children:d,container:u}=t,m=bl(t,["className","align","variant","side","sideOffset","alignOffset","showArrow","children","container"]);return e.jsx(ht.Portal,{container:u,children:e.jsxs(ht.Content,Object.assign({ref:s,align:n,alignOffset:o,sideOffset:i,side:r,forceMount:!0,className:pn("relative z-[49] w-fit max-w-72 text-xs mx-4 p-3 text-left rounded-lg border border-opaque shadow-modal-default outline-none data-[state=open]:animate-in [&[data-state=open]>span]:animate-none data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","default"===l?"bg-surface-search-field text-subtle":"info"===l?"bg-surface-accent-yellow-subtle text-warning-bolder":"bg-utility-sky-blue-500 text-static",a)},m,{children:[d,c&&e.jsx(ht.Arrow,{width:16,height:6,className:pn("visible","default"===l?"fill-surface-search-field":"info"===l?"fill-surface-accent-yellow-subtle":"fill-utility-sky-blue-500")})]}))})}));wl.displayName=ht.Content.displayName;const Tl=t=>{var{disabled:s=!1,open:a,content:n,anchor:l,children:r,className:i,triggerClassName:o,hasOpenState:c=!1,isMTooltip:d=!1,modal:u=!1,openChangeCallback:m}=t,p=bl(t,["disabled","open","content","anchor","children","className","triggerClassName","hasOpenState","isMTooltip","modal","openChangeCallback"]);return e.jsxs(El,Object.assign({open:!s&&a,modal:u,onOpenChange:m},p,{children:[l,n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:pn("inline-flex items-center justify-center",c&&"data-[state=open]:bg-surface-hovered",o),onClick:e=>{d&&(e.preventDefault(),e.stopPropagation())},children:e.jsx(_l,{asChild:!0,children:e.jsx("div",{className:pn("inline-flex items-center justify-center",c&&"data-[state=open]:bg-surface-hovered",o),children:r})})}),e.jsx(wl,Object.assign({},p,{className:pn("w-fit max-w-[324px]",i),onCloseAutoFocus:e=>e.preventDefault(),children:n}))]}),!n&&r]}))};var Nl=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const yl={default:"text-default",subtle:"text-subtle",subtler:"text-subtler",subtlest:"text-subtlest",disabled:"text-disabled",inverse:"text-inverse",static:"text-static","static-black":"text-static-black",brand:"text-brand",critical:"text-critical","critical-bolder":"text-critical-bolder",warning:"text-warning","warning-bolder":"text-warning-bolder",success:"text-success","success-bolder":"text-success-bolder"},Cl={1:"line-clamp-1",2:"line-clamp-2",3:"line-clamp-3",4:"line-clamp-4",5:"line-clamp-5",6:"line-clamp-6"},Sl=w.cva("font-semibold",{variants:{size:{"2xl":"text-7xl",xl:"text-5xl",lg:"text-3xl",md:"text-2xl",sm:"text-xl",xs:"text-lg"},color:yl,lineClamp:Cl},defaultVariants:{size:"lg",color:"default"}}),jl=w.cva("font-medium",{variants:{size:{h1:"text-2xl",h2:"text-xl",h3:"text-lg",h4:"text-base",h5:"text-sm"},color:yl,lineClamp:Cl},defaultVariants:{size:"h1",color:"default"}}),Il=w.cva("text-default",{variants:{size:{sm:"text-xs",lg:"text-sm"},color:yl,lineClamp:Cl},defaultVariants:{size:"lg",color:"default"}}),Ol=w.cva("",{variants:{size:{xs:"text-xs",sm:"text-sm",lg:"text-base"},weight:{regular:"font-normal",medium:"font-medium",semibold:"font-semibold"},color:yl,lineClamp:Cl},defaultVariants:{size:"lg",weight:"regular",color:"default"}}),Al=w.cva("",{variants:{size:{lg:"text-xs",sm:"text-2xs"},weight:{regular:"font-normal",medium:"font-medium"},color:yl,lineClamp:Cl},defaultVariants:{size:"lg",weight:"regular",color:"subtler"}}),Ml={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6"},Pl={p:"p",blockquote:"blockquote",span:"span",code:"code",bold:"b",italic:"i",strikethrough:"s",underline:"u"},Ll=({underline:e=!1,strikethrough:t=!1,strong:s=!1,italic:a=!1},n="p")=>Pl[e&&"underline"||t&&"strikethrough"||s&&"bold"||a&&"italic"||n],kl=e=>N.sanitize(`${e}`,{ADD_ATTR:["target"],FORBID_TAGS:["style","form","input","checkbox","svg","script","iframe","object","embed","applet","meta","link","button","textarea","select","option","img"],FORBID_ATTR:["action","style","data-*","aria-*","srcset","on*"]}),Rl=Fe.forwardRef(((t,s)=>{const{className:a,size:n,color:l,lineClamp:r,children:i,dangerous:o}=t,c=Nl(t,["className","size","color","lineClamp","children","dangerous"]),d=Ml[n||"h1"],u=o&&kl(`${i}`);return e.jsx(d,Object.assign({ref:s,className:pn(jl({size:n,color:l,lineClamp:r}),a)},c,o&&{dangerouslySetInnerHTML:{__html:`${u}`}},{children:o?null:i}))})),Dl=Fe.forwardRef(((t,s)=>{const{className:a,size:n,color:l,lineClamp:r,underline:i,strikethrough:o,strong:c,italic:d,children:u,dangerous:m}=t,p=Nl(t,["className","size","color","lineClamp","underline","strikethrough","strong","italic","children","dangerous"]),f=Ll({underline:i,strikethrough:o,strong:c,italic:d},"span"),h=m&&kl(`${u}`);return e.jsx(f,Object.assign({ref:s,className:pn(Sl({size:n,color:l,lineClamp:r}),a)},b.omit(p,"lineClamp"),m&&{dangerouslySetInnerHTML:{__html:`${h}`}},{children:m?null:u}))}));Fe.forwardRef(((t,s)=>{const{className:a,size:n,color:l,children:r,lineClamp:i}=t,o=Nl(t,["className","size","color","children","lineClamp"]);return e.jsx("p",Object.assign({ref:s,className:pn(Il({size:n,color:l,lineClamp:i}),a)},o,{children:r}))}));const Ul=Fe.forwardRef(((t,s)=>{const{className:a,size:n,weight:l,color:r,lineClamp:i,underline:o,strikethrough:c,strong:d,italic:u,children:m,dangerous:p}=t,f=Nl(t,["className","size","weight","color","lineClamp","underline","strikethrough","strong","italic","children","dangerous"]),h=Ll({underline:o,strikethrough:c,strong:d,italic:u},"span"),g=p&&kl(`${m}`);return e.jsx(h,Object.assign({ref:s,className:pn(Ol({size:n,weight:l,color:r,lineClamp:i}),a)},b.omit(f,"lineClamp"),p&&{dangerouslySetInnerHTML:{__html:`${g}`}},{children:p?null:m}))}));Fe.forwardRef(((t,s)=>{const{className:a,size:n,weight:l,color:r,lineClamp:i,underline:o,strikethrough:c,strong:d,italic:u,children:m,dangerous:p}=t,f=Nl(t,["className","size","weight","color","lineClamp","underline","strikethrough","strong","italic","children","dangerous"]),h=Ll({underline:o,strikethrough:c,strong:d,italic:u},"p"),g=p&&kl(`${m}`);return e.jsx(h,Object.assign({ref:s,className:pn(Ol({size:n,weight:l,color:r,lineClamp:i}),a)},f,p&&{dangerouslySetInnerHTML:{__html:`${g}`}},{children:p?null:m}))}));const Fl=Fe.forwardRef(((t,s)=>{const{className:a,size:n,weight:l,color:r,lineClamp:i,underline:o,strikethrough:c,strong:d,italic:u,children:m,dangerous:p}=t,f=Nl(t,["className","size","weight","color","lineClamp","underline","strikethrough","strong","italic","children","dangerous"]),h=Ll({underline:o,strikethrough:c,strong:d,italic:u},"span"),g=p&&kl(`${m}`);return e.jsx(h,Object.assign({ref:s,className:pn(Al({size:n,weight:l,color:r,lineClamp:i}),a)},b.omit(f,"lineClamp"),p&&{dangerouslySetInnerHTML:{__html:`${g}`}},{children:p?null:m}))}));var Bl=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Gl=ft.Provider,zl=ft.Trigger,Yl=ft.Arrow,Hl=Fe.forwardRef(((t,s)=>{var{open:a,defaultOpen:n,disabled:l=!1,children:r,title:i,description:o,size:c="sm",titleDangerous:d=!1,descriptionDangerous:u=!1,contentClassName:m,triggerClassName:p}=t,f=Bl(t,["open","defaultOpen","disabled","children","title","description","size","titleDangerous","descriptionDangerous","contentClassName","triggerClassName"]);const h=!xl((e=>e.isMobile)),g="message"===f.variant?"static":"default"===f.variant?"warning-bolder":"default",v="message"===f.variant?"static":"info"===f.variant?"warning-bolder":"default";return e.jsx(e.Fragment,{children:h?e.jsx(Gl,{children:e.jsxs(ft.Root,{open:!(l||!o&&!i)&&a,defaultOpen:n,children:[e.jsx(zl,{asChild:!0,children:e.jsx("div",{className:pn("cursor-pointer",p),children:r})}),e.jsxs(Vl,Object.assign({ref:s,className:m},f,{children:[i&&e.jsx("p",{className:"mb-1",children:e.jsx(Fl,{size:"lg",weight:"medium",color:g,dangerous:d,className:pn("text-wrap","md"===c&&"text-sm"),children:i})}),o&&e.jsx(Fl,{size:"lg",weight:i?"regular":"medium",color:i?"subtle":v,dangerous:u,className:pn("text-wrap","md"===c&&"text-sm"),children:o})]}))]})}):e.jsx(Tl,Object.assign({open:a,content:o,disabled:l,triggerClassName:p,className:pn(m,"md"===c&&"text-sm"),isMTooltip:!0},f,{children:r}))})}));Hl.displayName=ft.Root.displayName;const Vl=Fe.forwardRef(((t,s)=>{var{className:a,variant:n="default",align:l="center",side:r="top",sideOffset:i=4,alignOffset:o=0,showArrow:c=!0,arrowClassName:d}=t,u=Bl(t,["className","variant","align","side","sideOffset","alignOffset","showArrow","arrowClassName"]);return e.jsxs(ft.Content,Object.assign({ref:s,align:l,sideOffset:i,alignOffset:o,side:r,className:pn("relative z-[49] w-fit max-w-72 text-xs mx-4 px-3 py-2 text-left rounded-lg shadow-modal-bolder ","outline-none delay-0 data-[state=open]:animate-in [&[data-state=open]>span]:animate-none data-[state=open]:fade-in-0 ","data-[state=delayed-open]:animate-in [&[data-state=delayed-open]>span]:animate-none data-[state=delayed-open]:fade-in-0 ","data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 ","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","default"===n?"bg-alpha-100 text-default":"info"===n?"bg-surface-accent-yellow-subtle text-warning-bolder":"bg-utility-sky-blue-500 text-default",a)},u,{children:[u.children,c&&e.jsx(Yl,{width:12,height:6,className:pn("default"===n?"fill-alpha-100":"info"===n?"fill-surface-accent-yellow-subtle":"fill-utility-sky-blue-500",d)})]}))}));Vl.displayName=ft.Content.displayName;var $l=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Wl=w.cva("shrink-0 inline-flex items-center justify-center whitespace-nowrap rounded-full font-medium transition-colors ring-offset-surface-default focus-visible:outline-none focus-visible:shadow-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 disabled:pointer-events-none disabled:opacity-30 disabled:shadow-none",{variants:{variant:{primary:"bg-surface-primary-default text-icon-static shadow-button-primary hover:bg-surface-primary-hovered active:bg-surface-primary-pressed",outline:"border border-default text-icon-subtle shadow-button-basic hover:bg-surface-hovered focus:bg-surface-pressed active:shadow-button-pressed",ghost:"text-icon hover:bg-surface-hovered active:bg-surface-pressed"},color:{default:"",brand:"",warning:"",error:"",gray:"",static:"text-icon-static hover:bg-transparent active:bg-transparent"},size:{xs:"h-5 w-5 text-xs",sm:"h-7 w-7 text-sm",m:"h-8 w-8 text-sm",md:"h-9 w-9 text-sm",lg:"h-11 w-11"}},compoundVariants:[{variant:"primary",color:"default",className:"text-icon-brand bg-surface-search-field border border-default hover:bg-surface-hovered active:bg-surface-pressed shadow-button-basic disabled:bg-surface-disabled disabled:text-surface-accent-blue-subtle [&>svg]:disabled:text-surface-accent-blue-subtle disabled:opacity-100"},{variant:"primary",color:"brand",className:"bg-surface-primary-default hover:bg-surface-primary-hovered active:bg-surface-primary-pressed"},{variant:"primary",color:"warning",className:"bg-surface-warning-default hover:bg-surface-warning-hovered active:bg-surface-warning-pressed"},{variant:"primary",color:"error",className:"bg-surface-critical-default hover:bg-surface-critical-hovered active:bg-surface-critical-pressed"},{variant:"primary",color:"gray",className:"text-icon-default bg-surface-search-field border border-default hover:bg-surface-hovered active:bg-surface-pressed shadow-button-basic disabled:bg-surface-disabled disabled:text-disabled disabled:opacity-100 [&>svg]:disabled:text-icon-disabled"},{variant:"outline",color:"default",className:"border-default text-icon shadow-button-basic active:shadow-button-pressed"},{variant:"outline",color:"brand",className:"border-surface-primary-default text-icon-brand"},{variant:"outline",color:"warning",className:"border-surface-warning-default text-icon-warning hover:bg-surface-warning-subtle-hovered active:bg-surface-warning-subtle-pressed"},{variant:"outline",color:"error",className:"border-surface-critical-default text-icon-critical hover:bg-surface-critical-subtle-hovered active:bg-surface-critical-subtle-pressed"},{variant:"outline",color:"gray",className:"text-icon-subtle hover:bg-surface-hovered active:shadow-button-pressed"},{variant:"ghost",color:"default",className:"text-icon"},{variant:"ghost",color:"brand",className:"text-icon-brand"},{variant:"ghost",color:"warning",className:"text-icon-warning focus:shadow-rings-warning"},{variant:"ghost",color:"error",className:"text-icon-critical focus:shadow-rings-error"},{variant:"ghost",color:"gray",className:"text-icon-default hover:text-icon-default"}],defaultVariants:{variant:"primary",color:"brand",size:"lg"}}),Kl=Fe.forwardRef(((s,a)=>{var{className:n,variant:l,size:r,color:i,asChild:o=!1,loading:c=!1,children:d,icon:u,disabled:m,hoverText:p}=s,f=$l(s,["className","variant","size","color","asChild","loading","children","icon","disabled","hoverText"]);const h=o?U.Slot:"button",g=pn({"w-3 h-3":"xs"===r,"w-4.5 h-4.5":"sm"===r,"w-5.5 h-5.5":"md"===r,"w-6 h-6":"lg"===r}),v=m||c;return e.jsx(Hl,{sideOffset:4,size:"md",description:p,children:e.jsx(h,Object.assign({className:pn(Wl({variant:l,size:r,color:i}),v&&"cursor-not-allowed !pointer-events-auto",n),ref:a,disabled:v},f,{children:c?e.jsx(t.Loader2,{className:pn("animate-spin",g)}):u?e.jsx(u,{className:g}):Fe.isValidElement(d)?Fe.cloneElement(d,{className:pn(g,d.props.className)}):null}))})}));function ql({tProps:t,customProps:a}){const{type:n,title:l,content:r,isClosable:i=!1,translateInToast:o}=a,{id:c}=t,d=s.useTranslations(),u=rs(r)?r:JSON.stringify(r);return e.jsx("div",{children:e.jsx("div",{id:c,className:"z-[10000000] min-h-10 w-fit max-w-[90vw] md:max-w-[560px] rounded-full bg-surface-search-field border-opaque border shadow-modal-default py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-center w-full space-x-2",children:[n&&e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:["info"===n&&e.jsx(mn,{className:"text-surface-info-default w-6 h-6"}),"success"===n&&e.jsx(Pt,{className:"text-surface-success-default w-6 h-6"}),"warning"===n&&e.jsx(dn,{className:"text-surface-warning-default w-6 h-6"}),"error"===n&&e.jsx(kt,{className:"text-icon-critical w-6 h-6"})]}),e.jsxs("div",{className:"flex flex-col flex-grow overflow-hidden space-y-1",children:[l&&e.jsx("div",{children:e.jsx(Ul,{size:"sm",weight:"regular",color:"default",children:l})}),e.jsx("div",{children:e.jsx(Ul,{size:"sm",weight:"regular",color:"default",children:o?d(u):u})})]}),i&&e.jsx(Kl,{variant:"ghost",icon:on,onClick:()=>ae.toast.dismiss(c),className:"w-4 h-4 text-icon-subtlest"})]})})})}function Ql(){const t=a.useCallback(((t,s)=>{t.id&&ae.toast.remove(t.id),ae.toast.custom((a=>e.jsx(ql,{tProps:Object.assign(Object.assign({},a),{duration:s}),customProps:t})),{id:t.id})}),[]),s=a.useCallback((e=>t(Object.assign({},e))),[]),n=a.useCallback((e=>t(Object.assign(Object.assign({},e),{type:"success"}))),[]),l=a.useCallback((e=>t(Object.assign(Object.assign({},e),{type:"error"}))),[]),r=a.useCallback((e=>t(Object.assign(Object.assign({},e),{type:"warning"}))),[]),i=a.useCallback(((e,s)=>t(Object.assign(Object.assign({},e),{type:"info"}),s)),[]),o=a.useCallback((e=>{ae.toast.dismiss(e)}),[]);return{addToast:t,success:n,error:l,warning:r,info:i,close:o,message:s}}var Xl=Object.freeze({__proto__:null,Message:class{static _toast(t){t.id&&ae.toast.remove(t.id);ae.toast.custom((s=>e.jsx(ql,{tProps:s,customProps:t})),{id:t.id})}static success(e){return this._toast(Object.assign(Object.assign({},e),{type:"success"}))}static error(e){return this._toast(Object.assign(Object.assign({},e),{type:"error"}))}static info(e){return this._toast(Object.assign(Object.assign({},e),{type:"info"}))}static warning(e){return this._toast(Object.assign(Object.assign({},e),{type:"warning"}))}static close(e){ae.toast.dismiss(e)}},useNotification:Ql});function Jl(){const[e,t]=a.useState(!1),{warning:s}=Ql();return{acting:e,handleRedeemAndUseSeasonPass:async e=>{try{t(!0);const{success:a,data:n,msg:l}=await Os.post("/v1/season/reward/auto_redeem_and_use_season_pass_if_needed",{isGoLang:!0,withMyShellSecurityToken:!0,adapter:e=>e.item});if(!a)return void s({content:null!=l?l:""});e&&e(n)}catch(e){}finally{t(!1)}}}}function Zl({src:t}){return e.jsx("video",{src:t,loop:!0,autoPlay:!0,muted:!0,playsInline:!0,disablePictureInPicture:!0,className:"w-full h-full block object-cover"})}var er=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((t,s)=>{const a=Fe.forwardRef(((t,a)=>{const{asChild:n,...l}=t,r=n?U.Slot:s;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),e.jsx(r,{...l,ref:a})}));return a.displayName=`Primitive.${s}`,{...t,[s]:a}}),{});function tr(e){const t=Fe.useRef(e);return Fe.useEffect((()=>{t.current=e})),Fe.useMemo((()=>(...e)=>t.current?.(...e)),[])}var sr="focusScope.autoFocusOnMount",ar="focusScope.autoFocusOnUnmount",nr={bubbles:!1,cancelable:!0},lr=Fe.forwardRef(((t,s)=>{const{loop:a=!1,trapped:n=!1,onMountAutoFocus:l,onUnmountAutoFocus:r,...i}=t,[o,c]=Fe.useState(null),d=tr(l),u=tr(r),m=Fe.useRef(null),p=function(...e){return Fe.useCallback(function(...e){return t=>e.forEach((e=>function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}(e,t)))}(...e),e)}(s,(e=>c(e))),f=Fe.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Fe.useEffect((()=>{if(n){let e=function(e){if(f.paused||!o)return;const t=e.target;o.contains(t)?m.current=t:cr(m.current,{select:!0})},t=function(e){if(f.paused||!o)return;const t=e.relatedTarget;null!==t&&(o.contains(t)||cr(m.current,{select:!0}))},s=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&cr(o)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const a=new MutationObserver(s);return o&&a.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),a.disconnect()}}}),[n,o,f.paused]),Fe.useEffect((()=>{if(o){dr.add(f);const t=document.activeElement;if(!o.contains(t)){const s=new CustomEvent(sr,nr);o.addEventListener(sr,d),o.dispatchEvent(s),s.defaultPrevented||(!function(e,{select:t=!1}={}){const s=document.activeElement;for(const a of e)if(cr(a,{select:t}),document.activeElement!==s)return}((e=rr(o),e.filter((e=>"A"!==e.tagName))),{select:!0}),document.activeElement===t&&cr(o))}return()=>{o.removeEventListener(sr,d),setTimeout((()=>{const e=new CustomEvent(ar,nr);o.addEventListener(ar,u),o.dispatchEvent(e),e.defaultPrevented||cr(t??document.body,{select:!0}),o.removeEventListener(ar,u),dr.remove(f)}),0)}}var e}),[o,d,u,f]);const h=Fe.useCallback((e=>{if(!a&&!n)return;if(f.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,s=document.activeElement;if(t&&s){const t=e.currentTarget,[n,l]=function(e){const t=rr(e),s=ir(t,e),a=ir(t.reverse(),e);return[s,a]}(t);n&&l?e.shiftKey||s!==l?e.shiftKey&&s===n&&(e.preventDefault(),a&&cr(l,{select:!0})):(e.preventDefault(),a&&cr(n,{select:!0})):s===t&&e.preventDefault()}}),[a,n,f.paused]);return e.jsx(er.div,{tabIndex:-1,...i,ref:p,onKeyDown:h})}));function rr(e){const t=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)t.push(s.currentNode);return t}function ir(e,t){for(const s of e)if(!or(s,{upTo:t}))return s}function or(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function cr(e,{select:t=!1}={}){if(e&&e.focus){const s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}lr.displayName="FocusScope";var dr=function(){let e=[];return{add(t){const s=e[0];t!==s&&s?.pause(),e=ur(e,t),e.unshift(t)},remove(t){e=ur(e,t),e[0]?.resume()}}}();function ur(e,t){const s=[...e],a=s.indexOf(t);return-1!==a&&s.splice(a,1),s}var mr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const pr=w.cva("inline-flex shrink-0",{variants:{size:{"2xs":"w-3 h-3",xs:"w-3.5 h-3.5",sm:"w-4 h-4",md:"w-4.5 h-4.5",lg:"w-5 h-5",xl:"w-5.5 h-5.5","2xl":"w-6 h-6","3xl":"w-7 h-7","4xl":"w-8 h-8","5xl":"w-9 h-9","6xl":"w-10 h-10","7xl":"w-12 h-12"},color:{default:"text-default",subtle:"text-subtle",subtlest:"text-subtlest",disabled:"text-disabled",inverse:"text-inverse",static:"text-static",brand:"text-brand",critical:"text-critical",warning:"text-warning",success:"text-success"},rotate:{45:"rotate-45",90:"rotate-90","-45":"-rotate-45","-90":"-rotate-90",180:"rotate-180"}},defaultVariants:{size:"sm",color:"default"}}),fr=Fe.forwardRef(((t,s)=>{const{children:a,component:n,size:l,color:r,rotate:i,className:o}=t,c=mr(t,["children","component","size","color","rotate","className"]),d=n||"span";return e.jsx(d,Object.assign({ref:s},c,{className:pn(pr({size:l,color:r,rotate:i}),o),children:a}))}));fr.displayName="Icon";var hr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const gr=w.cva("",{variants:{rounded:{none:"rounded-none",sm:"rounded-sm",default:"rounded",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl","3xl":"rounded-3xl",full:"rounded-full"},object:{contain:"object-contain",cover:"object-cover",fill:"object-fill",none:"object-none"}},defaultVariants:{rounded:"none"}});function vr(t){var{className:s,imgClassName:a,placeholder:n=!0,width:l="100%",height:r="100%",src:i,rounded:o="none",fallback:c="",object:d="cover",isBackgroud:u=!1}=t,m=hr(t,["className","imgClassName","placeholder","width","height","src","rounded","fallback","object","isBackgroud"]);return e.jsx(mt.default,Object.assign({placeholder:n,width:l,height:r,src:i,fallback:c||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg==",preview:!1,rootClassName:pn(gr({rounded:o,object:d}),u&&"absolute top-0 left-0 z-0 w-full h-full object-cover",s),className:a},m))}var xr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const br=Fe.forwardRef(((t,s)=>{var{className:a,orientation:n="horizontal",decorative:l=!0}=t,r=xr(t,["className","orientation","decorative"]);return e.jsx(pt.Root,Object.assign({ref:s,decorative:l,orientation:n,className:pn("shrink-0 border-default","horizontal"===n?"border-b w-full ":"h-full  border-r",a)},r))}));br.displayName=pt.Root.displayName;var Er=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const _r=w.cva("relative shrink-0 inline-flex items-center justify-center whitespace-nowrap rounded-full font-medium transition-colors ring-offset-surface-default focus-visible:outline-none focus-visible:shadow-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 disabled:pointer-events-none disabled:opacity-30 disabled:shadow-none",{variants:{variant:{primary:"text-static [&>span>svg]:text-icon-static [&>span>span>svg]:text-icon-static bg-surface-primary-default shadow-button-primary hover:bg-surface-primary-hovered active:bg-surface-primary-pressed",outline:"border hover:bg-surface-hovered active:bg-surface-pressed",static:"bg-static border hover:bg-surface-hoverd-static active:bg-surface-pressed-static",link:"rounded-none font-normal underline-offset-4 hover:underline active:underline",plain:"rounded-md font-medium hover:bg-surface-hovered active:bg-surface-pressed"},color:{default:"",brand:"",warning:"",error:"",gray:"",chat:""},size:{lg:"",md:"",sm:""}},compoundVariants:[{variant:"primary",size:"lg",className:"h-11 min-w-11 px-6"},{variant:"primary",size:"md",className:"h-9 min-w-9 px-4 text-sm"},{variant:"primary",size:"sm",className:"h-7 min-w-7 px-3 text-sm"},{variant:"primary",color:"default",className:"text-brand [&>span>svg]:text-icon-brand [&>span>span>svg]:text-icon-brand disabled:bg-surface-disabled disabled:text-surface-accent-blue-subtle [&>span>svg]:disabled:text-surface-accent-blue-subtle disabled:opacity-100 bg-surface-search-field border border-default hover:bg-surface-hovered active:bg-surface-pressed active:shadow-button-pressed shadow-button-basic"},{variant:"primary",color:"brand",className:"bg-surface-primary-default hover:bg-surface-primary-hovered active:bg-surface-primary-pressed"},{variant:"primary",color:"warning",className:"bg-surface-warning-default hover:bg-surface-warning-hovered active:bg-surface-warning-pressed"},{variant:"primary",color:"error",className:"bg-surface-critical-default hover:bg-surface-critical-hovered active:bg-surface-critical-pressed"},{variant:"primary",color:"gray",className:"text-subtle [&>span>svg]:text-icon-subtle bg-surface-search-field border border-default hover:bg-surface-hovered active:bg-surface-pressed shadow-button-basic disabled:bg-surface-disabled disabled:text-disabled disabled:opacity-100 [&>span>svg]:disabled:text-icon-disabled"},{variant:"primary",color:"chat",className:"shadow-none text-subtle [&>span>svg]:text-icon-subtle bg-surface-accent-gray-subtlest border border-default hover:bg-surface-accent-gray-subtler active:bg-surface-accent-gray-subtler active:shadow-button-pressed disabled:bg-surface-accent-gray-subtlest disabled:text-disabled disabled:opacity-100 [&>span>svg]:disabled:text-icon-disabled"},{variant:"static",color:"default",className:"text-static-black [&>span>svg]:text-icon-static-black"},{variant:"static",color:"brand",className:"text-brand [&>span>svg]:text-icon-brand"},{variant:"static",color:"warning",className:"text-warning [&>span>svg]:text-icon-warning"},{variant:"static",color:"error",className:"text-critical [&>span>svg]:text-icon-critical"},{variant:"static",color:"gray",className:"text-subtler"},{variant:"outline",color:"default",className:"border-default text-subtle [&>span>svg]:text-icon-subtle shadow-button-basic active:shadow-button-pressed"},{variant:"outline",color:"brand",className:"border-surface-primary-default text-brand [&>span>svg]:text-icon-brand"},{variant:"outline",color:"warning",className:"border-surface-warning-default text-warning [&>span>svg]:text-icon-warning hover:bg-surface-warning-subtle-hovered active:bg-surface-warning-subtle-pressed"},{variant:"outline",color:"error",className:"border-surface-critical-default text-critical [&>span>svg]:text-icon-critical hover:bg-surface-critical-subtle-hovered active:bg-surface-critical-subtle-pressed"},{variant:"outline",color:"gray",className:"text-subtle [&>span>svg]:text-icon-subtle hover:bg-surface-hovered active:shadow-button-pressed"},{variant:"outline",size:"lg",className:"h-11 min-w-11 px-6"},{variant:"outline",size:"md",className:"h-9 min-w-9 px-4 text-sm"},{variant:"outline",size:"sm",className:"h-7 min-w-7 px-3 text-sm"},{variant:"static",size:"lg",className:"h-11 min-w-11 px-6"},{variant:"static",size:"md",className:"h-9 min-w-9 px-4 text-sm"},{variant:"static",size:"sm",className:"h-7 min-w-7 px-3 text-sm"},{variant:"link",className:"h-fit w-fit min-w-auto px-0.5 py-0.5"},{variant:"link",color:"default",className:"text-default [&>span>svg]:text-icon-default"},{variant:"link",color:"brand",className:"text-brand [&>span>svg]:text-icon-brand"},{variant:"link",color:"warning",className:"text-warning [&>span>svg]:text-icon-warning"},{variant:"link",color:"error",className:"text-critical [&>span>svg]:text-icon-critical"},{variant:"link",color:"gray",className:"text-subtler hover:text-subtler"},{variant:"link",size:"lg",className:"h-fit w-fit px-0.5 py-0.5 text-base"},{variant:"link",size:"md",className:"h-fit w-fit px-0.5 py-0.5 text-sm"},{variant:"link",size:"sm",className:"h-fit w-fit px-0.5 py-0.5 text-xs"},{variant:"plain",className:"h-fit w-fit min-w-auto px-0.5 py-0.5"},{variant:"plain",color:"default",className:"text-default [&>span>svg]:text-icon"},{variant:"plain",color:"brand",className:"text-brand [&>span>svg]:text-icon-brand"},{variant:"plain",color:"warning",className:"text-warning [&>span>svg]:text-icon-warning"},{variant:"plain",color:"error",className:"text-critical [&>span>svg]:text-icon-critical"},{variant:"plain",color:"gray",className:"text-subtler hover:text-subtle active:text-subtle"},{variant:"plain",size:"lg",className:"h-fit w-fit px-0.5 py-0.5 text-base"},{variant:"plain",size:"md",className:"h-fit w-fit px-0.5 py-0.5 text-sm"},{variant:"plain",size:"sm",className:"h-fit w-fit px-0.5 py-0.5 text-xs"}],defaultVariants:{variant:"primary",color:"default",size:"lg"}}),wr=w.cva("relative shrink-0 text-inherit inline-flex items-center justify-center whitespace-nowrap transition-colors ring-offset-surface-default",{variants:{variant:{primary:"",outline:"",link:"font-normal",plain:"font-medium",static:""},size:{lg:"text-base w-5 h-5",md:"text-sm w-4.5 h-4.5",sm:"text-sm w-4 h-4"}},compoundVariants:[{variant:"plain",size:"lg",className:"text-base w-4.5 h-4.5"},{variant:"plain",size:"md",className:"text-sm w-4 h-4"},{variant:"plain",size:"md",className:"text-sm"}],defaultVariants:{variant:"primary",size:"lg"}}),Tr=Fe.forwardRef(((s,a)=>{var{className:n="",iconClassName:l,variant:r,color:i="brand",icon:o,iconDirection:c="left",size:d,asChild:u=!1,loading:m=!1,noStyle:p=!1,iconOutBox:f=!1,isBlock:h=!1,disabled:g,children:v,autoFocus:x,asset:b,assetNumber:E=0}=s,_=Er(s,["className","iconClassName","variant","color","icon","iconDirection","size","asChild","loading","noStyle","iconOutBox","isBlock","disabled","children","autoFocus","asset","assetNumber"]);const w=u?U.Slot:"button",T=g||m;return e.jsxs(w,Object.assign({className:p?n:pn(_r({variant:r,color:i,size:d,className:n}),T&&"cursor-not-allowed !pointer-events-auto",h&&"w-full"),ref:a,disabled:T,autoFocus:x},_,{children:[m&&e.jsx("span",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center",children:e.jsx(t.Loader2,{className:pn(wr({variant:r,size:d}),"animate-spin","lg"===d?"w-6 h-6":"md"===d?"w-5 h-5":"w-4.5 h-4.5")})}),!b&&o&&f&&"left"===c&&Nr(o,"left",{loading:m,noStyle:p,iconClassName:l,variant:r,color:i,size:d}),e.jsxs("span",{className:pn("w-full inline-flex items-center justify-center",m?"opacity-0":"opacity-100","plain"===r&&"font-medium"),children:[!b&&o&&!f&&"left"===c&&Nr(o,"left",{loading:m,noStyle:p,iconClassName:l,variant:r,color:i,size:d}),v,b?e.jsxs(e.Fragment,{children:[e.jsx(br,{orientation:"vertical",className:pn("mx-1.5 h-3","primary"===r&&"brand"===i?"border-alpha-facetime-white":"border-alpha-facetime-black")}),e.jsx(vr,{src:"energy"===b?ns("image/bot/tag/20231214/1719340128612116720.png"):"",alt:b,width:16,height:16,className:"flex-shrink-0"}),e.jsx(Ul,{size:"xs",className:pn("text-inherit ml-0.5","primary"===r&&"brand"===i?"text-static":"text-default"),children:E})]}):null,!b&&o&&!f&&"right"===c&&Nr(o,"right",{loading:m,noStyle:p,iconClassName:l,variant:r,color:i,size:d})]}),!b&&o&&f&&"right"===c&&Nr(o,"right",{loading:m,noStyle:p,iconClassName:l,variant:r,color:i,size:d})]}))})),Nr=(t,s,{loading:a,noStyle:n,iconClassName:l,variant:r="primary",color:i="brand",size:o="lg"})=>e.jsx(fr,{component:t,className:n?l:pn(wr({variant:r,size:o}),"plain"===r||"link"===r?"left"===s?"mr-0.5":"ml-0.5":"left"===s?"mr-1.5":"ml-1.5",l,a?"opacity-0":"opacity-100")});Tr.displayName="Button";var yr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Cr=Fe.forwardRef(((t,s)=>{var{className:a,onClick:n}=t,l=yr(t,["className","onClick"]);return e.jsx(rt.Overlay,Object.assign({ref:s,className:pn("fixed inset-0 z-50 bg-alpha-mask-desktop data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),onClick:e=>{n&&n(e)}},l))}));Cr.displayName=rt.Overlay.displayName;const Sr=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=yr(t,["className"]);return e.jsx(J.Drawer.Overlay,Object.assign({ref:s,className:pn("fixed inset-0 z-50 bg-alpha-mask-desktop",a)},n))}));Sr.displayName=J.Drawer.Overlay.displayName;const jr=Fe.forwardRef(((t,s)=>{var{className:a,children:n}=t,l=yr(t,["className","children"]);return e.jsx(rt.Content,Object.assign({className:pn("absolute left-1/2 top-1/2 z-50 -translate-x-1/2 -translate-y-1/2 !touch-auto !select-text","duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] focus:outline-none",a)},l,{children:n}))})),Ir=t=>{var{children:s}=t,a=yr(t,["children"]);return e.jsx(rt.Dialog,Object.assign({},a,{children:e.jsx(rt.Portal,{children:s})}))},Or=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=yr(t,["className"]);return xl((e=>e.isMobile))?e.jsx(J.Drawer.Title,Object.assign({ref:s},n,{className:pn("text-xl text-default font-medium line-clamp-1",a)})):e.jsx(rt.Title,Object.assign({ref:s},n,{className:pn("text-xl text-default font-medium line-clamp-1",a)}))}));Or.displayName=rt.Title.displayName;const Ar=w.cva("",{variants:{size:{lg:"w-[750px] max-h-[640px]",md:"w-[620px] max-h-[640px]",sm:"w-[380px] max-h-[640px]"},zIndex:{9:"z-[9]",99:"z-[99]",999:"z-[999]",9999:"z-[9999]"}},defaultVariants:{size:"lg",zIndex:99}}),Mr=t=>{var{title:a,description:n,size:l="lg",zIndex:r=99,hideClose:i=!1,overlayClose:o=!0,modalOnly:c=!0,contentClassName:d,overlayClassName:u,iconClassName:m,closeClassName:p,fullScreen:f=!1,focusScopeOptions:h,isLogin:g=!1,isNotification:v=!1,isHorizontal:x=!1,state:b,showCancel:E=!0,confirmLoading:_=!1,cancelText:w,confirmText:T,children:N,onClose:y,onConfirm:C}=t,S=yr(t,["title","description","size","zIndex","hideClose","overlayClose","modalOnly","contentClassName","overlayClassName","iconClassName","closeClassName","fullScreen","focusScopeOptions","isLogin","isNotification","isHorizontal","state","showCancel","confirmLoading","cancelText","confirmText","children","onClose","onConfirm"]);const j=xl((e=>e.isMobile));if(j&&!c&&!v){const t=e.jsxs(J.Drawer.Content,{className:pn("fixed inset-x-0 bottom-0 z-50 h-auto overflow-hidden no-scrollbar bg-surface-default shadow-modal-default focus:outline-none",f?"rounded-t-none max-h-full":"rounded-t-2xl max-h-[85vh]",d),children:[a?e.jsx(Pr,{children:e.jsx(Or,{children:a})}):e.jsx(Or,{className:"hidden"}),e.jsx("div",{className:pn(g?"overflow-y-scroll":"overflow-y-auto",f?a?"max-h-[calc(100vh-60px)]":"max-h-[100vh]":a?"max-h-[calc(85vh-60px)]":"max-h-[85vh]"),children:N}),!i&&e.jsx(J.Drawer.Close,{asChild:!0,children:e.jsxs("div",{className:pn("absolute right-4 top-3",p),onClick:()=>{y&&y()},children:[e.jsx(Kl,{icon:on,size:"md",variant:"ghost",color:"default",className:m}),e.jsx("span",{className:"sr-only",children:"Close"})]})})]});return e.jsx(J.Drawer.Root,Object.assign({},S,{repositionInputs:!1,children:e.jsxs(J.Drawer.Portal,{children:[e.jsx(Sr,{onClick:()=>{o&&y&&y()},className:u}),h?e.jsx(lr,Object.assign({},h,{children:t})):t]})}))}const I=s.useTranslations("common"),O=e.jsxs(jr,{className:pn("rounded-2xl bg-surface-default shadow-modal-default overflow-hidden",j?g?"w-[90%]":"w-[80%]":Ar({size:l,zIndex:r}),v&&"w-[312px] md:w-[380px]",d),children:[v?e.jsxs(e.Fragment,{children:[e.jsx(Pr,{className:pn(v&&"border-none !pb-3"),children:b&&e.jsx("div",{className:pn("flex items-center justify-center w-10 h-10 rounded-full flex-shrink-0 flex-grow-0",(e=>{switch(e){case"info":return"bg-surface-accent-blue-subtler";case"success":return"bg-surface-accent-green-subtler";case"warning":return"bg-surface-accent-yellow-subtler";case"error":return"bg-surface-accent-red-subtler"}})(b)),children:(t=>{switch(t){case"info":return e.jsx(Dt,{className:"text-icon-brand w-6 h-6"});case"success":return e.jsx(ia,{className:"text-icon-success w-6 h-6"});case"warning":return e.jsx(Ta,{className:"text-icon-warning w-6 h-6"});case"error":return e.jsx(ln,{className:"text-icon-critical w-6 h-6"})}})(b)})}),e.jsxs("div",{className:"space-y-1.5",children:[a?e.jsx("div",{className:"px-5",children:e.jsx(Dl,{size:"sm",children:a})}):null,N||(n?e.jsx("div",{className:"px-5",children:e.jsx(Ul,{size:"sm",weight:"regular",children:n})}):null)]}),e.jsxs(Lr,{className:pn("gap-x-5 min-h-[76px] p-5 border-none justify-center w-full"),children:[E&&e.jsx(Tr,{variant:"primary",color:"gray",onClick:y,className:"flex-1",children:w||I("cancel")}),e.jsx(Tr,{variant:"primary",onClick:C,loading:_,color:"error"===b?"error":"warning"===b?"warning":"brand",className:"flex-1",children:T||I("confirm")})]})]}):e.jsxs(e.Fragment,{children:[a?e.jsx(Pr,{children:e.jsx(Or,{children:a})}):e.jsx(Or,{className:"hidden"}),N]}),!i&&e.jsx(rt.Close,{asChild:!0,children:e.jsxs("div",{onClick:()=>{y&&y()},className:pn("absolute right-4 top-4",v&&"top-5",p),children:[e.jsx(Kl,{icon:on,size:"md",variant:"ghost",color:"default",className:m}),e.jsx("span",{className:"sr-only",children:"Close"})]})})]});return e.jsxs(Ir,Object.assign({},S,{children:[e.jsx(Cr,{onClick:()=>{o&&y&&y()},className:u}),h?e.jsx(lr,Object.assign({},h,{children:O})):O]}))};function Pr(t){var{className:s,children:a}=t,n=yr(t,["className","children"]);return e.jsx("div",Object.assign({className:pn("border-b border-default flex flex-col py-4 md:py-5 px-4 justify-center",s)},n,{children:a}))}function Lr(t){var{className:s,children:a}=t,n=yr(t,["className","children"]);return e.jsx("div",Object.assign({className:pn("border-t border-default flex justify-end p-4",s)},n,{children:a}))}function kr(t){var{className:s,children:a}=t,n=yr(t,["className","children"]);return e.jsx("div",Object.assign({className:pn("py-3",s)},n,{children:a}))}Pr.displayName="ModalHeader",Lr.displayName="ModalFooter",kr.displayName="ModalBody";const Rr=a.createContext(void 0);let Dr;const Ur=e=>{const t=a.useContext(Rr);if(!t)throw new Error("userStoreContext must be used within userStoreProvider");return n.useStore(t,e)};function Fr(){const e=Ur((e=>e.setEnergyInfo)),t=Ur((e=>e.userId));return{getEnergyInfo:async(s=!0)=>{try{const{data:a}=await function(e){return Os.post("/v1/user/get_energy",{body:{userId:e},isGoLang:!0,adapter:e=>e.energyInfo})}(t);s&&e(a)}catch(e){}}}}function Br(){const e=Ur((e=>e.setUser));return{queryUserProfile:async()=>{try{const{data:t}=await Us();return e(t),t}catch(e){throw new Error(e.response.data.message)}}}}function Gr({isOpen:t,onClose:n,rewardInfo:l,isLoading:r=!1}){var i;const o=s.useTranslations("common"),c=s.useTranslations("chat"),{getEnergyInfo:d}=Fr(),{queryUserProfile:u}=Br(),m=kn((e=>e.setNewlyPropsCount)),[p,f]=a.useState(!1);return e.jsxs(Ir,{open:t,children:[e.jsx(Cr,{onClick:n,children:e.jsx("div",{className:"w-full h-full",children:e.jsx("img",{src:lt.default.src,className:"w-full h-full object-cover",alt:"success background"})})}),e.jsx(jr,{children:e.jsxs("div",{className:"flex flex-col items-center w-[350px]",children:[e.jsxs("div",{className:"flex flex-col items-center text-center space-y-1.5",children:[e.jsx(Dl,{size:"lg",className:"text-static",children:o("congratulations")}),e.jsx(Ul,{size:"sm",weight:"regular",color:"static",className:"opacity-80",children:c("claim_season_pass_success_desc",{name:null==l?void 0:l.name})})]}),e.jsx("div",{className:"aspect-square w-full relative mt-5 rounded-xl overflow-hidden",children:e.jsx("div",{className:"aspect-square h-[358px] md:h-[350px] rounded-xl overflow-hidden relative flex-shrink-0",children:(h=ds(null!==(i=null==l?void 0:l.mediaUrl)&&void 0!==i?i:""),["mp4"].some((e=>e===h))?e.jsx(Zl,{src:ns(null==l?void 0:l.mediaUrl)}):e.jsx(vr,{src:ns(null==l?void 0:l.mediaUrl),alt:"img"}))})}),e.jsx(Ul,{size:"lg",weight:"medium",color:"static",className:"mt-2 text-center w-full",children:null==l?void 0:l.name}),e.jsx("div",{className:"w-full mt-5",children:e.jsx(Tr,{size:"lg",onClick:async()=>{m(0);try{f(!0),await Promise.all([d(),u()]),n()}catch(e){}finally{f(!1)}},loading:r||p,isBlock:!0,children:o("got_it")})})]})})]});var h}Ur.getState=()=>null==Dr?void 0:Dr.getState();var zr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Yr=w.cva("relative rounded-xl border flex justify-center flex-col md:flex-row md:justify-between items-center gap-3 py-2 px-3 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-default",{variants:{variant:{default:"bg-surface-default text-default",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"bg-surface-accent-yellow-subtlest border-surface-accent-yellow-subtle text-default",info:"bg-surface-accent-blue-subtlest border-surface-accent-blue-subtle text-default",error:"bg-surface-accent-red-subtlest border-surface-accent-red-subtle text-default"}},defaultVariants:{variant:"default"}}),Hr=Fe.forwardRef(((t,s)=>{var{className:a,variant:n}=t,l=zr(t,["className","variant"]);return e.jsx("div",Object.assign({ref:s,role:"alert",className:pn(Yr({variant:n}),a)},l))}));Hr.displayName="Alert";Fe.forwardRef(((t,s)=>{var{className:a}=t,n=zr(t,["className"]);return e.jsx("h5",Object.assign({ref:s,className:pn("mb-1 font-medium leading-none tracking-tight",a)},n))})).displayName="AlertTitle";const Vr=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=zr(t,["className"]);return e.jsx("div",Object.assign({ref:s,className:pn("text-base [&_p]:leading-relaxed",a)},n))}));function $r({onClose:t,type:n}){const l=s.useTranslations("chat"),[r,i]=a.useState(),[o,c]=a.useState(!1),[d,u]=a.useState(!1),{acting:m,handleRedeemAndUseSeasonPass:p}=Jl(),{getEnergyInfo:f}=Fr(),{queryUserProfile:h}=Br();return e.jsxs(e.Fragment,{children:[e.jsxs(Hr,{variant:"warning",className:"w-full flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{children:e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(Dt,{className:"hidden md:block shrink-0 size-6 text-icon-warning"}),e.jsx(Ul,{children:l("action"===n?"action_claim_season_passcard_tip":"claim_season_passcard_tip")})]})}),e.jsx(Tr,{size:"md",color:"warning",onClick:()=>{p((e=>{i(e),c(!0)}))},className:"md:flex-none w-full md:w-fit self-end lg:self-auto",loading:m,children:l("claim_season_passcard_btn_text")})]}),o&&e.jsx(Gr,{isOpen:o,onClose:async()=>{try{u(!0),await Promise.all([f(),h()]),c(!1),null==t||t()}catch(e){}finally{u(!1)}},rewardInfo:r,isLoading:d})]})}Vr.displayName="AlertDescription";var Wr=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function Kr(t){var{className:s,href:a,scroll:n=!1,replace:l=!1,prefetch:r=!0,children:i,onClick:o}=t,c=Wr(t,["className","href","scroll","replace","prefetch","children","onClick"]);const d=/^(https?:\/\/)/.test("string"==typeof a?a:`${a.pathname}`);return e.jsx(vt.default,Object.assign({href:a,scroll:n,replace:l,prefetch:r,onClick:o,className:pn(s),rel:d?"nofollow,noreferrer":"dofollow",target:d?"_blank":void 0},c,{children:i}))}function qr(e){const t=e.match(/\d+/);return(null==t?void 0:t.length)?t[(null==t?void 0:t.length)-1]:""}function Qr({isOpen:t,onClose:a,rewardInfo:n,count:l,isLoading:r=!1}){const i=s.useTranslations("common"),o=s.useTranslations("reward_center.reward_redemption_content.rewards");return e.jsx(Mr,{open:t,onClose:a,size:"sm",modalOnly:!0,children:e.jsxs(kr,{className:"p-5",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(Dl,{size:"xl",children:"🎉"}),e.jsx(Dl,{size:"sm",className:"mt-3",children:i("congrats_verb")}),e.jsx(Ul,{className:"mt-1.5",children:n.propType===Sn.seasonBadge||n.propType===Sn.standardBattlePass&&!n.subType.includes("m")||n.propType===Sn.energyPack&&!n.subType.includes("bonus")?o(`${us(n.propType)}.use_success_tip`,{count:Number(qr(n.subType))*l}):o(`${us(n.subType)}.use_success_tip`,{count:Number(qr(n.subType))*l})})]}),e.jsx("div",{className:"w-full flex justify-center items-center mt-5",children:e.jsx(Tr,{variant:"primary",size:"lg",isBlock:!0,loading:r,onClick:a,tabIndex:-1,children:i("got_it")})})]})})}function Xr(){const e=kn((e=>e.setMyProps)),t=kn((e=>e.myProps)),s=kn((e=>e.myPropsQuerying)),a=kn((e=>e.setMyPropsQuerying));return{querying:s,queryProps:async()=>{try{a(!0);const{data:t}=await Os.post("/v1/backpack/list",{isGoLang:!0,adapter:e=>e.items.map((e=>({id:e.item.id,name:e.item.name,description:e.item.description,media:ns(e.item.mediaUrl),count:e.count,propType:e.item.itemType,subType:e.item.subType,startDate:Number(e.item.usableStartDateUnix)?Ve.default(Number(e.item.usableStartDateUnix)):void 0,endDate:Number(e.item.usableEndDateUnix)?Ve.default(Number(e.item.usableEndDateUnix)):void 0,status:e.status})))});e(null!=t?t:[])}catch(e){}finally{a(!1)}},myProps:t}}function Jr(){const[e,t]=a.useState(!1),{queryProps:s}=Xr();return{acting:e,handleUseProp:a.useCallback((async(e,a,n,l)=>{try{t(!0),await function(e,t){return Os.post("/v1/backpack/use_backpack_item",{body:{backpackItemId:e,count:t},isGoLang:!0})}(e,n),l&&l(),s()}catch(e){}finally{t(!1)}}),[s])}}function Zr({onClose:t,type:n}){const{acting:l,handleUseProp:r}=Jr(),i=a.useRef(),{usableEnergyPack:o}=function(){const e=s.useTranslations("common"),{warning:t}=Ql(),n=kn((e=>e.myProps)),l=xl((e=>e.setNoEnergyWithUsablePropModalVisible)),r=a.useMemo((()=>{const e=n.filter((e=>e.propType===Sn.energyPack&&(!e.endDate||Ve.default().isBefore(Ve.default(e.endDate)))));return e.length?e.reduce(((e,t)=>Number(qr(null==t?void 0:t.subType))<Number(qr(null==e?void 0:e.subType))?t:e)):null}),[n]),i=a.useCallback((()=>!!r||(t({content:e("no_enough_energy_for_current_action"),id:"reach-limitation-warning"}),!1)),[l,r]),o=a.useCallback((()=>{r?l(!0):t({content:e("no_enough_energy_for_current_action"),id:"reach-limitation-warning"})}),[l,r]);return{usableEnergyPack:r,checkBeforePopupNoEnergy:o,getIsNoEnergy:i}}(),c=s.useTranslations("common"),d=s.useTranslations("reward_center"),[u,m]=a.useState(!1),[p,f]=a.useState(!1),{getEnergyInfo:h}=Fr(),g=a.useCallback((()=>{i.current=o,r(o.id,o,1,(()=>{m(!0)}))}),[r,o]),v=a.useCallback((async()=>{try{f(!0),await h(),null==t||t(),i.current=void 0,m(!1)}catch(e){console.error(e)}finally{f(!1)}}),[h]);return e.jsxs(e.Fragment,{children:[o?e.jsxs(Hr,{variant:"warning",className:"w-full flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{children:e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(Dt,{className:"hidden md:block shrink-0 size-6 text-icon-warning"}),e.jsx(Ul,{children:c("usable_energy_pack.desc",{value:qr(o.subType)})})]})}),e.jsx(Tr,{size:"md",color:"warning",onClick:g,loading:l,className:"w-full md:w-fit shrink-0 self-end lg:self-auto",children:c("use")})]}):e.jsxs(Hr,{variant:"warning",className:"w-full flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{children:e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(Dt,{className:"hidden md:block shrink-0 size-6 text-icon-warning"}),e.jsx(Ul,{children:c("action"===n?"action_energy_pack_in_reward_center":"explore_energy_pack_in_reward_center")})]})}),e.jsx(Kr,{href:"/rewards-center/reward-redemption",className:"w-full md:w-fit self-end lg:self-auto md:flex-none",children:e.jsx(Tr,{size:"md",color:"warning",className:"w-full",children:d("title")})})]}),u&&e.jsx(Qr,{isOpen:u,onClose:v,rewardInfo:i.current,count:1,isLoading:p})]})}var ei=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const ti=rt.Root,si=rt.Portal;Fe.forwardRef(((t,s)=>{var{className:a}=t,n=ei(t,["className"]);return e.jsx(rt.Trigger,Object.assign({ref:s,className:pn("ring-offset-surface-default focus-visible:outline-none focus-visible:shadow-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1",a)},n))})).displayName=rt.Trigger.displayName;const ai=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=ei(t,["className"]);return e.jsx(rt.Overlay,Object.assign({ref:s,className:pn("fixed inset-0 z-50 bg-opacity-90 md:bg-opacity-75 bg-alpha-mask-desktop data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},n))}));ai.displayName=rt.Overlay.displayName;const ni=Fe.forwardRef(((s,a)=>{var{className:n,children:l,hideClose:r=!1,maskClosable:i=!0,overlayClose:o=!0,onClose:c,overlayClassName:d,iconClassName:u}=s,m=ei(s,["className","children","hideClose","maskClosable","overlayClose","onClose","overlayClassName","iconClassName"]);return e.jsxs(si,{children:[e.jsx(ai,{onClick:()=>{i&&o&&c&&c()},className:d}),e.jsxs(rt.Content,Object.assign({ref:a,className:pn("fixed left-[50%] top-[50%] z-50 grid w-[90%] rounded-4xl max-w-lg translate-x-[-50%] translate-y-[-50%] bg-surface-default shadow-modal-default duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] ring-offset-surface-default focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 focus-visible:outline-0",n)},m,{children:[l,!r&&e.jsxs(rt.Close,{className:pn("w-9 h-9 absolute right-5 top-3 flex justify-center items-center focus-visible:outline-0 rounded-full hover:bg-surface-hovered",u),onClick:()=>{c&&c()},children:[e.jsx(t.X,{className:"w-6 h-6 text-icon-subtle"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})}));function li(t){var{className:s}=t,a=ei(t,["className"]);return e.jsx("div",Object.assign({className:pn("flex flex-col p-4",s)},a))}function ri(t){var{className:s}=t,a=ei(t,["className"]);return e.jsx("div",Object.assign({className:pn("flex justify-end p-4",s)},a))}ni.displayName=rt.Content.displayName,li.displayName="DialogHeader",ri.displayName="DialogFooter";const ii=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=ei(t,["className"]);return e.jsx(rt.Title,Object.assign({ref:s,className:pn("text-xl font-normal",a)},n))}));ii.displayName=rt.Title.displayName;const oi=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=ei(t,["className"]);return e.jsx(rt.Description,Object.assign({ref:s,className:pn("text-sm text-subtle p-4",a)},n))}));oi.displayName=rt.Description.displayName;const ci=w.cva("animate-spin",{variants:{size:{"2xs":"h-3.5 w-3.5",xs:"h-4 w-4",sm:"h-5 w-5",md:"h-6 w-6",xl:"h-7 w-7",lg:"h-9 w-9"},speed:{slow:"duration-2000",default:"duration-600",fast:"duration-500"},color:{default:"text-default",brand:"text-brand",static:"text-static",warning:"text-warning",success:"text-success"}},defaultVariants:{size:"md",speed:"default",color:"default"}});function di(s){const{size:a,speed:n,color:l,className:r}=s;return e.jsx(t.Loader2,{className:pn(ci({size:a,speed:n,color:l}),r)})}const ui=(e,t,a,n=!0)=>{const[l,r]=h.useCopyToClipboard(),{success:i,error:o}=Ql(),c=s.useTranslations("common");return{onCopy:s=>{let l=e;s&&(l=s),r(l),n&&i({content:t||c("copied"),id:"text-copied"}),"function"==typeof a&&a()},onCopyImage:t=>{let s=e;t&&(s=t);const a=new Image;a.crossOrigin="anonymous",a.src=s,a.onload=()=>{try{const e=document.createElement("canvas");e.width=a.width,e.height=a.height;const t=e.getContext("2d");null==t||t.drawImage(a,0,0),e.toBlob((e=>{if(e){const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]),i({content:c("copied")})}}))}catch(e){o({content:`${c("copy_failed")} ${null==e?void 0:e.message}`})}}},value:l}};Ve.default.extend(it.default);const mi=e=>{const{widgetName:t,status:s,endTimeTimestamp:a,startTimeTimestamp:n}=e;return`${t} (${(e=>{const t=Ve.default.duration(e,"seconds"),s=Math.floor(t.asMinutes()),a=t.seconds();return s>0?`${s}min${a}s`:`${a}s`})("PROCESSING"===s?Ve.default().valueOf()/1e3-Number(n):Number(a)-Number(n))})`};let pi=null;async function fi(e){if(!pi)try{const e=await import("js-tiktoken"),{getEncoding:t}=e;pi=t("cl100k_base")}catch(e){throw console.error("Error loading js-tiktoken:",e),new Error("Failed to load tokenizer")}return pi.encode(null!=e?e:"").length}function hi(){return{track:(e,t)=>{var s,a;console.log("sensors track",e,t),(null===(s=null===window||void 0===window?void 0:window.sensors)||void 0===s?void 0:s.track)?null===(a=null===window||void 0===window?void 0:window.sensors)||void 0===a||a.track(e,Object.assign({},t||{})):Ts.addToQueue(e,t)},setOnceProfile:e=>{var t;null===(t=null===window||void 0===window?void 0:window.sensors)||void 0===t||t.setOnceProfile(Object.assign({},e||{}))},setProfile:e=>{var t;null===(t=null===window||void 0===window?void 0:window.sensors)||void 0===t||t.setProfile(Object.assign({},e||{}))},login:e=>{var t;null===(t=null===window||void 0===window?void 0:window.sensors)||void 0===t||t.login(e)}}}var gi=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const vi=pl(1),xi={messageListMap:{},lastMsgIdMap:{},lastUserInteractionMsgIdMap:{},draftReplyMessageMap:{},localDraftMessageMap:{},localErrorMessageMap:{},localFiles:{},exceptionsForTextDisplay:{},fileUpload:{uploading:null,deletedList:[],alert:{visible:!1,data:[]}}},bi={name:"chat-storage",version:2,storage:bn((()=>localStorage)),partialize:e=>({localDraftMessageMap:e.localDraftMessageMap,exceptionsForTextDisplay:e.exceptionsForTextDisplay,localErrorMessageMap:e.localErrorMessageMap}),merge:(e,t)=>Object.assign(Object.assign({},t),{localDraftMessageMap:Object.assign(Object.assign({},t.localDraftMessageMap),e.localDraftMessageMap),exceptionsForTextDisplay:Object.assign(Object.assign({},t.exceptionsForTextDisplay),e.exceptionsForTextDisplay),localErrorMessageMap:Object.assign(Object.assign({},t.localErrorMessageMap),e.localErrorMessageMap)})},Ei=e=>n.createStore()(wn(vn(_n(((t,s)=>Object.assign(Object.assign({},xi),{messageListMap:Object.assign({},e),sendDraftMessage:(e,s,a)=>{t((t=>{var n,l,r,i;const o=`${e}-${s}`;t.lastUserInteractionMsgIdMap[o]=a.id,t.messageListMap[o]=[...null!==(n=t.messageListMap[o])&&void 0!==n?n:[],a],t.lastMsgIdMap[o]=null!==(r=null===(l=t.messageListMap[o].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:"",(null===(i=a.embedObjs)||void 0===i?void 0:i.length)&&(t.localFiles[o]=[])}))},replaceDraftMessage:(e,s,a)=>{t((t=>{var n,l,r,i,o;const c=`${e}-${s}`,d=t.lastUserInteractionMsgIdMap[c];if(d){const e=(null!==(i=t.messageListMap[c])&&void 0!==i?i:[]).findIndex((e=>e.id===d));e>=0?(null===(o=t.messageListMap[c])||void 0===o||o.splice(e,1,a),t.lastMsgIdMap[c]=a.id,t.lastUserInteractionMsgIdMap[c]=a.id):console.error("logic error")}else t.messageListMap[c]=[...null!==(n=t.messageListMap[c])&&void 0!==n?n:[],a],t.lastMsgIdMap[c]=null!==(r=null===(l=t.messageListMap[c].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},updateReply:(e,s,a)=>{t((t=>{var n,l,r,i,o;const c=`${e}-${s}`,d=t.draftReplyMessageMap[c];if(d){const e=(null!==(l=t.messageListMap[c])&&void 0!==l?l:[]).findIndex((e=>e.id===d));e>=0?(null===(r=t.messageListMap[c])||void 0===r||r.splice(e,1,a),t.draftReplyMessageMap[c]=""):console.error("logic error")}else{const e=(null!==(n=t.messageListMap[c])&&void 0!==n?n:[]).findIndex((e=>e.id===a.id));e>=0&&(t.messageListMap[c][e]=a)}t.lastMsgIdMap[c]=null!==(o=null===(i=t.messageListMap[c].at(-1))||void 0===i?void 0:i.id)&&void 0!==o?o:""}))},prependMessages:(e,s,a)=>{t((t=>{var n,l,r;const i=`${e}-${s}`;t.messageListMap[i]=[...a,...null!==(n=t.messageListMap[i])&&void 0!==n?n:[]],t.lastMsgIdMap[i]=null!==(r=null===(l=t.messageListMap[i].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},appendMessages:(e,s,a)=>{t((t=>{var n,l,r;const i=`${e}-${s}`,o=Array.isArray(a)?a:[a],c=o.find((e=>"PENDING_FOR_RESPONSE"===e.type));c&&(t.draftReplyMessageMap[i]=c.id),t.messageListMap[i]=[...null!==(n=t.messageListMap[i])&&void 0!==n?n:[],...o],t.lastMsgIdMap[i]=null!==(r=null===(l=t.messageListMap[i].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},mixMessages:(e,s,a)=>{t((t=>{var n,l,r;const i=`${e}-${s}`,o=Array.isArray(a)?a:[a];t.messageListMap[i]=((e,t)=>{const s={};return(null!=e?e:[]).forEach(((e,t)=>{s[e.id]=Object.assign(Object.assign({},e),{originalIndex:t})})),t.forEach(((t,a)=>{s[t.id]=Object.assign(Object.assign({},t),{originalIndex:t.id in s?s[t.id].originalIndex:e.length+a})})),Object.values(s).sort(((e,t)=>{var s,a;const n=e.createdDateUnix,l=t.createdDateUnix;return n!==l?Number(n)-Number(l):(null!==(s=e.originalIndex)&&void 0!==s?s:0)-(null!==(a=t.originalIndex)&&void 0!==a?a:0)})).map((e=>gi(e,["originalIndex"])))})([...null!==(n=t.messageListMap[i])&&void 0!==n?n:[]],o),t.lastMsgIdMap[i]=null!==(r=null===(l=t.messageListMap[i].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},addTextStream(e,s,a,n,l){t((t=>{const r=`${e}-${s}`,i=t.messageListMap[r].findIndex((e=>e.id===a));if(i>=0){const e=t.messageListMap[r][i];t.messageListMap[r][i]=Object.assign(Object.assign({},e),{text:(e.text||"")+n,isLlmBot:l})}}))},addAudioStream(e,s,a,n){t((t=>{const l=`${e}-${s}`,r=t.messageListMap[l].findIndex((e=>e.id===a));if(r>=0){const e=t.messageListMap[l][r];t.messageListMap[l][r]=Object.assign(Object.assign({},e),{audioBuffer:e.audioBuffer?[...e.audioBuffer,n]:[n]})}}))},addTranslationStream(e,s,a,n){t((t=>{const l=`${e}-${s}`,r=t.messageListMap[l].findIndex((e=>e.id===a));if(r>=0){const e=t.messageListMap[l][r];t.messageListMap[l][r]=Object.assign(Object.assign({},e),{translation:(e.translation||"")+n})}}))},updateMessage:(e,s,a)=>{t((t=>{var n;const l=`${e}-${s}`,r=t.messageListMap[l].findIndex((e=>e.id===a.id));if(r>=0){const e=t.messageListMap[l][r];"CANCELING"===e.status&&"CANCELED"!==a.status||"CANCELED"===e.status||(t.messageListMap[l][r]=Object.assign(Object.assign(Object.assign({},e),a),{imageGenMessageResponse:null!==(n=null==a?void 0:a.imageGenMessageResponse)&&void 0!==n?n:null==e?void 0:e.imageGenMessageResponse}))}}))},replaceMessage:(e,s,a,n)=>{t((t=>{var l,r;const i=`${e}-${s}`,o=t.messageListMap[i].findIndex((e=>e.id===a));o>=0&&(t.messageListMap[i][o]=n),t.lastMsgIdMap[i]=null!==(r=null===(l=t.messageListMap[i].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},partialUpdateMessage(e,s,a,n){t((t=>{const l=`${e}-${s}`,r=t.messageListMap[l].findIndex((e=>e.id===a));if(r>=0){const e=t.messageListMap[l][r];if(e){if("CANCELING"===e.status&&"CANCELED"!==n.status||"CANCELED"===e.status)return;t.messageListMap[l][r]=Object.assign(Object.assign({},e),n)}}}))},partialUpdateRegenMessage(e,s,a,n,l){t((t=>{var r,i;const o=`${e}-${s}`,c=t.messageListMap[o].findIndex((e=>e.id===a));if(c>=0){const e=t.messageListMap[o][c];if(e){if("CANCELING"===e.status&&"CANCELED"!==l.status||"CANCELED"===e.status)return;const s=(null!==(r=e.regeneratedMessages)&&void 0!==r?r:[]).findIndex((e=>n===e.id));if(s>=0){const a=(null!==(i=e.regeneratedMessages)&&void 0!==i?i:[])[s];t.messageListMap[o][c].regeneratedMessages[s]=Object.assign(Object.assign({},a),l)}}}}))},setLocalDraftMessage(e,s,a){t((t=>{const n=`${e}-${s}`;a?t.localDraftMessageMap[n]=a:delete t.localDraftMessageMap[n],t.localDraftMessageMap=Object.assign({},t.localDraftMessageMap)}))},deleteSpecifiedMessage(e,s,a){t((t=>{var n,l,r;const i=`${e}-${s}`;t.messageListMap[i]=a?[...null!==(n=t.messageListMap[i])&&void 0!==n?n:[]].filter((e=>e.id!==a)):[],t.lastMsgIdMap[i]=null!==(r=null===(l=t.messageListMap[i].at(-1))||void 0===l?void 0:l.id)&&void 0!==r?r:""}))},addTextDisplayException(e,s,a){t((t=>{var n;const l=`${e}-${s}`,r=[...null!==(n=t.exceptionsForTextDisplay[l])&&void 0!==n?n:[],a];t.exceptionsForTextDisplay=Object.assign(Object.assign({},t.exceptionsForTextDisplay),{[l]:r})}))},handleInteractionError(e,s,a){t((t=>{var n,l,r,i,o,c;const d=`${e}-${s}`,u=t.lastUserInteractionMsgIdMap[d],m=t.draftReplyMessageMap[d],p=(null!==(n=t.messageListMap[d])&&void 0!==n?n:[]).findIndex((e=>e.id===u)),f=(null!==(l=t.messageListMap[d])&&void 0!==l?l:[]).find((e=>e.id===m));if(p>=0){const e=t.messageListMap[d][p],s=Object.assign(Object.assign({},e),{status:a});t.messageListMap[d][p]=s,t.localErrorMessageMap[d]=[...null!==(r=t.localErrorMessageMap[d])&&void 0!==r?r:[],s],m&&f&&"PENDING_FOR_RESPONSE"===f.type&&(t.messageListMap[d]=[...null!==(i=t.messageListMap[d])&&void 0!==i?i:[]].filter((e=>e.id!==m)),t.lastMsgIdMap[d]=null!==(c=null===(o=t.messageListMap[d].at(-1))||void 0===o?void 0:o.id)&&void 0!==c?c:"",t.draftReplyMessageMap[d]="")}}))},removeLocalErrorMessage(e,s,a){t((t=>{var n;const l=`${e}-${s}`,r=[...t.localErrorMessageMap[l]],i=(null!=r?r:[]).findIndex((e=>e.id===a));i>=0&&r.splice(i,1);const o=(null!==(n=t.messageListMap[l])&&void 0!==n?n:[]).findIndex((e=>e.id===a));o>=0&&t.messageListMap[l].splice(o,1),t.localErrorMessageMap[l]=r}))},clearDraftMessage(e,s){t((t=>{var a,n;const l=`${e}-${s}`,r=t.lastUserInteractionMsgIdMap[l],i=t.draftReplyMessageMap[l];if(r){const e=(null!==(a=t.messageListMap[l])&&void 0!==a?a:[]).findIndex((e=>e.id===r));e>=0&&t.messageListMap[l].splice(e,1)}if(i){const e=(null!==(n=t.messageListMap[l])&&void 0!==n?n:[]).findIndex((e=>e.id===i));e>=0&&t.messageListMap[l].splice(e,1)}t.lastUserInteractionMsgIdMap[l]="",t.draftReplyMessageMap[l]=""}))},async uploadFiles(e,a,n,l,r){const i=`${e}-${a}`;t((e=>{const t=e.localFiles[i]||[];if(l){const s=t.map((e=>e.id===n[0].id?n[0]:e));e.localFiles[i]=[...s]}else e.localFiles[i]=[...t,...n]})),n.forEach((e=>{vi((async()=>{const{deletedList:a}=s().fileUpload;if(a.includes(e.id))return void t((t=>{t.fileUpload.deletedList=t.fileUpload.deletedList.filter((t=>t!==e.id))}));let n;t((t=>{t.fileUpload.uploading=e})),n="function"==typeof r?await r(e.file):await ml({scenario:ll.SCENARIO_IM_CHAT,contentType:e.uiData.contentType,onProgress:s=>{t((t=>{t.fileUpload.uploading=Object.assign(Object.assign({},e),{progress:s})}))},file:e.file,cancelToken:s=>{t((t=>{const a=(t.localFiles[i]||[]).map((t=>t.id===e.id?Object.assign(Object.assign({},t),{cancelToken:{cancel:s}}):t));t.localFiles[i]=[...a]}))}});s().fileUpload.deletedList.includes(e.id)?t((t=>{t.fileUpload.deletedList=t.fileUpload.deletedList.filter((t=>t!==e.id)),t.fileUpload.uploading=null})):t((t=>{0===vi.pendingCount&&(t.fileUpload.uploading=null);const{deletedList:s}=t.fileUpload;s.includes(e.id)&&(t.fileUpload.uploading=null);const a=(t.localFiles[i]||[]).map((t=>t.id===e.id?Object.assign(Object.assign({},t),{status:(null==n?void 0:n.objectAccessUrl)?"SUCCESS":"ERROR",url:null==n?void 0:n.objectAccessUrl}):t));t.localFiles[i]=[...a]}))}))}))},deleteUploadFile(e,s,a){const n=`${e}-${s}`;t((e=>{const t=e.localFiles[n]||[];if(a){e.localFiles[n]=[...(null!=t?t:[]).filter((e=>e.id!==a))];const l=t.find((e=>e.id===a));(null==l?void 0:l.cancelToken.cancel)&&l.cancelToken.cancel(),e.fileUpload.deletedList=[...e.fileUpload.deletedList,s]}else e.localFiles[n]=[]}))},setFileAlert(e){t((t=>{t.fileUpload.alert=e}))}})),bi),{store:"new-chat"}))),_i=a.createContext(void 0);let wi;const Ti=e=>{const t=a.useContext(_i);if(!t)throw new Error("chatStoreContext must be used within chatStoreProvider");return n.useStore(t,e)};function Ni({onTerminate:t,loading:s}){return e.jsx(Tr,{variant:"primary",color:"default",size:"md",onClick:t,loading:s,children:e.jsxs("span",{className:"inline-flex space-x-[6px]",children:[e.jsx(tn,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Stop"})]})})}function yi({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0A.75.75 0 0 1 15 4.5h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z",clipRule:"evenodd"}))}Ti.getState=()=>null==wi?void 0:wi.getState();const Ci=Fe.forwardRef(yi);function Si({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z",clipRule:"evenodd"}))}const ji=Fe.forwardRef(Si);function Ii({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M4.5 7.5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3v-9Z",clipRule:"evenodd"}))}const Oi=Fe.forwardRef(Ii);function Ai({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Mi=Fe.forwardRef(Ai);function Pi({className:t}){return e.jsxs("svg",{strokeWidth:"0",viewBox:"0 0 24 24",className:t,focusable:"false",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),e.jsx("path",{d:"M20 7v10H4V7h16m0-2H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2zm0 3h2v2h-2zM8 8h2v2H8zm0 3h2v2H8zm-3 0h2v2H5zm0-3h2v2H5zm3 6h8v2H8zm6-3h2v2h-2zm0-3h2v2h-2zm3 3h2v2h-2zm0-3h2v2h-2z",fill:"currentColor"})]})}var Li=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const ki=bt.Root,Ri=bt.Trigger;Fe.forwardRef(((s,a)=>{var{className:n,inset:l,children:r}=s,i=Li(s,["className","inset","children"]);return e.jsxs(bt.SubTrigger,Object.assign({ref:a,className:pn("flex cursor-default select-none items-center rounded-lg px-3 py-2 outline-none focus:bg-surface-container-selected-default data-[state=open]:bg-surface-container-selected-default",l&&"pl-8",n)},i,{children:[r,e.jsx(t.ChevronRight,{className:"ml-auto h-4 w-4"})]}))})).displayName=bt.SubTrigger.displayName;Fe.forwardRef(((t,s)=>{var{className:a}=t,n=Li(t,["className"]);return e.jsx(bt.SubContent,Object.assign({ref:s,className:pn("z-50 min-w-[8rem] overflow-hidden rounded-xl border border-alpha bg-surface-search-field p-2 text-default shadow-modal-default data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a)},n))})).displayName=bt.SubContent.displayName;const Di=Fe.forwardRef(((t,s)=>{var{className:a,sideOffset:n=4}=t,l=Li(t,["className","sideOffset"]);return e.jsx(bt.Content,Object.assign({ref:s,sideOffset:n,className:pn("z-[100] min-w-[8rem] overflow-hidden rounded-xl border border-opaque bg-surface-default p-1 text-default shadow-modal-default data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a)},l))}));Di.displayName=bt.Content.displayName;const Ui=Fe.forwardRef(((t,s)=>{var{className:a,inset:n}=t,l=Li(t,["className","inset"]);return e.jsx(bt.Item,Object.assign({ref:s,className:pn("relative flex cursor-default select-none items-center rounded-lg px-2 py-1 outline-none transition-colors focus:bg-surface-container-selected-default data-[disabled]:pointer-events-none data-[disabled]:opacity-30",n&&"pl-8",a)},l))}));Ui.displayName=bt.Item.displayName;Fe.forwardRef(((s,a)=>{var{className:n,children:l,checked:r}=s,i=Li(s,["className","children","checked"]);return e.jsxs(bt.CheckboxItem,Object.assign({ref:a,className:pn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-30",n),checked:r},i,{children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(bt.ItemIndicator,{children:e.jsx(t.Check,{className:"h-4 w-4"})})}),l]}))})).displayName=bt.CheckboxItem.displayName;Fe.forwardRef(((s,a)=>{var{className:n,children:l}=s,r=Li(s,["className","children"]);return e.jsxs(bt.RadioItem,Object.assign({ref:a,className:pn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",n)},r,{children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(bt.ItemIndicator,{children:e.jsx(t.Circle,{className:"h-2 w-2 fill-current"})})}),l]}))})).displayName=bt.RadioItem.displayName;Fe.forwardRef(((t,s)=>{var{className:a,inset:n}=t,l=Li(t,["className","inset"]);return e.jsx(bt.Label,Object.assign({ref:s,className:pn("px-3 py-1 text-sm font-medium",n&&"pl-8",a)},l))})).displayName=bt.Label.displayName;const Fi=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=Li(t,["className"]);return e.jsx(bt.Separator,Object.assign({ref:s,className:pn("my-1 h-px bg-[var(--border)]",a)},n))}));function Bi(e){return Os.post(`/v1/channel/chat/list/delete/${e}`,{isGoLang:!0})}function Gi(e,t){return Os.post("/v1/feedback/message",{body:{action:{Liked:1,Dislike:2,Normal:3}[e],messageId:t},isGoLang:!0})}function zi(e,t,s,a){return Os.post("/v1/feedback/issue",{body:{entityId:t,issueType:e,content:JSON.stringify({issues:s,othersContent:a})},isGoLang:!0})}function Yi(e,t,a,n){const l=s.useTranslations("workshop"),[r,i]=c.useToggle(!1),{success:o,error:d}=Ql();return{clearing:r,clearHistory:async()=>{try{i(!0);const{success:s}=await function(e,t){return Os.post("/v1/chat/deleteAllHistory",{body:{bizId:t,bizType:"widget"===e?"HISTORY_OPERATION_BIZ_TYPE_WIDGET":"HISTORY_OPERATION_BIZ_TYPE_BOT"},isGoLang:!0})}(e,t);s?(o({content:l("delete_widget_success")}),a(),null==n||n()):d({content:l("delete_widget_error")})}catch(e){console.error(e),d({content:l("delete_widget_error")})}finally{i(!1)}}}}function Hi({type:t,id:n,disabled:l=!1,onSuccess:r}){const{getList:i}=a.useContext(jt),{deleteSpecifiedMessageId:o}=a.useContext(At),[d,u]=c.useBoolean(!1),m=s.useTranslations("chat"),{clearing:p,clearHistory:f}=Yi(t,n,i,o),{clearHistory:h=f}=a.useContext(At);return e.jsxs(e.Fragment,{children:[e.jsxs(Ui,{disabled:l,className:"cursor-pointer flex items-center gap-3 relative text-critical",onSelect:e=>e.preventDefault(),onClick:()=>{u(!0)},children:[e.jsx(an,{className:"size-5 stroke-critical"}),m("delete_chat_history")]}),d&&e.jsx(Mr,{overlayClassName:"z-[100]",contentClassName:"z-[110]",state:"warning",isNotification:!0,open:d,onClose:()=>u(!1),onConfirm:async()=>{try{await h(),r()}catch(e){console.error(e)}},title:m("delete_confirmation.header"),description:m("delete_confirmation.delete_all_content",{entity:t}),confirmLoading:p})]})}function Vi(e){let t;switch(e){case"TEXT":case"VOICE":case"REPLY":case"GREETING":case"VOICE_CALL_TEXT":case"VOICE_CALL_VOICE":case"VOICE_CALL_REPLY":case"BUTTON_INTERACTION":default:t="NORMAL";break;case"PROMPT_UPDATED":case"WIDGET_PROMPT_UPDATED":case"NEED_TO_REGISTER":case"VOICE_CALL_END":case"LLM_MODERATION_REQUEST":case"ROOM_CLOSED":case"OTHER_SIDE_LEFT":case"OTHER_SIDE_NO_ENOUGH_ENERGY":case"VISITOR_DISABLED":case"CLAIM_PASSCARD":case"USE_ENERGY_PACK":t="NOTIFICATION";break;case"RESET":t="INFO"}return t}function $i(e,t){var s,a,n;return{id:e.id,userId:e.userId,referenceText:e.referenceText,text:e.text,audioUrl:e.voiceUrl,duration:e.voiceFileDurationSeconds,audioSpeed:e.audioSpeed,status:e.status,type:e.type,createdDateUnix:e.createdDateUnix,updatedDateUnix:e.updatedDateUnix,entityId:"widget"===t?null!==(s=e.widgetId)&&void 0!==s?s:"":e.botId,replyId:e.replyId,feedbackState:e.feedbackState,feedbackIssues:e.feedbackIssues,asyncJobInfo:e.asyncJobInfo,runningWidgetInfo:null===(a=e.extraInfo)||void 0===a?void 0:a.runningWidgetInfo,runningError:e.runningError,handled:e.handled,imageGenMessageResponse:e.imageGenMessageResponse,inputSetting:e.inputSetting,uploadSetting:e.uploadSetting,componentContainer:e.componentContainer,embedObjs:e.embedObjs,slashCommandInput:e.imSlashCommandInput,referenceSource:e.referenceSource,recommendatioQuestions:e.recommendationQuestion,regeneratedMessages:(null!==(n=e.regeneratedMessages)&&void 0!==n?n:[]).map((e=>$i(e,t))),extraInfo:e.extraInfo,isLlmBot:e.isLlmBot}}function Wi(e,t){return"DRAFT"===e.status||"LOCAL_ERROR"===e.status||"NETWORK_ERROR"===e.status?function(e){return{id:e.id,text:e.text,audioUrl:e.audioUrl,status:e.status,type:e.type,userId:e.userId,createdDateUnix:e.createdDateUnix,updatedDateUnix:e.updatedDateUnix,entityId:e.entityId,embedObjs:e.embedObjs,slashCommandInput:e.slashCommandInput,requestParams:e.requestParams}}(e):$i(e,t)}function Ki(e,t,s){let a="OTHER";return"TEXT"!==s&&"VOICE"!==s&&"BUTTON_INTERACTION"!==s&&"VOICE_CALL_TEXT"!==s||(a=e===t?"USER":"OTHER_USER"),a}function qi(e,t){var s;const a="TEXT"!==e.type&&"VOICE"!==e.type&&"BUTTON_INTERACTION"!==e.type;return null===(s=t.get(`${a?"entity":"user"}-${a?e.entityId:e.userId}`))||void 0===s?void 0:s.avatar}function Qi(e,t,s){var a;if(!("TEXT"!==e.type&&"VOICE"!==e.type&&"BUTTON_INTERACTION"!==e.type)){const a=t.get(`user-${e.userId}`);return(null==a?void 0:a.isVisitor)?s?s(a.nameTag):a.name:null==a?void 0:a.name}return null===(a=t.get(`entity-${e.entityId}`))||void 0===a?void 0:a.name}function Xi(e,t){if(e.replyId&&"0"!==e.replyId)return t.get(`user-${e.userId}`)}function Ji(e,t,a,n){const[l,r]=c.useBoolean(!1),i=s.useTranslations("common"),o=s.useTranslations("workshop"),{success:d,error:u}=Ql();return{loading:l,handleClearMemory:async s=>{try{r(!0);const{success:l,data:o}=await function(e,t){return Os.post("/v1/chat/reset",{body:{bizId:t,bizType:"widget"===e?"HISTORY_OPERATION_BIZ_TYPE_WIDGET":"HISTORY_OPERATION_BIZ_TYPE_BOT"},isGoLang:!0,adapter:t=>t.messages.map((t=>Wi(t,e)))})}(e,t);l&&(d({content:`${null!=n?n:""} ${i("memory_cleared_with")}`}),null==s||s(),a(null!=o?o:[],!0))}catch(e){u({content:o("clear_widget_error")})}finally{r(!1)}}}}function Zi({type:t,id:n,disabled:l=!1,onSuccess:r}){const{entityInfo:i}=a.useContext(jt),{name:o}=i,{appendMessages:c}=a.useContext(At),d=s.useTranslations("chat"),{loading:u,handleClearMemory:m}=Ji(t,n,c,o),{clearMemory:p=m}=a.useContext(At);return e.jsxs(Ui,{disabled:l||u,className:"cursor-pointer flex items-center gap-3 relative",onSelect:e=>e.preventDefault(),onClick:async()=>{try{p(r)}catch(e){console.error(e)}},children:[u?e.jsx(di,{size:"sm",color:"default"}):e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.3712 5.57263V3.83542C9.3712 3.36599 9.75175 2.98543 10.2212 2.98543C10.6906 2.98543 11.0712 3.36598 11.0712 3.83542V5.57263C11.0712 7.02921 12.252 8.21 13.7085 8.21H16.2957V9.90999H4.14666V8.21H6.73383C8.19041 8.21 9.3712 7.02921 9.3712 5.57263ZM6.73383 6.89131C7.46212 6.89131 8.05252 6.30092 8.05252 5.57263V3.83542C8.05252 2.6377 9.02346 1.66675 10.2212 1.66675C11.4189 1.66675 12.3899 2.6377 12.3899 3.83542V5.57263C12.3899 6.30092 12.9803 6.89131 13.7085 6.89131H16.5076C17.1188 6.89131 17.6144 7.38686 17.6144 7.99814V10.1218C17.6144 10.5432 17.3789 10.9096 17.0324 11.0965L17.6513 14.7292C17.9724 16.6135 16.5207 18.3334 14.6092 18.3334H5.58673C3.67531 18.3334 2.2236 16.6135 2.54463 14.7292L3.17353 11.0378L3.36378 11.0702C3.04269 10.8764 2.82798 10.5242 2.82798 10.1218V7.99814C2.82798 7.38686 3.32352 6.89131 3.93481 6.89131H6.73383ZM4.25575 11.2287L3.62792 14.9138C3.42121 16.127 4.35596 17.2345 5.58673 17.2345H7.01902C7.01323 17.2025 7.0102 17.1696 7.0102 17.136V14.1932C7.0102 13.8898 7.2562 13.6438 7.55965 13.6438C7.86311 13.6438 8.1091 13.8898 8.1091 14.1932V17.136C8.1091 17.1696 8.10608 17.2025 8.10029 17.2345H11.3071C11.3013 17.2025 11.2983 17.1696 11.2983 17.136V14.1932C11.2983 13.8898 11.5443 13.6438 11.8477 13.6438C12.1512 13.6438 12.3972 13.8898 12.3972 14.1932V17.136C12.3972 17.1696 12.3941 17.2025 12.3884 17.2345H14.6092C15.84 17.2345 16.7748 16.127 16.568 14.9138L15.9402 11.2287H4.25575Z",fill:"currentColor"})}),d("clear_memory")]})}function eo({disabled:t=!1,onSuccess:n}){const{setEditorMode:l}=a.useContext(At),r=s.useTranslations("chat");return e.jsxs(Ui,{disabled:t,className:"cursor-pointer flex items-center gap-3 relative",onSelect:e=>e.preventDefault(),onClick:()=>{null==l||l("SHARE"),n()},children:[e.jsx(Zs,{className:"size-5"}),r("share_chat_records")]})}Fi.displayName=bt.Separator.displayName;const to=()=>xl((e=>e.isMobile)),so=()=>{const e=d.usePathname()||"",t=xl((e=>e.isMobile));return a.useMemo((()=>{const s=("undefined"!=typeof document?document.cookie:"").match(/(^|;\s*)NEXT_LOCALE=([^;]+)/);return{defaultLocale:"en",locale:s&&(null==s?void 0:s[2])||"en",pathname:e,isMobile:t}}),[e,t])};function ao(e,t,s,a){const n=d.useRouter(),{isMobile:l}=so(),[r,i]=c.useToggle(!1);return{removing:r,remove:async()=>{try{i(!0);const{success:r}=await(()=>{let t;switch(e){case"bot":default:t=Fn;break;case"widget":t=al;break;case"room":t=Bi}return t})()(t);if(!r)throw new Error;{const t=await s("remove");null==a||a({pinned:!1}),(t=>{if(l){let t;switch(e){case"bot":case"room":default:t="/m/chat";break;case"widget":t="/m/workshop"}return void n.replace(t)}let s;const a=t[0];s="widget"===e?t.length?`/robot-workshop/widget/${t[0].id}`:"/robot-workshop":a?`/${"bot"===a.type?"chat":"room"}/${a.id}`:"/explore";n.replace(s)})(t)}}catch(e){throw console.error(e),new Error}finally{i(!1)}}}}function no({type:t,id:n,disabled:l=!1,onSuccess:r}){const{getList:i,partialUpdateDetail:o}=a.useContext(jt),c=s.useTranslations("chat"),{removing:d,remove:u}=ao(t,n,i,o);return e.jsxs(Ui,{disabled:l||d,className:"cursor-pointer flex items-center gap-3 relative",onSelect:e=>e.preventDefault(),onClick:async()=>{try{await u(),r()}catch(e){console.error(e)}},children:[d?e.jsx(di,{size:"sm"}):e.jsx(ln,{className:"size-5"}),c("remove_from_list")]})}function lo(){const t=!xl((e=>e.isMobile)),[s,n]=c.useToggle(!1),{type:l,entityInfo:r,menuDisabled:i,menuFunctions:o,customMenuFunction:d}=a.useContext(jt),{id:u}=r,m=()=>{n(!1)};return e.jsxs(ki,{open:s,children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{variant:"ghost",color:"brand",size:"md",icon:s?on:la,className:"data-[state=open]:bg-surface-hovered",onClick:()=>n(!s),disabled:i||!o.length&&!(null==d?void 0:d.length)})}),e.jsxs(Di,{className:"w-[calc(100vw-32px)] md:w-fit",side:"top",align:"start",sideOffset:t?8:56,collisionPadding:{left:16,right:16},onInteractOutside:()=>n(!1),onCloseAutoFocus:e=>e.preventDefault(),children:[o.map((t=>e.jsxs(a.Fragment,{children:[t.menuFunction===exports.MenuFunctionEnum.REMOVE_FROM_LIST&&e.jsx(no,{type:l,id:u,onSuccess:m}),t.menuFunction===exports.MenuFunctionEnum.SHARE&&e.jsx(eo,{onSuccess:m}),t.menuFunction===exports.MenuFunctionEnum.CLEAR_MEMORY&&e.jsx(Zi,{type:l,id:u,onSuccess:m}),t.menuFunction===exports.MenuFunctionEnum.CLEAR_HISTORY&&e.jsx(Hi,{type:l,id:u,onSuccess:m})]},t.menuFunction))),(null!=d?d:[]).map(((t,s)=>{const n=a.cloneElement(t,{onSuccess:m});return e.jsx(a.Fragment,{children:n},s)}))]})]})}function ro(){const t=u.useToast(),s=a.useRef(null),n=a.useRef(null);return a.useEffect((()=>{let e=10;return n.current=t({position:"top",title:"Warning!",description:`Stop recording after ${e} s`,status:"warning",duration:1e4,isClosable:!0}),s.current=setInterval((()=>{e>=0&&n.current&&(e--,t.update(n.current,{position:"top",title:"Warning!",description:`Stop recording after ${e} s`,status:"warning",duration:1e4,isClosable:!0}))}),1e3),()=>{clearInterval(s.current)}}),[]),e.jsx(e.Fragment,{})}var io;!function(e){e.DELETE_MEMORY="DELETE_MEMORY",e.SHOW_BOT_MODAL="SHOW_BOT_MODAL",e.SHOW_BOT_POPUP="SHOW_BOT_POPUP",e.AWAIT_RECORD_COMPLETE="AWAIT_RECORD_COMPLETE",e.TRANSLATE="TRANSLATE",e.SHOW_WIDGET_MODAL="SHOW_WIDGET_MODAL",e.SHOW_WIDGET_POPUP="SHOW_WIDGET_POPUP",e.DELETE_WIDGET_MEMORY="DELETE_WIDGET_MEMORY"}(io||(io={}));const oo=90;var co,uo;!function(e){e.Idle="Idle",e.Recording="Recording",e.Stopped="Stopped",e.Playing="Playing",e.Completed="Completed",e.CallUping="CallUping"}(co||(co={})),function(e){e.INIT="INIT",e.SET_RECORDER="SET_RECORDER",e.SET_TIME="SET_TIME",e.SET_TIME_UPDATE="SET_TIME_UPDATE"}(uo||(uo={}));const mo={status:co.Idle,timeLeft:oo,duration:0,recordBlob:null,recordBlobDataURI:"",recorder:null,chunks:[],audioUrl:"",callUping:!1,timeUpdate:0,mimeType:""},po=(e,t)=>{const{type:s,payload:a={}}=t;switch(s){case uo.INIT:return Object.assign({},mo);case co.CallUping:return Object.assign(Object.assign({},e),a);case co.Recording:return Object.assign(Object.assign(Object.assign({},e),{chunks:[],status:co.Recording}),a);case co.Stopped:return Object.assign(Object.assign(Object.assign({},e),{status:co.Stopped}),a);case co.Playing:return Object.assign(Object.assign(Object.assign({},e),{status:co.Playing}),a);case co.Completed:return Object.assign(Object.assign(Object.assign({},e),{status:co.Completed}),a);case uo.SET_RECORDER:return Object.assign(Object.assign({},e),a);case uo.SET_TIME:{const t=e.timeLeft-1,s=0===t?co.Stopped:e.status;return Object.assign(Object.assign({},e),{duration:e.duration+1,status:s,timeLeft:t})}case uo.SET_TIME_UPDATE:return Object.assign(Object.assign({},e),a);default:return e}};function fo({onChangePlayingAudio:e,onChangeInputType:t,onRecordEnd:n}){const l=xl((e=>e.isMobile)),r=s.useTranslations("common"),{error:i}=Ql(),[o,c]=a.useReducer(po,mo),[d,u]=a.useState(""),m=a.useRef(),p=a.useRef(!1),f=a.useRef(o.timeLeft);a.useMemo((()=>{f.current=o.timeLeft}),[o.timeLeft]),a.useEffect((()=>{u(function(){const e=["audio/mp4","audio/mpeg","audio/wav","audio/webm","audio/webm;codecs=opus","audio/webm;codecs=pcm","audio/ogg","audio/ogg;codecs=opus","audio/ogg;codecs=vorbis"];let t="";try{for(const s of e)if(MediaRecorder.isTypeSupported(s)){t=s;break}}catch(e){}return t}())}),[]);const h=a.useCallback((async()=>{if(o.recorder&&"recording"===o.recorder.state)return new Promise((e=>{if(o.recorder){o.recorder.stop(),o.recorder.stream.getTracks().forEach((e=>{e.stop()}));const t=t=>{c({type:co.Stopped,payload:{recorder:null}}),e(t)};vs.subscribe(io.AWAIT_RECORD_COMPLETE,t,!0)}}))}),[o.recorder]),g=a.useCallback((async()=>{p.current=!1,o.recorder&&await h(),c({type:co.CallUping,payload:{callUping:!0,status:l?co.Recording:co.Idle}}),setTimeout((()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||window.MediaRecorder?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((e=>{try{c(d?{type:uo.SET_RECORDER,payload:{recorder:new MediaRecorder(e,{mimeType:d}),mimeType:d}}:{type:uo.SET_RECORDER,payload:{recorder:new MediaRecorder(e)}})}catch(e){i({content:"The browser doesn't support mediaRecorder",id:"mediaRecorder"}),c({type:co.CallUping,payload:{callUping:!1}})}}),(e=>{i({content:JSON.stringify(e.message),id:JSON.stringify(e.message)}),c({type:co.CallUping,payload:{callUping:!1}}),h()})):(c({type:co.CallUping,payload:{callUping:!1}}),i({content:r("not_support_record"),id:r("not_support_record")}))}))}),[h,i,o.recorder,d,l]),v=a.useCallback((async()=>h()),[h]);a.useEffect((()=>{o.recorder&&o.recorder.start()}),[o.recorder]),a.useEffect((()=>{l&&g()}),[l]),a.useEffect((()=>{o.recorder&&(o.recorder.ondataavailable=e=>{o.chunks.push(e.data)})}),[o.recorder,o.chunks]),a.useEffect((()=>{o.recorder&&(o.recorder.onstop=async()=>{clearInterval(m.current);const e=new Blob(o.chunks,{type:d}),t={timeLeft:oo,chunks:[],recordBlob:e,audioUrl:URL.createObjectURL(e),mimeType:d};c({type:co.Completed,payload:t}),vs.dispatch(io.AWAIT_RECORD_COMPLETE,t)})}),[o.chunks,o.recorder,d]),a.useEffect((()=>{o.recorder&&(o.recorder.onerror=e=>{i({content:e.toString(),id:e.toString()}),h()})}),[h,i,o.recorder]);const x=a.useCallback((()=>{t("audio"),e(),c({type:co.Recording}),m.current&&clearInterval(m.current),m.current=window.setInterval((()=>{if(f.current){0===f.current-1&&v()}c({type:uo.SET_TIME})}),1e3)}),[t,e,v]);a.useEffect((()=>{o.recorder&&(o.recorder.onstart=()=>{x()})}),[o.recorder,x]);const b=a.useCallback((async()=>(p.current=!0,await v(),new Promise((e=>{setTimeout((()=>{c({type:uo.INIT}),e(!0)}),50)})))),[o.recorder,v]);return a.useEffect((()=>{const e=async e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName){if("Space"===e.code){if(e.preventDefault(),o.status===co.Idle&&g(),o.status===co.Recording){const e=await v();await n(e)}o.status===co.Stopped&&await n(o)}"Enter"===e.code&&(e.preventDefault(),o.status===co.Completed&&await n(o)),"Escape"===e.code&&(e.preventDefault(),o.status===co.Recording&&v(),b())}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[b,o,n]),{supportedType:d,startRecording:g,stopRecording:v,clearRecord:b,state:o,dispatch:c}}function ho({interacting:t=!1,disabled:n=!1,exitAudioInput:l,scrollLayoutToTop:r,onSend:i}){const{setInputMode:o}=a.useContext(At),c=s.useTranslations("chat"),d=a.useRef(null),u=xl((e=>e.isMobile)),[m,p]=a.useState(!1),{clearRecord:f,state:h,startRecording:g,stopRecording:v,dispatch:x}=fo({onChangeInputType:()=>{},onRecordEnd:async e=>{},onChangePlayingAudio:()=>{}}),b=async()=>{try{u&&(null==o||o("TEXT")),await f()}catch(e){console.error(e)}},E=a.useCallback((()=>{if(d.current){const{currentTime:e}=d.current;x({type:uo.SET_TIME_UPDATE,payload:{timeUpdate:e}})}}),[x]),_=()=>{x({type:co.Stopped})},w=()=>{d.current&&(d.current.addEventListener("timeupdate",E),d.current.play(),x({type:co.Playing}))},T=()=>{var e;d.current&&(d.current.removeEventListener("timeupdate",E),null===(e=d.current)||void 0===e||e.pause(),_())},N=()=>{const{recordBlob:e,mimeType:t}=h;e&&(i(e,t),f())},y=async()=>{p(!0);const e=await v(),{recordBlob:t,mimeType:s}=e;t&&(i(t,s),f(),p(!1),null==o||o("TEXT"))},C=()=>{g()};return a.useEffect((()=>{h.status===co.Recording&&(null==r||r())}),[r,h.status]),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"w-full flex space-x-2 items-center justify-between h-18",children:[h.status===co.CallUping&&e.jsx("div",{children:"111"}),h.status===co.Idle&&e.jsxs(e.Fragment,{children:[e.jsx(lo,{}),e.jsx("div",{className:Ge.default("w-full px-4 py-2 bg-surface-default text-center text-brand text-sm leading-6 border border-default rounded-xl hover:bg-surface-container-hovered cursor-pointer",{"cursor-not-allowed":n}),onClick:C,children:c("record_top")}),e.jsx(Kl,{variant:"ghost",size:"md",color:"brand",onClick:()=>{null==l||l()},children:e.jsx(Pi,{className:"w-6 h-6 text-brand"})})]}),h.status===co.Recording&&e.jsxs("div",{className:"w-full flex items-center flex-col md:flex-row gap-x-2 px-4 md:px-0",children:[e.jsx(Kl,{variant:"primary",color:"default",size:"md",icon:Mi,className:"hidden md:inline-flex",onClick:b}),e.jsxs("div",{className:"relative w-full px-4 py-2 flex flex-row justify-between text-white text-sm leading-6 rounded-xl cursor-pointer overflow-hidden bg-surface-accent-blue-subtlest md:bg-surface-accent-red-subtlest",onClick:()=>!u&&v(),children:[e.jsx("span",{className:"z-10 rounded-xl px-2 py-[2px] text-sm leading-[24px] bg-surface-accent-blue-subtle text-brand md:text-critical md:bg-surface-accent-red-subtle",children:cs(h.duration)}),m?e.jsx("span",{className:"text-subtle text-sm z-10 self-center",children:c("sending")}):e.jsxs("span",{className:"text-sm self-center justify-center z-10 text-brand md:text-critical",children:[c("recording"),"..."]}),e.jsx("div",{className:"z-10 rounded-full bg-surface-accent-red-subtle w-7 h-7 md:flex justify-center items-center hidden",onClick:v,children:e.jsx(Oi,{className:"size-4 text-critical"})}),e.jsx(Kl,{className:"md:hidden",variant:"primary",size:"sm",icon:aa,loading:t,onClick:y})]}),e.jsx(Kl,{variant:"primary",color:"default",size:"md",icon:Mi,className:"my-2 mx-4 md:hidden rounded-lg border-none bg-surface-pressed",onClick:b})]}),(h.status===co.Completed||h.status===co.Stopped)&&e.jsxs(e.Fragment,{children:[e.jsx(Kl,{variant:"primary",color:"default",size:"md",icon:Mi,className:"hidden md:inline-flex",onClick:b}),e.jsxs("div",{className:"relative w-full px-4 py-2 flex flex-row justify-between text-white text-sm leading-6 rounded-xl cursor-pointer overflow-hidden bg-surface-accent-blue-subtlest md:bg-surface-accent-gray-subtler",onClick:v,children:[e.jsx("span",{className:"z-10 rounded-xl px-2 py-[2px] text-sm leading-[24px] bg-surface-accent-blue-subtle text-brand md:text-subtle md:bg-surface-accent-gray-subtle",children:cs(h.duration)}),e.jsx(Kl,{variant:"ghost",size:"md",onClick:w,className:"text-brand z-10 bg-surface-accent-gray-subtle w-7 h-7 rounded-full hidden md:flex md:justify-center md:items-center",children:e.jsx(ji,{className:"w-4 h-4"})}),h.timeUpdate>0&&e.jsx("div",{className:"absolute z-0 top-0 left-0 h-full bg-[#E0E0E0] dark:bg-[#595A63] opacity-60 rounded-l-xl",style:{width:100*ms(h.timeUpdate,h.duration)+"%"}})]}),e.jsx(Kl,{variant:"primary",size:"md",icon:aa,loading:t,onClick:N})]}),h.status===co.Playing&&e.jsxs(e.Fragment,{children:[e.jsx(Kl,{variant:"primary",color:"default",size:"md",icon:Mi,className:"hidden md:inline-flex",onClick:b}),e.jsxs("div",{className:"relative w-full px-4 py-2 flex flex-row justify-between text-white text-sm leading-6 rounded-xl cursor-pointer overflow-hidden bg-surface-accent-blue-subtlest md:bg-surface-accent-gray-subtler",children:[e.jsx("span",{className:"z-10 rounded-xl px-2 py-[2px] text-sm leading-[24px] bg-surface-accent-blue-subtle text-brand md:text-subtle md:bg-surface-accent-gray-subtle",children:cs(h.duration)}),e.jsx(Kl,{variant:"ghost",size:"md",onClick:T,className:"text-brand  z-10 bg-surface-accent-gray-subtle w-7 h-7 rounded-full hidden md:flex md:justify-center md:items-center",children:e.jsx(Ci,{className:"w-4 h-4"})}),h.timeUpdate>0&&e.jsx("div",{className:"absolute z-0 top-0 left-0 h-full w-full bg-[#E0E0E0] dark:bg-[#595A63] opacity-60 rounded-l-xl",style:{width:100*ms(h.timeUpdate,h.duration)+"%"}})]}),e.jsx(Kl,{variant:"primary",size:"md",icon:aa,onClick:N,loading:m})]})]}),h.audioUrl&&e.jsx("audio",{ref:d,src:h.audioUrl,onEnded:_}),h.timeLeft<=10&&e.jsx(ro,{})]})}function go({onStart:t,disabled:s=!1}){return e.jsx(Kl,{onClick:t,variant:"ghost",color:"brand",size:"md",disabled:s,icon:Da})}function vo(){const t=s.useTranslations("chat"),{resolvedTheme:a}=i.useTheme(),n="dark"===a;return e.jsxs("div",{className:"absolute top-0 bottom-0 left-0 right-0 z-10 rounded-3xl bg-alpha-80 flex justify-center items-center flex-col gap-2",children:[e.jsx(Ye.default,{alt:"drop files",src:n?"/images/file-drop-dark.png":"/images/file-drop.png",width:245,height:116,className:"w-[245px] h-[116px]"}),e.jsx(Ul,{children:t("panel.drop")})]})}function xo({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z",clipRule:"evenodd"}))}const bo=Fe.forwardRef(xo);function Eo({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z",clipRule:"evenodd"}))}const _o=Fe.forwardRef(Eo);function wo({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z",clipRule:"evenodd"}))}const To=Fe.forwardRef(wo),No=()=>{const[e,t]=a.useState($e.default()),[s,n]=a.useState(!1);return a.useEffect((()=>{const e=$e.default();t(e),n(-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger"))}),[]),{isMobile:e.phone||e.tablet,isIos:e.apple.phone||e.apple.tablet||e.apple.ipod,isWeixin:s}};let yo=null;const Co=a.forwardRef(((t,s)=>{const n=a.useRef(null),l=(()=>{if(yo)return yo;const e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.gain.value=1;let s=null;return window.addEventListener("touchstart",(()=>{const t=e.createBuffer(1,1,22050),s=e.createBufferSource();s.buffer=t,s.connect(e.destination),s.start(0)}),{once:!0}),yo={play(a,n){e.decodeAudioData(a.slice(0),(a=>{"suspended"===e.state&&(s&&s.stop(),e.resume()),0===t.gain.value&&(t.gain.value=1);const l=e.createBufferSource();l.buffer=a,l.connect(e.destination),s=l,l.start(0,n)}))},pause(){e.suspend()}},yo})(),r=a.useRef();a.useLayoutEffect((()=>()=>{l.pause(),n.current&&n.current.pause()}),[]);const i=a.useCallback((async()=>{var e;if(!(null===(e=n.current)||void 0===e?void 0:e.paused))return Promise.reject();if(t.src&&r.current){const e=await r.current;if(e)return l.play(e,n.current.currentTime)}return Promise.resolve()}),[]),o=a.useCallback((async()=>{if(t.src)try{r.current=window.fetch(t.src).then((e=>e.arrayBuffer())).catch((e=>{console.error(e)}))}catch(e){console.error(e)}}),[]);return a.useImperativeHandle(s,(()=>({play:()=>i().then((()=>(console.log("audioCompPlay"),n.current.play()))).catch((()=>{})),pause:()=>(null==yo||yo.pause(),n.current.pause()),load:()=>(o(),n.current.load()),addEventListener:(e,t,s)=>n.current.addEventListener(e,t,s),get currentTime(){return n.current.currentTime},set currentTime(e){n.current.currentTime=e},get duration(){return n.current.duration},get paused(){return n.current.paused}})),[i,o]),e.jsx("audio",Object.assign({},t,{muted:!0,ref:n}))}));Co.displayName="IosAudioPlayer";const So=()=>{const{isIos:e}=No();return e?Co:"audio"};function jo(t){const s=a.useRef(null);return a.useEffect((()=>{let e;return s.current&&(e=Tt.default.loadAnimation({container:s.current,renderer:"svg",loop:!0,autoplay:!0,animationData:require("@/common/assets/audio-playing.json")})),()=>e.destroy()}),[]),e.jsx("div",{ref:s,className:"size-3"})}function Io(t){const n=a.useRef(null),[l,r]=a.useState(0),[i,o]=a.useState(!1),[c,d]=a.useState(0),[u,m]=a.useState(!1),p=t.preview,{status:f}=t.data,h="error"===f,g="pending"===f,v="completed"===f;s.useTranslations("chat");const x=So(),b=()=>{const e=n.current;e&&(d(e.currentTime),e.paused||requestAnimationFrame(b))},E=l,_=cs(E?E<1?1:E:0);return e.jsxs("div",{className:Ge.default("audio-player flex flex-col justify-start items-start w-full"),children:[e.jsxs("div",{className:"w-full flex items-center justify-start space-x-2 text-xs",children:[v&&e.jsx("button",{className:"w-7 h-7 rounded-full bg-surface-primary-default flex justify-center items-center",onClick:()=>{var e;n.current&&(n.current.paused?n.current.play().then((()=>{o(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)})):(null===(e=n.current)||void 0===e||e.pause(),o(!1)))},children:i?e.jsx(jo,{}):e.jsx(ji,{className:"ml-[2px] fill-[#fefefe] w-[16px] h-[16px]"})}),!v&&e.jsxs("div",{className:Ge.default({"flex justify-center items-center p-1.5 rounded-lg mr-3":!0,"bg-[#D72C0D]":h,"bg-[#8C9196]":g}),children:[h&&e.jsx(To,{className:"w-4 h-4 text-white"}),g&&e.jsx("div",{className:"w-4 h-4 flex justify-center items-center",children:e.jsx(di,{size:"sm",className:"text-static w-[14px] h-[14px]"})})]}),e.jsxs("div",{className:"flex-1 relative flex flex-col justify-center items-start h-[8px] w-[50px]",children:[e.jsx("div",{className:"relative w-full h-[2px] bg-[#DADFE5] dark:bg-[#383C52]"}),e.jsxs("div",{className:"absolute w-full flex flex-row justify-start items-center",children:[e.jsx("div",{className:"bg-[var(--text)] h-[2px] w-full items-start",style:{width:100*ms(c,E)+"%"}}),e.jsx("div",{className:"w-[7px] h-[7px] rounded-full bg-[var(--text)]"})]})]}),e.jsx("span",{className:"w-10 text-default bg-surface-container-default text-sm dark:text-brand",children:i?cs(c):_})]}),e.jsx(x,{ref:n,src:p,onLoadedData:()=>{URL.revokeObjectURL(p);const e=null==n?void 0:n.current;r(e.duration)},onEnded:function(){n.current&&(n.current.currentTime=0),o(!1)},onTimeUpdate:b,onError:()=>{m(!0)},autoPlay:!1})]})}const Oo=a.memo((({data:t,onDelete:s,onPreview:n,uploadFiles:l,index:r,isChoosingFile:i})=>{const{status:o,uiData:c,file:d,id:u}=t,{mimeType:m,icon:p,iconUrl:f,bg:h,type:g,name:v,serverType:x,ex:b}=c||{},E="ERROR"===o,_="PENDING"===o,w="SUCCESS"===o,T="APPLICATION"===m||"TEXT"===m,N="IMAGE"===m,y="AUDIO"===m,C="VIDEO"===m,S=a.useMemo((()=>d&&["IMAGE","AUDIO","VIDEO"].includes(m)?URL.createObjectURL(d):""),[_,r]);return e.jsxs("div",{className:Ge.default("h-14 relative rounded-xl group/attach first:ml-3 last:mr-3 mr-2 cursor-default hover:cursor-pointer",E?"border border-critical":!(N||C)&&"border border-default",{relative:N||C,"flex justify-start items-center px-3 py-1.5":T,"w-[180px] flex justify-start items-center p-1.5 rounded-xl":y}),onClick:e=>{var s;e.preventDefault(),null===(s=document.getElementById("mobileInput"))||void 0===s||s.focus(),(e=>{w&&(N||C)&&(n(e),i&&(i.current=!0)),E&&(null==l||l([Object.assign(Object.assign({},t),{status:"PENDING"})],!0))})(r)},children:[(y||!w&&T)&&e.jsxs("div",{className:Ge.default({"absolute top-0 left-0 right-0 bottom-0 flex justify-center items-center":N||C,"size-8 rounded-lg mr-3":!(N||C),"bg-surface-critical-default":E&&!(N||C),"bg-surface-accent-gray-bolder":_&&!(N||C),hidden:y,"flex justify-center items-center":T}),style:h?{background:h}:{},children:[E&&e.jsx(To,{className:"size-5 text-white"}),_&&e.jsx("div",{className:"size-4 flex justify-center items-center",children:e.jsx(di,{size:"sm",className:"text-static size-[14px]"})})]}),w&&T&&e.jsx("div",{className:"size-8 rounded-lg mr-3",children:e.jsx("img",{src:f})}),T&&e.jsxs("div",{className:"w-[116px] flex flex-col justify-center items-start",children:[e.jsx("span",{className:"text-xs text-default line-clamp-1 break-all font-medium",children:d.name}),e.jsx("span",{className:"text-xs text-subtle line-clamp-1 break-all",children:g})]}),N&&e.jsxs("div",{className:Ge.default("size-14 rounded-xl overflow-hidden",E&&"border border-critical"),children:[e.jsx("img",{src:S,className:"w-full h-full object-cover",onLoad:()=>{URL.revokeObjectURL(S)}}),!w&&e.jsxs("div",{className:Ge.default("absolute z-[1] left-0 top-0 bottom-0 right-0 rounded-xl flex justify-center items-center bg-beta-black-40"),children:[_&&e.jsx("div",{className:"w-4 h-4 flex justify-center items-center",children:e.jsx(di,{size:"sm",className:"text-static w-[14px] h-[14px]"})}),E&&e.jsx(To,{className:"w-4 h-4 text-white"})]})]}),C&&e.jsxs("div",{className:Ge.default("relative size-14 rounded-xl overflow-hidden",E&&"border border-critical"),children:[e.jsx("video",{src:S,className:"w-full h-full object-fill overflow-hidden",onLoad:()=>{URL.revokeObjectURL(S)}}),e.jsxs("div",{className:Ge.default("absolute z-[1] left-0 top-0 bottom-0 right-0 flex justify-center items-center bg-beta-black-40"),children:[w&&e.jsx(ji,{className:"w-5 h-5 text-white"}),_&&e.jsx("div",{className:"w-4 h-4 flex justify-center items-center",children:e.jsx(di,{size:"sm",className:"text-static w-[14px] h-[14px]"})}),E&&e.jsx(To,{className:"w-4 h-4 text-white"})]})]}),y&&e.jsx(Io,{data:t,preview:S}),E&&e.jsx("div",{className:"absolute z-[1] -right-[10px] -top-[10px] rounded-full error-icon bg-surface-container-default justify-center items-center flex group-hover/attach:hidden",children:e.jsx(dn,{className:"size-5 text-icon-critical"})}),e.jsx(Kl,{variant:"primary",color:"gray",size:"xs",icon:Mi,onClick:e=>{var t;e.stopPropagation(),e.preventDefault(),null===(t=document.getElementById("mobileInput"))||void 0===t||t.focus(),null==s||s(u)},className:"absolute z-10 -right-[10px] -top-[10px] flex md:hidden md:group-hover/attach:flex"})]})}));Oo.displayName="File";const Ao=a.memo((t=>e.jsx(Oo,{data:t.data,onDelete:t.onDelete,onPreview:t.onPreview,uploadFiles:t.uploadFiles,index:t.index,isChoosingFile:t.isChoosingFile})));Ao.displayName="FileCard";const Mo=ze.default((()=>Promise.resolve().then((function(){return Im}))),{ssr:!1}),Po=a.memo((()=>{const t=a.useRef(null),s=a.useRef(0),n=a.useRef(),{file:l}=a.useContext(At),{uploadedFiles:r=[],uploadFiles:i,deleteFile:o,isChoosingFile:c}=l||{},[d,u]=a.useState({canLeft:!1,canRight:!1}),[m,p]=a.useState({visible:!1,index:0}),f=a.useMemo((()=>r.filter((e=>["image","video"].includes(e.uiData.mimeType.toLocaleLowerCase()))).map((e=>{var t;return{type:e.uiData.serverType,status:"EMBED_OBJ_STATUS_DONE",title:e.uiData.name,url:e.url,id:e.id,iconUrl:null!==(t=e.uiData.iconUrl)&&void 0!==t?t:"",extensionName:e.uiData.ex.toUpperCase()}}))),[r]),h=(e,a)=>{var n;if(e.preventDefault(),null===(n=document.getElementById("mobileInput"))||void 0===n||n.focus(),t.current){const e=t.current.clientWidth,n=s.current+("left"===a?-e:e);t.current.scrollTo({left:n,behavior:"smooth"})}},g=a.useCallback((()=>{if(t.current){s.current=t.current.scrollLeft;const{scrollWidth:e,clientWidth:a}=t.current;u({canLeft:s.current>20,canRight:a+s.current+10<e})}}),[]);a.useEffect((()=>{g()}),[null==i?void 0:i.length]);const v=e=>{p({visible:!0,index:e})};return 0===r.length?null:e.jsxs("div",{className:"attachments relative w-full overflow-x-hidden -ml-3 -mr-3 px-3",children:[e.jsx(Kl,{variant:"outline",size:"lg",icon:bo,className:Ge.default("absolute left-0 top-1/2 -translate-y-1/2 z-10 mt-[5px]",d.canLeft?"flex":"hidden"),onClick:e=>h(e,"left")}),e.jsx("div",{className:"w-full flex overflow-x-scroll no-scrollbar pt-[10px]",ref:t,onScroll:()=>{clearTimeout(n.current),n.current=setTimeout(g,100)},children:(x=r,(x||[]).map(((t,s)=>e.jsx(Ao,{data:t,onDelete:o,onPreview:v,uploadFiles:i,index:s,isChoosingFile:c},t.id))))}),e.jsx(Tr,{variant:"outline",size:"lg",icon:_o,className:Ge.default("absolute right-0 top-1/2 -translate-y-1/2 z-10 mt-[5px]",d.canRight?"flex":"hidden"),onClick:e=>h(e,"right")}),m.visible&&e.jsx(Mo,{open:m.visible,onClose:()=>{c&&(c.current=!1),p({visible:!1,index:0})},imgVideoList:f,activeIndex:m.index})]});var x}));Po.displayName="Attachments";var Lo=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function ko({disabled:t=!1}){const{uploadDisabled:s=!1}=a.useContext(jt),{getClickRootProps:n,getInputProps:l,file:r}=a.useContext(At),{isChoosingFile:i}=r||{},o=(null==n?void 0:n())||{},{onClick:c}=o,d=Lo(o,["onClick"]);return e.jsxs("div",Object.assign({onClick:e=>{e.preventDefault(),t||(i&&!t&&(i.current=!0),c&&c(e))}},d,{children:[e.jsx("input",Object.assign({className:"invisible w-0 h-0"},null==l?void 0:l())),e.jsx(Kl,{disabled:t||s,variant:"ghost",color:"brand",size:"md",icon:Xa})]}))}function Ro({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"}))}const Do=Fe.forwardRef(Ro);function Uo({loading:t=!1,disabled:s=!1,onSend:a,energyCost:n,showEnergyCostIcon:l}){return e.jsxs(Tr,{loading:t,disabled:s,variant:"primary",size:"md",onClick:a,className:"w-fit rounded-lg shrink-0",children:[e.jsx(Do,{className:"w-4.5 h-4.5"}),l&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"h-3 border-l-[0.5px] mx-1.5 border-[#FFFFFF33]"}),e.jsxs("div",{className:"space-x-[2px] items-center flex",children:[e.jsx(Ye.default,{src:ns("image/website/icon/20240826/energy.png"),alt:"energy",width:14,height:14,className:"size-[14px]"}),e.jsx("span",{className:"text-xs font-medium",children:null!=n?n:1})]})]})]})}var Fo=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Bo=a.forwardRef(((t,n)=>{var{value:l,disabled:r,disabledReason:i,sendDisabled:o,onChange:d,onSend:u,placeholder:m,style:p,className:f,rows:h,autoFocus:g}=t,v=Fo(t,["value","disabled","disabledReason","sendDisabled","onChange","onSend","placeholder","style","className","rows","autoFocus"]);const{onPastedFiles:x}=a.useContext(At),b=s.useTranslations("chat"),E=a.useRef(null),_=a.useRef(!1);a.useImperativeHandle(n,(()=>({focus:()=>{var e;null===(e=E.current)||void 0===e||e.focus()},blur:()=>{var e;null===(e=E.current)||void 0===e||e.blur()}})));const w=a.useCallback((e=>{var t;"insertLineBreak"!==(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.inputType)&&(null==d||d(e))}),[d]),T=e=>{var t;null===(t=null==E?void 0:E.current)||void 0===t||t.setSelectionRange(e,e)},N=a.useCallback((e=>{var t;if((null===(t=e.target)||void 0===t?void 0:t.value)&&"Enter"===e.key)if(e.shiftKey){const{value:t,selectionStart:s,selectionEnd:a}=e.target,n=t.slice(0,s),l=t.slice(a);null==d||d({target:{value:`${n}\n${l}`}});const r=s+1;setTimeout((()=>{T(r)}))}else{if(e.preventDefault(),_.current)return;if(o)return;null==u||u(l)}}),[d,u,o,l]);return c.useEffectOnce((()=>{T(l.length)})),e.jsx(Hl,{align:"start",sideOffset:8,alignOffset:8,variant:"info",showArrow:!1,triggerClassName:"cursor-text",description:r&&i?i:"",disabled:!r,children:e.jsx(He.default,Object.assign({ref:E,className:pn("flex w-full resize-none p-2 bg-surface-default text-sm text-default placeholder:text-subtlest focus-visible:outline-none disabled:cursor-not-allowed disabled:placeholder:text-disabled max-h-full overflow-auto",f),rows:h||1,disabled:r,value:l,onChange:w,autoFocus:null==g||g,onKeyDown:N,placeholder:i||m||b("placeholder"),onCompositionStart:()=>{_.current=!0},onCompositionEnd:()=>{_.current=!1},onPaste:e=>{const{clipboardData:t}=e,{items:s}=null!=t?t:{},a=Array.from(null!=s?s:[]).filter((e=>"file"===e.kind)).map((e=>e.getAsFile())).filter(Boolean);null==x||x(a)}},v))})}));Bo.displayName="TextInput";const Go=({minKeyboardHeight:e=300,defaultValue:t=!1,callback:s})=>{const[n,l]=a.useState(t),r=a.useRef(s),i=a.useRef(n);return a.useEffect((()=>{r.current=s}),[s]),a.useEffect((()=>{const t=()=>{const t=window.visualViewport.height,s=window.screen.height,a=s-e>t;i.current!==a&&(l(a),i.current=a,r.current&&r.current(a,s,t))};return"undefined"!=typeof visualViewport&&window.visualViewport.addEventListener("resize",t),()=>{"undefined"!=typeof visualViewport&&window.visualViewport.removeEventListener("resize",t)}}),[]),n};var zo=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Yo=w.cva("relative flex shrink-0 overflow-hidden bg-surface-container-hovered border-default border-[0.3px]",{variants:{size:{xs:"w-5 h-5 rounded",sm:"w-6 h-6 rounded-md",md:"w-8 h-8 rounded-lg",lg:"w-9 h-9 rounded-lg",xl:"w-12 h-12 rounded-xl","2xl":"w-14 h-14 rounded-xl","3xl":"w-16 h-16 rounded-xl","4xl":"w-18 h-18 rounded-2xl","5xl":"w-21 h-21 rounded-2xl","6xl":"w-30 h-30 rounded-4xl"}},defaultVariants:{size:"md"}}),Ho=Fe.forwardRef(((t,s)=>{var{className:a,size:n="md"}=t,l=zo(t,["className","size"]);return e.jsx(er.span,Object.assign({ref:s,className:pn(Yo({size:n}),a)},l))}));Ho.displayName="Avatar";const Vo=Fe.forwardRef(((t,s)=>{var{className:a,onLoad:n,onError:l}=t,r=zo(t,["className","onLoad","onError"]);const[i,o]=Fe.useState("loading");return"error"!==i?e.jsx(er.img,Object.assign({ref:s,className:pn("aspect-square h-full w-full object-cover",a),onLoad:e=>{o("loaded"),n&&n(e)},onError:e=>{o("error"),l&&l(e)}},r)):e.jsx(er.span,Object.assign({ref:s,className:pn("flex h-full w-full items-center justify-center bg-surface-container-pressed",a)},r))}));Vo.displayName="AvatarImage";const $o=Fe.forwardRef(((t,s)=>{var{className:a,rootStyle:n,size:l,src:r,variant:i="bot"}=t,o=zo(t,["className","rootStyle","size","src","variant"]);const c="user"===i?"https://www.myshellstatic.com/cdn-cgi/image/quality=40,format=webp/image/user/avatar/default/20240715/avatar.png":"https://www.myshellstatic.com/cdn-cgi/image/quality=40,format=webp/image/bot/logo/20240106/default.png";return e.jsx(Ho,{size:l,className:a,style:n,children:e.jsx(Vo,Object.assign({ref:s},o,{src:r||c}))})}));function Wo({showMobileDetail:t}){const{entityInfo:s}=a.useContext(jt),{name:n,logoUrl:l}=s;return e.jsxs("div",{className:"flex items-center gap-[6px]",onClick:()=>null==t?void 0:t(),children:[e.jsx($o,{src:l,size:"md",className:"shrink-0"}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx("span",{className:"line-clamp-1 break-all",children:n}),e.jsx(ha,{className:"size-[18px] text-brand"})]})]})}$o.displayName="Avatar";var Ko=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const qo=a.forwardRef(((t,n)=>{var{value:l,disabled:r,disabledReason:i,sendDisabled:o,onChange:d,onSend:u,placeholder:m,style:p,className:f,rows:h,autoFocus:g,showMobileDetail:v,audioInputSlot:x,loading:b,interactingDisabled:E,energyCost:_,showEnergyCostIcon:w}=t,T=Ko(t,["value","disabled","disabledReason","sendDisabled","onChange","onSend","placeholder","style","className","rows","autoFocus","showMobileDetail","audioInputSlot","loading","interactingDisabled","energyCost","showEnergyCostIcon"]);const{uploadDisabled:N}=a.useContext(jt),{file:y,onPastedFiles:C}=a.useContext(At),{uploadedFiles:S,isChoosingFile:j}=y||{},I=s.useTranslations("chat"),O=a.useRef(null),A=a.useRef(null),M=a.useRef(!1),P=(l||"").trim().split("\n")[0].slice(0,100),[L,k]=a.useState("display");c.useClickAway(A,(()=>{(null==j?void 0:j.current)||k("display")}));Go({callback:e=>{e||(null==j?void 0:j.current)||k("display")}});const R=e=>{var t;null===(t=null==O?void 0:O.current)||void 0===t||t.setSelectionRange(e,e)};a.useImperativeHandle(n,(()=>({focus:()=>{var e;null===(e=O.current)||void 0===e||e.focus()},blur:()=>{var e;null===(e=O.current)||void 0===e||e.blur()}})));const D=a.useCallback((e=>{var t;"insertLineBreak"!==(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.inputType)&&(null==d||d(e))}),[d]),U=a.useCallback((e=>{var t;if((null===(t=e.target)||void 0===t?void 0:t.value)&&"Enter"===e.key){const{value:t,selectionStart:s,selectionEnd:a}=e.target,n=t.slice(0,s),l=t.slice(a);null==d||d({target:{value:`${n}\n${l}`}});const r=s+1;setTimeout((()=>{R(r)}))}}),[d]);return"display"===L?e.jsxs("div",{className:"px-4 flex flex-col gap-2",children:[e.jsx(Hl,{side:"top",align:"start",sideOffset:8,alignOffset:8,variant:"info",showArrow:!1,description:r&&i||"",triggerClassName:"w-full",children:r?e.jsxs("div",{className:"p-2 w-full h-10 overflow-hidden border border-default rounded-lg shadow-textarea flex items-center gap-2",children:[e.jsx("p",{className:Ge.default("grow truncate h-6 text-sm leading-6 text-start",P.length?"text-default":"text-subtlest"),children:P||i||m||I("placeholder")}),e.jsx(Kl,{icon:(null==S?void 0:S.length)?Ya:Xa,variant:"ghost",size:"md",className:"shrink-0",disabled:r||N})]}):e.jsxs("div",{className:"p-2 w-full h-10 overflow-hidden border border-default rounded-lg shadow-textarea flex items-center gap-2",onClick:()=>k("input"),children:[e.jsx("p",{className:Ge.default("grow truncate h-6 text-sm leading-6 text-start",P.length?"text-default":"text-subtlest"),children:P||i||m||I("placeholder")}),e.jsx(Kl,{icon:(null==S?void 0:S.length)?Ya:Xa,variant:"ghost",size:"md",className:"shrink-0",disabled:r||N})]})}),e.jsxs("div",{className:"w-full flex justify-between items-center",children:[e.jsx("div",{className:"shrink-0",children:e.jsx(Wo,{showMobileDetail:v})}),x]})]}):e.jsxs("div",{className:"w-full bg-surface-default flex flex-col gap-2",ref:A,children:[e.jsx(br,{className:"w-full bg-[var(--border)]"}),e.jsx("div",{className:"px-4",children:e.jsx(He.default,Object.assign({ref:O,className:"flex w-full resize-none bg-surface-default text-sm leading-6 placeholder:text-subtlest focus-visible:outline-none disabled:cursor-not-allowed disabled:placeholder:text-disabled h-fit max-h-[144px] focus:overflow-auto",rows:h||1,disabled:r,value:l,onCompositionStart:()=>{M.current=!0},onCompositionEnd:()=>{M.current=!1},onPaste:e=>{const{clipboardData:t}=e,{items:s}=null!=t?t:{},a=Array.from(null!=s?s:[]).filter((e=>"file"===e.kind)).map((e=>e.getAsFile())).filter(Boolean);null==C||C(a)},onChange:D,onFocus:e=>{const{value:t}=e.target,s=t.length;setTimeout((()=>{R(s)}))},onKeyDown:U,autoFocus:null==g||g,placeholder:i||m||I("placeholder")},T))}),e.jsx(Po,{}),e.jsxs("div",{className:"w-full flex justify-between items-center pl-2 pr-4",children:[e.jsx("div",{className:"shrink-0",children:e.jsx(ko,{disabled:r})}),e.jsx(Uo,{loading:b,disabled:E||o,onSend:()=>{null==u||u(l),k("display")},energyCost:_,showEnergyCostIcon:w&&!!l})]})]})}));function Qo({maxSize:t}){const{file:n}=a.useContext(At),{isChoosingFile:l}=n||{};s.useTranslations("common");const r=s.useTranslations("chat"),i=Ti((e=>e.fileUpload.alert)),o=Ti((e=>e.setFileAlert)),d=i.data[0].length>0,u=i.data[1].length>0,m=d&&u?2:1,[p,f]=a.useState(1===m&&u?1:0),h=()=>{o({visible:!1,data:[]}),l&&(l.current=!1),2===m&&0===p&&f(1)},g=0===p?i.data[0]:i.data[1];return c.useEffectOnce((()=>{l&&(l.current=!0)})),e.jsx(Mr,{open:!0,onClose:h,hideClose:!0,isNotification:!0,state:"warning",size:"sm",overlayClassName:"z-[100]",contentClassName:"z-[110] p-0",title:r(0===p?"panel.unsupported":"panel.maxsize"),onConfirm:h,showCancel:!1,children:e.jsxs("div",{className:"w-full rounded-4xl px-4",children:[0===p&&e.jsx(Ul,{size:"sm",color:"subtle",children:r("panel.unsupported_tip")}),0===p&&e.jsx("ul",{className:"list-disc list-inside",children:g.map((t=>e.jsx("li",{className:"list-item line-clamp-2 break-all",children:e.jsx(Ul,{size:"sm",className:"-ml-3",children:t.name})},t.name)))}),1===p&&e.jsx("span",{children:r("panel.maxsize_tip",{maxSize:t||50})})]})})}qo.displayName="MobileTextInput";var Xo=a.memo((function({question:t,handlePickQuestion:s,isMobile:n=!1,disableClick:l=!1}){const r=Ur((e=>e.energy)),{entityInfo:i}=a.useContext(jt),{energyPerChat:o}=i,c=(null!=r?r:0)>=(null!=o?o:1);return e.jsxs("div",{className:Ge.default("py-2 px-4 max-h-[76px] h-full border border-[#E4E9F0] dark:border-[#42434A] rounded-xl text-[#414345] dark:text-[#B8BCCF] bg-white hover:bg-[#F6F6F7] dark:bg-[#1C1E26] dark:hover:bg-[#232533] text-sm flex space-x-[6px] items-center shadow-button-basic shrink-0",c&&!l?"cursor-pointer":"cursor-not-allowed opacity-50",n?"w-full":" w-[320px]"),onClick:()=>{c&&!l&&s(t)},children:[e.jsx("div",{className:"grow line-clamp-3",children:t}),e.jsx(Xs,{className:"w-5 h-5 text-[#6D7175] dark-[#868996] shrink-0"})]})}));const Jo={hidden:{opacity:0,y:100},visible:{opacity:1,y:0,transition:{delayChildren:.1,staggerChildren:.1}},exit:{opacity:0,y:100,transition:{duration:.1,ease:"easeInOut"}}},Zo={hidden:{opacity:0},visible:{opacity:1,transition:{delayChildren:.1,staggerChildren:.1}}};function ec({questions:t,handlePick:s,disableClick:n=!1}){const l=a.useRef(null),r=h.useHover(l),i=a.useRef(null),[o,c]=a.useState(!0),[d,u]=a.useState(!1);return a.useEffect((()=>{const e=i.current,t=()=>{if(e){const{scrollLeft:t,clientWidth:s,scrollWidth:a}=e;c(0===t),u(Math.ceil(t+s)===a)}};return e&&e.addEventListener("scroll",t),()=>{e&&e.removeEventListener("scroll",t)}}),[]),e.jsxs(f.motion.div,{ref:l,className:"w-full overflow-hidden relative py-2 px-6 shrink-0",variants:Jo,initial:"hidden",animate:"visible",exit:"exit",children:[!o&&e.jsx("div",{className:"w-20 absolute left-0 top-2 bg-gradient-to-l from-[#FFFFFF73] dark:from-[#17181C00] to-[#FFFFFF] dark:to-[#17181C] z-10",style:{height:"calc(100% - 16px)"}}),r&&!o&&e.jsx("div",{className:"h-full flex items-center absolute left-3 top-0 z-20",children:e.jsx(Kl,{size:"md",variant:"outline",color:"default",icon:ua,onClick:()=>{var e;null===(e=i.current)||void 0===e||e.scrollBy({top:0,left:-320,behavior:"smooth"})}})}),e.jsx(f.motion.ul,{ref:i,className:"flex h-full space-x-3 w-full overflow-y-hidden overflow-x-auto no-scrollbar",variants:Zo,initial:"hidden",animate:"visible",children:t.map((t=>e.jsx(f.motion.li,{children:e.jsx(Xo,{question:t,handlePickQuestion:s,disableClick:n})},t)))},"questions-container"),!d&&e.jsx("div",{className:"w-20 absolute right-0 top-2 bg-gradient-to-r from-[#FFFFFF73] dark:from-[#17181C00] to-[#FFFFFF] dark:to-[#17181C] z-10",style:{height:"calc(100% - 16px)"}}),r&&!d&&e.jsx("div",{className:"h-full flex items-center absolute right-3 top-0 z-20",children:e.jsx(Kl,{size:"md",variant:"outline",color:"default",icon:pa,onClick:()=>{var e;null===(e=i.current)||void 0===e||e.scrollBy({top:0,left:320,behavior:"smooth"})}})})]},"questions-wrapper")}function tc(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function sc(e,t){void 0===e&&(e={}),void 0===t&&(t={}),Object.keys(t).forEach((s=>{void 0===e[s]?e[s]=t[s]:tc(t[s])&&tc(e[s])&&Object.keys(t[s]).length>0&&sc(e[s],t[s])}))}const ac={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function nc(){const e="undefined"!=typeof document?document:{};return sc(e,ac),e}const lc={document:ac,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function rc(){const e="undefined"!=typeof window?window:{};return sc(e,lc),e}function ic(e,t){return void 0===t&&(t=0),setTimeout(e,t)}function oc(){return Date.now()}function cc(e,t){void 0===t&&(t="x");const s=rc();let a,n,l;const r=function(e){const t=rc();let s;return t.getComputedStyle&&(s=t.getComputedStyle(e,null)),!s&&e.currentStyle&&(s=e.currentStyle),s||(s=e.style),s}(e);return s.WebKitCSSMatrix?(n=r.transform||r.webkitTransform,n.split(",").length>6&&(n=n.split(", ").map((e=>e.replace(",","."))).join(", ")),l=new s.WebKitCSSMatrix("none"===n?"":n)):(l=r.MozTransform||r.OTransform||r.MsTransform||r.msTransform||r.transform||r.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),a=l.toString().split(",")),"x"===t&&(n=s.WebKitCSSMatrix?l.m41:16===a.length?parseFloat(a[12]):parseFloat(a[4])),"y"===t&&(n=s.WebKitCSSMatrix?l.m42:16===a.length?parseFloat(a[13]):parseFloat(a[5])),n||0}function dc(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function uc(){const e=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let a=1;a<arguments.length;a+=1){const n=a<0||arguments.length<=a?void 0:arguments[a];if(null!=n&&(s=n,!("undefined"!=typeof window&&void 0!==window.HTMLElement?s instanceof HTMLElement:s&&(1===s.nodeType||11===s.nodeType)))){const s=Object.keys(Object(n)).filter((e=>t.indexOf(e)<0));for(let t=0,a=s.length;t<a;t+=1){const a=s[t],l=Object.getOwnPropertyDescriptor(n,a);void 0!==l&&l.enumerable&&(dc(e[a])&&dc(n[a])?n[a].__swiper__?e[a]=n[a]:uc(e[a],n[a]):!dc(e[a])&&dc(n[a])?(e[a]={},n[a].__swiper__?e[a]=n[a]:uc(e[a],n[a])):e[a]=n[a])}}}var s;return e}function mc(e,t,s){e.style.setProperty(t,s)}function pc(e){let{swiper:t,targetPosition:s,side:a}=e;const n=rc(),l=-t.translate;let r,i=null;const o=t.params.speed;t.wrapperEl.style.scrollSnapType="none",n.cancelAnimationFrame(t.cssModeFrameID);const c=s>l?"next":"prev",d=(e,t)=>"next"===c&&e>=t||"prev"===c&&e<=t,u=()=>{r=(new Date).getTime(),null===i&&(i=r);const e=Math.max(Math.min((r-i)/o,1),0),c=.5-Math.cos(e*Math.PI)/2;let m=l+c*(s-l);if(d(m,s)&&(m=s),t.wrapperEl.scrollTo({[a]:m}),d(m,s))return t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout((()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[a]:m})})),void n.cancelAnimationFrame(t.cssModeFrameID);t.cssModeFrameID=n.requestAnimationFrame(u)};u()}function fc(e,t){void 0===t&&(t="");const s=[...e.children];return e instanceof HTMLSlotElement&&s.push(...e.assignedElements()),t?s.filter((e=>e.matches(t))):s}function hc(e){try{return void console.warn(e)}catch(e){}}function gc(e,t){void 0===t&&(t=[]);const s=document.createElement(e);return s.classList.add(...Array.isArray(t)?t:function(e){return void 0===e&&(e=""),e.trim().split(" ").filter((e=>!!e.trim()))}(t)),s}function vc(e,t){return rc().getComputedStyle(e,null).getPropertyValue(t)}function xc(e){let t,s=e;if(s){for(t=0;null!==(s=s.previousSibling);)1===s.nodeType&&(t+=1);return t}}function bc(e,t,s){const a=rc();return e["width"===t?"offsetWidth":"offsetHeight"]+parseFloat(a.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-right":"margin-top"))+parseFloat(a.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-left":"margin-bottom"))}let Ec,_c,wc;function Tc(){return Ec||(Ec=function(){const e=rc(),t=nc();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}()),Ec}function Nc(e){return void 0===e&&(e={}),_c||(_c=function(e){let{userAgent:t}=void 0===e?{}:e;const s=Tc(),a=rc(),n=a.navigator.platform,l=t||a.navigator.userAgent,r={ios:!1,android:!1},i=a.screen.width,o=a.screen.height,c=l.match(/(Android);?[\s\/]+([\d.]+)?/);let d=l.match(/(iPad).*OS\s([\d_]+)/);const u=l.match(/(iPod)(.*OS\s([\d_]+))?/),m=!d&&l.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p="Win32"===n;let f="MacIntel"===n;return!d&&f&&s.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${i}x${o}`)>=0&&(d=l.match(/(Version)\/([\d.]+)/),d||(d=[0,1,"13_0_0"]),f=!1),c&&!p&&(r.os="android",r.android=!0),(d||m||u)&&(r.os="ios",r.ios=!0),r}(e)),_c}function yc(){return wc||(wc=function(){const e=rc(),t=Nc();let s=!1;function a(){const t=e.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}if(a()){const t=String(e.navigator.userAgent);if(t.includes("Version/")){const[e,a]=t.split("Version/")[1].split(" ")[0].split(".").map((e=>Number(e)));s=e<16||16===e&&a<2}}const n=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),l=a();return{isSafari:s||l,needPerspectiveFix:s,need3dFix:l||n&&t.ios,isWebView:n}}()),wc}var Cc={on(e,t,s){const a=this;if(!a.eventsListeners||a.destroyed)return a;if("function"!=typeof t)return a;const n=s?"unshift":"push";return e.split(" ").forEach((e=>{a.eventsListeners[e]||(a.eventsListeners[e]=[]),a.eventsListeners[e][n](t)})),a},once(e,t,s){const a=this;if(!a.eventsListeners||a.destroyed)return a;if("function"!=typeof t)return a;function n(){a.off(e,n),n.__emitterProxy&&delete n.__emitterProxy;for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];t.apply(a,l)}return n.__emitterProxy=t,a.on(e,n,s)},onAny(e,t){const s=this;if(!s.eventsListeners||s.destroyed)return s;if("function"!=typeof e)return s;const a=t?"unshift":"push";return s.eventsAnyListeners.indexOf(e)<0&&s.eventsAnyListeners[a](e),s},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsAnyListeners)return t;const s=t.eventsAnyListeners.indexOf(e);return s>=0&&t.eventsAnyListeners.splice(s,1),t},off(e,t){const s=this;return!s.eventsListeners||s.destroyed?s:s.eventsListeners?(e.split(" ").forEach((e=>{void 0===t?s.eventsListeners[e]=[]:s.eventsListeners[e]&&s.eventsListeners[e].forEach(((a,n)=>{(a===t||a.__emitterProxy&&a.__emitterProxy===t)&&s.eventsListeners[e].splice(n,1)}))})),s):s},emit(){const e=this;if(!e.eventsListeners||e.destroyed)return e;if(!e.eventsListeners)return e;let t,s,a;for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];"string"==typeof l[0]||Array.isArray(l[0])?(t=l[0],s=l.slice(1,l.length),a=e):(t=l[0].events,s=l[0].data,a=l[0].context||e),s.unshift(a);return(Array.isArray(t)?t:t.split(" ")).forEach((t=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach((e=>{e.apply(a,[t,...s])})),e.eventsListeners&&e.eventsListeners[t]&&e.eventsListeners[t].forEach((e=>{e.apply(a,s)}))})),e}};const Sc=(e,t,s)=>{t&&!e.classList.contains(s)?e.classList.add(s):!t&&e.classList.contains(s)&&e.classList.remove(s)};const jc=(e,t,s)=>{t&&!e.classList.contains(s)?e.classList.add(s):!t&&e.classList.contains(s)&&e.classList.remove(s)};const Ic=(e,t)=>{if(!e||e.destroyed||!e.params)return;const s=t.closest(e.isElement?"swiper-slide":`.${e.params.slideClass}`);if(s){let t=s.querySelector(`.${e.params.lazyPreloaderClass}`);!t&&e.isElement&&(s.shadowRoot?t=s.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`):requestAnimationFrame((()=>{s.shadowRoot&&(t=s.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`),t&&t.remove())}))),t&&t.remove()}},Oc=(e,t)=>{if(!e.slides[t])return;const s=e.slides[t].querySelector('[loading="lazy"]');s&&s.removeAttribute("loading")},Ac=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const s=e.slides.length;if(!s||!t||t<0)return;t=Math.min(t,s);const a="auto"===e.params.slidesPerView?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),n=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const s=n,l=[s-t];return l.push(...Array.from({length:t}).map(((e,t)=>s+a+t))),void e.slides.forEach(((t,s)=>{l.includes(t.column)&&Oc(e,s)}))}const l=n+a-1;if(e.params.rewind||e.params.loop)for(let a=n-t;a<=l+t;a+=1){const t=(a%s+s)%s;(t<n||t>l)&&Oc(e,t)}else for(let a=Math.max(n-t,0);a<=Math.min(l+t,s-1);a+=1)a!==n&&(a>l||a<n)&&Oc(e,a)};var Mc={updateSize:function(){const e=this;let t,s;const a=e.el;t=void 0!==e.params.width&&null!==e.params.width?e.params.width:a.clientWidth,s=void 0!==e.params.height&&null!==e.params.height?e.params.height:a.clientHeight,0===t&&e.isHorizontal()||0===s&&e.isVertical()||(t=t-parseInt(vc(a,"padding-left")||0,10)-parseInt(vc(a,"padding-right")||0,10),s=s-parseInt(vc(a,"padding-top")||0,10)-parseInt(vc(a,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(s)&&(s=0),Object.assign(e,{width:t,height:s,size:e.isHorizontal()?t:s}))},updateSlides:function(){const e=this;function t(t,s){return parseFloat(t.getPropertyValue(e.getDirectionLabel(s))||0)}const s=e.params,{wrapperEl:a,slidesEl:n,size:l,rtlTranslate:r,wrongRTL:i}=e,o=e.virtual&&s.virtual.enabled,c=o?e.virtual.slides.length:e.slides.length,d=fc(n,`.${e.params.slideClass}, swiper-slide`),u=o?e.virtual.slides.length:d.length;let m=[];const p=[],f=[];let h=s.slidesOffsetBefore;"function"==typeof h&&(h=s.slidesOffsetBefore.call(e));let g=s.slidesOffsetAfter;"function"==typeof g&&(g=s.slidesOffsetAfter.call(e));const v=e.snapGrid.length,x=e.slidesGrid.length;let b=s.spaceBetween,E=-h,_=0,w=0;if(void 0===l)return;"string"==typeof b&&b.indexOf("%")>=0?b=parseFloat(b.replace("%",""))/100*l:"string"==typeof b&&(b=parseFloat(b)),e.virtualSize=-b,d.forEach((e=>{r?e.style.marginLeft="":e.style.marginRight="",e.style.marginBottom="",e.style.marginTop=""})),s.centeredSlides&&s.cssMode&&(mc(a,"--swiper-centered-offset-before",""),mc(a,"--swiper-centered-offset-after",""));const T=s.grid&&s.grid.rows>1&&e.grid;let N;T?e.grid.initSlides(d):e.grid&&e.grid.unsetSlides();const y="auto"===s.slidesPerView&&s.breakpoints&&Object.keys(s.breakpoints).filter((e=>void 0!==s.breakpoints[e].slidesPerView)).length>0;for(let a=0;a<u;a+=1){let n;if(N=0,d[a]&&(n=d[a]),T&&e.grid.updateSlide(a,n,d),!d[a]||"none"!==vc(n,"display")){if("auto"===s.slidesPerView){y&&(d[a].style[e.getDirectionLabel("width")]="");const l=getComputedStyle(n),r=n.style.transform,i=n.style.webkitTransform;if(r&&(n.style.transform="none"),i&&(n.style.webkitTransform="none"),s.roundLengths)N=e.isHorizontal()?bc(n,"width"):bc(n,"height");else{const e=t(l,"width"),s=t(l,"padding-left"),a=t(l,"padding-right"),r=t(l,"margin-left"),i=t(l,"margin-right"),o=l.getPropertyValue("box-sizing");if(o&&"border-box"===o)N=e+r+i;else{const{clientWidth:t,offsetWidth:l}=n;N=e+s+a+r+i+(l-t)}}r&&(n.style.transform=r),i&&(n.style.webkitTransform=i),s.roundLengths&&(N=Math.floor(N))}else N=(l-(s.slidesPerView-1)*b)/s.slidesPerView,s.roundLengths&&(N=Math.floor(N)),d[a]&&(d[a].style[e.getDirectionLabel("width")]=`${N}px`);d[a]&&(d[a].swiperSlideSize=N),f.push(N),s.centeredSlides?(E=E+N/2+_/2+b,0===_&&0!==a&&(E=E-l/2-b),0===a&&(E=E-l/2-b),Math.abs(E)<.001&&(E=0),s.roundLengths&&(E=Math.floor(E)),w%s.slidesPerGroup==0&&m.push(E),p.push(E)):(s.roundLengths&&(E=Math.floor(E)),(w-Math.min(e.params.slidesPerGroupSkip,w))%e.params.slidesPerGroup==0&&m.push(E),p.push(E),E=E+N+b),e.virtualSize+=N+b,_=N,w+=1}}if(e.virtualSize=Math.max(e.virtualSize,l)+g,r&&i&&("slide"===s.effect||"coverflow"===s.effect)&&(a.style.width=`${e.virtualSize+b}px`),s.setWrapperSize&&(a.style[e.getDirectionLabel("width")]=`${e.virtualSize+b}px`),T&&e.grid.updateWrapperSize(N,m),!s.centeredSlides){const t=[];for(let a=0;a<m.length;a+=1){let n=m[a];s.roundLengths&&(n=Math.floor(n)),m[a]<=e.virtualSize-l&&t.push(n)}m=t,Math.floor(e.virtualSize-l)-Math.floor(m[m.length-1])>1&&m.push(e.virtualSize-l)}if(o&&s.loop){const t=f[0]+b;if(s.slidesPerGroup>1){const a=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/s.slidesPerGroup),n=t*s.slidesPerGroup;for(let e=0;e<a;e+=1)m.push(m[m.length-1]+n)}for(let a=0;a<e.virtual.slidesBefore+e.virtual.slidesAfter;a+=1)1===s.slidesPerGroup&&m.push(m[m.length-1]+t),p.push(p[p.length-1]+t),e.virtualSize+=t}if(0===m.length&&(m=[0]),0!==b){const t=e.isHorizontal()&&r?"marginLeft":e.getDirectionLabel("marginRight");d.filter(((e,t)=>!(s.cssMode&&!s.loop)||t!==d.length-1)).forEach((e=>{e.style[t]=`${b}px`}))}if(s.centeredSlides&&s.centeredSlidesBounds){let e=0;f.forEach((t=>{e+=t+(b||0)})),e-=b;const t=e-l;m=m.map((e=>e<=0?-h:e>t?t+g:e))}if(s.centerInsufficientSlides){let e=0;f.forEach((t=>{e+=t+(b||0)})),e-=b;const t=(s.slidesOffsetBefore||0)+(s.slidesOffsetAfter||0);if(e+t<l){const s=(l-e-t)/2;m.forEach(((e,t)=>{m[t]=e-s})),p.forEach(((e,t)=>{p[t]=e+s}))}}if(Object.assign(e,{slides:d,snapGrid:m,slidesGrid:p,slidesSizesGrid:f}),s.centeredSlides&&s.cssMode&&!s.centeredSlidesBounds){mc(a,"--swiper-centered-offset-before",-m[0]+"px"),mc(a,"--swiper-centered-offset-after",e.size/2-f[f.length-1]/2+"px");const t=-e.snapGrid[0],s=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map((e=>e+t)),e.slidesGrid=e.slidesGrid.map((e=>e+s))}if(u!==c&&e.emit("slidesLengthChange"),m.length!==v&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),p.length!==x&&e.emit("slidesGridLengthChange"),s.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!(o||s.cssMode||"slide"!==s.effect&&"fade"!==s.effect)){const t=`${s.containerModifierClass}backface-hidden`,a=e.el.classList.contains(t);u<=s.maxBackfaceHiddenSlides?a||e.el.classList.add(t):a&&e.el.classList.remove(t)}},updateAutoHeight:function(e){const t=this,s=[],a=t.virtual&&t.params.virtual.enabled;let n,l=0;"number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const r=e=>a?t.slides[t.getSlideIndexByData(e)]:t.slides[e];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach((e=>{s.push(e)}));else for(n=0;n<Math.ceil(t.params.slidesPerView);n+=1){const e=t.activeIndex+n;if(e>t.slides.length&&!a)break;s.push(r(e))}else s.push(r(t.activeIndex));for(n=0;n<s.length;n+=1)if(void 0!==s[n]){const e=s[n].offsetHeight;l=e>l?e:l}(l||0===l)&&(t.wrapperEl.style.height=`${l}px`)},updateSlidesOffset:function(){const e=this,t=e.slides,s=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let a=0;a<t.length;a+=1)t[a].swiperSlideOffset=(e.isHorizontal()?t[a].offsetLeft:t[a].offsetTop)-s-e.cssOverflowAdjustment()},updateSlidesProgress:function(e){void 0===e&&(e=this&&this.translate||0);const t=this,s=t.params,{slides:a,rtlTranslate:n,snapGrid:l}=t;if(0===a.length)return;void 0===a[0].swiperSlideOffset&&t.updateSlidesOffset();let r=-e;n&&(r=e),t.visibleSlidesIndexes=[],t.visibleSlides=[];let i=s.spaceBetween;"string"==typeof i&&i.indexOf("%")>=0?i=parseFloat(i.replace("%",""))/100*t.size:"string"==typeof i&&(i=parseFloat(i));for(let e=0;e<a.length;e+=1){const o=a[e];let c=o.swiperSlideOffset;s.cssMode&&s.centeredSlides&&(c-=a[0].swiperSlideOffset);const d=(r+(s.centeredSlides?t.minTranslate():0)-c)/(o.swiperSlideSize+i),u=(r-l[0]+(s.centeredSlides?t.minTranslate():0)-c)/(o.swiperSlideSize+i),m=-(r-c),p=m+t.slidesSizesGrid[e],f=m>=0&&m<=t.size-t.slidesSizesGrid[e],h=m>=0&&m<t.size-1||p>1&&p<=t.size||m<=0&&p>=t.size;h&&(t.visibleSlides.push(o),t.visibleSlidesIndexes.push(e)),Sc(o,h,s.slideVisibleClass),Sc(o,f,s.slideFullyVisibleClass),o.progress=n?-d:d,o.originalProgress=n?-u:u}},updateProgress:function(e){const t=this;if(void 0===e){const s=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*s||0}const s=t.params,a=t.maxTranslate()-t.minTranslate();let{progress:n,isBeginning:l,isEnd:r,progressLoop:i}=t;const o=l,c=r;if(0===a)n=0,l=!0,r=!0;else{n=(e-t.minTranslate())/a;const s=Math.abs(e-t.minTranslate())<1,i=Math.abs(e-t.maxTranslate())<1;l=s||n<=0,r=i||n>=1,s&&(n=0),i&&(n=1)}if(s.loop){const s=t.getSlideIndexByData(0),a=t.getSlideIndexByData(t.slides.length-1),n=t.slidesGrid[s],l=t.slidesGrid[a],r=t.slidesGrid[t.slidesGrid.length-1],o=Math.abs(e);i=o>=n?(o-n)/r:(o+r-l)/r,i>1&&(i-=1)}Object.assign(t,{progress:n,progressLoop:i,isBeginning:l,isEnd:r}),(s.watchSlidesProgress||s.centeredSlides&&s.autoHeight)&&t.updateSlidesProgress(e),l&&!o&&t.emit("reachBeginning toEdge"),r&&!c&&t.emit("reachEnd toEdge"),(o&&!l||c&&!r)&&t.emit("fromEdge"),t.emit("progress",n)},updateSlidesClasses:function(){const e=this,{slides:t,params:s,slidesEl:a,activeIndex:n}=e,l=e.virtual&&s.virtual.enabled,r=e.grid&&s.grid&&s.grid.rows>1,i=e=>fc(a,`.${s.slideClass}${e}, swiper-slide${e}`)[0];let o,c,d;if(l)if(s.loop){let t=n-e.virtual.slidesBefore;t<0&&(t=e.virtual.slides.length+t),t>=e.virtual.slides.length&&(t-=e.virtual.slides.length),o=i(`[data-swiper-slide-index="${t}"]`)}else o=i(`[data-swiper-slide-index="${n}"]`);else r?(o=t.filter((e=>e.column===n))[0],d=t.filter((e=>e.column===n+1))[0],c=t.filter((e=>e.column===n-1))[0]):o=t[n];o&&(r||(d=function(e,t){const s=[];for(;e.nextElementSibling;){const a=e.nextElementSibling;t?a.matches(t)&&s.push(a):s.push(a),e=a}return s}(o,`.${s.slideClass}, swiper-slide`)[0],s.loop&&!d&&(d=t[0]),c=function(e,t){const s=[];for(;e.previousElementSibling;){const a=e.previousElementSibling;t?a.matches(t)&&s.push(a):s.push(a),e=a}return s}(o,`.${s.slideClass}, swiper-slide`)[0],s.loop&&0===!c&&(c=t[t.length-1]))),t.forEach((e=>{jc(e,e===o,s.slideActiveClass),jc(e,e===d,s.slideNextClass),jc(e,e===c,s.slidePrevClass)})),e.emitSlidesClasses()},updateActiveIndex:function(e){const t=this,s=t.rtlTranslate?t.translate:-t.translate,{snapGrid:a,params:n,activeIndex:l,realIndex:r,snapIndex:i}=t;let o,c=e;const d=e=>{let s=e-t.virtual.slidesBefore;return s<0&&(s=t.virtual.slides.length+s),s>=t.virtual.slides.length&&(s-=t.virtual.slides.length),s};if(void 0===c&&(c=function(e){const{slidesGrid:t,params:s}=e,a=e.rtlTranslate?e.translate:-e.translate;let n;for(let e=0;e<t.length;e+=1)void 0!==t[e+1]?a>=t[e]&&a<t[e+1]-(t[e+1]-t[e])/2?n=e:a>=t[e]&&a<t[e+1]&&(n=e+1):a>=t[e]&&(n=e);return s.normalizeSlideIndex&&(n<0||void 0===n)&&(n=0),n}(t)),a.indexOf(s)>=0)o=a.indexOf(s);else{const e=Math.min(n.slidesPerGroupSkip,c);o=e+Math.floor((c-e)/n.slidesPerGroup)}if(o>=a.length&&(o=a.length-1),c===l&&!t.params.loop)return void(o!==i&&(t.snapIndex=o,t.emit("snapIndexChange")));if(c===l&&t.params.loop&&t.virtual&&t.params.virtual.enabled)return void(t.realIndex=d(c));const u=t.grid&&n.grid&&n.grid.rows>1;let m;if(t.virtual&&n.virtual.enabled&&n.loop)m=d(c);else if(u){const e=t.slides.filter((e=>e.column===c))[0];let s=parseInt(e.getAttribute("data-swiper-slide-index"),10);Number.isNaN(s)&&(s=Math.max(t.slides.indexOf(e),0)),m=Math.floor(s/n.grid.rows)}else if(t.slides[c]){const e=t.slides[c].getAttribute("data-swiper-slide-index");m=e?parseInt(e,10):c}else m=c;Object.assign(t,{previousSnapIndex:i,snapIndex:o,previousRealIndex:r,realIndex:m,previousIndex:l,activeIndex:c}),t.initialized&&Ac(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(r!==m&&t.emit("realIndexChange"),t.emit("slideChange"))},updateClickedSlide:function(e,t){const s=this,a=s.params;let n=e.closest(`.${a.slideClass}, swiper-slide`);!n&&s.isElement&&t&&t.length>1&&t.includes(e)&&[...t.slice(t.indexOf(e)+1,t.length)].forEach((e=>{!n&&e.matches&&e.matches(`.${a.slideClass}, swiper-slide`)&&(n=e)}));let l,r=!1;if(n)for(let e=0;e<s.slides.length;e+=1)if(s.slides[e]===n){r=!0,l=e;break}if(!n||!r)return s.clickedSlide=void 0,void(s.clickedIndex=void 0);s.clickedSlide=n,s.virtual&&s.params.virtual.enabled?s.clickedIndex=parseInt(n.getAttribute("data-swiper-slide-index"),10):s.clickedIndex=l,a.slideToClickedSlide&&void 0!==s.clickedIndex&&s.clickedIndex!==s.activeIndex&&s.slideToClickedSlide()}};var Pc={getTranslate:function(e){void 0===e&&(e=this.isHorizontal()?"x":"y");const{params:t,rtlTranslate:s,translate:a,wrapperEl:n}=this;if(t.virtualTranslate)return s?-a:a;if(t.cssMode)return a;let l=cc(n,e);return l+=this.cssOverflowAdjustment(),s&&(l=-l),l||0},setTranslate:function(e,t){const s=this,{rtlTranslate:a,params:n,wrapperEl:l,progress:r}=s;let i,o=0,c=0;s.isHorizontal()?o=a?-e:e:c=e,n.roundLengths&&(o=Math.floor(o),c=Math.floor(c)),s.previousTranslate=s.translate,s.translate=s.isHorizontal()?o:c,n.cssMode?l[s.isHorizontal()?"scrollLeft":"scrollTop"]=s.isHorizontal()?-o:-c:n.virtualTranslate||(s.isHorizontal()?o-=s.cssOverflowAdjustment():c-=s.cssOverflowAdjustment(),l.style.transform=`translate3d(${o}px, ${c}px, 0px)`);const d=s.maxTranslate()-s.minTranslate();i=0===d?0:(e-s.minTranslate())/d,i!==r&&s.updateProgress(e),s.emit("setTranslate",s.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e,t,s,a,n){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===s&&(s=!0),void 0===a&&(a=!0);const l=this,{params:r,wrapperEl:i}=l;if(l.animating&&r.preventInteractionOnTransition)return!1;const o=l.minTranslate(),c=l.maxTranslate();let d;if(d=a&&e>o?o:a&&e<c?c:e,l.updateProgress(d),r.cssMode){const e=l.isHorizontal();if(0===t)i[e?"scrollLeft":"scrollTop"]=-d;else{if(!l.support.smoothScroll)return pc({swiper:l,targetPosition:-d,side:e?"left":"top"}),!0;i.scrollTo({[e?"left":"top"]:-d,behavior:"smooth"})}return!0}return 0===t?(l.setTransition(0),l.setTranslate(d),s&&(l.emit("beforeTransitionStart",t,n),l.emit("transitionEnd"))):(l.setTransition(t),l.setTranslate(d),s&&(l.emit("beforeTransitionStart",t,n),l.emit("transitionStart")),l.animating||(l.animating=!0,l.onTranslateToWrapperTransitionEnd||(l.onTranslateToWrapperTransitionEnd=function(e){l&&!l.destroyed&&e.target===this&&(l.wrapperEl.removeEventListener("transitionend",l.onTranslateToWrapperTransitionEnd),l.onTranslateToWrapperTransitionEnd=null,delete l.onTranslateToWrapperTransitionEnd,l.animating=!1,s&&l.emit("transitionEnd"))}),l.wrapperEl.addEventListener("transitionend",l.onTranslateToWrapperTransitionEnd))),!0}};function Lc(e){let{swiper:t,runCallbacks:s,direction:a,step:n}=e;const{activeIndex:l,previousIndex:r}=t;let i=a;if(i||(i=l>r?"next":l<r?"prev":"reset"),t.emit(`transition${n}`),s&&l!==r){if("reset"===i)return void t.emit(`slideResetTransition${n}`);t.emit(`slideChangeTransition${n}`),"next"===i?t.emit(`slideNextTransition${n}`):t.emit(`slidePrevTransition${n}`)}}var kc={setTransition:function(e,t){const s=this;s.params.cssMode||(s.wrapperEl.style.transitionDuration=`${e}ms`,s.wrapperEl.style.transitionDelay=0===e?"0ms":""),s.emit("setTransition",e,t)},transitionStart:function(e,t){void 0===e&&(e=!0);const s=this,{params:a}=s;a.cssMode||(a.autoHeight&&s.updateAutoHeight(),Lc({swiper:s,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function(e,t){void 0===e&&(e=!0);const s=this,{params:a}=s;s.animating=!1,a.cssMode||(s.setTransition(0),Lc({swiper:s,runCallbacks:e,direction:t,step:"End"}))}};var Rc={slideTo:function(e,t,s,a,n){void 0===e&&(e=0),void 0===s&&(s=!0),"string"==typeof e&&(e=parseInt(e,10));const l=this;let r=e;r<0&&(r=0);const{params:i,snapGrid:o,slidesGrid:c,previousIndex:d,activeIndex:u,rtlTranslate:m,wrapperEl:p,enabled:f}=l;if(!f&&!a&&!n||l.destroyed||l.animating&&i.preventInteractionOnTransition)return!1;void 0===t&&(t=l.params.speed);const h=Math.min(l.params.slidesPerGroupSkip,r);let g=h+Math.floor((r-h)/l.params.slidesPerGroup);g>=o.length&&(g=o.length-1);const v=-o[g];if(i.normalizeSlideIndex)for(let e=0;e<c.length;e+=1){const t=-Math.floor(100*v),s=Math.floor(100*c[e]),a=Math.floor(100*c[e+1]);void 0!==c[e+1]?t>=s&&t<a-(a-s)/2?r=e:t>=s&&t<a&&(r=e+1):t>=s&&(r=e)}if(l.initialized&&r!==u){if(!l.allowSlideNext&&(m?v>l.translate&&v>l.minTranslate():v<l.translate&&v<l.minTranslate()))return!1;if(!l.allowSlidePrev&&v>l.translate&&v>l.maxTranslate()&&(u||0)!==r)return!1}let x;if(r!==(d||0)&&s&&l.emit("beforeSlideChangeStart"),l.updateProgress(v),x=r>u?"next":r<u?"prev":"reset",m&&-v===l.translate||!m&&v===l.translate)return l.updateActiveIndex(r),i.autoHeight&&l.updateAutoHeight(),l.updateSlidesClasses(),"slide"!==i.effect&&l.setTranslate(v),"reset"!==x&&(l.transitionStart(s,x),l.transitionEnd(s,x)),!1;if(i.cssMode){const e=l.isHorizontal(),s=m?v:-v;if(0===t){const t=l.virtual&&l.params.virtual.enabled;t&&(l.wrapperEl.style.scrollSnapType="none",l._immediateVirtual=!0),t&&!l._cssModeVirtualInitialSet&&l.params.initialSlide>0?(l._cssModeVirtualInitialSet=!0,requestAnimationFrame((()=>{p[e?"scrollLeft":"scrollTop"]=s}))):p[e?"scrollLeft":"scrollTop"]=s,t&&requestAnimationFrame((()=>{l.wrapperEl.style.scrollSnapType="",l._immediateVirtual=!1}))}else{if(!l.support.smoothScroll)return pc({swiper:l,targetPosition:s,side:e?"left":"top"}),!0;p.scrollTo({[e?"left":"top"]:s,behavior:"smooth"})}return!0}return l.setTransition(t),l.setTranslate(v),l.updateActiveIndex(r),l.updateSlidesClasses(),l.emit("beforeTransitionStart",t,a),l.transitionStart(s,x),0===t?l.transitionEnd(s,x):l.animating||(l.animating=!0,l.onSlideToWrapperTransitionEnd||(l.onSlideToWrapperTransitionEnd=function(e){l&&!l.destroyed&&e.target===this&&(l.wrapperEl.removeEventListener("transitionend",l.onSlideToWrapperTransitionEnd),l.onSlideToWrapperTransitionEnd=null,delete l.onSlideToWrapperTransitionEnd,l.transitionEnd(s,x))}),l.wrapperEl.addEventListener("transitionend",l.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(e,t,s,a){if(void 0===e&&(e=0),void 0===s&&(s=!0),"string"==typeof e){e=parseInt(e,10)}const n=this;if(n.destroyed)return;void 0===t&&(t=n.params.speed);const l=n.grid&&n.params.grid&&n.params.grid.rows>1;let r=e;if(n.params.loop)if(n.virtual&&n.params.virtual.enabled)r+=n.virtual.slidesBefore;else{let e;if(l){const t=r*n.params.grid.rows;e=n.slides.filter((e=>1*e.getAttribute("data-swiper-slide-index")===t))[0].column}else e=n.getSlideIndexByData(r);const t=l?Math.ceil(n.slides.length/n.params.grid.rows):n.slides.length,{centeredSlides:s}=n.params;let i=n.params.slidesPerView;"auto"===i?i=n.slidesPerViewDynamic():(i=Math.ceil(parseFloat(n.params.slidesPerView,10)),s&&i%2==0&&(i+=1));let o=t-e<i;if(s&&(o=o||e<Math.ceil(i/2)),a&&s&&"auto"!==n.params.slidesPerView&&!l&&(o=!1),o){const a=s?e<n.activeIndex?"prev":"next":e-n.activeIndex-1<n.params.slidesPerView?"next":"prev";n.loopFix({direction:a,slideTo:!0,activeSlideIndex:"next"===a?e+1:e-t+1,slideRealIndex:"next"===a?n.realIndex:void 0})}if(l){const e=r*n.params.grid.rows;r=n.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0].column}else r=n.getSlideIndexByData(r)}return requestAnimationFrame((()=>{n.slideTo(r,t,s,a)})),n},slideNext:function(e,t,s){void 0===t&&(t=!0);const a=this,{enabled:n,params:l,animating:r}=a;if(!n||a.destroyed)return a;void 0===e&&(e=a.params.speed);let i=l.slidesPerGroup;"auto"===l.slidesPerView&&1===l.slidesPerGroup&&l.slidesPerGroupAuto&&(i=Math.max(a.slidesPerViewDynamic("current",!0),1));const o=a.activeIndex<l.slidesPerGroupSkip?1:i,c=a.virtual&&l.virtual.enabled;if(l.loop){if(r&&!c&&l.loopPreventsSliding)return!1;if(a.loopFix({direction:"next"}),a._clientLeft=a.wrapperEl.clientLeft,a.activeIndex===a.slides.length-1&&l.cssMode)return requestAnimationFrame((()=>{a.slideTo(a.activeIndex+o,e,t,s)})),!0}return l.rewind&&a.isEnd?a.slideTo(0,e,t,s):a.slideTo(a.activeIndex+o,e,t,s)},slidePrev:function(e,t,s){void 0===t&&(t=!0);const a=this,{params:n,snapGrid:l,slidesGrid:r,rtlTranslate:i,enabled:o,animating:c}=a;if(!o||a.destroyed)return a;void 0===e&&(e=a.params.speed);const d=a.virtual&&n.virtual.enabled;if(n.loop){if(c&&!d&&n.loopPreventsSliding)return!1;a.loopFix({direction:"prev"}),a._clientLeft=a.wrapperEl.clientLeft}function u(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const m=u(i?a.translate:-a.translate),p=l.map((e=>u(e)));let f=l[p.indexOf(m)-1];if(void 0===f&&n.cssMode){let e;l.forEach(((t,s)=>{m>=t&&(e=s)})),void 0!==e&&(f=l[e>0?e-1:e])}let h=0;if(void 0!==f&&(h=r.indexOf(f),h<0&&(h=a.activeIndex-1),"auto"===n.slidesPerView&&1===n.slidesPerGroup&&n.slidesPerGroupAuto&&(h=h-a.slidesPerViewDynamic("previous",!0)+1,h=Math.max(h,0))),n.rewind&&a.isBeginning){const n=a.params.virtual&&a.params.virtual.enabled&&a.virtual?a.virtual.slides.length-1:a.slides.length-1;return a.slideTo(n,e,t,s)}return n.loop&&0===a.activeIndex&&n.cssMode?(requestAnimationFrame((()=>{a.slideTo(h,e,t,s)})),!0):a.slideTo(h,e,t,s)},slideReset:function(e,t,s){void 0===t&&(t=!0);const a=this;if(!a.destroyed)return void 0===e&&(e=a.params.speed),a.slideTo(a.activeIndex,e,t,s)},slideToClosest:function(e,t,s,a){void 0===t&&(t=!0),void 0===a&&(a=.5);const n=this;if(n.destroyed)return;void 0===e&&(e=n.params.speed);let l=n.activeIndex;const r=Math.min(n.params.slidesPerGroupSkip,l),i=r+Math.floor((l-r)/n.params.slidesPerGroup),o=n.rtlTranslate?n.translate:-n.translate;if(o>=n.snapGrid[i]){const e=n.snapGrid[i];o-e>(n.snapGrid[i+1]-e)*a&&(l+=n.params.slidesPerGroup)}else{const e=n.snapGrid[i-1];o-e<=(n.snapGrid[i]-e)*a&&(l-=n.params.slidesPerGroup)}return l=Math.max(l,0),l=Math.min(l,n.slidesGrid.length-1),n.slideTo(l,e,t,s)},slideToClickedSlide:function(){const e=this;if(e.destroyed)return;const{params:t,slidesEl:s}=e,a="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let n,l=e.clickedIndex;const r=e.isElement?"swiper-slide":`.${t.slideClass}`;if(t.loop){if(e.animating)return;n=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?l<e.loopedSlides-a/2||l>e.slides.length-e.loopedSlides+a/2?(e.loopFix(),l=e.getSlideIndex(fc(s,`${r}[data-swiper-slide-index="${n}"]`)[0]),ic((()=>{e.slideTo(l)}))):e.slideTo(l):l>e.slides.length-a?(e.loopFix(),l=e.getSlideIndex(fc(s,`${r}[data-swiper-slide-index="${n}"]`)[0]),ic((()=>{e.slideTo(l)}))):e.slideTo(l)}else e.slideTo(l)}};var Dc={loopCreate:function(e){const t=this,{params:s,slidesEl:a}=t;if(!s.loop||t.virtual&&t.params.virtual.enabled)return;const n=()=>{fc(a,`.${s.slideClass}, swiper-slide`).forEach(((e,t)=>{e.setAttribute("data-swiper-slide-index",t)}))},l=t.grid&&s.grid&&s.grid.rows>1,r=s.slidesPerGroup*(l?s.grid.rows:1),i=t.slides.length%r!=0,o=l&&t.slides.length%s.grid.rows!=0,c=e=>{for(let a=0;a<e;a+=1){const e=t.isElement?gc("swiper-slide",[s.slideBlankClass]):gc("div",[s.slideClass,s.slideBlankClass]);t.slidesEl.append(e)}};if(i){if(s.loopAddBlankSlides){c(r-t.slides.length%r),t.recalcSlides(),t.updateSlides()}else hc("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");n()}else if(o){if(s.loopAddBlankSlides){c(s.grid.rows-t.slides.length%s.grid.rows),t.recalcSlides(),t.updateSlides()}else hc("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");n()}else n();t.loopFix({slideRealIndex:e,direction:s.centeredSlides?void 0:"next"})},loopFix:function(e){let{slideRealIndex:t,slideTo:s=!0,direction:a,setTranslate:n,activeSlideIndex:l,byController:r,byMousewheel:i}=void 0===e?{}:e;const o=this;if(!o.params.loop)return;o.emit("beforeLoopFix");const{slides:c,allowSlidePrev:d,allowSlideNext:u,slidesEl:m,params:p}=o,{centeredSlides:f}=p;if(o.allowSlidePrev=!0,o.allowSlideNext=!0,o.virtual&&p.virtual.enabled)return s&&(p.centeredSlides||0!==o.snapIndex?p.centeredSlides&&o.snapIndex<p.slidesPerView?o.slideTo(o.virtual.slides.length+o.snapIndex,0,!1,!0):o.snapIndex===o.snapGrid.length-1&&o.slideTo(o.virtual.slidesBefore,0,!1,!0):o.slideTo(o.virtual.slides.length,0,!1,!0)),o.allowSlidePrev=d,o.allowSlideNext=u,void o.emit("loopFix");let h=p.slidesPerView;"auto"===h?h=o.slidesPerViewDynamic():(h=Math.ceil(parseFloat(p.slidesPerView,10)),f&&h%2==0&&(h+=1));const g=p.slidesPerGroupAuto?h:p.slidesPerGroup;let v=g;v%g!=0&&(v+=g-v%g),v+=p.loopAdditionalSlides,o.loopedSlides=v;const x=o.grid&&p.grid&&p.grid.rows>1;c.length<h+v?hc("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):x&&"row"===p.grid.fill&&hc("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const b=[],E=[];let _=o.activeIndex;void 0===l?l=o.getSlideIndex(c.filter((e=>e.classList.contains(p.slideActiveClass)))[0]):_=l;const w="next"===a||!a,T="prev"===a||!a;let N=0,y=0;const C=x?Math.ceil(c.length/p.grid.rows):c.length,S=(x?c[l].column:l)+(f&&void 0===n?-h/2+.5:0);if(S<v){N=Math.max(v-S,g);for(let e=0;e<v-S;e+=1){const t=e-Math.floor(e/C)*C;if(x){const e=C-t-1;for(let t=c.length-1;t>=0;t-=1)c[t].column===e&&b.push(t)}else b.push(C-t-1)}}else if(S+h>C-v){y=Math.max(S-(C-2*v),g);for(let e=0;e<y;e+=1){const t=e-Math.floor(e/C)*C;x?c.forEach(((e,s)=>{e.column===t&&E.push(s)})):E.push(t)}}if(o.__preventObserver__=!0,requestAnimationFrame((()=>{o.__preventObserver__=!1})),T&&b.forEach((e=>{c[e].swiperLoopMoveDOM=!0,m.prepend(c[e]),c[e].swiperLoopMoveDOM=!1})),w&&E.forEach((e=>{c[e].swiperLoopMoveDOM=!0,m.append(c[e]),c[e].swiperLoopMoveDOM=!1})),o.recalcSlides(),"auto"===p.slidesPerView?o.updateSlides():x&&(b.length>0&&T||E.length>0&&w)&&o.slides.forEach(((e,t)=>{o.grid.updateSlide(t,e,o.slides)})),p.watchSlidesProgress&&o.updateSlidesOffset(),s)if(b.length>0&&T){if(void 0===t){const e=o.slidesGrid[_],t=o.slidesGrid[_+N]-e;i?o.setTranslate(o.translate-t):(o.slideTo(_+Math.ceil(N),0,!1,!0),n&&(o.touchEventsData.startTranslate=o.touchEventsData.startTranslate-t,o.touchEventsData.currentTranslate=o.touchEventsData.currentTranslate-t))}else if(n){const e=x?b.length/p.grid.rows:b.length;o.slideTo(o.activeIndex+e,0,!1,!0),o.touchEventsData.currentTranslate=o.translate}}else if(E.length>0&&w)if(void 0===t){const e=o.slidesGrid[_],t=o.slidesGrid[_-y]-e;i?o.setTranslate(o.translate-t):(o.slideTo(_-y,0,!1,!0),n&&(o.touchEventsData.startTranslate=o.touchEventsData.startTranslate-t,o.touchEventsData.currentTranslate=o.touchEventsData.currentTranslate-t))}else{const e=x?E.length/p.grid.rows:E.length;o.slideTo(o.activeIndex-e,0,!1,!0)}if(o.allowSlidePrev=d,o.allowSlideNext=u,o.controller&&o.controller.control&&!r){const e={slideRealIndex:t,direction:a,setTranslate:n,activeSlideIndex:l,byController:!0};Array.isArray(o.controller.control)?o.controller.control.forEach((t=>{!t.destroyed&&t.params.loop&&t.loopFix({...e,slideTo:t.params.slidesPerView===p.slidesPerView&&s})})):o.controller.control instanceof o.constructor&&o.controller.control.params.loop&&o.controller.control.loopFix({...e,slideTo:o.controller.control.params.slidesPerView===p.slidesPerView&&s})}o.emit("loopFix")},loopDestroy:function(){const e=this,{params:t,slidesEl:s}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const a=[];e.slides.forEach((e=>{const t=void 0===e.swiperSlideIndex?1*e.getAttribute("data-swiper-slide-index"):e.swiperSlideIndex;a[t]=e})),e.slides.forEach((e=>{e.removeAttribute("data-swiper-slide-index")})),a.forEach((e=>{s.append(e)})),e.recalcSlides(),e.slideTo(e.realIndex,0)}};function Uc(e,t,s){const a=rc(),{params:n}=e,l=n.edgeSwipeDetection,r=n.edgeSwipeThreshold;return!l||!(s<=r||s>=a.innerWidth-r)||"prevent"===l&&(t.preventDefault(),!0)}function Fc(e){const t=this,s=nc();let a=e;a.originalEvent&&(a=a.originalEvent);const n=t.touchEventsData;if("pointerdown"===a.type){if(null!==n.pointerId&&n.pointerId!==a.pointerId)return;n.pointerId=a.pointerId}else"touchstart"===a.type&&1===a.targetTouches.length&&(n.touchId=a.targetTouches[0].identifier);if("touchstart"===a.type)return void Uc(t,a,a.targetTouches[0].pageX);const{params:l,touches:r,enabled:i}=t;if(!i)return;if(!l.simulateTouch&&"mouse"===a.pointerType)return;if(t.animating&&l.preventInteractionOnTransition)return;!t.animating&&l.cssMode&&l.loop&&t.loopFix();let o=a.target;if("wrapper"===l.touchEventsTarget&&!function(e,t){const s=t.contains(e);if(!s&&t instanceof HTMLSlotElement)return[...t.assignedElements()].includes(e);return s}(o,t.wrapperEl))return;if("which"in a&&3===a.which)return;if("button"in a&&a.button>0)return;if(n.isTouched&&n.isMoved)return;const c=!!l.noSwipingClass&&""!==l.noSwipingClass,d=a.composedPath?a.composedPath():a.path;c&&a.target&&a.target.shadowRoot&&d&&(o=d[0]);const u=l.noSwipingSelector?l.noSwipingSelector:`.${l.noSwipingClass}`,m=!(!a.target||!a.target.shadowRoot);if(l.noSwiping&&(m?function(e,t){return void 0===t&&(t=this),function t(s){if(!s||s===nc()||s===rc())return null;s.assignedSlot&&(s=s.assignedSlot);const a=s.closest(e);return a||s.getRootNode?a||t(s.getRootNode().host):null}(t)}(u,o):o.closest(u)))return void(t.allowClick=!0);if(l.swipeHandler&&!o.closest(l.swipeHandler))return;r.currentX=a.pageX,r.currentY=a.pageY;const p=r.currentX,f=r.currentY;if(!Uc(t,a,p))return;Object.assign(n,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),r.startX=p,r.startY=f,n.touchStartTime=oc(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,l.threshold>0&&(n.allowThresholdMove=!1);let h=!0;o.matches(n.focusableElements)&&(h=!1,"SELECT"===o.nodeName&&(n.isTouched=!1)),s.activeElement&&s.activeElement.matches(n.focusableElements)&&s.activeElement!==o&&s.activeElement.blur();const g=h&&t.allowTouchMove&&l.touchStartPreventDefault;!l.touchStartForcePreventDefault&&!g||o.isContentEditable||a.preventDefault(),l.freeMode&&l.freeMode.enabled&&t.freeMode&&t.animating&&!l.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",a)}function Bc(e){const t=nc(),s=this,a=s.touchEventsData,{params:n,touches:l,rtlTranslate:r,enabled:i}=s;if(!i)return;if(!n.simulateTouch&&"mouse"===e.pointerType)return;let o,c=e;if(c.originalEvent&&(c=c.originalEvent),"pointermove"===c.type){if(null!==a.touchId)return;if(c.pointerId!==a.pointerId)return}if("touchmove"===c.type){if(o=[...c.changedTouches].filter((e=>e.identifier===a.touchId))[0],!o||o.identifier!==a.touchId)return}else o=c;if(!a.isTouched)return void(a.startMoving&&a.isScrolling&&s.emit("touchMoveOpposite",c));const d=o.pageX,u=o.pageY;if(c.preventedByNestedSwiper)return l.startX=d,void(l.startY=u);if(!s.allowTouchMove)return c.target.matches(a.focusableElements)||(s.allowClick=!1),void(a.isTouched&&(Object.assign(l,{startX:d,startY:u,currentX:d,currentY:u}),a.touchStartTime=oc()));if(n.touchReleaseOnEdges&&!n.loop)if(s.isVertical()){if(u<l.startY&&s.translate<=s.maxTranslate()||u>l.startY&&s.translate>=s.minTranslate())return a.isTouched=!1,void(a.isMoved=!1)}else if(d<l.startX&&s.translate<=s.maxTranslate()||d>l.startX&&s.translate>=s.minTranslate())return;if(t.activeElement&&c.target===t.activeElement&&c.target.matches(a.focusableElements))return a.isMoved=!0,void(s.allowClick=!1);a.allowTouchCallbacks&&s.emit("touchMove",c),l.previousX=l.currentX,l.previousY=l.currentY,l.currentX=d,l.currentY=u;const m=l.currentX-l.startX,p=l.currentY-l.startY;if(s.params.threshold&&Math.sqrt(m**2+p**2)<s.params.threshold)return;if(void 0===a.isScrolling){let e;s.isHorizontal()&&l.currentY===l.startY||s.isVertical()&&l.currentX===l.startX?a.isScrolling=!1:m*m+p*p>=25&&(e=180*Math.atan2(Math.abs(p),Math.abs(m))/Math.PI,a.isScrolling=s.isHorizontal()?e>n.touchAngle:90-e>n.touchAngle)}if(a.isScrolling&&s.emit("touchMoveOpposite",c),void 0===a.startMoving&&(l.currentX===l.startX&&l.currentY===l.startY||(a.startMoving=!0)),a.isScrolling||"touchmove"===c.type&&a.preventTouchMoveFromPointerMove)return void(a.isTouched=!1);if(!a.startMoving)return;s.allowClick=!1,!n.cssMode&&c.cancelable&&c.preventDefault(),n.touchMoveStopPropagation&&!n.nested&&c.stopPropagation();let f=s.isHorizontal()?m:p,h=s.isHorizontal()?l.currentX-l.previousX:l.currentY-l.previousY;n.oneWayMovement&&(f=Math.abs(f)*(r?1:-1),h=Math.abs(h)*(r?1:-1)),l.diff=f,f*=n.touchRatio,r&&(f=-f,h=-h);const g=s.touchesDirection;s.swipeDirection=f>0?"prev":"next",s.touchesDirection=h>0?"prev":"next";const v=s.params.loop&&!n.cssMode,x="next"===s.touchesDirection&&s.allowSlideNext||"prev"===s.touchesDirection&&s.allowSlidePrev;if(!a.isMoved){if(v&&x&&s.loopFix({direction:s.swipeDirection}),a.startTranslate=s.getTranslate(),s.setTransition(0),s.animating){const e=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});s.wrapperEl.dispatchEvent(e)}a.allowMomentumBounce=!1,!n.grabCursor||!0!==s.allowSlideNext&&!0!==s.allowSlidePrev||s.setGrabCursor(!0),s.emit("sliderFirstMove",c)}if((new Date).getTime(),a.isMoved&&a.allowThresholdMove&&g!==s.touchesDirection&&v&&x&&Math.abs(f)>=1)return Object.assign(l,{startX:d,startY:u,currentX:d,currentY:u,startTranslate:a.currentTranslate}),a.loopSwapReset=!0,void(a.startTranslate=a.currentTranslate);s.emit("sliderMove",c),a.isMoved=!0,a.currentTranslate=f+a.startTranslate;let b=!0,E=n.resistanceRatio;if(n.touchReleaseOnEdges&&(E=0),f>0?(v&&x&&a.allowThresholdMove&&a.currentTranslate>(n.centeredSlides?s.minTranslate()-s.slidesSizesGrid[s.activeIndex+1]-("auto"!==n.slidesPerView&&s.slides.length-n.slidesPerView>=2?s.slidesSizesGrid[s.activeIndex+1]+s.params.spaceBetween:0)-s.params.spaceBetween:s.minTranslate())&&s.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),a.currentTranslate>s.minTranslate()&&(b=!1,n.resistance&&(a.currentTranslate=s.minTranslate()-1+(-s.minTranslate()+a.startTranslate+f)**E))):f<0&&(v&&x&&a.allowThresholdMove&&a.currentTranslate<(n.centeredSlides?s.maxTranslate()+s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween+("auto"!==n.slidesPerView&&s.slides.length-n.slidesPerView>=2?s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween:0):s.maxTranslate())&&s.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:s.slides.length-("auto"===n.slidesPerView?s.slidesPerViewDynamic():Math.ceil(parseFloat(n.slidesPerView,10)))}),a.currentTranslate<s.maxTranslate()&&(b=!1,n.resistance&&(a.currentTranslate=s.maxTranslate()+1-(s.maxTranslate()-a.startTranslate-f)**E))),b&&(c.preventedByNestedSwiper=!0),!s.allowSlideNext&&"next"===s.swipeDirection&&a.currentTranslate<a.startTranslate&&(a.currentTranslate=a.startTranslate),!s.allowSlidePrev&&"prev"===s.swipeDirection&&a.currentTranslate>a.startTranslate&&(a.currentTranslate=a.startTranslate),s.allowSlidePrev||s.allowSlideNext||(a.currentTranslate=a.startTranslate),n.threshold>0){if(!(Math.abs(f)>n.threshold||a.allowThresholdMove))return void(a.currentTranslate=a.startTranslate);if(!a.allowThresholdMove)return a.allowThresholdMove=!0,l.startX=l.currentX,l.startY=l.currentY,a.currentTranslate=a.startTranslate,void(l.diff=s.isHorizontal()?l.currentX-l.startX:l.currentY-l.startY)}n.followFinger&&!n.cssMode&&((n.freeMode&&n.freeMode.enabled&&s.freeMode||n.watchSlidesProgress)&&(s.updateActiveIndex(),s.updateSlidesClasses()),n.freeMode&&n.freeMode.enabled&&s.freeMode&&s.freeMode.onTouchMove(),s.updateProgress(a.currentTranslate),s.setTranslate(a.currentTranslate))}function Gc(e){const t=this,s=t.touchEventsData;let a,n=e;n.originalEvent&&(n=n.originalEvent);if("touchend"===n.type||"touchcancel"===n.type){if(a=[...n.changedTouches].filter((e=>e.identifier===s.touchId))[0],!a||a.identifier!==s.touchId)return}else{if(null!==s.touchId)return;if(n.pointerId!==s.pointerId)return;a=n}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(n.type)){if(!(["pointercancel","contextmenu"].includes(n.type)&&(t.browser.isSafari||t.browser.isWebView)))return}s.pointerId=null,s.touchId=null;const{params:l,touches:r,rtlTranslate:i,slidesGrid:o,enabled:c}=t;if(!c)return;if(!l.simulateTouch&&"mouse"===n.pointerType)return;if(s.allowTouchCallbacks&&t.emit("touchEnd",n),s.allowTouchCallbacks=!1,!s.isTouched)return s.isMoved&&l.grabCursor&&t.setGrabCursor(!1),s.isMoved=!1,void(s.startMoving=!1);l.grabCursor&&s.isMoved&&s.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const d=oc(),u=d-s.touchStartTime;if(t.allowClick){const e=n.path||n.composedPath&&n.composedPath();t.updateClickedSlide(e&&e[0]||n.target,e),t.emit("tap click",n),u<300&&d-s.lastClickTime<300&&t.emit("doubleTap doubleClick",n)}if(s.lastClickTime=oc(),ic((()=>{t.destroyed||(t.allowClick=!0)})),!s.isTouched||!s.isMoved||!t.swipeDirection||0===r.diff&&!s.loopSwapReset||s.currentTranslate===s.startTranslate&&!s.loopSwapReset)return s.isTouched=!1,s.isMoved=!1,void(s.startMoving=!1);let m;if(s.isTouched=!1,s.isMoved=!1,s.startMoving=!1,m=l.followFinger?i?t.translate:-t.translate:-s.currentTranslate,l.cssMode)return;if(l.freeMode&&l.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:m});const p=m>=-t.maxTranslate()&&!t.params.loop;let f=0,h=t.slidesSizesGrid[0];for(let e=0;e<o.length;e+=e<l.slidesPerGroupSkip?1:l.slidesPerGroup){const t=e<l.slidesPerGroupSkip-1?1:l.slidesPerGroup;void 0!==o[e+t]?(p||m>=o[e]&&m<o[e+t])&&(f=e,h=o[e+t]-o[e]):(p||m>=o[e])&&(f=e,h=o[o.length-1]-o[o.length-2])}let g=null,v=null;l.rewind&&(t.isBeginning?v=l.virtual&&l.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(g=0));const x=(m-o[f])/h,b=f<l.slidesPerGroupSkip-1?1:l.slidesPerGroup;if(u>l.longSwipesMs){if(!l.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(x>=l.longSwipesRatio?t.slideTo(l.rewind&&t.isEnd?g:f+b):t.slideTo(f)),"prev"===t.swipeDirection&&(x>1-l.longSwipesRatio?t.slideTo(f+b):null!==v&&x<0&&Math.abs(x)>l.longSwipesRatio?t.slideTo(v):t.slideTo(f))}else{if(!l.shortSwipes)return void t.slideTo(t.activeIndex);t.navigation&&(n.target===t.navigation.nextEl||n.target===t.navigation.prevEl)?n.target===t.navigation.nextEl?t.slideTo(f+b):t.slideTo(f):("next"===t.swipeDirection&&t.slideTo(null!==g?g:f+b),"prev"===t.swipeDirection&&t.slideTo(null!==v?v:f))}}function zc(){const e=this,{params:t,el:s}=e;if(s&&0===s.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:a,allowSlidePrev:n,snapGrid:l}=e,r=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const i=r&&t.loop;!("auto"===t.slidesPerView||t.slidesPerView>1)||!e.isEnd||e.isBeginning||e.params.centeredSlides||i?e.params.loop&&!r?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0):e.slideTo(e.slides.length-1,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout((()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()}),500)),e.allowSlidePrev=n,e.allowSlideNext=a,e.params.watchOverflow&&l!==e.snapGrid&&e.checkOverflow()}function Yc(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function Hc(){const e=this,{wrapperEl:t,rtlTranslate:s,enabled:a}=e;if(!a)return;let n;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const l=e.maxTranslate()-e.minTranslate();n=0===l?0:(e.translate-e.minTranslate())/l,n!==e.progress&&e.updateProgress(s?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function Vc(e){const t=this;Ic(t,e.target),t.params.cssMode||"auto"!==t.params.slidesPerView&&!t.params.autoHeight||t.update()}function $c(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const Wc=(e,t)=>{const s=nc(),{params:a,el:n,wrapperEl:l,device:r}=e,i=!!a.nested,o="on"===t?"addEventListener":"removeEventListener",c=t;n&&"string"!=typeof n&&(s[o]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:i}),n[o]("touchstart",e.onTouchStart,{passive:!1}),n[o]("pointerdown",e.onTouchStart,{passive:!1}),s[o]("touchmove",e.onTouchMove,{passive:!1,capture:i}),s[o]("pointermove",e.onTouchMove,{passive:!1,capture:i}),s[o]("touchend",e.onTouchEnd,{passive:!0}),s[o]("pointerup",e.onTouchEnd,{passive:!0}),s[o]("pointercancel",e.onTouchEnd,{passive:!0}),s[o]("touchcancel",e.onTouchEnd,{passive:!0}),s[o]("pointerout",e.onTouchEnd,{passive:!0}),s[o]("pointerleave",e.onTouchEnd,{passive:!0}),s[o]("contextmenu",e.onTouchEnd,{passive:!0}),(a.preventClicks||a.preventClicksPropagation)&&n[o]("click",e.onClick,!0),a.cssMode&&l[o]("scroll",e.onScroll),a.updateOnWindowResize?e[c](r.ios||r.android?"resize orientationchange observerUpdate":"resize observerUpdate",zc,!0):e[c]("observerUpdate",zc,!0),n[o]("load",e.onLoad,{capture:!0}))};const Kc=(e,t)=>e.grid&&t.grid&&t.grid.rows>1;var qc={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function Qc(e,t){return function(s){void 0===s&&(s={});const a=Object.keys(s)[0],n=s[a];"object"==typeof n&&null!==n?(!0===e[a]&&(e[a]={enabled:!0}),"navigation"===a&&e[a]&&e[a].enabled&&!e[a].prevEl&&!e[a].nextEl&&(e[a].auto=!0),["pagination","scrollbar"].indexOf(a)>=0&&e[a]&&e[a].enabled&&!e[a].el&&(e[a].auto=!0),a in e&&"enabled"in n?("object"!=typeof e[a]||"enabled"in e[a]||(e[a].enabled=!0),e[a]||(e[a]={enabled:!1}),uc(t,s)):uc(t,s)):uc(t,s)}}const Xc={eventsEmitter:Cc,update:Mc,translate:Pc,transition:kc,slide:Rc,loop:Dc,grabCursor:{setGrabCursor:function(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const s="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),s.style.cursor="move",s.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame((()=>{t.__preventObserver__=!1}))},unsetGrabCursor:function(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame((()=>{e.__preventObserver__=!1})))}},events:{attachEvents:function(){const e=this,{params:t}=e;e.onTouchStart=Fc.bind(e),e.onTouchMove=Bc.bind(e),e.onTouchEnd=Gc.bind(e),e.onDocumentTouchStart=$c.bind(e),t.cssMode&&(e.onScroll=Hc.bind(e)),e.onClick=Yc.bind(e),e.onLoad=Vc.bind(e),Wc(e,"on")},detachEvents:function(){Wc(this,"off")}},breakpoints:{setBreakpoint:function(){const e=this,{realIndex:t,initialized:s,params:a,el:n}=e,l=a.breakpoints;if(!l||l&&0===Object.keys(l).length)return;const r=e.getBreakpoint(l,e.params.breakpointsBase,e.el);if(!r||e.currentBreakpoint===r)return;const i=(r in l?l[r]:void 0)||e.originalParams,o=Kc(e,a),c=Kc(e,i),d=e.params.grabCursor,u=i.grabCursor,m=a.enabled;o&&!c?(n.classList.remove(`${a.containerModifierClass}grid`,`${a.containerModifierClass}grid-column`),e.emitContainerClasses()):!o&&c&&(n.classList.add(`${a.containerModifierClass}grid`),(i.grid.fill&&"column"===i.grid.fill||!i.grid.fill&&"column"===a.grid.fill)&&n.classList.add(`${a.containerModifierClass}grid-column`),e.emitContainerClasses()),d&&!u?e.unsetGrabCursor():!d&&u&&e.setGrabCursor(),["navigation","pagination","scrollbar"].forEach((t=>{if(void 0===i[t])return;const s=a[t]&&a[t].enabled,n=i[t]&&i[t].enabled;s&&!n&&e[t].disable(),!s&&n&&e[t].enable()}));const p=i.direction&&i.direction!==a.direction,f=a.loop&&(i.slidesPerView!==a.slidesPerView||p),h=a.loop;p&&s&&e.changeDirection(),uc(e.params,i);const g=e.params.enabled,v=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),m&&!g?e.disable():!m&&g&&e.enable(),e.currentBreakpoint=r,e.emit("_beforeBreakpoint",i),s&&(f?(e.loopDestroy(),e.loopCreate(t),e.updateSlides()):!h&&v?(e.loopCreate(t),e.updateSlides()):h&&!v&&e.loopDestroy()),e.emit("breakpoint",i)},getBreakpoint:function(e,t,s){if(void 0===t&&(t="window"),!e||"container"===t&&!s)return;let a=!1;const n=rc(),l="window"===t?n.innerHeight:s.clientHeight,r=Object.keys(e).map((e=>{if("string"==typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:l*t,point:e}}return{value:e,point:e}}));r.sort(((e,t)=>parseInt(e.value,10)-parseInt(t.value,10)));for(let e=0;e<r.length;e+=1){const{point:l,value:i}=r[e];"window"===t?n.matchMedia(`(min-width: ${i}px)`).matches&&(a=l):i<=s.clientWidth&&(a=l)}return a||"max"}},checkOverflow:{checkOverflow:function(){const e=this,{isLocked:t,params:s}=e,{slidesOffsetBefore:a}=s;if(a){const t=e.slides.length-1,s=e.slidesGrid[t]+e.slidesSizesGrid[t]+2*a;e.isLocked=e.size>s}else e.isLocked=1===e.snapGrid.length;!0===s.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===s.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},classes:{addClasses:function(){const e=this,{classNames:t,params:s,rtl:a,el:n,device:l}=e,r=function(e,t){const s=[];return e.forEach((e=>{"object"==typeof e?Object.keys(e).forEach((a=>{e[a]&&s.push(t+a)})):"string"==typeof e&&s.push(t+e)})),s}(["initialized",s.direction,{"free-mode":e.params.freeMode&&s.freeMode.enabled},{autoheight:s.autoHeight},{rtl:a},{grid:s.grid&&s.grid.rows>1},{"grid-column":s.grid&&s.grid.rows>1&&"column"===s.grid.fill},{android:l.android},{ios:l.ios},{"css-mode":s.cssMode},{centered:s.cssMode&&s.centeredSlides},{"watch-progress":s.watchSlidesProgress}],s.containerModifierClass);t.push(...r),n.classList.add(...t),e.emitContainerClasses()},removeClasses:function(){const{el:e,classNames:t}=this;e&&"string"!=typeof e&&(e.classList.remove(...t),this.emitContainerClasses())}}},Jc={};let Zc=class e{constructor(){let t,s;for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];1===n.length&&n[0].constructor&&"Object"===Object.prototype.toString.call(n[0]).slice(8,-1)?s=n[0]:[t,s]=n,s||(s={}),s=uc({},s),t&&!s.el&&(s.el=t);const r=nc();if(s.el&&"string"==typeof s.el&&r.querySelectorAll(s.el).length>1){const t=[];return r.querySelectorAll(s.el).forEach((a=>{const n=uc({},s,{el:a});t.push(new e(n))})),t}const i=this;i.__swiper__=!0,i.support=Tc(),i.device=Nc({userAgent:s.userAgent}),i.browser=yc(),i.eventsListeners={},i.eventsAnyListeners=[],i.modules=[...i.__modules__],s.modules&&Array.isArray(s.modules)&&i.modules.push(...s.modules);const o={};i.modules.forEach((e=>{e({params:s,swiper:i,extendParams:Qc(s,o),on:i.on.bind(i),once:i.once.bind(i),off:i.off.bind(i),emit:i.emit.bind(i)})}));const c=uc({},qc,o);return i.params=uc({},c,Jc,s),i.originalParams=uc({},i.params),i.passedParams=uc({},s),i.params&&i.params.on&&Object.keys(i.params.on).forEach((e=>{i.on(e,i.params.on[e])})),i.params&&i.params.onAny&&i.onAny(i.params.onAny),Object.assign(i,{enabled:i.params.enabled,el:t,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===i.params.direction,isVertical:()=>"vertical"===i.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:i.params.allowSlideNext,allowSlidePrev:i.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:i.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:i.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),i.emit("_swiper"),i.params.init&&i.init(),i}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:t,params:s}=this,a=xc(fc(t,`.${s.slideClass}, swiper-slide`)[0]);return xc(e)-a}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter((t=>1*t.getAttribute("data-swiper-slide-index")===e))[0])}recalcSlides(){const{slidesEl:e,params:t}=this;this.slides=fc(e,`.${t.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const s=this;e=Math.min(Math.max(e,0),1);const a=s.minTranslate(),n=(s.maxTranslate()-a)*e+a;s.translateTo(n,void 0===t?0:t),s.updateActiveIndex(),s.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter((t=>0===t.indexOf("swiper")||0===t.indexOf(e.params.containerModifierClass)));e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter((e=>0===e.indexOf("swiper-slide")||0===e.indexOf(t.params.slideClass))).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach((s=>{const a=e.getSlideClasses(s);t.push({slideEl:s,classNames:a}),e.emit("_slideClass",s,a)})),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){void 0===e&&(e="current"),void 0===t&&(t=!1);const{params:s,slides:a,slidesGrid:n,slidesSizesGrid:l,size:r,activeIndex:i}=this;let o=1;if("number"==typeof s.slidesPerView)return s.slidesPerView;if(s.centeredSlides){let e,t=a[i]?Math.ceil(a[i].swiperSlideSize):0;for(let s=i+1;s<a.length;s+=1)a[s]&&!e&&(t+=Math.ceil(a[s].swiperSlideSize),o+=1,t>r&&(e=!0));for(let s=i-1;s>=0;s-=1)a[s]&&!e&&(t+=a[s].swiperSlideSize,o+=1,t>r&&(e=!0))}else if("current"===e)for(let e=i+1;e<a.length;e+=1){(t?n[e]+l[e]-n[i]<r:n[e]-n[i]<r)&&(o+=1)}else for(let e=i-1;e>=0;e-=1){n[i]-n[e]<r&&(o+=1)}return o}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:s}=e;function a(){const t=e.rtlTranslate?-1*e.translate:e.translate,s=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(s),e.updateActiveIndex(),e.updateSlidesClasses()}let n;if(s.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach((t=>{t.complete&&Ic(e,t)})),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),s.freeMode&&s.freeMode.enabled&&!s.cssMode)a(),s.autoHeight&&e.updateAutoHeight();else{if(("auto"===s.slidesPerView||s.slidesPerView>1)&&e.isEnd&&!s.centeredSlides){const t=e.virtual&&s.virtual.enabled?e.virtual.slides:e.slides;n=e.slideTo(t.length-1,0,!1,!0)}else n=e.slideTo(e.activeIndex,0,!1,!0);n||a()}s.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){void 0===t&&(t=!0);const s=this,a=s.params.direction;return e||(e="horizontal"===a?"vertical":"horizontal"),e===a||"horizontal"!==e&&"vertical"!==e||(s.el.classList.remove(`${s.params.containerModifierClass}${a}`),s.el.classList.add(`${s.params.containerModifierClass}${e}`),s.emitContainerClasses(),s.params.direction=e,s.slides.forEach((t=>{"vertical"===e?t.style.width="":t.style.height=""})),s.emit("changeDirection"),t&&s.update()),s}changeLanguageDirection(e){const t=this;t.rtl&&"rtl"===e||!t.rtl&&"ltr"===e||(t.rtl="rtl"===e,t.rtlTranslate="horizontal"===t.params.direction&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let s=e||t.params.el;if("string"==typeof s&&(s=document.querySelector(s)),!s)return!1;s.swiper=t,s.parentNode&&s.parentNode.host&&s.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);const a=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`;let n=(()=>{if(s&&s.shadowRoot&&s.shadowRoot.querySelector){return s.shadowRoot.querySelector(a())}return fc(s,a())[0]})();return!n&&t.params.createElements&&(n=gc("div",t.params.wrapperClass),s.append(n),fc(s,`.${t.params.slideClass}`).forEach((e=>{n.append(e)}))),Object.assign(t,{el:s,wrapperEl:n,slidesEl:t.isElement&&!s.parentNode.host.slideSlots?s.parentNode.host:n,hostEl:t.isElement?s.parentNode.host:s,mounted:!0,rtl:"rtl"===s.dir.toLowerCase()||"rtl"===vc(s,"direction"),rtlTranslate:"horizontal"===t.params.direction&&("rtl"===s.dir.toLowerCase()||"rtl"===vc(s,"direction")),wrongRTL:"-webkit-box"===vc(n,"display")}),!0}init(e){const t=this;if(t.initialized)return t;if(!1===t.mount(e))return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(),t.attachEvents();const s=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&s.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),s.forEach((e=>{e.complete?Ic(t,e):e.addEventListener("load",(e=>{Ic(t,e.target)}))})),Ac(t),t.initialized=!0,Ac(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);const s=this,{params:a,el:n,wrapperEl:l,slides:r}=s;return void 0===s.params||s.destroyed||(s.emit("beforeDestroy"),s.initialized=!1,s.detachEvents(),a.loop&&s.loopDestroy(),t&&(s.removeClasses(),n&&"string"!=typeof n&&n.removeAttribute("style"),l&&l.removeAttribute("style"),r&&r.length&&r.forEach((e=>{e.classList.remove(a.slideVisibleClass,a.slideFullyVisibleClass,a.slideActiveClass,a.slideNextClass,a.slidePrevClass),e.removeAttribute("style"),e.removeAttribute("data-swiper-slide-index")}))),s.emit("destroy"),Object.keys(s.eventsListeners).forEach((e=>{s.off(e)})),!1!==e&&(s.el&&"string"!=typeof s.el&&(s.el.swiper=null),function(e){const t=e;Object.keys(t).forEach((e=>{try{t[e]=null}catch(e){}try{delete t[e]}catch(e){}}))}(s)),s.destroyed=!0),null}static extendDefaults(e){uc(Jc,e)}static get extendedDefaults(){return Jc}static get defaults(){return qc}static installModule(t){e.prototype.__modules__||(e.prototype.__modules__=[]);const s=e.prototype.__modules__;"function"==typeof t&&s.indexOf(t)<0&&s.push(t)}static use(t){return Array.isArray(t)?(t.forEach((t=>e.installModule(t))),e):(e.installModule(t),e)}};Object.keys(Xc).forEach((e=>{Object.keys(Xc[e]).forEach((t=>{Zc.prototype[t]=Xc[e][t]}))})),Zc.use([function(e){let{swiper:t,on:s,emit:a}=e;const n=rc();let l=null,r=null;const i=()=>{t&&!t.destroyed&&t.initialized&&(a("beforeResize"),a("resize"))},o=()=>{t&&!t.destroyed&&t.initialized&&a("orientationchange")};s("init",(()=>{t.params.resizeObserver&&void 0!==n.ResizeObserver?t&&!t.destroyed&&t.initialized&&(l=new ResizeObserver((e=>{r=n.requestAnimationFrame((()=>{const{width:s,height:a}=t;let n=s,l=a;e.forEach((e=>{let{contentBoxSize:s,contentRect:a,target:r}=e;r&&r!==t.el||(n=a?a.width:(s[0]||s).inlineSize,l=a?a.height:(s[0]||s).blockSize)})),n===s&&l===a||i()}))})),l.observe(t.el)):(n.addEventListener("resize",i),n.addEventListener("orientationchange",o))})),s("destroy",(()=>{r&&n.cancelAnimationFrame(r),l&&l.unobserve&&t.el&&(l.unobserve(t.el),l=null),n.removeEventListener("resize",i),n.removeEventListener("orientationchange",o)}))},function(e){let{swiper:t,extendParams:s,on:a,emit:n}=e;const l=[],r=rc(),i=function(e,s){void 0===s&&(s={});const a=new(r.MutationObserver||r.WebkitMutationObserver)((e=>{if(t.__preventObserver__)return;if(1===e.length)return void n("observerUpdate",e[0]);const s=function(){n("observerUpdate",e[0])};r.requestAnimationFrame?r.requestAnimationFrame(s):r.setTimeout(s,0)}));a.observe(e,{attributes:void 0===s.attributes||s.attributes,childList:t.isElement||(void 0===s.childList||s).childList,characterData:void 0===s.characterData||s.characterData}),l.push(a)};s({observer:!1,observeParents:!1,observeSlideChildren:!1}),a("init",(()=>{if(t.params.observer){if(t.params.observeParents){const e=function(e){const t=[];let s=e.parentElement;for(;s;)t.push(s),s=s.parentElement;return t}(t.hostEl);for(let t=0;t<e.length;t+=1)i(e[t])}i(t.hostEl,{childList:t.params.observeSlideChildren}),i(t.wrapperEl,{attributes:!1})}})),a("destroy",(()=>{l.forEach((e=>{e.disconnect()})),l.splice(0,l.length)}))}]);const ed=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function td(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)&&!e.__swiper__}function sd(e,t){const s=["__proto__","constructor","prototype"];Object.keys(t).filter((e=>s.indexOf(e)<0)).forEach((s=>{void 0===e[s]?e[s]=t[s]:td(t[s])&&td(e[s])&&Object.keys(t[s]).length>0?t[s].__swiper__?e[s]=t[s]:sd(e[s],t[s]):e[s]=t[s]}))}function ad(e){return void 0===e&&(e={}),e.navigation&&void 0===e.navigation.nextEl&&void 0===e.navigation.prevEl}function nd(e){return void 0===e&&(e={}),e.pagination&&void 0===e.pagination.el}function ld(e){return void 0===e&&(e={}),e.scrollbar&&void 0===e.scrollbar.el}function rd(e){void 0===e&&(e="");const t=e.split(" ").map((e=>e.trim())).filter((e=>!!e)),s=[];return t.forEach((e=>{s.indexOf(e)<0&&s.push(e)})),s.join(" ")}function id(e){return void 0===e&&(e=""),e?e.includes("swiper-wrapper")?e:`swiper-wrapper ${e}`:"swiper-wrapper"}function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},od.apply(this,arguments)}function cd(e){return e.type&&e.type.displayName&&e.type.displayName.includes("SwiperSlide")}function dd(e){const t=[];return Fe.default.Children.toArray(e).forEach((e=>{cd(e)?t.push(e):e.props&&e.props.children&&dd(e.props.children).forEach((e=>t.push(e)))})),t}function ud(e){const t=[],s={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return Fe.default.Children.toArray(e).forEach((e=>{if(cd(e))t.push(e);else if(e.props&&e.props.slot&&s[e.props.slot])s[e.props.slot].push(e);else if(e.props&&e.props.children){const a=dd(e.props.children);a.length>0?a.forEach((e=>t.push(e))):s["container-end"].push(e)}else s["container-end"].push(e)})),{slides:t,slots:s}}function md(e,t){return"undefined"==typeof window?a.useEffect(e,t):a.useLayoutEffect(e,t)}const pd=a.createContext(null),fd=a.createContext(null),hd=a.forwardRef((function(e,t){let{className:s,tag:n="div",wrapperTag:l="div",children:r,onSwiper:i,...o}=void 0===e?{}:e,c=!1;const[d,u]=a.useState("swiper"),[m,p]=a.useState(null),[f,h]=a.useState(!1),g=a.useRef(!1),v=a.useRef(null),x=a.useRef(null),b=a.useRef(null),E=a.useRef(null),_=a.useRef(null),w=a.useRef(null),T=a.useRef(null),N=a.useRef(null),{params:y,passedParams:C,rest:S,events:j}=function(e,t){void 0===e&&(e={}),void 0===t&&(t=!0);const s={on:{}},a={},n={};sd(s,qc),s._emitClasses=!0,s.init=!1;const l={},r=ed.map((e=>e.replace(/_/,""))),i=Object.assign({},e);return Object.keys(i).forEach((i=>{void 0!==e[i]&&(r.indexOf(i)>=0?td(e[i])?(s[i]={},n[i]={},sd(s[i],e[i]),sd(n[i],e[i])):(s[i]=e[i],n[i]=e[i]):0===i.search(/on[A-Z]/)&&"function"==typeof e[i]?t?a[`${i[2].toLowerCase()}${i.substr(3)}`]=e[i]:s.on[`${i[2].toLowerCase()}${i.substr(3)}`]=e[i]:l[i]=e[i])})),["navigation","pagination","scrollbar"].forEach((e=>{!0===s[e]&&(s[e]={}),!1===s[e]&&delete s[e]})),{params:s,passedParams:n,rest:l,events:a}}(o),{slides:I,slots:O}=ud(r),A=()=>{h(!f)};Object.assign(y.on,{_containerClasses(e,t){u(t)}});const M=()=>{Object.assign(y.on,j),c=!0;const e={...y};if(delete e.wrapperClass,x.current=new Zc(e),x.current.virtual&&x.current.params.virtual.enabled){x.current.virtual.slides=I;const e={cache:!1,slides:I,renderExternal:p,renderExternalUpdate:!1};sd(x.current.params.virtual,e),sd(x.current.originalParams.virtual,e)}};v.current||M(),x.current&&x.current.on("_beforeBreakpoint",A);return a.useEffect((()=>()=>{x.current&&x.current.off("_beforeBreakpoint",A)})),a.useEffect((()=>{!g.current&&x.current&&(x.current.emitSlidesClasses(),g.current=!0)})),md((()=>{if(t&&(t.current=v.current),v.current)return x.current.destroyed&&M(),function(e,t){let{el:s,nextEl:a,prevEl:n,paginationEl:l,scrollbarEl:r,swiper:i}=e;ad(t)&&a&&n&&(i.params.navigation.nextEl=a,i.originalParams.navigation.nextEl=a,i.params.navigation.prevEl=n,i.originalParams.navigation.prevEl=n),nd(t)&&l&&(i.params.pagination.el=l,i.originalParams.pagination.el=l),ld(t)&&r&&(i.params.scrollbar.el=r,i.originalParams.scrollbar.el=r),i.init(s)}({el:v.current,nextEl:_.current,prevEl:w.current,paginationEl:T.current,scrollbarEl:N.current,swiper:x.current},y),i&&!x.current.destroyed&&i(x.current),()=>{x.current&&!x.current.destroyed&&x.current.destroy(!0,!1)}}),[]),md((()=>{!c&&j&&x.current&&Object.keys(j).forEach((e=>{x.current.on(e,j[e])}));const e=function(e,t,s,a,n){const l=[];if(!t)return l;const r=e=>{l.indexOf(e)<0&&l.push(e)};if(s&&a){const e=a.map(n),t=s.map(n);e.join("")!==t.join("")&&r("children"),a.length!==s.length&&r("children")}return ed.filter((e=>"_"===e[0])).map((e=>e.replace(/_/,""))).forEach((s=>{if(s in e&&s in t)if(td(e[s])&&td(t[s])){const a=Object.keys(e[s]),n=Object.keys(t[s]);a.length!==n.length?r(s):(a.forEach((a=>{e[s][a]!==t[s][a]&&r(s)})),n.forEach((a=>{e[s][a]!==t[s][a]&&r(s)})))}else e[s]!==t[s]&&r(s)})),l}(C,b.current,I,E.current,(e=>e.key));return b.current=C,E.current=I,e.length&&x.current&&!x.current.destroyed&&function(e){let{swiper:t,slides:s,passedParams:a,changedParams:n,nextEl:l,prevEl:r,scrollbarEl:i,paginationEl:o}=e;const c=n.filter((e=>"children"!==e&&"direction"!==e&&"wrapperClass"!==e)),{params:d,pagination:u,navigation:m,scrollbar:p,virtual:f,thumbs:h}=t;let g,v,x,b,E,_,w,T;n.includes("thumbs")&&a.thumbs&&a.thumbs.swiper&&d.thumbs&&!d.thumbs.swiper&&(g=!0),n.includes("controller")&&a.controller&&a.controller.control&&d.controller&&!d.controller.control&&(v=!0),n.includes("pagination")&&a.pagination&&(a.pagination.el||o)&&(d.pagination||!1===d.pagination)&&u&&!u.el&&(x=!0),n.includes("scrollbar")&&a.scrollbar&&(a.scrollbar.el||i)&&(d.scrollbar||!1===d.scrollbar)&&p&&!p.el&&(b=!0),n.includes("navigation")&&a.navigation&&(a.navigation.prevEl||r)&&(a.navigation.nextEl||l)&&(d.navigation||!1===d.navigation)&&m&&!m.prevEl&&!m.nextEl&&(E=!0);const N=e=>{t[e]&&(t[e].destroy(),"navigation"===e?(t.isElement&&(t[e].prevEl.remove(),t[e].nextEl.remove()),d[e].prevEl=void 0,d[e].nextEl=void 0,t[e].prevEl=void 0,t[e].nextEl=void 0):(t.isElement&&t[e].el.remove(),d[e].el=void 0,t[e].el=void 0))};n.includes("loop")&&t.isElement&&(d.loop&&!a.loop?_=!0:!d.loop&&a.loop?w=!0:T=!0),c.forEach((e=>{if(td(d[e])&&td(a[e]))Object.assign(d[e],a[e]),"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e||!("enabled"in a[e])||a[e].enabled||N(e);else{const t=a[e];!0!==t&&!1!==t||"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e?d[e]=a[e]:!1===t&&N(e)}})),c.includes("controller")&&!v&&t.controller&&t.controller.control&&d.controller&&d.controller.control&&(t.controller.control=d.controller.control),n.includes("children")&&s&&f&&d.virtual.enabled?(f.slides=s,f.update(!0)):n.includes("virtual")&&f&&d.virtual.enabled&&(s&&(f.slides=s),f.update(!0)),n.includes("children")&&s&&d.loop&&(T=!0),g&&h.init()&&h.update(!0);v&&(t.controller.control=d.controller.control),x&&(!t.isElement||o&&"string"!=typeof o||(o=document.createElement("div"),o.classList.add("swiper-pagination"),o.part.add("pagination"),t.el.appendChild(o)),o&&(d.pagination.el=o),u.init(),u.render(),u.update()),b&&(!t.isElement||i&&"string"!=typeof i||(i=document.createElement("div"),i.classList.add("swiper-scrollbar"),i.part.add("scrollbar"),t.el.appendChild(i)),i&&(d.scrollbar.el=i),p.init(),p.updateSize(),p.setTranslate()),E&&(t.isElement&&(l&&"string"!=typeof l||(l=document.createElement("div"),l.classList.add("swiper-button-next"),l.innerHTML=t.hostEl.constructor.nextButtonSvg,l.part.add("button-next"),t.el.appendChild(l)),r&&"string"!=typeof r||(r=document.createElement("div"),r.classList.add("swiper-button-prev"),r.innerHTML=t.hostEl.constructor.prevButtonSvg,r.part.add("button-prev"),t.el.appendChild(r))),l&&(d.navigation.nextEl=l),r&&(d.navigation.prevEl=r),m.init(),m.update()),n.includes("allowSlideNext")&&(t.allowSlideNext=a.allowSlideNext),n.includes("allowSlidePrev")&&(t.allowSlidePrev=a.allowSlidePrev),n.includes("direction")&&t.changeDirection(a.direction,!1),(_||T)&&t.loopDestroy(),(w||T)&&t.loopCreate(),t.update()}({swiper:x.current,slides:I,passedParams:C,changedParams:e,nextEl:_.current,prevEl:w.current,scrollbarEl:N.current,paginationEl:T.current}),()=>{j&&x.current&&Object.keys(j).forEach((e=>{x.current.off(e,j[e])}))}})),md((()=>{var e;!(e=x.current)||e.destroyed||!e.params.virtual||e.params.virtual&&!e.params.virtual.enabled||(e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.parallax&&e.params.parallax&&e.params.parallax.enabled&&e.parallax.setTranslate())}),[m]),Fe.default.createElement(n,od({ref:v,className:rd(`${d}${s?` ${s}`:""}`)},S),Fe.default.createElement(fd.Provider,{value:x.current},O["container-start"],Fe.default.createElement(l,{className:id(y.wrapperClass)},O["wrapper-start"],y.virtual?function(e,t,s){if(!s)return null;const a=e=>{let s=e;return e<0?s=t.length+e:s>=t.length&&(s-=t.length),s},n=e.isHorizontal()?{[e.rtlTranslate?"right":"left"]:`${s.offset}px`}:{top:`${s.offset}px`},{from:l,to:r}=s,i=e.params.loop?-t.length:0,o=e.params.loop?2*t.length:t.length,c=[];for(let e=i;e<o;e+=1)e>=l&&e<=r&&c.push(t[a(e)]);return c.map(((t,s)=>Fe.default.cloneElement(t,{swiper:e,style:n,key:t.props.virtualIndex||t.key||`slide-${s}`})))}(x.current,I,m):I.map(((e,t)=>Fe.default.cloneElement(e,{swiper:x.current,swiperSlideIndex:t}))),O["wrapper-end"]),ad(y)&&Fe.default.createElement(Fe.default.Fragment,null,Fe.default.createElement("div",{ref:w,className:"swiper-button-prev"}),Fe.default.createElement("div",{ref:_,className:"swiper-button-next"})),ld(y)&&Fe.default.createElement("div",{ref:N,className:"swiper-scrollbar"}),nd(y)&&Fe.default.createElement("div",{ref:T,className:"swiper-pagination"}),O["container-end"]))}));hd.displayName="Swiper";const gd=a.forwardRef((function(e,t){let{tag:s="div",children:n,className:l="",swiper:r,zoom:i,lazy:o,virtualIndex:c,swiperSlideIndex:d,...u}=void 0===e?{}:e;const m=a.useRef(null),[p,f]=a.useState("swiper-slide"),[h,g]=a.useState(!1);function v(e,t,s){t===m.current&&f(s)}md((()=>{if(void 0!==d&&(m.current.swiperSlideIndex=d),t&&(t.current=m.current),m.current&&r){if(!r.destroyed)return r.on("_slideClass",v),()=>{r&&r.off("_slideClass",v)};"swiper-slide"!==p&&f("swiper-slide")}})),md((()=>{r&&m.current&&!r.destroyed&&f(r.getSlideClasses(m.current))}),[r]);const x={isActive:p.indexOf("swiper-slide-active")>=0,isVisible:p.indexOf("swiper-slide-visible")>=0,isPrev:p.indexOf("swiper-slide-prev")>=0,isNext:p.indexOf("swiper-slide-next")>=0},b=()=>"function"==typeof n?n(x):n;return Fe.default.createElement(s,od({ref:m,className:rd(`${p}${l?` ${l}`:""}`),"data-swiper-slide-index":c,onLoad:()=>{g(!0)}},u),i&&Fe.default.createElement(pd.Provider,{value:x},Fe.default.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":"number"==typeof i?i:void 0},b(),o&&!h&&Fe.default.createElement("div",{className:"swiper-lazy-preloader"}))),!i&&Fe.default.createElement(pd.Provider,{value:x},b(),o&&!h&&Fe.default.createElement("div",{className:"swiper-lazy-preloader"})))}));gd.displayName="SwiperSlide";const vd={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{delayChildren:.1,staggerChildren:.1}},exit:{opacity:0,y:50,transition:{duration:.2,ease:"easeInOut"}}};function xd({questions:t,handlePick:s,disableClick:a=!1}){return e.jsx(f.motion.div,{className:"w-full shrink-0 overflow-hidden relative pt-1",variants:vd,initial:"hidden",animate:"visible",exit:"exit",children:e.jsx(hd,{spaceBetween:8,freeMode:!0,touchRatio:1,slidesPerView:"auto",centeredSlides:!0,className:"flex h-full w-full",children:t.map((t=>e.jsx(gd,{style:{width:"calc(100% - 32px)",flexShrink:0},children:e.jsx(f.motion.div,{className:"h-full",children:e.jsx(Xo,{question:t,handlePickQuestion:s,isMobile:!0,disableClick:a})})},t)))})})}function bd({editorContainerRef:t,editorAnchorRef:s,textareaRef:n,scrollLayoutToTop:l,showMobileDetail:r}){const i=hi(),o=Ur((e=>e.isVisitor)),c=Ur((e=>e.user)),{type:d,interactionDisabled:u,audioDisabled:m=!1,textDisabled:p=!1,disabledReason:f,entityInfo:h,showInteractionCostEnergy:g,atBottom:v,imgGenerator:x,terminatable:b=!0}=a.useContext(jt),{sendTextMessage:E,sendAudioMessage:_,sending:w,interacting:T,showTerminate:N,draftMessage:y,setDraftMessage:C,terminate:S,dragMaskVisible:j,inputMode:I,setInputMode:O,file:A,questions:M,terminating:P}=a.useContext(At),L=(e=>{const[t,s]=a.useState(0);return a.useEffect((()=>{const t=new ResizeObserver((e=>{for(const t of e)s(t.contentRect.width)}));return e.current&&t.observe(e.current),()=>{e.current&&t.unobserve(e.current)}}),[e]),t})(s),{uploadedFiles:k}=A||{},{id:R,name:D,energyPerChat:U,energyPerLevelByPass:F,maxTokens:B}=h,G=xl((e=>e.isMobile)),z=()=>{null==O||O("AUDIO"),null==l||l()},[Y,H]=a.useState(null!=y?y:""),[V,$]=a.useState(0),W=a.useMemo((()=>{var e;return(null==F?void 0:F.length)?V>(B||1500)?F[(null!==(e=F.length)&&void 0!==e?e:0)-1]:F[Math.ceil((V||1)/1500)-1]||1:U}),[U,F,B,V]),K=a.useCallback((()=>{null==l||l(),"bot"===d&&(null==i||i.track("UserSendMessage",{message_type:"text",bot_id:R,bot_name:D,keyboard_behavior:I,chat_platform:"web2",bot_battery_cost:W,token_count:V,user_membership_type:o?"0":(null==c?void 0:c.isGenesisPasscard)||(null==c?void 0:c.isPasscard)?"3":`${null==c?void 0:c.level}`})),E(Y,k,x?xe.CONVERSATION_SCENARIO_BOT_GENERATION:void 0),H("")}),[W,R,x,I,o,D,l,E,i,Y,V,d,k,null==c?void 0:c.isGenesisPasscard,null==c?void 0:c.isPasscard,null==c?void 0:c.level]),q=a.useCallback(((e,t)=>{_(e,t),"bot"===d&&(null==i||i.track("UserSendMessage",{message_type:"voice",bot_id:R,bot_name:D,keyboard_behavior:"DirectInput",chat_platform:"web2",bot_battery_cost:U,user_membership_type:o?"0":(null==c?void 0:c.isGenesisPasscard)||(null==c?void 0:c.isPasscard)?"3":`${null==c?void 0:c.level}`}))}),[U,R,o,D,_,i,d,null==c?void 0:c.isGenesisPasscard,null==c?void 0:c.isPasscard,null==c?void 0:c.level]);a.useEffect((()=>{C(Y),(async e=>{fi(e).then((e=>$(e)))})(Y)}),[Y]);const Q=Ti((e=>e.fileUpload.alert)),X=a.useCallback((e=>{null==l||l(),E(e)}),[l,E]);return e.jsxs(e.Fragment,{children:[v&&!!(null==M?void 0:M.length)&&(G?e.jsx(xd,{questions:M,handlePick:X,disableClick:u||w||T}):e.jsx(ec,{questions:M,handlePick:X,disableClick:u||w||T})),e.jsx(br,{className:"w-full bg-[var(--border)] hidden md:block relative"}),e.jsx("div",{ref:s,className:"shrink-0 h-fit w-full",children:e.jsxs("div",{ref:t,className:"px-0 md:px-6 py-3 md:py-4 flex flex-col gap-2 md:gap-1 h-fit shrink-0 top-2 right-[9px] z-10 bg-surface-default md:rounded-b-3xl",style:{width:L||"100%"},children:[j&&e.jsx(vo,{}),Q.visible&&e.jsx(Qo,{maxSize:50}),e.jsxs("div",{className:"relative flex flex-col gap-1",children:[b&&N&&e.jsx("div",{className:"flex justify-center absolute -top-[60px] md:-top-[78px] left-1/2 -translate-x-1/2 z-20",children:e.jsx(Ni,{onTerminate:()=>null==S?void 0:S(),loading:P})}),"TEXT"===I&&(G?e.jsx(qo,{onSend:K,value:Y,ref:n,onChange:e=>H(e.target.value),sendDisabled:u||w||T,disabled:u||p,disabledReason:f,showMobileDetail:r,audioInputSlot:e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(lo,{}),e.jsx(go,{onStart:z,disabled:u||m})]}),loading:w||T,interactingDisabled:u||w||T,energyCost:W,showEnergyCostIcon:g}):e.jsxs(e.Fragment,{children:[e.jsx(Bo,{className:"w-full min-h-9 max-h-[156px]",onSend:K,sendDisabled:u||w||T,autoFocus:!0,value:Y,ref:n,onChange:e=>H(e.target.value),disabled:u||p,disabledReason:f,onFocus:()=>{null==l||l()}}),e.jsx(Po,{}),e.jsx("div",{className:"w-full flex items-center justify-between",children:e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx(lo,{}),e.jsx(ko,{disabled:u})]}),Y||k?e.jsx(Uo,{loading:w||T,disabled:u||w||T,onSend:K,energyCost:W,showEnergyCostIcon:g}):e.jsx(go,{onStart:z,disabled:u||m})]})})]})),"AUDIO"===I&&e.jsx(ho,{exitAudioInput:()=>{null==O||O("TEXT")},onSend:q,interacting:w,disabled:u||m,scrollLayoutToTop:l})]})]})})]})}function Ed(){const t=s.useTranslations("chat"),{share:n,setEditorMode:l}=a.useContext(At),{allChecked:r,checkAllHandler:i}=n||{};return e.jsxs("div",{className:"w-full h-14 px-4 md:px-0 flex justify-between items-center md:justify-end shrink-0 absolute top-0 right-0 md:right-6 z-20 bg-surface-default md:bg-transparent",children:[e.jsx("span",{className:"md:hidden",children:e.jsx(Kl,{size:"md",variant:"ghost",icon:on,onClick:()=>null==l?void 0:l("NORMAL")})}),e.jsx(Tr,{variant:"outline",color:"brand",size:"md",className:"bg-surface-default",onClick:()=>{null==i||i()},children:t("select_all")})]})}const _d=a.forwardRef(((t,s)=>e.jsx(fr,Object.assign({},t,{children:e.jsxs("svg",{ref:s,className:t.className,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("g",{clipPath:"url(#clip0_15911_38152)",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.375 5C4.375 3.61929 5.49429 2.5 6.875 2.5H13.125C14.5057 2.5 15.625 3.61929 15.625 5V5.33464C16.3717 5.7666 16.875 6.57395 16.875 7.5V7.83464C17.6217 8.2666 18.125 9.07395 18.125 10V14.9039V15C18.125 16.3807 17.0057 17.5 15.625 17.5H4.375C2.99429 17.5 1.875 16.3807 1.875 15V14.904C1.875 14.9039 1.875 14.9038 1.875 14.9037V10C1.875 9.07395 2.37825 8.2666 3.125 7.83464V7.5C3.125 6.57395 3.62825 5.7666 4.375 5.33464V5ZM5.625 5H14.375C14.375 4.30964 13.8154 3.75 13.125 3.75H6.875C6.18464 3.75 5.625 4.30964 5.625 5ZM4.375 7.5H15.625C15.625 6.95672 15.2781 6.49286 14.7917 6.32097C14.6622 6.27519 14.5222 6.25 14.375 6.25H5.625C5.47778 6.25 5.3378 6.27519 5.20828 6.32097C4.72194 6.49286 4.375 6.95672 4.375 7.5ZM3.13432 15.1534C3.20996 15.7714 3.73659 16.25 4.375 16.25H15.625C16.2634 16.25 16.79 15.7714 16.8657 15.1534L14.8204 13.1081C14.3885 12.6763 13.6884 12.6763 13.2566 13.1081L12.6147 13.75L12.8475 13.9829C13.0916 14.227 13.0916 14.6227 12.8475 14.8668C12.6034 15.1109 12.2077 15.1109 11.9636 14.8668L11.2888 14.192L8.47421 11.3773C8.04237 10.9455 7.34224 10.9455 6.91041 11.3773L3.13432 15.1534ZM11.7308 12.8661L9.35809 10.4935C8.4381 9.57347 6.94651 9.57347 6.02653 10.4935L3.125 13.395V10C3.125 9.45672 3.47194 8.99286 3.95828 8.82097C4.0878 8.77519 4.22778 8.75 4.375 8.75H15.625C15.7722 8.75 15.9122 8.77519 16.0417 8.82097C16.5281 8.99286 16.875 9.45672 16.875 10V13.395L15.7042 12.2242C14.7843 11.3042 13.2927 11.3042 12.3727 12.2242L11.7308 12.8661ZM10.9375 10.2083C10.9375 9.69057 11.3572 9.27083 11.875 9.27083C12.3928 9.27083 12.8125 9.69057 12.8125 10.2083C12.8125 10.7261 12.3928 11.1458 11.875 11.1458C11.3572 11.1458 10.9375 10.7261 10.9375 10.2083Z",fill:"currentColor"})}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_15911_38152",children:e.jsx("rect",{width:"20",height:"20",fill:"white"})})})]})})))),wd=()=>{const e=d.useRouter();return Object.assign(Object.assign({},e),{openUrl:t=>{t.startsWith("https")||t.startsWith("http")?window.open(t):e.push(t)}})};function Td({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const Nd=Fe.forwardRef(Td);function yd({logoUrl:t}){return e.jsx("div",{className:"flex-shrink-0 rounded-2xl w-[84px] h-[84px] md:w-[120px] md:h-[120px] overflow-hidden ml-[16px] md:ml-[24px] -mt-[30px] md:-mt-[48px] z-0 border-[2px] md:border-[6px] border-white dark:border-[#1C1E26]",children:t?e.jsx($o,{src:t,alt:"bot avatar",className:"w-full h-full"}):e.jsx("div",{className:"w-full h-full rounded-md bg-[#bbb]"})})}function Cd({className:t,onClick:a}){const n=s.useTranslations();return e.jsxs("div",{className:pn("w-full h-full flex flex-col justify-start items-center p-6 !mb-[20%]",t),children:[e.jsx("img",{src:"https://www.myshellstatic.com/image/website/error/20240603/error-state.png",alt:"error logo",className:"w-[225px] h-[180px]"}),e.jsxs("p",{className:"mt-8 md:mt-12 text-[24px] font-semibold text-default",children:[n("disconnect_tip_oops"),"!!"]}),e.jsx("p",{className:"mt-2 text-base text-subtler text-center md:text-left",children:n("common.error_oops")}),e.jsx(Tr,{variant:"outline",className:"mt-6 flex justify-center items-center",onClick:a,children:e.jsxs("span",{className:"flex justify-center items-center space-x-1.5 text-brand",children:[e.jsx(qs,{className:"text-brand stroke-brand w-5 h-5"}),e.jsx("span",{className:"text-base",children:`${n("profile.refresh")}`})]})})]})}const Sd=({breakpointCols:t={default:0,3280:5,1919:4,1439:3,1199:2},className:s="",columnClassName:n="",children:l,columnAttrs:r={}})=>{const[i,o]=a.useState("number"==typeof t?t:t.default);a.useEffect((()=>{const e=()=>{(()=>{const e=(null===window||void 0===window?void 0:window.innerWidth)||1/0;let s=i;if("object"==typeof t){let a=1/0;for(const n in t){const l=parseInt(n);l>0&&e<=l&&l<a&&(a=l,s=t[n])}s=Math.max(1,s||1)}i!==s&&o(s)})()};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[t,i]);return e.jsx("div",Object.assign({},r,{className:pn("flex mr-4 md:mr-6 w-auto",s||"my-masonry-grid"),children:i>0&&(()=>{const e=(()=>{const e=new Array(i),t=Fe.default.Children.toArray(l);for(let s=0;s<t.length;s++){const a=s%i;e[a]||(e[a]=[]),e[a].push(t[s])}return e})(),t=100/e.length+"%";return e.map(((e,s)=>a.createElement("div",Object.assign({},r,{style:Object.assign(Object.assign({},r.style),{width:t}),className:pn("pl-2 md:pl-5 bg-clip-padding space-y-2 md:space-y-5",n),key:s}),e)))})()}))};var jd=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function Id(t){var{className:s,animate:a=!0}=t,n=jd(t,["className","animate"]);return e.jsx("div",Object.assign({className:pn("rounded-md bg-surface-container-hovered",s,a&&"animate-pulse ")},n))}const Od={galleryList:[],galleryUserList:[]},Ad=n.create()(Be.default(((e,t)=>Object.assign(Object.assign({},Od),{setGalleryList:t=>{e({galleryList:t})},setGalleryUserList:t=>{e({galleryUserList:t})}})),(e=>({history:[]}))));var Md=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function Pd(e){return Os.post("/v1/bot/gallery/delete",{body:{ids:[e]},isGoLang:!0})}const Ld=new Map;async function kd(e){if(!Ld.has(e)){const t=await function(e){return Os.post("/v1/shared/generate_shared_code",{body:{bizId:e,bizType:"BIZ_TYPE_GALLERY_IMAGE"},isGoLang:!0})}(e);t.success&&t.data&&Ld.set(e,t.data.code)}return Ld.get(e)}function Rd({deleting:t,open:a,onClose:n,onConfirm:l}){const r=s.useTranslations();return e.jsx(Mr,{overlayClose:!t,hideClose:t,open:a,onClose:n,onConfirm:l,state:"warning",confirmText:r("common.delete"),isNotification:!0,title:r("chat.delete_confirmation.header"),description:r("chat.delete_gallery"),confirmLoading:t,overlayClassName:"z-[110]",contentClassName:"z-[110]"})}function Dd(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Ud="object"==typeof global&&global&&global.Object===Object&&global,Fd="object"==typeof self&&self&&self.Object===Object&&self,Bd=Ud||Fd||Function("return this")(),Gd=function(){return Bd.Date.now()},zd=/\s/;var Yd=/^\s+/;function Hd(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&zd.test(e.charAt(t)););return t}(e)+1).replace(Yd,""):e}var Vd=Bd.Symbol,$d=Object.prototype,Wd=$d.hasOwnProperty,Kd=$d.toString,qd=Vd?Vd.toStringTag:void 0;var Qd=Object.prototype.toString;var Xd="[object Null]",Jd="[object Undefined]",Zd=Vd?Vd.toStringTag:void 0;function eu(e){return null==e?void 0===e?Jd:Xd:Zd&&Zd in Object(e)?function(e){var t=Wd.call(e,qd),s=e[qd];try{e[qd]=void 0;var a=!0}catch(e){}var n=Kd.call(e);return a&&(t?e[qd]=s:delete e[qd]),n}(e):function(e){return Qd.call(e)}(e)}var tu="[object Symbol]";var su=NaN,au=/^[-+]0x[0-9a-f]+$/i,nu=/^0b[01]+$/i,lu=/^0o[0-7]+$/i,ru=parseInt;function iu(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&eu(e)==tu}(e))return su;if(Dd(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Dd(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Hd(e);var s=nu.test(e);return s||lu.test(e)?ru(e.slice(2),s?2:8):au.test(e)?su:+e}var ou="Expected a function",cu=Math.max,du=Math.min;function uu(e,t,s){var a,n,l,r,i,o,c=0,d=!1,u=!1,m=!0;if("function"!=typeof e)throw new TypeError(ou);function p(t){var s=a,l=n;return a=n=void 0,c=t,r=e.apply(l,s)}function f(e){var s=e-o;return void 0===o||s>=t||s<0||u&&e-c>=l}function h(){var e=Gd();if(f(e))return g(e);i=setTimeout(h,function(e){var s=t-(e-o);return u?du(s,l-(e-c)):s}(e))}function g(e){return i=void 0,m&&a?p(e):(a=n=void 0,r)}function v(){var e=Gd(),s=f(e);if(a=arguments,n=this,o=e,s){if(void 0===i)return function(e){return c=e,i=setTimeout(h,t),d?p(e):r}(o);if(u)return clearTimeout(i),i=setTimeout(h,t),p(o)}return void 0===i&&(i=setTimeout(h,t)),r}return t=iu(t)||0,Dd(s)&&(d=!!s.leading,l=(u="maxWait"in s)?cu(iu(s.maxWait)||0,t):l,m="trailing"in s?!!s.trailing:m),v.cancel=function(){void 0!==i&&clearTimeout(i),c=0,a=o=n=i=void 0},v.flush=function(){return void 0===i?r:g(Gd())},v}var mu="Expected a function";function pu(e,t,s){var a=!0,n=!0;if("function"!=typeof e)throw new TypeError(mu);return Dd(s)&&(a="leading"in s?!!s.leading:a,n="trailing"in s?!!s.trailing:n),uu(e,t,{leading:a,maxWait:t,trailing:n})}function fu({className:t}){return e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",className:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_17237_21185)",children:[e.jsx("path",{d:"M17.388 17.9344C17.7395 18.2943 18.3422 18.2943 18.677 17.9344C19.0202 17.5661 19.0202 16.9969 18.677 16.6453L10.7167 8.65982C10.3651 8.30826 9.76244 8.30826 9.42759 8.65982C9.07601 9.02811 9.08444 9.60568 9.42759 9.95725L17.388 17.9344ZM12.5163 12.1838L10.0637 9.72289C9.91309 9.57218 9.86287 9.40482 10.0135 9.26253C10.1391 9.12853 10.3149 9.16204 10.4739 9.32111L12.9349 11.782L12.5163 12.1838Z",fill:"white"}),e.jsx("path",{d:"M7.0671 18.0684C7.21777 18.0684 7.32659 17.9595 7.3517 17.8005C7.61956 15.5656 7.72837 15.5069 10.0052 15.1387C10.1809 15.1052 10.2897 15.0215 10.2897 14.8541C10.2897 14.695 10.1809 14.5946 10.0387 14.5694C7.74512 14.1342 7.61956 14.1426 7.3517 11.9077C7.32659 11.7486 7.21777 11.6398 7.0671 11.6398C6.90807 11.6398 6.79925 11.7486 6.7825 11.8993C6.48954 14.1677 6.4142 14.243 4.09557 14.5694C3.95327 14.5862 3.84445 14.695 3.84445 14.8541C3.84445 15.0131 3.95327 15.1052 4.09557 15.1387C6.4142 15.5823 6.48117 15.5823 6.7825 17.8172C6.79925 17.9595 6.90807 18.0684 7.0671 18.0684ZM3.0911 10.7776C3.20829 10.7776 3.27525 10.6939 3.30036 10.5851C3.58496 8.99473 3.59333 8.89424 5.27581 8.60966C5.38462 8.58452 5.46833 8.51758 5.46833 8.40039C5.46833 8.28321 5.38462 8.20787 5.27581 8.19113C3.59333 7.89816 3.58496 7.79771 3.30036 6.20731C3.27525 6.09849 3.20829 6.02316 3.0911 6.02316C2.97391 6.02316 2.90695 6.09849 2.88184 6.20731C2.59724 7.79771 2.58887 7.89816 0.906389 8.19113C0.797573 8.20787 0.713867 8.28321 0.713867 8.40039C0.713867 8.51758 0.797573 8.58452 0.906389 8.60966C2.58887 8.89424 2.59724 8.99473 2.88184 10.5851C2.90695 10.6939 2.97391 10.7776 3.0911 10.7776ZM7.67815 5.42048C7.7786 5.42048 7.82882 5.36188 7.84557 5.26981C8.13015 3.93053 8.11344 3.8803 9.51965 3.59571C9.61172 3.57896 9.67872 3.52037 9.67872 3.42829C9.67872 3.32785 9.61172 3.26925 9.51965 3.25251C8.11344 2.96791 8.13015 2.91769 7.84557 1.58677C7.82882 1.4947 7.7786 1.42773 7.67815 1.42773C7.57771 1.42773 7.52748 1.4947 7.51074 1.58677C7.22615 2.91769 7.24288 2.96791 5.83664 3.25251C5.74456 3.26925 5.6776 3.32785 5.6776 3.42829C5.6776 3.52037 5.74456 3.57896 5.83664 3.59571C7.24288 3.8803 7.22615 3.93053 7.51074 5.26981C7.52748 5.36188 7.57771 5.42048 7.67815 5.42048ZM14.5922 8.37528C14.7094 8.37528 14.7764 8.29994 14.8015 8.19113C15.0861 6.60073 15.0944 6.50028 16.7769 6.20731C16.8941 6.19057 16.9694 6.11523 16.9694 5.99805C16.9694 5.88086 16.8941 5.81389 16.7769 5.78878C15.0944 5.50418 15.0861 5.40374 14.8015 3.81333C14.7764 3.70452 14.7094 3.62081 14.5922 3.62081C14.475 3.62081 14.4081 3.70452 14.3829 3.81333C14.0984 5.40374 14.09 5.50418 12.4075 5.78878C12.2987 5.81389 12.215 5.88086 12.215 5.99805C12.215 6.11523 12.2987 6.19057 12.4075 6.20731C14.09 6.50028 14.0984 6.60073 14.3829 8.19113C14.4081 8.29994 14.475 8.37528 14.5922 8.37528Z",fill:"white"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_17237_21185",children:e.jsx("rect",{width:"20",height:"20",fill:"white"})})})]})}function hu({className:t}){return e.jsxs("svg",{width:"300",height:"301",viewBox:"0 0 300 301",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[e.jsxs("g",{opacity:"0.8",children:[e.jsx("circle",{opacity:"0.4",cx:"154.5",cy:"149.212",r:"115.5",fill:"url(#paint0_linear_16733_50048)"}),e.jsx("circle",{cx:"271.962",cy:"77.5061",r:"6.68125",stroke:"#A3A3A3","stroke-width":"2.69663"}),e.jsx("circle",{cx:"184.996",cy:"277.731",r:"6.68125",stroke:"#A3A3A3","stroke-width":"2.69663"}),e.jsx("g",{filter:"url(#filter0_f_16733_50048)",children:e.jsx("path",{d:"M57.6408 158.465L59.9169 164.616L66.0678 166.892L59.9169 169.168L57.6408 175.319L55.3648 169.168L49.2139 166.892L55.3648 164.616L57.6408 158.465Z",fill:"#B5B5B5"})}),e.jsx("path",{d:"M271.74 196.218L275.123 205.361L284.266 208.744L275.123 212.127L271.74 221.27L268.357 212.127L259.214 208.744L268.357 205.361L271.74 196.218Z",fill:"#A3A3A3"}),e.jsx("path",{d:"M190.196 174.966L130.436 95.8145L73.1945 135.793C67.7948 139.557 66.6526 147.059 70.6504 152.277L107.566 200.433L190.196 174.966Z",fill:"#ADADAD"}),e.jsx("path",{d:"M190.196 174.967L130.437 95.8145L177.009 64.8702C182.538 61.2098 189.963 62.6896 193.675 68.1671L230.408 122.605L190.196 174.967V174.967Z",fill:"#999999"}),e.jsx("path",{d:"M230.409 122.605L230.383 122.553V122.605H230.409ZM168.495 108.535C170.519 104.667 174.18 101.889 178.463 100.98L211.147 94.0489L191.781 65.3372C188.873 61.0538 183.681 58.9251 178.619 59.9375L104.27 74.9943L150.349 143.243L168.495 108.535Z",fill:"url(#paint1_linear_16733_50048)"}),e.jsx("path",{d:"M120.545 126.291L150.27 143.373L150.347 143.243L104.268 74.9941L67.8466 135.221C65.1208 139.738 65.4323 145.45 68.6513 149.655L81.0602 165.854L108.292 128.887C111.122 125.019 116.392 123.903 120.545 126.291V126.291ZM150.373 143.451L150.425 143.399L150.347 143.425L150.373 143.451ZM107.565 200.433L109.59 197.707L107.565 200.407V200.433ZM234.588 89.0645L211.146 94.0488L230.382 122.553L239.208 94.1267C240.117 91.2191 237.547 88.4414 234.588 89.0645V89.0645Z",fill:"url(#paint2_linear_16733_50048)"}),e.jsx("path",{d:"M150.426 143.398L230.383 122.604L150.426 143.372V143.398Z",fill:"#FE506B"}),e.jsx("path",{d:"M178.463 100.981C174.179 101.889 170.545 104.667 168.494 108.535L150.322 143.244L150.4 143.373L230.357 122.605V122.553L211.121 94.0234L178.463 100.981Z",fill:"#CAC134"}),e.jsx("path",{d:"M178.463 100.981C174.179 101.889 170.545 104.667 168.494 108.535L150.322 143.244L150.4 143.373L230.357 122.605V122.553L211.121 94.0234L178.463 100.981Z",fill:"url(#paint3_linear_16733_50048)"}),e.jsx("path",{d:"M150.348 143.243L150.271 143.373L150.348 143.425L150.426 143.399V143.373L150.348 143.243Z",fill:"#FFBA3B"}),e.jsx("path",{d:"M150.348 143.243L150.271 143.373L150.348 143.425L150.426 143.399V143.373L150.348 143.243Z",fill:"#FE506B"}),e.jsx("path",{d:"M74.9083 174.135C72.4161 177.51 73.5064 182.313 77.2187 184.26L107.54 200.433V200.407L81.0348 165.828L74.9083 174.135V174.135Z",fill:"url(#paint4_linear_16733_50048)"}),e.jsx("path",{d:"M150.478 143.503L150.374 143.451L109.591 197.708L150.478 143.503Z",fill:"#FE506B"}),e.jsx("path",{d:"M150.244 143.45L150.269 143.399L120.545 126.317C116.392 123.929 111.122 125.045 108.292 128.887L81.0342 165.828L107.539 200.407L109.59 197.707L150.373 143.425L150.321 143.399L150.244 143.45V143.45Z",fill:"#FFBA3B"}),e.jsx("path",{d:"M150.244 143.45L150.269 143.399L120.545 126.317C116.392 123.929 111.122 125.045 108.292 128.887L81.0342 165.828L107.539 200.407L109.59 197.707L150.373 143.425L150.321 143.399L150.244 143.45V143.45Z",fill:"url(#paint5_linear_16733_50048)"}),e.jsx("path",{d:"M150.347 143.425L150.269 143.373L150.243 143.451L150.347 143.425Z",fill:"#FFBA3B"}),e.jsx("path",{d:"M150.347 143.425L150.269 143.373L150.243 143.451L150.347 143.425Z",fill:"#FE506B"}),e.jsx("path",{d:"M150.347 143.425L150.269 143.373L150.243 143.451L150.347 143.425Z",fill:"#FE506B"}),e.jsx("path",{d:"M177.009 210.168L112.031 231.922C108.293 233.194 104.503 230.183 104.892 226.263L107.566 200.433L190.196 174.966L186.562 199.55C185.446 204.482 181.837 208.506 177.009 210.168Z",fill:"url(#paint6_linear_16733_50048)"}),e.jsx("path",{d:"M243.596 120.373L216.156 151.888C214.287 154.224 212.133 156.301 209.744 158.093L190.145 175.018L230.357 122.631L241.312 117.517C243.129 116.66 244.842 118.815 243.596 120.373V120.373Z",fill:"url(#paint7_linear_16733_50048)"}),e.jsx("path",{d:"M155.306 207.416L159.122 205.963C160.498 205.417 162.082 205.703 163.224 206.663L169.091 211.648C171.324 213.543 170.908 217.099 168.286 218.397L164.756 220.163C163.302 220.89 161.537 220.682 160.291 219.618L154.138 214.348C151.776 212.297 152.451 208.533 155.306 207.416V207.416ZM184.563 251.211L187.419 249.601C188.457 249.004 189.755 248.848 190.82 249.134L196.271 250.718C198.348 251.315 198.53 253.417 196.609 254.715L194.013 256.455C192.948 257.182 191.495 257.415 190.326 257.078L184.589 255.364C182.435 254.715 182.409 252.431 184.563 251.211V251.211Z",fill:"#D1D1D1"}),e.jsx("path",{d:"M60.7273 234.645L64.1105 243.787L73.2534 247.171L64.1105 250.554L60.7273 259.697L57.3441 250.554L48.2012 247.171L57.3441 243.787L60.7273 234.645Z",fill:"#B5B5B5"}),e.jsx("circle",{cx:"244.382",cy:"167.229",r:"4.04494",stroke:"#A3A3A3","stroke-width":"2.69663"}),e.jsx("g",{filter:"url(#filter1_d_16733_50048)",children:e.jsx("path",{d:"M238.033 156.358C236.314 152.682 233.857 149.383 230.73 146.554C227.615 143.735 223.988 141.523 219.953 139.978C215.785 138.383 211.358 137.574 206.797 137.574C202.237 137.574 197.81 138.383 193.642 139.978C189.607 141.523 185.98 143.737 182.865 146.554C179.738 149.383 177.281 152.682 175.562 156.358C173.788 160.13 172.869 164.247 172.872 168.415C172.872 177.066 176.834 185.25 183.794 191.086C181.577 193.99 178.378 196.622 173.621 199.476C173.332 199.65 173.107 199.913 172.982 200.226C172.857 200.539 172.838 200.885 172.928 201.21C173.018 201.535 173.212 201.822 173.481 202.026C173.749 202.23 174.077 202.34 174.414 202.341C179.109 202.341 183.426 201.874 187.244 200.952C190.498 200.167 193.404 199.05 195.894 197.627C199.427 198.712 203.102 199.262 206.797 199.256C211.358 199.256 215.785 198.447 219.953 196.852C223.988 195.31 227.615 193.094 230.729 190.276C233.857 187.447 236.314 184.149 238.032 180.473C239.804 176.7 240.722 172.583 240.722 168.415C240.722 164.247 239.804 160.131 238.032 156.358H238.033Z",fill:"url(#paint8_linear_16733_50048)"})}),e.jsx("path",{d:"M204.594 173.353C203.943 168.485 210.548 167.399 210.548 164.391C210.548 162.499 209.06 161.445 206.61 161.445C204.718 161.445 203.168 162.313 201.648 163.895L199.105 161.569C201.09 159.274 203.819 157.755 207.137 157.755C211.634 157.755 214.921 159.863 214.921 163.988C214.921 168.516 208.13 169.074 208.626 173.353H204.594ZM206.641 181.633C205.028 181.633 203.881 180.486 203.881 178.873C203.881 177.261 205.059 176.144 206.641 176.144C208.192 176.144 209.37 177.261 209.37 178.873C209.37 180.486 208.192 181.633 206.641 181.633Z",fill:"white"}),e.jsx("g",{filter:"url(#filter2_f_16733_50048)",children:e.jsx("path",{d:"M97.0057 24.3076L101.083 35.326L112.101 39.4032L101.083 43.4804L97.0057 54.4988L92.9286 43.4804L81.9102 39.4032L92.9286 35.326L97.0057 24.3076Z",fill:"#A4A4A4"})})]}),e.jsxs("defs",{children:[e.jsxs("filter",{id:"filter0_f_16733_50048",x:"46.5172",y:"155.768",width:"22.2468",height:"22.2468",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[e.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),e.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),e.jsx("feGaussianBlur",{stdDeviation:"1.34831",result:"effect1_foregroundBlur_16733_50048"})]}),e.jsxs("filter",{id:"filter1_d_16733_50048",x:"159.389",y:"130.833",width:"94.8159",height:"91.7329",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[e.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),e.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),e.jsx("feOffset",{dy:"6.74157"}),e.jsx("feGaussianBlur",{stdDeviation:"6.74157"}),e.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),e.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0 0.937255 0 0 0 0.39 0"}),e.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_16733_50048"}),e.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_16733_50048",result:"shape"})]}),e.jsxs("filter",{id:"filter2_f_16733_50048",x:"79.2135",y:"21.611",width:"35.5847",height:"35.5847",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[e.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),e.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),e.jsx("feGaussianBlur",{stdDeviation:"1.34831",result:"effect1_foregroundBlur_16733_50048"})]}),e.jsxs("linearGradient",{id:"paint0_linear_16733_50048",x1:"154.5",y1:"-31.7465",x2:"154.5",y2:"264.712",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"white",stopOpacity:"0"}),e.jsx("stop",{offset:"1",stopColor:"#D4D4D4"})]}),e.jsxs("linearGradient",{id:"paint1_linear_16733_50048",x1:"167.339",y1:"59.6885",x2:"167.339",y2:"143.243",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#D6D6D6"}),e.jsx("stop",{offset:"1",stopColor:"#A9A9A9"})]}),e.jsxs("linearGradient",{id:"paint2_linear_16733_50048",x1:"152.697",y1:"74.9941",x2:"152.697",y2:"200.433",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#DCDCDC"}),e.jsx("stop",{offset:"1",stopColor:"#A6A6A6"})]}),e.jsxs("linearGradient",{id:"paint3_linear_16733_50048",x1:"190.34",y1:"94.0234",x2:"190.34",y2:"143.373",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#D7D7D7"}),e.jsx("stop",{offset:"1",stopColor:"#B7B7B7"})]}),e.jsxs("linearGradient",{id:"paint4_linear_16733_50048",x1:"90.5522",y1:"165.828",x2:"90.5522",y2:"200.433",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#D7D7D7"}),e.jsx("stop",{offset:"1",stopColor:"#ACACAC"})]}),e.jsxs("linearGradient",{id:"paint5_linear_16733_50048",x1:"115.704",y1:"125.063",x2:"115.704",y2:"200.407",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#D9D9D9"}),e.jsx("stop",{offset:"1",stopColor:"#A9A9A9"})]}),e.jsxs("linearGradient",{id:"paint6_linear_16733_50048",x1:"147.53",y1:"174.966",x2:"147.53",y2:"232.218",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#C4C4C4"}),e.jsx("stop",{offset:"1",stopColor:"#C4C4C4",stopOpacity:"0"})]}),e.jsxs("linearGradient",{id:"paint7_linear_16733_50048",x1:"217.083",y1:"117.322",x2:"217.083",y2:"175.018",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#DEDEDE"}),e.jsx("stop",{offset:"1",stopColor:"#C2C2C2"})]}),e.jsxs("linearGradient",{id:"paint8_linear_16733_50048",x1:"179.339",y1:"155.283",x2:"206.797",y2:"202.341",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#7F7F7F"}),e.jsx("stop",{offset:"1",stopColor:"#A3A3A3"})]})]})]})}function gu(){const[e,t]=a.useState(!1),{warning:n}=Ql(),l=xl((e=>e.isMobile)),r=s.useTranslations("common"),i=s.useTranslations(),o=d.useParams().botId,c=a.useCallback((async(e,s,a)=>{t(!0),fetch(e).then((e=>e.blob())).then((e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=s,document.body.appendChild(n),n.click(),setTimeout((()=>{document.body.removeChild(n),URL.revokeObjectURL(t)}),1e3),null==a||a()})).catch((e=>{console.error(e),n({content:r("download_failed")})})).finally((()=>{t(!1)}))}),[n]),u=a.useCallback((async(e,s,a)=>{if(e.endsWith(".gif")||e.endsWith(".webp"))c(e,s,a);else{t(!0);let l="";o&&(l=await Gn(`${o}`));const i="https://www.myshellstatic.com/image/website/logo/logotext.png";try{const t=await m(e),n=await m(i),r=new URL(window.location.href);l&&(r.searchParams.set("shareCode",l),r.searchParams.set("bot","1"),r.searchParams.set("utm_channel","referral"),r.searchParams.set("utm_source","imageshare"),r.searchParams.set("utm_medium","qrcode"),r.searchParams.set("utm_campaign",l));const o=r.toString(),c=await xt.default.toDataURL(o),d=await m(c),u=document.createElement("canvas"),p=u.getContext("2d");if(!p)throw new Error("Could not get canvas context");const f=t.width,h=f>1300&&t.height<300?.6:f>1e3?.85:1,g=Math.max(.22*f*h,82),v=t.height+g,x=Math.max(.295*f*h,110),b=Math.max(.0641*f*h,24),E=Math.max(.166*f*h,54);u.width=2*f,u.height=2*v,p.scale(2,2),p.drawImage(t,0,0,f,t.height);const _=t.height;p.fillStyle="white",p.fillRect(0,_,f,g);const w=Math.max(.0292*f*h,16),T=Math.max(.0219*f*h,12),N=w+8,y=_+b+b/2-T;p.drawImage(n,N,y,x,b),p.font=1.3*T+"px sans-serif",p.fillStyle="#6D7175";const C=["Scan to","Generate"],S=1.3*w,j=Math.max(.12*f,56),I=f-E-j*h-w-10;let O="",A=S;for(let e=0;e<C.length;e++)e>0&&(O=`${C[e]} `,A+=S);let M=_+A/2+S+S/2+4;O="";for(let e=0;e<C.length;e++){const t=`${O+C[e]} `,s=p.measureText(t);s.width>j&&e>0?(p.fillText(O,I,M),O=`${C[e]} `,M+=S):O=t}p.fillText(O,I,M);const P=f-E-w;p.drawImage(d,P,_+(g-E)/2,E,E),u.toBlob((e=>{if(!e)throw new Error("Failed to create image blob");{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=s,document.body.appendChild(n),n.click(),setTimeout((()=>{document.body.removeChild(n),URL.revokeObjectURL(t)}),1e3),null==a||a()}}),"image/png",1)}catch(e){n({id:"download_image",content:r("download_failed")})}finally{t(!1)}}}),[n,r,i,l]),m=e=>new Promise(((t,s)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>t(a),a.onerror=s,a.src=e}));return{downloading:e,onDownload:c,onImageDownload:u}}const vu=(e,t,s)=>{const{isMobile:n,pathname:l}=so(),r=l;a.useLayoutEffect((()=>{if(e.current&&(n||t))try{const t=Number(sessionStorage.getItem(`scrollPos:${r}`));e.current.scrollTo(0,t)}catch(e){console.error(e)}}),[n,l])},xu=(e,t)=>{const{pathname:s}=so(),n=s;return a.useCallback((t=>{try{let s=null;t&&"string"==typeof t?s=window.document.getElementById(t):e&&(s=e.current),s&&sessionStorage.setItem(`scrollPos:${n}`,String((null==s?void 0:s.scrollTop)||"0"))}catch(e){console.error(e)}}),[s])};function bu({detailData:t,followCallback:n,size:l="lg",className:r}){const[i,o]=a.useState(!1),[c,d]=a.useState((null==t?void 0:t.followStatus)===exports.FollowStatus.FOLLOWED),u=Ur((e=>e.setUser)),m=s.useTranslations("profile"),p=s.useTranslations("request"),f=Ur((e=>e.isLogin)),h=xl((e=>e.toggleLoginModal)),{success:g,warning:v}=Ql(),x=hi(),b=a.useCallback((async()=>{if(!f)return void h(!0);if(t&&!t.id||i)return;o(!0);const e=!c;var s,a;if((await(s=`${null==t?void 0:t.id}`,a=e,Os.post("/v1/user/follow",{body:{targetUserId:s,followed:a},isGoLang:!0}))).success){d(e),n&&n(e),o(!1);const{data:t}=await Us();u(t),e&&x.track("FollowCreator",{creator_id:null==t?void 0:t.id,creator_name:null==t?void 0:t.name})}else v({content:p("error.common")}),o(!1)}),[t,c,i,f]);return e.jsx(Tr,{variant:"primary",color:c?"gray":"brand",className:pn("px-6",r),size:l,onClick:()=>{b()},loading:i,tabIndex:-1,autoFocus:!1,children:m(c?"following":"follow")})}function Eu({handleDelete:t}){const a=s.useTranslations("common"),n=!xl((e=>e.isMobile));return e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,tabIndex:-1,onClick:e=>{e.stopPropagation()},children:e.jsx(Kl,{icon:ba,size:n?"md":"sm",variant:"ghost",color:"default"})}),e.jsx(Di,{side:"bottom",align:"end",onClick:e=>{e.stopPropagation()},children:e.jsx(Ui,{asChild:!0,children:e.jsxs("div",{className:"w-full space-x-1.5 cursor-pointer",onClick:t,children:[e.jsx(fr,{component:an,size:"lg",color:"critical"}),e.jsx(Ul,{size:"lg",color:"critical",children:a("delete")})]})})})]})}function _u({isMobile:t,item:n,botId:l,deleteCallback:r,followCallback:i}){var o,c,u,m,p;const f=Ur((e=>e.userId)),h=wd(),[g,v]=a.useState(!1),x=d.useSearchParams(),b=()=>{v(!0)},{error:E,success:_}=Ql(),[w,T]=a.useState(!1),N=s.useTranslations(),y=hi();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-b border-default",children:e.jsxs("div",{className:"w-full py-2.5 md:py-4 px-4 md:px-6 flex justify-between items-center space-x-3 overflow-hidden",children:[e.jsxs("div",{className:"flex justify-start items-center space-x-1 w-full overflow-hidden",children:[t&&e.jsx("div",{className:pn("flex z-10 space-x-3 left-4"),children:e.jsx(Kl,{onClick:()=>{const e=x.get("from"),t=x.get("prevPath");"profile"===e&&t?h.openUrl(`${t.replace("#","%23")}?from=gallery`):h.openUrl(`/gallery/${l}`)},icon:Nd,size:"md",variant:"ghost",color:"brand"})}),e.jsxs("div",{className:"flex items-center space-x-2 overflow-hidden",children:[e.jsx($o,{size:"md",src:ns(null===(o=n.authInfo)||void 0===o?void 0:o.avatar)}),e.jsx(Ul,{size:"lg",lineClamp:1,weight:"medium",children:fn(n.authInfo.name,10)})]})]}),f&&f!==(null===(c=n.authInfo)||void 0===c?void 0:c.userId)?e.jsx(bu,{size:"sm",detailData:{id:null===(u=n.authInfo)||void 0===u?void 0:u.userId,followStatus:null===(m=n.authInfo)||void 0===m?void 0:m.followStatus},followCallback:e=>{(e=>{e&&y.track("GalleryPicFollow",{bot_id:n.botId,bot_name:n.botName,creator_id:n.authInfo.userId,creator_name:n.authInfo.name}),null==i||i()})(e)},className:"min-w-none"}):e.jsx("div",{className:"w-9 h-9"}),f===(null===(p=n.authInfo)||void 0===p?void 0:p.userId)&&b&&e.jsx(Eu,{handleDelete:b})]})}),e.jsx(Rd,{open:g,deleting:w,onClose:()=>v(!1),onConfirm:()=>(async()=>{T(!0),(await Pd(n.id)).success?(_({content:N("common.delete_success")}),T(!1),v(!1),null==r||r(n.id)):(E({content:N("common.delete_error")}),T(!1))})()})]})}function wu(e,t,s){const[a,n]=c.useToggle(!1);return{generating:a,generateShareLink:async()=>{let a="";try{n(!0);const l=await(()=>{let s;switch(e){case"curve":s=()=>Promise.resolve(t);break;case"bot":case"ugc":case"toolbox":case"room":default:s=Gn;break;case"widget":s=sl;break;case"gallery":s=kd}return s})()(t);return"curve"===e||"widget"===e||"gallery"===e&&(a=l?`${window.location.origin}/gallery/${s}/${t}?code=${l}&utm_channel=referral&utm_source=share`:`${window.location.origin}/gallery/${s}/${t}?utm_channel=referral&utm_source=share`),a}catch(e){}finally{n(!1)}}}}var Tu=a.memo((function({id:t,botId:n,successCb:l}){const[r,i]=a.useState(""),{generating:o,generateShareLink:c}=wu("gallery",t,n),{onCopy:d}=ui(r),u=s.useTranslations(),m=a.useCallback((async()=>{let e=r;if(!e){const t=await c();e=null!=t?t:"",i(e)}d(e),null==l||l()}),[c,d,r,l]);return e.jsx(Tr,{icon:Zs,variant:"outline",color:"default","aria-label":"share gallery",loading:o,onClick:m,className:"flex-1 min-w-none",children:u("bot.share")})}));function Nu(){return e.jsx("div",{className:"w-full h-full flex justify-center items-center md:p-2",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(di,{color:"brand"})})})}function yu({item:t,botId:n,galleryId:l,isShare:r=!1,isMobile:i,deleteCallback:o,followCallback:c}){var u,m,p,f,h,g;const v=s.useTranslations(),x=wd();Ql();const{downloading:b,onDownload:E}=gu(),_=d.useSearchParams(),w=Ur((e=>e.showNsfw)),T=Ur((e=>e.isVisitor)),[N,y]=a.useState(t),[C,S]=a.useState(!1);Ql();const j=hi(),I=(null==N?void 0:N.isNsfw)&&(1===T||!(1===w)),{onCopy:O}=ui("","",(()=>{S(!0),setTimeout((()=>{S(!1),P()}),5e3)})),[A,M]=a.useState(!1),P=()=>{M(!1)};a.useMemo((()=>{const e=(null==N?void 0:N.viewCount)||0;if(e>=1e3){const t=`${(e/1e3).toFixed(1)}k`;return t.endsWith(".0")?`${t.slice(0,-2)}k`:`${t}`}return e}),[null==N?void 0:N.viewCount]);const[L,k]=a.useState(!1),[R,D]=a.useState(!1),U=async()=>{D(!0);const e=await function(e){return Os.post("/v1/bot/gallery/get_detail",{body:{id:e},isGoLang:!0})}(l);if(e.success){const{data:t}=e;y(t.info)}else k(!0);D(!1)},F=d.useSearchParams(),B=e=>{const t=F.get("from");if(o&&o(e),i){const e=F.get("prevPath");"profile"===t&&e?x.openUrl(`${e.replace("#","%23")}?from=gallery`):x.openUrl(`${i?"/m":""}/gallery/${n}`)}};a.useEffect((()=>{(null==t?void 0:t.id)?y(N):U()}),[null==t?void 0:t.id]);const G=_.get("code");a.useEffect((()=>{G&&fs.setSharingCode(G)}),[]);const{pathname:z}=so(),Y=a.useRef(null),H=xu(Y),V="gallery-info-page";vu(Y,!0),a.useEffect((()=>{function e(){i&&H(V)}const t=Y.current;t&&t.addEventListener("scroll",pu(e,500),!0);const s=()=>{sessionStorage.setItem(`scrollPos:${z}`,"0")};return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s),t&&t.removeEventListener("scroll",e,!0)}}),[]);return R?e.jsx(Nu,{}):N||L?e.jsx("div",{className:"w-full h-full flex flex-col md:flex-row overflow-y-hidden md:overflow-y-auto md:overflow-hidden rounded-b-2xl",children:L?e.jsxs("div",{className:"w-full h-full flex flex-col justify-center items-center",children:[e.jsx(hu,{}),e.jsx(Dl,{size:"sm",className:"mt-8 md:mt-12",children:v("invalid_link")}),e.jsx(Ul,{size:"sm",color:"subtle",className:"mt-1.5 text-center md:text-left",children:v("invalid_link_tip")}),e.jsx(Tr,{variant:"primary",size:"lg",className:"mt-6 flex justify-center items-center",onClick:()=>{x.openUrl(`/gallery/${n}`)},children:v("explore")})]}):e.jsxs(e.Fragment,{children:[i&&N&&e.jsx(_u,{isMobile:i,item:N,botId:n,followCallback:c,deleteCallback:B}),e.jsxs("div",{ref:Y,id:V,className:"w-full h-auto flex flex-col md:flex-row flex-1 overflow-y-auto md:overflow-y-hidden z-[2]",children:[e.jsxs("div",{className:"relative w-full md:w-[69.9%] max-w-[836px]",children:[e.jsxs("div",{className:pn("w-full h-full flex justify-center bg-surface-default",r&&"items-center"),children:[!i&&G&&e.jsx("div",{className:pn("absolute left-6 top-3 flex z-10 space-x-3"),children:e.jsx(Kl,{onClick:()=>{x.push(`/gallery/${n}`)},icon:Ws,size:"md",variant:"primary",color:"gray"})}),(null==N?void 0:N.galleryImageLink)&&e.jsx(vr,{className:"w-full !h-auto object-none object-top",imgClassName:pn("max-h-[540px] min-w-[96px] min-h-[96px] md:min-h-[96px] md:max-h-[836px] md:max-w-[836px] object-contain object-center",I?"min-h-[220px]":"min-h-[96px]"),src:N.galleryImageLink,alt:`ai art photo:${null===(u=null==N?void 0:N.generationInfo)||void 0===u?void 0:u.sourceText}`})]}),I&&e.jsxs("div",{className:"absolute top-0 bottom-0 bg-beta-black-10 w-full h-full flex flex-col items-center justify-center space-y-1",style:{backdropFilter:"blur(80px)",WebkitBackdropFilter:"blur(80px)",background:"linear-gradient(180deg, rgba(0, 0, 0, 0.10) 0%, rgba(0, 0, 0, 0.80) 100%)"},children:[e.jsx(fr,{component:ya,size:"4xl",color:"static"}),e.jsx(Ul,{size:"lg",color:"static",children:v("workshop.nsfw_bot_text")}),e.jsx(Ul,{size:"sm",className:"opacity-80 text-center max-w-[248px]",color:"static",children:v("workshop.nsfw_gallery_user_content")}),e.jsx(Tr,{size:"md",icon:pa,iconDirection:"right",color:"brand",variant:"primary",onClick:()=>{x.openUrl("/profile/settings")},className:"!mt-3",children:v("workshop.nsfw_bot_user_button")})]})]}),e.jsxs("div",{className:"relative flex-1 flex-shrink-0 flex flex-col bg-surface-default w-full md:w-[31.1%] min-w-[300px] text-justify md:border-l md:border-default",children:[!i&&N&&e.jsx(_u,{isMobile:i,item:N,botId:n,followCallback:c,deleteCallback:B}),e.jsxs("div",{className:"px-3 md:px-4 space-y-4 py-4 flex-1 overflow-y-auto pb-[107px] md:pb-0",children:[e.jsxs(Ul,{size:"sm",color:"subtle",className:Ge.default("block relative md:p-2 min-h-11",{"bg-surface-hovered rounded-md":A}),onClick:()=>{var e;i&&O(`${null===(e=null==N?void 0:N.generationInfo)||void 0===e?void 0:e.sourceText}`)},onMouseEnter:()=>{i||M(!0)},onMouseLeave:()=>{i||P()},children:[(null===(m=null==N?void 0:N.generationInfo)||void 0===m?void 0:m.sourceText)||v("chat.no_text_input"),(null===(p=null==N?void 0:N.generationInfo)||void 0===p?void 0:p.sourceText)&&A&&e.jsx("div",{className:"absolute bottom-2 right-0 p-2 h-7 rounded-full flex justify-center items-center",onClick:e=>{var t;O(`${null===(t=null==N?void 0:N.generationInfo)||void 0===t?void 0:t.sourceText}`)},children:e.jsx(Tr,{icon:va,size:"sm",variant:"primary",color:"gray","aria-label":"copy text",className:"flex-1 min-w-none",children:v(C?"common.copied":"common.copy")})})]}),(null===(f=null==N?void 0:N.generationInfo)||void 0===f?void 0:f.sourceImageLink)&&e.jsxs("div",{className:"relative w-14 h-14",onClick:()=>{var e;I?x.openUrl("/profile/settings"):x.openUrl(null===(e=null==N?void 0:N.generationInfo)||void 0===e?void 0:e.sourceImageLink)},children:[I&&(null===(h=null==N?void 0:N.generationInfo)||void 0===h?void 0:h.sourceImageLink)&&e.jsx("div",{className:"absolute top-0 bottom-0 z-[1] bg-beta-black-10 w-full h-full flex flex-col items-center justify-center space-y-1 rounded-xl cursor-pointer",style:{backdropFilter:"blur(20px)",background:i?"linear-gradient(180deg, rgba(0, 0, 0, 0.10) 0%, rgba(0, 0, 0, 0.80) 100%)":""},children:e.jsx(fr,{component:ya,size:"xl",color:"inverse"})}),e.jsx($o,{size:"2xl",src:null===(g=null==N?void 0:N.generationInfo)||void 0===g?void 0:g.sourceImageLink}),e.jsx("div",{className:"absolute right-0 bottom-0 w-4.5 h-4.5 bg-surface-default flex justify-center items-center rounded-md",children:e.jsx(fr,{component:Ya,size:"xs",className:"flex justify-center items-center border-2 border-surface-default"})})]}),e.jsx("div",{className:"md:px-2 flex-shrink-0 space-x-1 flex justify-start items-center"})]}),e.jsxs("div",{className:"border-t border-default absolute md:relative w-full left-0 bottom-0 z-10 bg-surface-default",children:[e.jsx("div",{className:"w-full py-4 px-4 flex justify-between items-center space-x-4",children:e.jsxs("div",{className:"w-full flex justify-between items-center space-x-4",children:[e.jsx(Tr,{tabIndex:-1,icon:Ys,variant:"outline",color:"default","aria-label":"download file",loading:b,onClick:()=>{N&&E(null==N?void 0:N.galleryImageLink,null==N?void 0:N.id,(()=>{var e,t;j.track("GalleryPicDownload",{picture_id:null==N?void 0:N.galleryImageLink,bot_id:null==N?void 0:N.botId,bot_name:null==N?void 0:N.botName,creator_id:null===(e=N.authInfo)||void 0===e?void 0:e.userId,creator_name:null===(t=N.authInfo)||void 0===t?void 0:t.name})}))},className:"flex-1 min-w-none",children:v("chat.Download")}),N&&e.jsx(Tu,{id:null==N?void 0:N.id,botId:null==N?void 0:N.botId,successCb:()=>{var e,t;j.track("GalleryPicShare",{picture_id:null==N?void 0:N.galleryImageLink,bot_id:null==N?void 0:N.botId,bot_name:null==N?void 0:N.botName,creator_id:null===(e=null==N?void 0:N.authInfo)||void 0===e?void 0:e.userId,creator_name:null===(t=null==N?void 0:N.authInfo)||void 0===t?void 0:t.name})}})]})}),r&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Tr,{icon:fu,isBlock:!0,variant:"primary",color:"brand",onClick:()=>{x.openUrl(`/chat/${n}`)},children:v("chat.go_to_gallery")})})]})]})]})]})}):null}function Cu({item:t,from:n="gallery",deleteCallback:l,followCallback:r}){var i;const o=xl((e=>e.isMobile)),c=s.useTranslations(),[u,m]=a.useState(!1),[p,f]=a.useState(!1),h=d.usePathname(),g=Ur((e=>e.showNsfw)),v=Ur((e=>e.isVisitor)),x=(null==t?void 0:t.isNsfw)&&(1===v||!(1===g)),b=Ur((e=>e.userId)),E=hi();a.useMemo((()=>{const e=null==t?void 0:t.viewCount;if(e>=1e3){const e=`${(t.viewCount/1e3).toFixed(1)}k`;return e.endsWith(".0")?`${e.slice(0,-2)}k`:`${e}`}return e}),[null==t?void 0:t.viewCount]);const[_,w]=a.useState(!1),{error:T,success:N}=Ql(),[y,C]=a.useState(!1);return a.useEffect((()=>{u||(document.body.style.pointerEvents="")}),[u]),e.jsxs(e.Fragment,{children:[e.jsxs(Kr,{href:`${o?"/m":""}/gallery/${t.botId}/${t.id}?from=${n}&prevPath=${h}`,className:"block relative rounded-xl overflow-hidden cursor-pointer",onMouseEnter:()=>{o||w(!0)},onMouseLeave:()=>{o||w(!1)},onClick:e=>{E.track("GalleryPicClick",{bot_id:t.botId,bot_name:t.botName,picture_id:t.galleryImageLink,creator_id:t.authInfo.userId,creator_name:t.authInfo.name}),o||(e.preventDefault(),e.stopPropagation(),m(!0))},children:[e.jsx("div",{className:"rounded-xl overflow-hidden ease-in-out duration-300 hover:scale-105",children:e.jsx(vr,{className:"rounded-xl min-h-[220px] max-h-[360px] md:max-h-[440px] bg-surface-container-hovered overflow-hidden",imgClassName:"min-h-[220px] max-h-[360px] md:max-h-[440px] object-cover",src:t.galleryImageLink,alt:`ai art photo:${null===(i=null==t?void 0:t.generationInfo)||void 0===i?void 0:i.sourceText}`})}),e.jsxs("div",{className:pn("absolute z-10 w-full p-3 overflow-hidden",x?"bottom-0 left-0 h-full flex flex-col justify-end rounded-xl":"bottom-0 left-0 rounded-b-xl"),style:{backdropFilter:x?"blur(32px)":"",WebkitBackdropFilter:x?"blur(32px)":"",background:x?"linear-gradient(180deg, rgba(0, 0, 0, 0.10) 0%, rgba(0, 0, 0, 0.80) 100%)":"linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, rgba(0, 0, 0, 0.60) 100%)"},children:[x&&e.jsxs("div",{className:"absolute top-0 left-0 p-5 w-full h-full flex flex-col justify-center items-center space-y-1 rounded-xl",children:[e.jsx(fr,{component:ya,size:"4xl",color:"static"}),e.jsx(Ul,{size:"lg",color:"static",children:c("workshop.nsfw_bot_text")}),e.jsx(Ul,{size:"sm",className:"opacity-60 text-center",color:"static",children:c("workshop.nsfw_gallery_user_content")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex-1 flex justify-start items-center space-x-1.5 max-w-[70%]",children:[e.jsx($o,{size:"xs",src:ns(t.authInfo.avatar)}),e.jsx(Ul,{size:"sm",className:"w-full",weight:"medium",color:"static",lineClamp:1,children:o?t.authInfo.name:fn(t.authInfo.name,10)})]}),e.jsx("div",{className:"flex-shrink-0 space-x-1 flex justify-end items-center"})]})]}),b===t.authInfo.userId&&_&&e.jsx("div",{className:"absolute z-20 top-2 right-2 p-2 rounded-full bg-beta-black-20 h-9 w-9 flex justify-center items-center",style:{backdropFilter:"blur(12px)"},onClick:e=>{e.stopPropagation(),e.preventDefault(),f(!0)},children:e.jsx(fr,{component:an,color:"static"})})]}),e.jsx(Mr,{open:u,onClose:()=>{m(!1)},onOpenChange:e=>{!e&&m(!1)},overlayClassName:"z-[90]",contentClassName:"w-[90%] max-w-[1197px] h-[calc(100vh-64px)] max-h-[836px] overflow-hidden rounded-2xl z-[100] bg-transparent",fullScreen:!0,overlayClose:!1,children:e.jsx("div",{className:"relative overflow-hidden w-full h-full rounded-2xl",children:e.jsx("div",{className:"w-full h-full relative overflow-hidden",children:e.jsx(yu,{item:t,botId:t.botId,galleryId:t.id,deleteCallback:()=>{m(!1),null==l||l(t.id)},followCallback:r})})})}),e.jsx(Rd,{open:p,deleting:y,onClose:()=>f(!1),onConfirm:()=>(async()=>{C(!0),(await Pd(t.id)).success?(N({content:c("common.delete_success")}),C(!1),f(!1),null==l||l(t.id)):(T({content:c("common.delete_error")}),C(!1))})()})]})}function Su({isMobile:t}){return e.jsx("div",{className:"h-screen flex-1 flex items-center justify-center",children:e.jsx(di,{color:"brand"})})}function ju({userId:e,botId:t}){const s=Ad((e=>e.galleryList)),n=Ad((e=>e.setGalleryList)),l=Ad((e=>e.galleryUserList)),r=Ad((e=>e.setGalleryUserList)),[i,o]=a.useState(!1),[c,d]=a.useState(!1),[u,m]=a.useState("0"),p=a.useRef(0),[f,h]=a.useState(!1),[g,v]=a.useState(!1);return{loading:c,hasMore:i,nextPageToken:u,fetchError:f,fetchEmpty:g,getGalleryData:async a=>{if("0"!==a&&!1===i)return;d(!0);const c=await function({pageToken:e,pageSize:t=15,botId:s,userId:a}){return Os.post("/v1/bot/gallery/get_list",{body:Object.assign(Object.assign({listRequest:{pageToken:e,pageSize:t}},s&&{botId:s}),a&&{userId:a}),isGoLang:!0})}({pageToken:a,botId:t,userId:e});d(!1);const{data:u}=c;if(c.success){const t=Array.isArray(u.list)?u.list.filter((e=>!!e&&"object"==typeof e)):[];e?r("0"===a?t:[...l,...t]):n("0"===a?t:[...s,...t]),v("0"===a&&0===t.length),m(u.listResponse.nextPageToken),o(u.listResponse.hasMore),p.current+=1}else h(!1)}}}function Iu({className:t,userId:n,containerRef:l}){const r=s.useTranslations(),i=xl((e=>e.isMobile)),o=Ad((e=>e.galleryUserList)),c=Ad((e=>e.setGalleryUserList)),{fetchEmpty:d,fetchError:u,loading:m,getGalleryData:p,hasMore:f,nextPageToken:h}=ju({userId:n});a.useEffect((()=>{p("0")}),[]);const g=a.useCallback((()=>{if(l.current){const{scrollTop:e,scrollHeight:t,clientHeight:s}=l.current;e+s>=t-10&&p(h)}}),[h]);a.useEffect((()=>{const e=l.current;if(e)return e.addEventListener("scroll",g),()=>e.removeEventListener("scroll",g)}),[g]);return n?e.jsxs("div",{className:"px-2 md:px-3.5",children:[m&&0===o.length&&e.jsx(Su,{isMobile:i}),!u&&(null==o?void 0:o.length)>0?e.jsxs(Sd,{className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:[null==o?void 0:o.map(((t,s)=>e.jsx(Cu,{item:t,deleteCallback:e=>(e=>{const t=null==o?void 0:o.filter((t=>t.id!==e));c(t)})(e),followCallback:()=>{(e=>{const t=null==o?void 0:o.map((t=>{const s=t.authInfo.followStatus===exports.FollowStatus.FOLLOWED?exports.FollowStatus.NOT_FOLLOWED:exports.FollowStatus.FOLLOWED;return t.authInfo.userId===e&&(t.authInfo.followStatus=s),t}));c(t)})(t.authInfo.userId)},from:"profile"},t.id))),f&&m&&[...Array(15)].map(((t,s)=>{const a=500*Math.random();return e.jsx(Id,{style:{height:a<300?300:a}},s)}))]}):null,!m&&!u&&(d||0===o.length)&&e.jsxs("div",{className:"w-full h-full flex flex-col justify-center items-center px-10 space-y-3",children:[e.jsx(fr,{component:_d,size:"4xl",color:"subtlest"}),e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-1",children:[e.jsx(Dl,{size:"sm",color:"default",children:r("chat.no_content_yet")}),e.jsx(Ul,{size:"sm",color:"subtlest",children:r("chat.be_fist_publish")})]})]}),u&&e.jsx(Cd,{onClick:()=>{p("0")},className:"pt-20"})]}):null}const Ou=e=>{const t=Number(e);return t>1e3?`${(t/1e3).toFixed(1)}k`:t};function Au({user:t}){so();const a=s.useTranslations("profile");return t?e.jsxs("div",{className:"text-base flex items-center",children:[e.jsx("span",{className:"text-subtle mr-1",children:a("follower")}),e.jsx("span",{className:"text-default font-medium",children:Ou(null==t?void 0:t.fansCount)}),e.jsx("p",{className:"border-r mx-2 h-[16px]"}),e.jsx("span",{className:"text-subtle mr-1",children:a("following")}),e.jsx("span",{className:"text-default font-medium",children:Ou(null==t?void 0:t.followedCount)})]}):null}function Mu({widgetId:t}){const{warning:n}=Ql(),l=s.useTranslations("workshop"),{value:r,setTrue:i,setFalse:o}=h.useBoolean(!1),{value:c,setTrue:d,setFalse:u}=h.useBoolean(!1),[m,p]=a.useState(),f=a.useRef(null),g=async()=>{try{i();const{data:e,success:s}=await function(e){return Os.post("/v1/widget/chat/voice/trail",{body:{widgetId:e},isGoLang:!0,adapter:e=>e.voiceUrl})}(t);if(!s)return void n({content:l("tts_widget_trail_failed")});p(e)}catch(e){}finally{o()}};return e.jsxs(e.Fragment,{children:[e.jsx(Tr,{variant:"primary",color:"default",className:"w-7 h-7 px-1 min-w-7",onClick:async e=>{e.preventDefault(),c?f.current&&!f.current.paused&&(f.current.pause(),u()):(m||await g(),f.current&&f.current.paused&&f.current.play())},loading:r,children:c?e.jsx(Va,{className:"w-[14px] h-[14px] text-brand stroke-[2px]"}):e.jsx(qa,{className:"w-[14px] h-[14px] text-brand stroke-[2px]"})}),m&&e.jsx("audio",{ref:f,src:m,onError:()=>{n({content:l("tts_widget_trail_failed")}),p(void 0)},autoPlay:!0,onPlay:()=>{d()},onEnded:()=>{f.current&&u()}})]})}function Pu({iconUrl:t,label:s,link:a,hoverContent:n,showHoverableContent:l,className:r}){const i=()=>e.jsxs("div",{className:"flex gap-[2px] items-center",children:[t&&e.jsx("img",{src:t,alt:"tag emoji",className:"size-[14px]"}),e.jsx("span",{className:"text-xs text-default font-medium truncate line-clamp-1",children:s})]});return e.jsx("li",{className:pn("inline-block px-2 py-[3px] shrink-0 rounded-md bg-surface-accent-gray-subtler",r),children:a?e.jsx(Kr,{href:a,className:pn("w-full h-full"),children:e.jsx(i,{})}):e.jsx(e.Fragment,{children:l?e.jsx(Hl,{description:n,showArrow:!1,contentClassName:"max-w-80",triggerClassName:"inline",children:e.jsx(i,{})}):e.jsx(i,{})})})}function Lu({showHoverableContent:t=!1,hoverContent:s="",iconUrl:a,label:n,link:l,className:r}){return e.jsx(Pu,{iconUrl:a,link:l,label:n,hoverContent:s,showHoverableContent:t,className:r})}function ku({tags:t,beforeTag:s,tagLink:a,showCount:n}){return t.length?e.jsx("ul",{className:"w-full flex items-center flex-wrap",children:(null!=t?t:[]).slice(0,null!=n?n:(null!=t?t:[]).length).map((t=>{var s,n;return e.jsx(Lu,{showHoverableContent:null===(s=t.extra)||void 0===s?void 0:s.isShowHover,hoverContent:null===(n=t.extra)||void 0===n?void 0:n.hoverText,iconUrl:t.iconUrl,label:t.label,link:a&&t.seoId&&`${a}/${t.seoId}?filter=${t.seoId}`,className:"mr-1.5 mb-1.5"},t.id)}))}):null}function Ru(t){var n;const{item:l,isLine:r,showChat:i,size:o="default",className:c,linkClassName:u,inBox:m,showTags:p,setShowUserDetail:f,from:h,disableJumpToChat:g,onClick:v,dividerClassName:x}=t,{isMobile:b}=so(),E=s.useTranslations(),_=d.useRouter(),[w,T]=a.useMemo((()=>{var e;return[(null==l?void 0:l.buttonUrl)?`${null==l?void 0:l.buttonUrl}${(null===(e=null==l?void 0:l.buttonUrl)||void 0===e?void 0:e.includes("?"))?"&":"?"}${h?`from=${h}`:""}`:null==l?void 0:l.buttonUrl,(null==l?void 0:l.clickUrl)?`${null==l?void 0:l.clickUrl}${(null==l?void 0:l.clickUrl.includes("?"))?"&":"?"}${h?`from=${h}`:""}`:null==l?void 0:l.clickUrl]}),[null==l?void 0:l.buttonUrl,null==l?void 0:l.clickUrl,h]);return e.jsxs("div",{className:pn("normal-item w-full cursor-pointer rounded-xl overflow-hidden",c),onClick:v?()=>v(null==l?void 0:l.id):void 0,children:[e.jsxs(Kr,{className:pn("w-full px-0 md:px-2.5 flex flex-row justify-start items-center rounded-xl overflow-hidden","sm"===o?"h-18":"h-[88px]",!m&&"hover:bg-surface-container-hovered transition-all",u),href:g?"":`${i?w:T}`,children:[e.jsx($o,{size:"sm"===o?"xl":"4xl",src:null==l?void 0:l.logoUrl,alt:"avatar"}),e.jsx("div",{className:pn("w-[calc(100%-84px)] flex-1 flex flex-col justify-center items-start ml-3 text-sm","sm"===o?"h-[46px]":"h-[84px]"),children:e.jsxs("div",{className:pn("w-full",i||(null==l?void 0:l.showVoice)?"flex justify-center items-center":""),children:[e.jsxs("div",{className:pn("h-full flex-1 flex flex-col  text-sm space-y-0.5",(null==l?void 0:l.showVoice)?"min-w-0":"md:justify-between items-start"),children:[e.jsx(Ul,{size:"lg",weight:"medium",color:m?"static":"default",lineClamp:1,children:null==l?void 0:l.title}),p?e.jsx("div",{className:"flex gap-2",children:(null===(n=(null==l?void 0:l.tags)||[])||void 0===n?void 0:n.length)>0?e.jsx(ku,{tags:l.tags,showCount:4}):e.jsx("div",{className:"h-[22px]"})}):e.jsx(Ul,{size:"sm",weight:"regular",color:m?"static":"subtler",lineClamp:"sm"===o?1:2,className:pn("max-w-full break-words",m&&"text-beta-white-80"),style:{wordBreak:"break-word"},dangerous:!0,children:(null==l?void 0:l.description)||E("bot.no_desc")}),l.authorName&&l.authorNameTag&&e.jsxs(Fl,{size:"lg",weight:"medium",lineClamp:1,className:pn("text-brand max-w-full break-words hover:underline"),style:{wordBreak:"break-word"},onClick:e=>{if(e.stopPropagation(),e.preventDefault(),b){const e=`${window.location.origin}/explore/profile/${encodeURIComponent(`${l.authorName}`)}/${encodeURIComponent(`${l.authorNameTag}`)}`;_.push(e)}else"function"==typeof f&&f({name:encodeURIComponent(`${l.authorName}`),nameTag:encodeURIComponent(`${l.authorNameTag}`)})},children:["@",l.authorName]})]}),i&&(null==l?void 0:l.buttonTitle)&&(null==l?void 0:l.buttonUrl)&&e.jsx(Tr,{variant:"static",size:"sm",children:null==l?void 0:l.buttonTitle}),(null==l?void 0:l.showVoice)&&e.jsx("div",{className:"flex-shrink-0 ml-2",children:e.jsx(Mu,{widgetId:l.id})})]})})]}),r&&e.jsx("div",{className:pn("pl-4","sm"===o?"ml-12":"ml-[72px]"),children:e.jsx("hr",{className:pn("w-full border-t-0 border-b border-default mt-2",x)})})]},`normal-item-${null==l?void 0:l.id}`)}function Du({customClass:t,children:s,animate:a=!0}){return e.jsx("div",{className:pn("bg-surface-container-hovered",t,a&&"animate-pulse "),children:s})}function Uu({className:t,size:s="default"}){return e.jsxs("div",{className:pn("w-full px-0 md:px-2.5 flex flex-row justify-start items-center rounded-xl overflow-hidden",t,"sm"===s?"h-18":"h-[88px]"),children:[e.jsx(Du,{customClass:pn("flex-shrink-0 rounded-2xl mr-3","sm"===s?"h-[48px] w-[48px]":"h-18 w-18")}),e.jsxs("div",{className:"flex justify-center flex-col w-full space-y-1",children:["default"===s&&e.jsx(Du,{customClass:"w-[60%] h-[16px] rounded"}),e.jsx(Du,{customClass:"w-full h-[16px] rounded"}),e.jsx(Du,{customClass:pn("h-[16px] rounded","default"===s?"w-[20%]":"w-[35%]")})]})]})}function Fu({bots:t,loading:a,disableJumpToChat:n,onBotClick:l,selectedBotId:r,from:i,containerClassName:o,itemBoxClassName:c,itemLinkClassName:d,itemDividerClassName:u}){var m;const p=s.useTranslations("profile"),f=(null==t?void 0:t.map((e=>({title:e.name,description:e.description,logoUrl:e.logoUrl,id:e.id,clickUrl:`/chat/${e.id}`,clickMobileUrl:`/chat/${e.id}`,type:"BOT"}))))||[];return e.jsx(e.Fragment,{children:a&&0===t.length?e.jsx("div",{className:pn("grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",o),children:null===(m=Array(4).fill(1))||void 0===m?void 0:m.map(((t,s)=>e.jsx(Uu,{size:"sm"},`bots-skeleton-${s}`)))}):e.jsx("div",{className:pn("grid grid-cols-1 gap-x-4 gap-y-2",(null==t?void 0:t.length)>0?"md:grid-cols-2":"",o),children:(null==f?void 0:f.length)>0?e.jsx(e.Fragment,{children:null==f?void 0:f.map(((s,a)=>e.jsx(Ru,{className:c,linkClassName:d,dividerClassName:pn(r===s.id?"border-brand":"",u),from:i||"Aipp Launch",size:"sm",item:s,isLine:!0,disableJumpToChat:n,onClick:()=>{const e=t.find((({id:e})=>e===s.id));e&&(null==l||l(e))}},`bots-common-item-${a}`)))}):e.jsx("div",{className:"text-default h-[120px] flex justify-center items-center",children:p("no_public_bots")},"no_public_bots")})})}const Bu=t=>e.jsxs(u.Icon,Object.assign({viewBox:"0 0 24 24",fill:"none"},t,{children:[e.jsx("path",{d:"M12 9C9.92893 9 8.25 10.6789 8.25 12.75C8.25 14.8211 9.92893 16.5 12 16.5C14.0711 16.5 15.75 14.8211 15.75 12.75C15.75 10.6789 14.0711 9 12 9Z",fill:"currentColor"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.34429 3.07113C10.2236 3.02391 11.109 3 12 3C12.891 3 13.7764 3.02391 14.6557 3.07113C15.6233 3.12309 16.4854 3.65612 16.9882 4.46184L17.8094 5.77786C18.0485 6.16099 18.4544 6.42131 18.9195 6.48741C19.3049 6.54218 19.6888 6.60145 20.0713 6.66518C21.5031 6.90378 22.5 8.15785 22.5 9.57403V18C22.5 19.6569 21.1569 21 19.5 21H4.5C2.84315 21 1.5 19.6569 1.5 18V9.57402C1.5 8.15784 2.49686 6.90377 3.92872 6.66517C4.31116 6.60144 4.6951 6.54217 5.08048 6.4874C5.54556 6.42131 5.95152 6.16099 6.19061 5.77785L7.01181 4.46184C7.5146 3.65612 8.37667 3.12309 9.34429 3.07113ZM6.75 12.75C6.75 9.8505 9.1005 7.5 12 7.5C14.8995 7.5 17.25 9.8505 17.25 12.75C17.25 15.6495 14.8995 18 12 18C9.1005 18 6.75 15.6495 6.75 12.75ZM18.75 11.25C19.1642 11.25 19.5 10.9142 19.5 10.5C19.5 10.0858 19.1642 9.75 18.75 9.75C18.3358 9.75 18 10.0858 18 10.5C18 10.9142 18.3358 11.25 18.75 11.25Z",fill:"currentColor"})]}));var Gu,zu,Yu,Hu,Vu;!function(e){e.BOT_STATUS_UNSPECIFIED="BOT_STATUS_UNSPECIFIED",e.Public="Public",e.Active="Active",e.Inactive="Inactive"}(Gu||(Gu={})),function(e){e.Pending="pending",e.Processing="processing",e.Failed="failed",e.Done="done"}(zu||(zu={})),function(e){e.BACKGROUND="BACKGROUND",e.OTHER="OTHER"}(Yu||(Yu={})),function(e){e.BOT_CHAT_MODEL_CATEGORY_UNSPECIFIED="BOT_CHAT_MODEL_CATEGORY_UNSPECIFIED",e.BOT_CHAT_MODEL_CATEGORY_CLOSESOURCE="BOT_CHAT_MODEL_CATEGORY_CLOSESOURCE",e.BOT_CHAT_MODEL_CATEGORY_OPENSOURCE="BOT_CHAT_MODEL_CATEGORY_OPENSOURCE",e.BOT_CHAT_MODEL_CATEGORY_SELFDEVELOP="BOT_CHAT_MODEL_CATEGORY_SELFDEVELOP"}(Hu||(Hu={})),function(e){e.BOT_CHAT_MODEL_STATUS_UNSPECIFIED="BOT_CHAT_MODEL_STATUS_UNSPECIFIED",e.BOT_CHAT_MODEL_STATUS_ACTIVE="BOT_CHAT_MODEL_STATUS_ACTIVE",e.BOT_CHAT_MODEL_STATUS_INVISIBLE="BOT_CHAT_MODEL_STATUS_INVISIBLE",e.BOT_CHAT_MODEL_STATUS_DISABLE="BOT_CHAT_MODEL_STATUS_DISABLE"}(Vu||(Vu={}));const $u=e=>"jpg"===e?"image/jpeg":`image/${e}`;function Wu({type:t,file:n,open:l,onClose:r}){var i,o,c;const d=to(),[m,p]=a.useState(!1),[f,h]=a.useState(""),[g,v]=a.useState(1),[x,E]=a.useState(1),_=a.createRef(),w=a.createRef(),T=s.useTranslations("common"),[N,y]=a.useState(0),[C,S]=a.useState(0),j=a.useMemo((()=>{if(0===C||0===N)return null;let e,t;d?(e=320,t=540):(e=720,t=480);const s=N/C;let a=N,n=C;return(a>e||n>t)&&(s>e/t?(a=e,n=a/s):(n=t,a=n*s)),{width:a,height:n}}),[C,N,d]),I=a.useMemo((()=>3*(x||1)),[x]),O=a.useMemo((()=>(x||1)/10),[x]),A=null!==(c=null===(o=null===(i=n.name)||void 0===i?void 0:i.split("."))||void 0===o?void 0:o.pop())&&void 0!==c?c:"png",{warning:M}=Ql();a.useEffect((()=>{const e=new FileReader;e.onload=()=>{const t=e.result;h(t)},e.readAsDataURL(n)}),[n]);const P=a.useCallback((async()=>{var e;p(!0);try{const t=null===(e=w.current)||void 0===e?void 0:e.cropper.getCroppedCanvas().toDataURL("image/jpeg",.6);fetch(t).then((e=>e.blob())).then((e=>{const t=new File([e],`${b.uniqueId()}-cropped-image.${A}`,{type:$u(A)});return async function(e,t,s){var a;const n=null!==(a=rl[(t.startsWith(".")?t.substring(1):t).toUpperCase()])&&void 0!==a?a:rl.ALL,l=await ul({scenario:e,contentType:n,fileName:dl(s.name),contentLength:String(s.size)});return(await fetch(l.data.uploadUrl,{method:"PUT",headers:{Expires:l.data.expiresAt,"Content-Type":l.data.contentType},body:s})).ok?l.data:{objectKey:"",objectAccessUrl:""}}(ll.SCENARIO_USER_BACKGROUND,A,t)})).then((e=>(r(!0,e),e))).catch((()=>{M({content:"Upload Failed!"}),r(!1)})).finally((()=>{p(!1)}))}catch(e){return null}}),[w,A,r,t,M]),L=a.useCallback((()=>{const e=_.current;if(e){const{naturalHeight:t,naturalWidth:s}=e.cropper.getCanvasData();y(s),S(t)}}),[_]),k=a.useCallback((()=>{const e=w.current;if(e){const{height:t,naturalHeight:s}=e.cropper.getCanvasData(),a=t/s;v(a),E(a)}}),[w]),R=e=>{v(e);const t=w.current;t&&t.cropper.zoomTo(e)};return e.jsxs(u.Modal,{closeOnEsc:!1,closeOnOverlayClick:!1,isOpen:l,onClose:()=>r(!1),isCentered:!0,children:[e.jsx(u.ModalOverlay,{}),e.jsxs(u.ModalContent,{w:"auto",maxW:"auto",maxH:"auto",className:"bg-surface-container-default",borderRadius:"24px",color:"#141718",p:0,children:[e.jsxs(u.ModalHeader,{display:"flex",className:"relative",p:4,children:[e.jsxs(u.Flex,{w:"full",justifyContent:"space-between",alignItems:"center",children:[e.jsx(u.Center,{w:"36px",h:"36px",cursor:"pointer",onClick:()=>r(!1),children:e.jsx(Ws,{className:"w-[24px] h-[24px] stroke-icon"})}),e.jsx(u.Text,{className:"flex-grow leading-loose text-default",fontSize:"18px",lineHeight:"28px",fontWeight:"600",children:T("cover_pic")})]}),e.jsx(u.Button,{ml:4,variant:"ghost",p:"8px 16px",h:"36px",className:"bg-surface-primary-default",_hover:{background:"var(--surface-primary-default)"},minW:"65px",rounded:"full",color:"#fff",onClick:P,isLoading:m,children:T("save")})]}),e.jsxs(u.ModalBody,{p:0,children:[e.jsx(u.Center,{bgColor:"#F5F7FA",children:e.jsxs(u.Box,{position:"relative",overflow:"hidden",w:"fit-content",h:"fit-content",children:[j&&e.jsx(wt.default,{className:"min-w-[200px] min-h-[200px]",style:j,ref:w,src:f,viewMode:1,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,cropBoxResizable:!1,cropBoxMovable:!1,checkOrientation:!0,guides:!0,dragMode:"move",modal:!1,autoCropArea:1,zoomOnWheel:!1,zoomOnTouch:!1,ready:k,aspectRatio:t===Yu.BACKGROUND?5:1}),e.jsx(wt.default,{className:"hidden w-[100px] h-[100px]",ref:_,src:f,ready:L})]})}),e.jsxs(u.Flex,{p:4,className:"space-x-3",children:[e.jsx(Pa,{className:"w-5 h-5 cursor-pointer stroke-icon",onClick:()=>{let e=g-O;e<x&&(e=x),R(e)}}),e.jsxs(u.Slider,{"aria-label":"slider-ex-1",value:g,min:x||1,max:I,step:O,onChange:e=>R(e),children:[e.jsx(u.SliderTrack,{bg:"var(--border)",height:"6px",children:e.jsx(u.SliderFilledTrack,{bg:"var(--surface-primary-default)"})}),e.jsx(u.SliderThumb,{bg:"var(--surface-primary-default)",width:"18px",height:"18px"})]}),e.jsx(ka,{className:"w-5 h-5 cursor-pointer  stroke-icon",onClick:()=>{let e=g+O;e>I&&(e=I),R(e)}})]})]})]})]})}const Ku=["png","jpeg","jpg"];function qu({bgPhoto:t,onActionSuccess:n,loading:l,className:r,showUpload:i=!1}){const o=a.useRef(null),[c,d]=a.useState(),[m,p]=a.useState(!1),{warning:f}=Ql(),h=s.useTranslations("common");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Ge.default("w-full relative",r||"h-[120px] md:max-h-[190px] md:h-[12.2vw]"),children:[l?e.jsx(Ye.default,{alt:"user detail background image",src:_t.default,fill:!0,priority:!0,className:"object-cover"}):e.jsx(Ye.default,{alt:"user detail background image",src:t||_t.default,fill:!0,priority:!0,className:"object-cover"}),i&&e.jsx(u.Center,{position:"absolute",w:"full",h:"full",children:e.jsxs("label",{children:[e.jsx(u.Box,{p:"8px 12px",bgColor:"white",boxShadow:"0px 1px 0px 0px rgba(0, 0, 0, 0.05)",rounded:"full",cursor:"pointer",children:e.jsx(Bu,{color:"var(--surface-primary-default)",fontSize:"20px"})}),e.jsx("span",{className:"hidden",children:"选择图片上传"}),e.jsx("input",{ref:o,type:"file",className:"hidden",accept:"image/png, image/jpeg",onChange:e=>{const t=e.target.files[0];if(t){const e=ds(t.name);if(!Ku.some((t=>t===e)))return void f({content:h("unsupported_img_file_type")});if(t.size>5242880)return void f({content:h("image_up_to_5m")});t.size>2097152?new Et.default(t,{quality:.6,success(e){d(e),p(!0)},error(e){d(t),p(!0)}}):(d(t),p(!0))}o.current&&(o.current.value="")},disabled:l})]})})]}),m&&e.jsx(Wu,{type:Yu.BACKGROUND,file:c,open:m,onClose:(e=!1,t)=>{console.log("onClose",t),p(!1),d(void 0),e&&n&&t&&n(null==t?void 0:t.objectKey)}})]})}function Qu({user:t}){const a=s.useTranslations("profile");return e.jsx("span",{className:Ge.default("flex-shrink-0 h-6 leading-6 px-[10px] bg-[#EBE1FF] rounded-lg text-xs text-[#391C79] font-bold",t&&(t.isGenesisPasscard||(null==t?void 0:t.isPasscard))?"bg-[#FFF2E2] text-[#FDA500] dark:bg-[#4F3E2C] dark:text-[#FFC453]":2===(null==t?void 0:t.level)?"bg-[#E0E5FF] text-[#3E5CFA] dark:bg-[#2C334F] dark:text-[#5974FF]":"bg-[#EDEEEF] text-[#414345] dark:bg-[#42434A] dark:text-[#B8BCCF]"),children:t&&(t.isGenesisPasscard||(null==t?void 0:t.isPasscard))?a("genesis"):2===(null==t?void 0:t.level)?a("standard"):a("basic")})}const Xu=()=>{const e=Ur((e=>e.setInviteLink)),t=Ur((e=>e.setUserInviteCode)),s=Ur((e=>e.setInvitationCount)),n=Ur((e=>e.setValidInvitationCount)),l=Ur((e=>e.setTgValidInvitationCount)),r=Ur((e=>e.isLogin)),i=a.useMemo((()=>new q.Subject),[]),[o,c]=a.useState(!1),d=async()=>{c(!0);const a=await Os.post("/v1/user/invitation/get_invitation",{isGoLang:!0});if(a.success){const{code:r,invitationCount:i,validInvitationCount:o,tgValidInvitationCount:c}=a.data;s(i),n(o),l(c),t(r),e(`${window.location.origin}/invite/${r}`)}c(!1)};return a.useEffect((()=>{r&&d()}),[i,r,n,t,e]),{invitationLoading:o}};function Ju(t){const[s,n]=a.useState(!1),[l,r]=a.useState(""),{onCopy:i}=ui(l),o=hi();Xu();const c=Ur((e=>e.inviteCode)),{userName:d,nameTag:u,userId:m}=t;return e.jsx("button",{className:"bg-white rounded-full border border-[#E4E9F0] w-9 h-9 cursor-pointer shadow-button-basic flex justify-center items-center disabled:opacity-70 disabled:cursor-not-allowed",onClick:()=>{if(!d)return;n(!0);let e="";u&&(e=`${ls()?window.location.origin:""}/explore/profile/${encodeURIComponent(d)}?nametag=${encodeURIComponent(u)}${c&&`&invite=${c}`}`,r(e),i(e)),o&&o.track&&(null==o||o.track("ShareItem",{item_type:"creator",item_id:m,item_name:d})),n(!1)},disabled:s,children:s?e.jsx(di,{size:"sm",className:"text-brand"}):e.jsx(Zs,{className:"w-5 h-[22px] text-[#202223]"})})}function Zu({showMore:t=!0,desc:n=""}){const l=n.replace(/^\n+|\n+$/g,"");const r=s.useTranslations("common"),[i,o]=c.useToggle(!1),d=a.useRef(null),[u,m]=a.useState(!1),p=!xl((e=>e.isMobile));a.useEffect((()=>{const e=()=>{if(o(!1),d.current){const e=parseInt(window.getComputedStyle(d.current).lineHeight),t=p?2*e:3*e;m(d.current.scrollHeight>t)}};return e(),window.addEventListener("resize",b.throttle(e,500)),()=>{window.removeEventListener("resize",e)}}),[p,l]);return l?e.jsx("div",{className:"text-sm flex flex-col w-full whitespace-pre-line",children:e.jsxs("div",{className:"relative w-full flex flex-col gap-1",children:[e.jsx("p",{ref:d,className:Ge.default("text-subtler leading-[1.5]",u&&!i&&"line-clamp-3 md:line-clamp-2"),style:{maxHeight:i?"none":p?"3rem":"4.5rem"},children:l}),u&&t&&e.jsx(Ul,{className:"px-0.5 text-brand cursor-pointer",weight:"medium",size:"sm",onClick:()=>o(!i),children:r(i?"show_less":"show_more")})]})}):null}function em({showSimplifyTags:t=!1,widgets:a,pinnedCallback:n,onClose:l,setShowUserDetail:r}){const i=s.useTranslations("workshop"),o=(null==a?void 0:a.map((e=>({title:e.name,description:e.description,logoUrl:e.logoUrl,id:e.id,clickUrl:`/robot-workshop/widget/${e.id}`,clickMobileUrl:`/robot-workshop/widget/${e.id}`,showVoice:e.chatCallerType===el.WIDGET_CHAT_CALLER_TYPE_VOICE,type:"WIDGET",tags:e.tags}))))||[];return o.length?e.jsx("div",{className:pn("grid grid-cols-1 gap-x-4 gap-y-2",o.length>0?"md:grid-cols-2":""),children:o.map(((t,s)=>e.jsx(Ru,{size:"sm",showTags:!0,item:t,isLine:!0},t.id)))}):e.jsx("div",{className:"text-default h-[120px] flex justify-center items-center",children:i("no_widgets_available")})}function tm({showInsideScroller:t=!1,detailData:n,showTopActions:l=!1,defaultTab:r="bots",onClose:i,followCallback:o}){const c=d.useSearchParams().get("from"),[u,m]=a.useState(!1),[p,f]=a.useState("gallery"===c?"gallery":r),[h,g]=a.useState(null),[v,x]=a.useState(),[b,E]=a.useState(),_=s.useTranslations(),w=s.useTranslations("bot"),T=s.useTranslations("workshop"),{isMobile:N}=so(),y=Ad((e=>e.setGalleryUserList)),C=a.useCallback((async()=>{var e,t;try{if(null==n?void 0:n.id){m(!0);const[s,a]=await Promise.all([(t=null==n?void 0:n.id,Os.post("/v1/bot/list_user_public_bots",{body:{userId:t},isGoLang:!0,adapter:e=>{var t;return(null!==(t=null==e?void 0:e.bots)&&void 0!==t?t:[]).map((e=>{var t,s,a,n,l,r,i,o;const{lastMessage:c={},latestInteractionDateUnix:d,canEditBot:u,inChatList:m,photos:p,pinned:f,summary:h={},setting:g={},unreadMessageCount:v,visitorCanChat:x,widgets:b}=e,E=h||{},{backgroundImageThemeHexColors:_}=E,w=Ds(E,["backgroundImageThemeHexColors"]);return Object.assign(Object.assign({canEditBot:u,pinned:f,inChatList:m,photos:p,official:null==h?void 0:h.isOfficial,nsfw:null===(t=null==h?void 0:h.tagList)||void 0===t?void 0:t.some((e=>"1800000000000000019"===e.id)),userId:Number((null===(s=null==h?void 0:h.author)||void 0===s?void 0:s.id)||0),lastMessage:c?Object.assign(Object.assign({},c),{createdDate:Number(null==c?void 0:c.createdDateUnix),updatedDate:Number(null==c?void 0:c.updatedDateUnix)}):null},w||{}),{createdDate:null==h?void 0:h.createdDateUnix,updatedDate:null==h?void 0:h.updatedDateUnix,botSetting:g,language:null!==(n=null===(a=null==h?void 0:h.language)||void 0===a?void 0:a.name)&&void 0!==n?n:"English",unreadMessageCount:v,privateBotId:Number((null==h?void 0:h.privateBotId)||0),lastInteractionDate:Number(d||0),schemes:null!==(l=null==_?void 0:_.schemes)&&void 0!==l?l:null,visitorCanChat:x,isImageBot:"BOT_GEN_TYPE_IMAGE"===(null==h?void 0:h.botGenType)||"BOT_GEN_TYPE_GIF"===(null==h?void 0:h.botGenType),membershipChatConfig:null!==(r=null==h?void 0:h.membershipChatConfig)&&void 0!==r?r:{},stakingDisabled:null==h?void 0:h.stakingDisabled,isPanelImageBot:"BOT_CHAT_PANEL_TYPE_COMPONENT"===(null==h?void 0:h.chatPanelType),isComponentBot:"BOT_CHAT_PANEL_TYPE_COMPONENT"===(null==h?void 0:h.chatPanelType),imComponent:Object.assign(Object.assign({},null==h?void 0:h.imComponent),{componentsInput:null===(o=null===(i=null==h?void 0:h.imComponent)||void 0===i?void 0:i.componentsInput)||void 0===o?void 0:o.map((e=>{var t,s;let a="",n="",l=[];const r={};let i=[];switch(e.type){case"BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD":a="upload",i=e.supportedFileTypes;break;case"BOT_IM_COMPONENT_INPUT_TYPE_AUDIO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_AUDIO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_VIDEO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_IMAGE_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_TEXT_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT":a="textarea",n=e.stringDefault;break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR":a="select",n=e.textSelectorDefault,l=null===(t=e.textSelectorAllOf)||void 0===t?void 0:t.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT":a=e.hasNumberLimitation?"numberSlider":"numberInput",n=e.numberDefault,r.maxLength=e.numberMax,r.minLength=e.numberMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT":a=e.hasIntegerLimitation?"interSlider":"interInput",n=e.integerDefault,r.maxLength=e.integerMax,r.minLength=e.integerMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX":a="checkbox",n=e.booleanDefault;break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR":a="numberSelect",n=e.numberSelectorDefault,l=null===(s=e.numberSelectorAllOf)||void 0===s?void 0:s.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_CODE_EDITOR":a="codeEditor",n=e.stringDefault}return Object.assign(Object.assign({},e),{id:e.fieldName,serverType:e.type,props:r,rules:r,type:a,defaultValue:n,options:l,supportedFileTypes:i})}))}),widgets:b})}))}})),Bs(null==n?void 0:n.id)]);E(s.data),x(null===(e=a.data)||void 0===e?void 0:e.widgets),m(!1)}}catch(e){console.error(e),m(!1)}}),[null==n?void 0:n.id]);a.useEffect((()=>{if(!u)return C(),()=>{y([])}}),[null==n?void 0:n.id]);const S=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`UserDetail ${t?"overflow-hidden h-full md:overflow-auto":"h-full overflow-hidden"} flex w-full flex-col flex-nowrap bg-surface-container-default text-default relative md:rounded-4xl`,children:[l&&e.jsx(e.Fragment,{children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Ge.default("absolute top-[10px] md:top-5 flex z-10 space-x-3 left-5"),children:e.jsx("div",{className:"bg-white rounded-full border border-[#E4E9F0] w-9 h-9 cursor-pointer shadow-button-basic flex justify-center items-center",onClick:i,children:e.jsx(Nd,{className:"w-[22px] h-[22px] text-[#202223]"})})}),e.jsx("div",{className:Ge.default("absolute top-[10px] md:top-5 flex z-10 space-x-3 right-5"),children:e.jsx(Ju,{userName:null==n?void 0:n.name,nameTag:null==n?void 0:n.nameTag,userId:null==n?void 0:n.id})})]}):e.jsxs("div",{className:Ge.default("absolute top-[10px] md:top-5 flex z-10 space-x-3",N?"left-4":"right-5"),children:[e.jsx(Ju,{userName:null==n?void 0:n.name,nameTag:null==n?void 0:n.nameTag,userId:null==n?void 0:n.id}),e.jsx("div",{className:"bg-white rounded-full border border-[#E4E9F0] w-9 h-9 cursor-pointer shadow-button-basic flex justify-center items-center",onClick:i,children:e.jsx(on,{className:"w-[22px] h-[22px] text-[#202223]"})})]})}),e.jsx("div",{ref:S,className:Ge.default("flex flex-col flex-grow items-center relative overflow-auto"),children:e.jsxs("div",{className:"flex flex-col w-full h-full pb-[8px] md:h-full md:pb-[12px]",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(qu,{bgPhoto:ns(null==n?void 0:n.backgroundUrl),showUpload:!1}),e.jsxs("div",{className:"relative flex space-x-3 md:space-x-5",children:[e.jsx(yd,{logoUrl:ns(null==n?void 0:n.avatar)}),!N&&e.jsxs("div",{className:"grow flex items-end justify-between pr-6 pb-1",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 pr-1.5 pb-1",children:[e.jsx("span",{className:Ge.default("text-2xl md:text-[28px] md:leading-[36px] font-semibold text-default line-clamp-1 break-all"),children:null==n?void 0:n.name}),e.jsx(Qu,{user:n})]}),e.jsx(Au,{user:n})]}),((null==n?void 0:n.followStatus)===exports.FollowStatus.FOLLOWED||(null==n?void 0:n.followStatus)===exports.FollowStatus.NOT_FOLLOWED)&&e.jsx(bu,{detailData:n,followCallback:o})]}),N&&((null==n?void 0:n.followStatus)===exports.FollowStatus.FOLLOWED||(null==n?void 0:n.followStatus)===exports.FollowStatus.NOT_FOLLOWED)&&e.jsx("div",{className:"absolute right-0 top-0 px-4 py-3",children:e.jsx(bu,{detailData:n,size:"md",followCallback:o,className:"min-w-[76px]"})})]})]}),N&&e.jsxs("div",{className:"flex flex-col px-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 pr-1.5 pb-1",children:[e.jsx("span",{className:Ge.default("text-2xl md:text-[28px] md:leading-[36px] font-semibold text-default line-clamp-1 break-all"),children:null==n?void 0:n.name}),e.jsx(Qu,{user:n})]}),e.jsx(Au,{user:n})]}),(null==n?void 0:n.description)&&e.jsx("div",{className:"px-2 ml-6",children:e.jsx(Zu,{desc:null==n?void 0:n.description})}),e.jsxs("div",{className:Ge.default("flex-1 pt-[6px] md:pb-5 flex flex-col space-y-4 mt-2 md:mt-5 ","gallery"===p?"":"md:px-6"),children:[e.jsx("div",{className:Ge.default("sticky bg-surface-container-default top-0 z-[2] md:relative md:bg-inherit md:z-auto mx-4 md:mx-2","gallery"===p?"md:px-6":""),children:e.jsx("div",{className:"flex justify-between items-center border-b border-default",children:e.jsx("div",{className:"flex space-x-2 items-center",children:e.jsxs("div",{className:"flex space-x-6 items-center",children:[e.jsx("div",{className:Ge.default("cursor-pointer relative z-[1] font-[500] text-sm md:text-base text-center","bots"===p?"pb-[5px] border-b-[2px] border-brand text-brand":"pb-[7px] text-subtle"),onClick:()=>f("bots"),children:w("robot")}),e.jsx("div",{className:Ge.default("cursor-pointer relative z-[1] font-[500] text-sm md:text-base text-center","widgets"===p?"pb-[5px] border-b-[2px] border-brand text-brand":"pb-[7px] text-subtle"),onClick:()=>f("widgets"),children:T("widget")}),e.jsx("div",{className:Ge.default("cursor-pointer relative z-[1] font-[500] text-sm md:text-base text-center","gallery"===p?"pb-[5px] border-b-[2px] border-brand text-brand":"pb-[7px] text-subtle"),onClick:()=>f("gallery"),children:_("chat.gallery")})]})})})}),"bots"===p&&e.jsx("div",{className:"mx-4 md:mx-0",children:e.jsx(Fu,{bots:b||[],onClose:i,loading:u})}),"widgets"===p&&e.jsx("div",{className:"mx-4 md:mx-0",children:e.jsx(em,{widgets:null!=v?v:[],pinnedCallback:()=>{C()},onClose:i,setShowUserDetail:g})}),"gallery"===p&&e.jsx(Iu,{userId:null==n?void 0:n.id,containerRef:S})]})]})})]}),!N&&!!(null==h?void 0:h.name)&&e.jsx(sm,{isOpen:!!(null==h?void 0:h.name),onClose:()=>{i&&i(),g(null)},userName:h.name,nameTag:h.nameTag})]})}function sm({isOpen:t,onClose:n,detailData:l,userName:r,nameTag:i,defaultTab:o}){const[c,d]=a.useState(l),[m,p]=a.useState(!1),{isMobile:f}=so(),h=s.useTranslations("profile"),g=s.useTranslations("common"),v=xl((e=>e.isOpenLoginModal)),x=async()=>{const e=await Us({name:r,nameTag:i});e.success?(d(e.data),p(!1)):p(!0)};a.useEffect((()=>{!(null==l?void 0:l.id)&&r&&i&&x()}),[r,i]);const b=()=>{x()};return m?e.jsx(Mr,{open:t,onClose:n,contentClassName:"w-[90%] md:w-[380px] p-4 z-[120]",overlayClassName:"z-[120]",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center bg-[#CCD4FF] dark:bg-[#2C334F] border-[6px] border-[#F2F4FE] dark:border-[#292C38] flex-shrink-0 ",children:e.jsx(Dt,{className:"w-6 h-6 stroke-surface-primary-default"})}),e.jsxs("div",{className:"flex flex-col space-y-2 text-default",children:[e.jsx("h2",{className:"text-xl text-default",children:h("user_not_found_title")}),e.jsx(u.Text,{fontSize:"14px",lineHeight:"20px",className:"text-subtle",children:h("user_not_found_content")})]}),e.jsx(u.Button,{variant:"unstyled",boxShadow:"0px -1px 0px 0px rgba(0, 0, 0, 0.20) inset, 0px 1px 0px 0px rgba(0, 0, 0, 0.08)",color:"white",rounded:"full",display:"flex",justifyContent:"center",alignItems:"center",className:"mt-4 w-full bg-surface-primary-default h-[44px] outline-none px-6 py-2.5 font-bold",_loading:{_hover:{bgColor:"#3E5CFA"}},onClick:n,children:g("confirm")})]})}):c?e.jsx(Mr,{open:!v&&t,onClose:n,contentClassName:pn("overflow-hidden shadow bg-transparent",f?"w-full h-full":"w-[80vw] max-w-[880px] min-h-[418px] h-[90vh] max-h-[800px] rounded-4xl"),children:e.jsx(tm,{detailData:c,showInsideScroller:!0,showTopActions:!0,onClose:n,followCallback:b,defaultTab:o})}):null}function am({publishing:t,open:n,publishState:l,onClose:r,onConfirm:i}){const o=s.useTranslations(),c=wd(),d=Ur((e=>e.user)),u=xl((e=>e.isMobile)),[m,p]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Mr,{overlayClose:!t,hideClose:t,open:n,onClose:r,onConfirm:()=>{"success"===l&&d?u?c.openUrl(`/m/explore/profile/${encodeURIComponent(d.name)}/${encodeURIComponent(d.nameTag)}?from=gallery`):(p(!0),r()):i()},state:l||"info",confirmText:o("success"===l?"chat.go_to_profile":"workshop.publish"),isNotification:!0,title:o("success"===l?"chat.publish_success":"chat.user_tips"),description:o("success"===l?"chat.publish_success_content":"chat.publish_tip_content"),confirmLoading:t,overlayClassName:"z-[110]",contentClassName:"z-[110]"}),m&&e.jsx(sm,{isOpen:m,onClose:()=>p(!1),userName:null==d?void 0:d.name,nameTag:null==d?void 0:d.nameTag,defaultTab:"gallery"})]})}function nm(){const t=hi(),n=s.useTranslations(),{type:l,entityInfo:r}=a.useContext(jt),{editorMode:i,setEditorMode:o,publish:d}=a.useContext(At),{id:u}=r,{everPublished:m,selectedImg:p,clearImg:f,publishing:h,batchPublishToGallery:g}=d||{},[v,x]=a.useState("info"),[b,E]=c.useBoolean(!1),{isMobile:_}=so(),{success:w}=Ql(),T=a.useCallback((()=>{var e;if("bot"===l){const s={bot_id:u,file_url:JSON.stringify([...null!==(e=null==p?void 0:p.values())&&void 0!==e?e:[]])};null==t||t.track("Chat_Publish_Gallery",s)}"info"!==v||m?(null==x||x("info"),E(!1),null==o||o("NORMAL")):null==x||x("success")}),[v,m,x,w,n,o]),N=a.useCallback((()=>{var e;"success"===v?(null==x||x("info"),E(!1)):null==g||g([...null!==(e=null==p?void 0:p.values())&&void 0!==e?e:[]],T)}),[v,x,g,p,T]);return e.jsxs(e.Fragment,{children:["PUBLISH"===i&&e.jsx("div",{className:"w-full z-10 border-t border-default",children:e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:Ge.default("relative chat-share bg-surface-default w-full flex justify-center items-center flex-col",_?" h-[116px]":"h-[108px] px-24"),children:[e.jsx(Kl,{variant:"primary",icon:_d,size:_?"sm":"lg",onClick:()=>{var e;(null==p?void 0:p.size)&&(m?null==g||g([...null!==(e=null==p?void 0:p.values())&&void 0!==e?e:[]],T):E(!0))},color:"default",className:"rounded-xl",loading:h,disabled:!(null==p?void 0:p.size)}),e.jsx("span",{className:"text-default mt-1.5",children:n("chat.publish_to_gallery")})]}),!_&&e.jsx(Kl,{variant:"ghost",icon:on,size:"md",onClick:()=>(null==o||o("NORMAL"),void(null==f||f())),color:"default",className:"absolute top-4 right-6"})]})}),e.jsx(am,{publishing:null!=h&&h,publishState:null!=v?v:"info",open:b,onClose:()=>{E(!1),"success"===v&&(null==o||o("NORMAL"),null==x||x("info"))},onConfirm:N})]})}async function lm(e){const t=document.createElement("a");t.href=`https://twitter.com/intent/tweet?url=${encodeURIComponent(e+"?utm_channel=referral&utm_source=x")}&text=@myshell_ai`,t.target="_blank",t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),document.body.removeChild(t)}let rm="",im=[];function om(){a.useContext(jt);const{setEditorMode:n,share:l}=a.useContext(At),{idSet:r,clear:i}=l||{},o=s.useTranslations("common"),{isMobile:c}=so(),{success:d,warning:m}=Ql(),[p,f]=a.useState(!1),[h,g]=a.useState(""),v=s.useTranslations("chat");async function x(e){!async function(e){"clipboard"in navigator?await navigator.clipboard.writeText(e):document.execCommand("copy",!0,e),d({content:o("copied")})}(e+"?utm_channel=referral&utm_source=share")}const b=a.useCallback((async(e,t,s)=>{var a;if(0!==(null==r?void 0:r.size)){f(!0);try{const l=[...null!=r?r:[]].sort();if(im.toString()!==l.toString()){const e=await(n=l,Os.post("/v1/bot/shared/generate_message_shared_code",{body:{messageIds:n},isGoLang:!0}));rm=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.code,im=l}const i=`${window.location.origin}/share/${rm}`,o=`${t}/api/image?url=${encodeURIComponent(`${i}?from=download`)}&ratio=1.5&type=png`,c="object"==typeof s&&s.isDownload;await e(c?o:i,c?s.botName:"")}finally{f(!1),g("")}var n}else m({content:o("select_chat")})}),[o,r,m]);return e.jsxs("div",{className:Ge.default("flex justify-center w-full relative bg-surface-default",c?"py-4":"py-4 px-[92ox]"),children:[e.jsxs("ul",{className:Ge.default("flex items-center justify-around",c?"w-full":"gap-20"),children:[e.jsx("li",{children:e.jsxs(u.Button,{variant:"unstyled",display:"flex",flexDirection:"column",alignItems:"center",gap:2,minW:"66px",h:"fit-content",className:"group",onClick:async function(){g("link"),await b(x)},isDisabled:p&&"link"===h,_disabled:{opacity:.3,cursor:"not-allowed"},children:[e.jsx("div",{className:"flex justify-center items-center w-[40px] h-[40px] border border-default rounded-xl",children:p&&"link"===h?e.jsx(u.Spinner,{color:"var(--text-brand)"}):e.jsx(Aa,{className:"text-icon-brand w-6 h-6"})}),e.jsx("span",{className:"text-sm font-normal",children:v("copy_link")})]})}),e.jsx("li",{children:e.jsxs(u.Button,{variant:"unstyled",display:"flex",flexDirection:"column",alignItems:"center",gap:2,minW:"66px",h:"fit-content",className:"group",onClick:async function(){g("twitter"),await b(lm)},isDisabled:p&&"link"===h,_disabled:{opacity:.3,cursor:"not-allowed"},children:[e.jsx("div",{className:"flex justify-center items-center w-[40px] h-[40px] border border-default rounded-xl",children:p&&"twitter"===h?e.jsx(u.Spinner,{color:"var(--text-brand)"}):e.jsx(t.TwitterIcon,{className:"text-icon-brand stroke-[1.5px] w-6 h-6"})}),e.jsx("span",{className:"text-sm font-normal",children:v("twitter")})]})})]}),!c&&e.jsx(Kl,{icon:on,size:"md",variant:"ghost",color:"gray",className:"absolute top-1/2 -translate-y-1/2 right-[92px] z-10 cursor-pointer",onClick:()=>{null==n||n("NORMAL"),null==i||i()}})]})}function cm(){return e.jsx("div",{className:"w-full h-full flex justify-center items-center bg-surface-default",children:e.jsx(di,{color:"brand"})})}const dm=ze.default((()=>Promise.resolve().then((function(){return Vh}))),{loading:()=>e.jsx(cm,{}),ssr:!1}),um=ze.default((()=>Promise.resolve().then((function(){return $h}))),{ssr:!1});const mm=52428800,pm={AUDIO:{".mp3":"audio/mpeg",".wav":"audio/wav",".ogg":"audio/ogg",".wma":"audio/x-ms-wma",".flac":"audio/flac",".ape":"audio/ape"},VIDEO:{".mp4":"video/mp4",".avi":"video/x-msvideo",".mov":"video/quicktime",".wmv":"video/x-ms-wmv",".flv":"video/x-flv"},APPLICATION:{".rtf":"application/rtf",".md":"text/markdown",".markdown":"text/markdown",".pdf":"application/pdf",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".doc":"application/msword",".txt":"text/plain",".csv":"text/csv"},IMAGE:{".apng":"image/apng",".png":"image/png",".jpeg":"image/jpeg",".jpg":"image/jpg",".gif":"image/gif",".bmp":"image/bmp",".tiff":"image/tiff",".tif":"image/tiff",".heic":"image/heic"},ALL:{"*":"*/*"}},fm=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pm.AUDIO),pm.VIDEO),pm.APPLICATION),pm.IMAGE),pm.ALL),hm={md:{icon:"other",type:"Markdown File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"},markdown:{icon:"other",type:"Markdown File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"},pdf:{icon:"PDF",type:"PDF",bg:"#EA3434",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/PDF.svg"},docx:{icon:"W",type:"Word File",bg:"#2684FF",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Word.svg"},doc:{icon:"W",type:"Word File",bg:"#2684FF",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Word.svg"},txt:{icon:"T",type:"TXT",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/TXT.svg"},csv:{icon:"CSV",type:"CSV",bg:"#079455",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2024053011/embed_icon/CSV.svg"},other:{icon:"other",type:"Rich Text File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"}},gm=Object.fromEntries(Object.entries(Me).map((([e,t])=>[t,e]))),vm=async e=>{const t=(s=e.file,URL.createObjectURL(s));var s;return"IMAGE"===e.uiData.mimeType?(async e=>new Promise(((t,s)=>{const a=new Image;a.onload=()=>{t({width:a.width,height:a.height}),URL.revokeObjectURL(e)},a.onerror=()=>{s(new Error("Failed to load image.")),URL.revokeObjectURL(e)},a.src=e})))(t):"VIDEO"===e.uiData.mimeType?(async e=>new Promise(((t,s)=>{const a=document.createElement("video");a.onloadedmetadata=()=>{t({width:a.videoWidth,height:a.videoHeight}),URL.revokeObjectURL(e)},a.onerror=()=>{s(new Error("Failed to load video.")),URL.revokeObjectURL(e)},a.src=e})))(t):null},xm=async e=>{const t=e.map((e=>{const t=(e=>{const t=e.name.split("."),s=t[t.length-1].toLowerCase(),a=`.${s}`,n=(e.type||fm[a]).split("/")[0].toUpperCase(),l=hm[s]||hm.other,r=s.toUpperCase();return Object.assign({mimeType:n,orginalMIMEType:e.type,contentType:rl[r],name:e.name,ex:s,serverType:"TEXT"===n?Me.APPLICATION:Me[n]},l)})(e);return{file:e,id:os(),type:null==t?void 0:t.serverType,uiData:t,status:"PENDING"}})).map((async e=>{try{const t=await vm(e);return Object.assign(Object.assign({},e),{mediaFileMetadata:Object.assign(Object.assign({},t||{}),{thumbnail:""})})}catch(t){return console.error(t),e}}));return await Promise.all(t)},bm=e=>{const t=Object.entries(pm).find((([t,s])=>s[e.toLowerCase()]));return t?Me[t[0]]:Me.ALL};function Em(e,t=2){if(0===e)return"0 Bytes";const s=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/1024**a).toFixed(s))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}`}const _m=a.createContext({clickFn:async()=>{},msgId:""}),wm=e=>{document.cookie=`NEXT_LOCALE=${e}; max-age=31536000; path=/`};function Tm(){const e=Ur((e=>e.language)),t=Ur((e=>e.setLanguage)),s=Ur((e=>e.userSettingsInfo)),n=Ur((e=>e.setUserSettingsInfo)),l=Ur((e=>e.setShowNsfw)),r=Ur((e=>e.isLogin)),{locale:i}=so(),o=d.useRouter(),c={en:"en",zh:"zh","zh-CN":"zh","zh-TW":"zh-tw",ja:"jp",es:"es",ru:"ru",ko:"ko"},u=a.useCallback((async(e=!0,s)=>{const a=await Os.post("/v1/user/get_user_settings",{isGoLang:!0,adapter:e=>e.settings});if(a.success){const{data:r}=a;if(n(a.data),r.length>0&&r.some((e=>e.name===Ut.SHOW_NSFW))){const e=r.filter((e=>e.name===Ut.SHOW_NSFW))[0].value;l("1"===e?Bt.OPEN:Bt.CLOSE)}else l(Bt.CLOSE);const d=((navigator.language||"").split("-")[0]||"").toLowerCase();let u=i||c[d]||"";const{lang:m}=document.documentElement;u&&Gt.includes(u)||(u="en");let p="";r.length>0&&r.some((e=>e.name===Ut.LANGUAGE))&&(p=r.filter((e=>e.name===Ut.LANGUAGE))[0].value),e&&p&&u!==p?(u=p,wm(p),e&&o.refresh()):e&&u!==m&&o.refresh(),t(u),s&&s()}}),[n,r]),m=a.useCallback((async e=>{var t;await q.lastValueFrom((t=e,Ps("/user/updateLanguage",{language:t}))),u()}),[u]),p=a.useCallback((async(e,t,s)=>{(await Gs(e)).success&&(t?u(!0,s):s&&s())}),[Gs]),f=a.useCallback(((e,t)=>{p([{name:Ut.FLAG_ICON_REWARD,value:"1"},{name:Ut.LAST_SEASON,value:e}],!0,t)}),[u]),h=a.useCallback(((e,t)=>{p([{name:Ut.FLAG_ICON_FORUM,value:"1"},{name:Ut.LAST_SEASON,value:e}],!0,t)}),[u]),g=a.useCallback((e=>{p([{name:Ut.FLAG_USET_FIRST_PUBLISH_GALLERY,value:"1"}],!0,e)}),[u]),v=a.useCallback((e=>{p([{name:Ut.FLAG_USET_FIRST_VISIT_GALLERY,value:"1"}],!0,e)}),[u]),x=a.useCallback(((e,t)=>{p([{name:Ut.FLAG_TAG_NOTICE,value:"1"}],!0,t)}),[u]),b=a.useCallback((()=>{p({name:Ut.FLAG_LLM_MODEL_CONFIG,value:"1"},!0)}),[u]),E=a.useCallback(((e,t)=>{p({name:Ut.SHOW_NSFW,value:e?"1":"0"},!1,(()=>{l(e?Bt.OPEN:Bt.CLOSE),null==t||t()}))}),[]),_=a.useCallback((e=>{p({name:Ut.FLAG_NSFW_CONFIRMED,value:"1"},!0,e)}),[u]),w=a.useCallback((e=>{p({name:Ut.FLAG_COMPLETED_OPBNB_CHAIN_TASK,value:"1"},!0,e)}),[u]),T=a.useCallback((e=>{p({name:Ut.FLAG_SILENT_PERIOD_CONFIRMED,value:e},!0)}),[u]),N=a.useCallback((e=>{p({name:Ut.DEDUCTION_CONFIRMED,value:e},!0)}),[u]),y=a.useCallback((e=>{p({name:Ut.FLAG_stake_earn_VIEWED,value:"1"},!0,e)}),[u]),C=a.useCallback((e=>{p({name:Ut.FLAG_SHARE_KEY_EARN_POPUP_CONFIRMED,value:e},!0)}),[u]),S=a.useCallback((e=>{p({name:Ut.TIME_ZONE,value:e},!0)}),[p]),j=a.useCallback((async(e,t)=>{await p({name:Ut.NOTIFICATION,value:e?"1":"0"},!0,t)}),[p]);return{userSettingsInfo:s,handleGetUserSettings:u,handleUpdateLanguage:m,currentLanguage:e,handleUpdateRewardsCenterVisited:f,handleUpdateForumCenterVisited:h,handleUpdateFirstPublishGallery:g,handleUpdateFirstVisitGallery:v,handleUpdateFlagTagNoticeVisited:x,handleModelConfigClicked:b,handleShowNsfw:E,handleNsfwConfirmed:_,handleBlockChainGuruTaskOnceCompleted:w,handleSilentPeriodConfirmed:T,handleDeductionConfirmed:N,handleSubscribingEarnViewed:y,handleShareKeyEarnPopupConfirmed:C,handleTimezoneChange:S,handleReceiveNotification:j}}function Nm(){const e=Hn((e=>e.multiPublishMap)),t=Hn((e=>e.clearMultiPublishMap)),n=Hn((e=>e.setHasUnRead)),l=s.useTranslations(),[r,i]=a.useState(!1),{success:o,warning:c,error:d}=Ql(),{handleUpdateFirstPublishGallery:u}=Tm(),{getEnergyInfo:m}=Fr(),{selectedBot:p}=a.useContext(_m),f=hi(),h=Ur((e=>e.flagUserFirstPublishGallery)),g=async e=>{var t,s,a;const l=await function(e){return Os.post("/v1/bot/gallery/check_gallery_update",{body:{botIds:[e]},isGoLang:!0})}(e);l.success&&n((null===(a=null===(s=null===(t=l.data)||void 0===t?void 0:t.info)||void 0===s?void 0:s[0])||void 0===a?void 0:a.hasUpdate)||!1)},v=async(e,s)=>{try{i(!0);const a=await function(e){const t=e.map((e=>Md(e,["botId"])));return Os.post("/v1/bot/gallery/publish",{body:{list:t},hideErrorToast:!0,isGoLang:!0})}(e);if(a.success){h||(o({content:l("chat.suc_send")}),u()),t();const a=setTimeout((()=>{(null==e?void 0:e[0].botId)&&g(e[0].botId),m(),clearTimeout(a)}),3e3);null==s||s()}else d({content:"ERROR_REASON_BAD_REQUEST_ERROR"===a.reason&&a.msg||l("chat.faild_send")});f.track("PublishGallery",{bot_id:e[0].botId,bot_name:null==p?void 0:p.name,picture_number:e.length,result:a.success})}catch(e){d({content:l("chat.faild_send")})}finally{i(!1)}};return{publishing:r,publishGalleryList:async(t,s)=>{const a=Object.keys(e).map((t=>e[t]));v(s||a,t)},checkGalleryUpdateHandle:g}}function ym({publishing:t,open:n,publishState:l,onClose:r,onConfirm:i}){const o=s.useTranslations(),c=wd(),d=Ur((e=>e.user)),u=xl((e=>e.isMobile)),[m,p]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Mr,{overlayClose:!t,hideClose:t,open:n,onClose:r,onConfirm:()=>{"success"===l&&d?u?c.openUrl(`/m/explore/profile/${encodeURIComponent(d.name)}/${encodeURIComponent(d.nameTag)}?from=gallery`):(p(!0),r()):i()},state:l||"info",confirmText:o("success"===l?"chat.go_to_profile":"workshop.publish"),isNotification:!0,title:o("success"===l?"chat.publish_success":"chat.user_tips"),description:o("success"===l?"chat.publish_success_content":"chat.publish_tip_content"),confirmLoading:t,overlayClassName:"z-[110]",contentClassName:"z-[110]"}),m&&e.jsx(sm,{isOpen:m,onClose:()=>p(!1),userName:null==d?void 0:d.name,nameTag:null==d?void 0:d.nameTag,defaultTab:"gallery"})]})}const Cm=ze.default((()=>Promise.resolve().then((function(){return Qh}))),{ssr:!1}),Sm=ze.default((()=>Promise.resolve().then((function(){return ag}))),{ssr:!1});function jm({imgVideoList:t,activeIndex:n,open:l,isGreeting:r,onClose:i}){const{isMobile:o}=No(),[c,d]=a.useState(null),[u,m]=a.useState("info"),{publishing:p,publishGalleryList:f}=Nm(),h=s.useTranslations(),{msgId:g,selectedBot:v}=a.useContext(_m),x=Ur((e=>e.flagUserFirstPublishGallery)),b=a.useCallback((e=>{var s,a;const n=t[e],l={botId:`${null==v?void 0:v.id}`,imageLink:n.url,messageId:g,naturalHeight:(null===(s=n.mediaFileMetadata)||void 0===s?void 0:s.height)||0,naturalWidth:(null===(a=n.mediaFileMetadata)||void 0===a?void 0:a.width)||0};x?f(_,[l]):d(l)}),[f,v,g,x]),{success:E}=Ql(),_=a.useCallback((()=>{"info"!==u||x?(E({content:h("chat.suc_send")}),m("info"),d(null),i()):m("success")}),[d,x,u]),w=a.useCallback((()=>{"success"===u?(d(null),i()):c&&f(_,[c])}),[u,f,_]);return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(Mr,{open:l,onClose:i,contentClassName:"w-full h-full max-h-none p-0 rounded-none bg-beta-black-10",hideClose:!0,children:e.jsx("div",{className:"overflow-hidden p-0",children:o?e.jsx(Cm,{imgVideoList:t,activeIndex:n,onClose:i,publishGalleryHandle:b,publishing:p,isGreeting:r}):e.jsx(Sm,{imgVideoList:t,activeIndex:n,onClose:i,publishGalleryHandle:b,publishing:p,isGreeting:r})})}),e.jsx(ym,{open:!!(null==c?void 0:c.botId),onClose:()=>{d(null),"success"===u&&i()},onConfirm:w,publishState:u,publishing:p})]})}var Im=Object.freeze({__proto__:null,default:jm});const Om=a.createContext({actions:[],displayMode:"NORMAL",setDisplayMode:()=>{},latest:!1,totalMessages:1,isTextDisplayException:!1}),Am=()=>a.useContext(Om),Mm=t=>{var s,n,l,r,i,o,d,u,m,p,f,h;const{message:g,latest:v,children:x}=t,b=Ur((e=>e.energy)),{chatSetting:E,type:_,entityInfo:w,entitySetting:T,messageShareAvailable:N=!0,feedbackAvailable:y=!0,globalContextMenuDisabled:C}=a.useContext(jt),{id:S}=w,{exceptionsForTextDisplay:j,messageList:I}=a.useContext(At),O=(null!==(n=null===(s=null==g?void 0:g.regeneratedMessages)||void 0===s?void 0:s.length)&&void 0!==n?n:0)+1,[A,M]=a.useState((null!==(r=null===(l=null==g?void 0:g.regeneratedMessages)||void 0===l?void 0:l.length)&&void 0!==r?r:0)+1),P=c.usePrevious(A),L=a.useMemo((()=>{var e;return(null!==(e=null==j?void 0:j[`${_}-${S}`])&&void 0!==e?e:[]).includes(null==g?void 0:g.id)}),[j,S,null==g?void 0:g.id,_]),k=a.useMemo((()=>{var e;return 1===O||A===O?g:null===(e=null==g?void 0:g.regeneratedMessages)||void 0===e?void 0:e.at(-(null!=A?A:1))}),[A,g,O]),R=a.useMemo((()=>{if(null==g?void 0:g.replyId){return I.find((e=>e.id===g.replyId))}}),[null==g?void 0:g.replyId,I]),D=C||!("DONE"===(null==g?void 0:g.status)&&((null===(i=null==g?void 0:g.asyncJobInfo)||void 0===i?void 0:i.jobId)?(null===(o=null==g?void 0:g.asyncJobInfo)||void 0===o?void 0:o.status)===_e.DONE:!(null===(d=null==g?void 0:g.imageGenMessageResponse)||void 0===d?void 0:d.jobId)||(null===(u=null==g?void 0:g.imageGenMessageResponse)||void 0===u?void 0:u.genStatus)===Ie.DONE)||"CANCELED"===(null==g?void 0:g.status)&&"PENDING_FOR_RESPONSE"!==(null==g?void 0:g.type)||"PROCESSING"===(null==g?void 0:g.status)&&("TEXT"===g.type||"VOICE"===g.type||"BUTTON_INTERACTION"===g.type)),U=a.useMemo((()=>{var e,t,s,a,n,l,r,i,o,c,d,u;const m="OTHER"===(null==g?void 0:g.source)&&y?[Se.Feedback]:[],p="OTHER"===(null==g?void 0:g.source)&&("DONE"===(null==g?void 0:g.status)||"CANCELED"===(null==g?void 0:g.status))&&v&&(null===(e=null==g?void 0:g.extraInfo)||void 0===e?void 0:e.canEdit)&&A===O&&(null===(t=null==E?void 0:E.isTranscriptionOn)||void 0===t||t||(null!==(s=null==j?void 0:j[`${_}-${S}`])&&void 0!==s?s:[]).includes(null==g?void 0:g.id))?[Se.Edit]:[],f="OTHER"===(null==g?void 0:g.source)&&v&&("DONE"===(null==g?void 0:g.status)||"CANCELED"===(null==g?void 0:g.status))&&(null===(a=null==g?void 0:g.extraInfo)||void 0===a?void 0:a.canRegenerate)&&b>=(null===(n=null==g?void 0:g.extraInfo)||void 0===n?void 0:n.consumeEnergy)&&R?[Se.Regenerate]:[],h=null===(l=null==E?void 0:E.isTranscriptionOn)||void 0===l||l||!(null==E?void 0:E.isTranscriptionOn)&&(null!==(r=null==j?void 0:j[`${_}-${S}`])&&void 0!==r?r:[]).includes(null==g?void 0:g.id)?[Se.Copy_Message]:[],x=null===(i=null==E?void 0:E.isTranscriptionOn)||void 0===i||i||!(null==E?void 0:E.isTranscriptionOn)&&(null!==(o=null==j?void 0:j[`${_}-${S}`])&&void 0!==o?o:[]).includes(null==g?void 0:g.id)?[Se.Select_Text]:[],w=N?[Se.Share]:[],C=(null==T?void 0:T.outputVoice)&&(null==E?void 0:E.isAudioOn)&&(null==g?void 0:g.audioUrl)?[Se.Download_Voice]:[],I="OTHER"!==(null==g?void 0:g.source)||null===(c=null==E?void 0:E.isTranscriptionOn)||void 0===c||c||(null!==(d=null==j?void 0:j[`${_}-${S}`])&&void 0!==d?d:[]).includes(null==g?void 0:g.id)?[]:[Se.Show_Text],M="OTHER"===(null==g?void 0:g.source)&&null!==(u=null==E?void 0:E.isTranslationOn)&&void 0!==u&&u?[Se.Translate]:[],P=[Se.Delete];return[...m,...m.length?[Se.Divider]:[],...h,...x,...p,...f,...C,...h.length+C.length>0?[Se.Divider]:[],...I,...M,...w,...I.length+M.length+w.length>0?[Se.Divider]:[],...P]}),[null==E?void 0:E.isAudioOn,null==E?void 0:E.isTranscriptionOn,null==E?void 0:E.isTranslationOn,A,b,null==T?void 0:T.outputVoice,j,y,S,v,null==g?void 0:g.audioUrl,null===(m=null==g?void 0:g.extraInfo)||void 0===m?void 0:m.canEdit,null===(p=null==g?void 0:g.extraInfo)||void 0===p?void 0:p.canRegenerate,null===(f=null==g?void 0:g.extraInfo)||void 0===f?void 0:f.consumeEnergy,null==g?void 0:g.id,null==g?void 0:g.source,null==g?void 0:g.status,N,R,O,_]),[F,B]=a.useState("NORMAL"),[G,z]=a.useState("info"),[Y,H]=c.useBoolean(!1),[V,$]=a.useState(void 0),[W,K]=c.useBoolean(!1),[q,Q]=c.useBoolean(!1),[X,J]=a.useState(0),Z=a.useMemo((()=>({message:g,displayMessage:k,contextMenuDisabled:D,actions:U,displayMode:F,setDisplayMode:B,latest:v,publishState:G,setPublishState:z,popupConfirmItem:V,setPopupConfirmItem:$,popupConfirmVisible:Y,setPopupConfirmVisible:H,deleteConfirming:W,setDeleteConfirming:K,selectTextVisible:q,setSelectTextVisible:Q,audioPlayProgress:X,setAudioPlayProgress:J,replyOriginMessage:R,totalMessages:O,currentMessageIndex:A,prevMessageIndex:P,setCurrentMessageIndex:M,isTextDisplayException:L})),[X,D,U,k,A,W,F,L,v,g,V,Y,P,G,R,q,K,H,Q,O]);return a.useEffect((()=>{var e,t;M((null!==(t=null===(e=null==g?void 0:g.regeneratedMessages)||void 0===e?void 0:e.length)&&void 0!==t?t:0)+1)}),[null===(h=null==g?void 0:g.regeneratedMessages)||void 0===h?void 0:h.length]),e.jsx(Om.Provider,{value:Z,children:x})},Pm=({loading:t})=>t?e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(di,{color:"brand"})}):null,Lm=`/chat/${Jt}`;function km(e,t,n){s.useTranslations("chat");const l=d.useRouter();a.useEffect((()=>{l.prefetch(Lm)}),[]);const r=xl((e=>e.toggleLoginModal)),i=()=>r(!0);return{onOpenLogin:i,onCreateRoom:()=>{l.push(Lm)},onLoginAndCreateRoom:()=>{l.push(Lm),requestAnimationFrame((()=>{i()}))},onMarked:async()=>{try{const{success:s}=await(t=e.id,Os.post("/v1/bot/chat/set_message_handled",{body:{msgId:t},isGoLang:!0}));s&&(null==n||n(e.id,{handled:!0}))}catch(e){console.error(e)}var t},onRemoveAndClearMemory:async()=>{try{const{success:s}=await Un(e.id);s&&(null==n||n(e.id,{handled:!0}),null==t||t())}catch(e){console.error(e)}}}}function Rm(){var t;const{clearMemory:n,partialUpdateMessage:l}=a.useContext(At),{message:r}=Am(),i=Ur((e=>e.isVisitor)),o=s.useTranslations("chat"),{onOpenLogin:c,onCreateRoom:d,onLoginAndCreateRoom:u,onMarked:m,onRemoveAndClearMemory:p}=km(r,n,l),f={ROOM_CLOSED:{text:o("room.room_close"),variant:"warning",textClassName:"w-full text-center"},OTHER_SIDE_LEFT:{text:o("room.other_side_left",{user:null==r?void 0:r.text}),buttons:[{children:i!==Ft.NO?o("room.login_to_create"):o("room.create"),color:"brand",onClick:i!==Ft.NO?u:d}],variant:"info"},OTHER_SIDE_NO_ENOUGH_ENERGY:{text:o("room.other_side_no_enough_energy"),buttons:[{children:o("login_register"),color:"warning",onClick:c}],variant:"warning"},PROMPT_UPDATED:{text:o("prompt_updated_tip"),buttons:[{children:o("clear"),color:"warning",onClick:p},{children:o("ignore"),color:"warning",variant:"outline",onClick:m}],variant:"warning"},RESET:{text:o("memory_cleared_tip"),variant:"info"}}[null==r?void 0:r.type];return e.jsx("div",{className:"w-full px-0 md:pl-[38px]",children:(null==r?void 0:r.customRender)?r.customRender:"INFO"===(null==r?void 0:r.msgDisplayType)?e.jsxs("div",{className:"w-full overflow-hidden flex gap-5 items-center",children:[e.jsx(br,{className:"grow inline-block w-auto"}),e.jsx(Ul,{className:"w-fit shrink-0",color:"subtle",size:"sm",children:(null==r?void 0:r.text)||f.text}),e.jsx(br,{className:"grow inline-block w-auto"})]}):e.jsxs(Hr,{variant:null==f?void 0:f.variant,className:"flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{className:null==f?void 0:f.textClassName,children:e.jsxs("div",{className:"flex gap-[6px]",children:["error"===(null==f?void 0:f.variant)?e.jsx(_a,{className:"hidden md:block shrink-0 size-6 text-icon-critical"}):e.jsx(Dt,{className:Ge.default("hidden md:block shrink-0 size-6","info"===(null==f?void 0:f.variant)?"text-icon-brand":"text-icon-warning")}),e.jsx(Ul,{children:null==f?void 0:f.text})]})}),(null===(t=null==f?void 0:f.buttons)||void 0===t?void 0:t.length)?e.jsx("div",{className:"w-full gap-x-2 md:w-auto flex justify-center self-end lg:self-auto",children:f.buttons.map(((t,s)=>e.jsx(Tr,{className:"w-full px-4 flex-1 md:w-full",color:t.color,size:"md",variant:t.variant,onClick:null==t?void 0:t.onClick,children:null==t?void 0:t.children},s)))}):null]})})}function Dm({doc:t}){const s=a.useRef(null),n=h.useHover(s),{downloading:l,onDownload:r}=gu();return e.jsxs("div",{className:"flex items-center space-x-3 px-3 rounded-xl border border-default bg-surface-search-field h-[58px] w-full max-w-full overflow-hidden relative",ref:s,children:[e.jsx(Ye.default,{src:t.iconUrl,alt:"file type",width:36,height:36,className:"rounded-[10.8px] overflow-hidden w-9 h-9 shrink-0"}),e.jsxs("div",{className:"flex flex-col space-y-[2px] grow overflow-hidden",children:[e.jsx("div",{className:"text-sm font-semibold text-default truncate",children:t.title}),e.jsx("span",{className:"text-xs text-subtle uppercase",children:t.extensionName})]}),e.jsx("div",{className:"w-[26px] h-10 shrink-0",children:n&&e.jsx(u.IconButton,{variant:"unstyled","aria-label":"download file",isLoading:l,onClick:()=>r(t.url,t.title),className:"p-1 min-w-fit text-subtle bg-surface-search-field",children:e.jsx(Ys,{className:"w-[18px] h-[18px] text-subtle cursor-pointer"})})})]})}var Um=a.memo((function({title:t,url:n}){const l=s.useTranslations("chat"),r=a.useRef(null),[i,o]=a.useState(0),[c,d]=a.useState(!1),[m,p]=a.useState(!1),[f,g]=a.useState(0),[v,x]=a.useState(!1),b=a.useRef(null),E=h.useHover(b),{downloading:_,onDownload:w}=gu(),T=a.useCallback((()=>{const e=r.current;i?e.paused?e.play().then((()=>{p(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)})):(null==e||e.pause(),p(!1)):(d(!0),null==e||e.load(),null==e||e.addEventListener("loadedmetadata",(()=>{(()=>{d(!1);const e=r.current;o(e.duration)})(),e.play().then((()=>{p(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)}))}),{once:!0}))}),[i]),N=()=>{const e=r.current;e&&(g(e.currentTime),e.paused||requestAnimationFrame(N))};return e.jsxs("div",{className:"p-3 rounded-xl border border-default bg-surface-search-field w-full max-w-full relative overflow-hidden",children:[e.jsxs("div",{className:"w-full flex flex-col space-y-2 text--default overflow-hidden",children:[v?e.jsxs("div",{className:"flex space-x-3 items-center min-h-[38px]",children:[e.jsx(ln,{className:"w-9 h-9 stroke-[#EC2F0D]"}),e.jsx("span",{className:"text-default",children:l("audio_cannot_load")})]}):e.jsxs("div",{className:"flex space-x-3 items-center w-full overflow-hidden",ref:b,children:[e.jsx(u.Button,{variant:"unstyled",onClick:T,borderRadius:"full","aria-label":"audio control button",isLoading:!n||c,isDisabled:!n||c,_disabled:{opacity:.3,cursor:"not-allowed"},size:"sm",spinner:e.jsx(di,{className:"text-brand",size:"md"}),className:"bg-[#ECEFFF] !flex !items-center !justify-center text-brand w-9 h-9 shrink-0",children:m?e.jsx(Ci,{className:"w-5 h-5"}):e.jsx(ji,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col space-y-[2px] grow overflow-hidden",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t}),e.jsx("span",{className:"text-xs text-subtle",children:cs(i?i<1?1:i:0)})]}),e.jsx("div",{className:"w-[26px] h-[26px] shrink-0",children:E&&e.jsx(u.IconButton,{variant:"unstyled","aria-label":"download file",isLoading:_,onClick:()=>w(n,t),className:"p-1 min-w-fit h-fit bg-surface-search-field",children:e.jsx(Ys,{className:"w-[18px] h-[18px] text-subtle cursor-pointer"})})})]}),e.jsxs("div",{className:"flex space-x-2 items-center pl-1",children:[e.jsxs(u.Slider,{flexGrow:1,min:0,max:i,value:f,onChangeStart:()=>{const e=r.current;e.paused||(null==e||e.pause(),p(!1))},onChange:e=>(e=>{const t=r.current;t.currentTime=e,g(t.currentTime)})(e),onChangeEnd:()=>{const e=r.current;e.paused&&e.play().then((()=>{p(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)}))},focusThumbOnChange:!1,isDisabled:!i,className:"flex items-center w-full h-6 cursor-pointer",children:[e.jsx(u.SliderTrack,{className:"bg-surface-container-selected-hovered h-[2px]",children:e.jsx(u.SliderFilledTrack,{className:"bg-[var(--text)]"})}),e.jsx(u.SliderThumb,{className:"bg-[var(--text)] w-[7px] h-[7px] rounded-full"})]}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(f)})]})]}),e.jsx("audio",{ref:r,src:n,onEnded:function(){var e;r.current&&(r.current.currentTime=0,null===(e=r.current)||void 0===e||e.pause(),p(!1)),g(0)},onTimeUpdate:N,onError:()=>{x(!0)},autoPlay:!1})]})}));var Fm=a.memo((function({title:t,url:n}){const l=s.useTranslations("chat"),r=a.useRef(null),[i,o]=a.useState(0),[c,d]=a.useState(!1),[m,p]=a.useState(0),[f,g]=a.useState(!1),v=a.useRef(null),x=h.useHover(v),{downloading:b,onDownload:E}=gu(),_=()=>{const e=r.current;e&&(p(e.currentTime),e.paused||requestAnimationFrame(_))};return e.jsxs("div",{className:"p-3 rounded-xl border border-default bg-surface-search-field w-full max-w-full relative overflow-hidden",children:[e.jsxs("div",{className:"w-full flex flex-col space-y-2 text-default overflow-hidden",children:[f?e.jsxs("div",{className:"flex space-x-3 items-center min-h-[38px]",children:[e.jsx(ln,{className:"w-9 h-9 stroke-[#EC2F0D]"}),e.jsx("span",{className:"text-default",children:l("audio_cannot_load")})]}):e.jsxs("div",{className:"flex space-x-3 items-center w-full overflow-hidden",ref:v,children:[e.jsx(u.Button,{variant:"unstyled",onClick:()=>{const e=r.current;e.paused?e.play().then((()=>{d(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)})):(null==e||e.pause(),d(!1))},borderRadius:"full","aria-label":"audio control button",isLoading:!n||!i,isDisabled:!n||!i,_disabled:{opacity:.3,cursor:"not-allowed"},size:"sm",spinner:e.jsx(di,{className:"text-brand",size:"md"}),className:"bg-[#ECEFFF] !flex !items-center !justify-center text-brand w-9 h-9 shrink-0",children:c?e.jsx(Ci,{className:"w-5 h-5"}):e.jsx(ji,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col space-y-[2px] grow overflow-hidden",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t}),e.jsx("span",{className:"text-xs text-subtle",children:cs(i?i<1?1:i:0)})]}),e.jsx("div",{className:"w-[26px] h-[26px] shrink-0",children:x&&e.jsx(u.IconButton,{variant:"unstyled","aria-label":"download file",isLoading:b,onClick:()=>E(n,t),className:"p-1 min-w-fit h-fit text-subtle bg-surface-search-field",children:e.jsx(Ys,{className:"w-[18px] h-[18px] text-subtle cursor-pointer"})})})]}),e.jsxs("div",{className:"flex space-x-2 items-center pl-1",children:[e.jsxs(u.Slider,{flexGrow:1,min:0,max:i,value:m,onChangeStart:()=>{const e=r.current;e.paused||(null==e||e.pause(),d(!1))},onChange:e=>(e=>{const t=r.current;t.currentTime=e,p(t.currentTime)})(e),onChangeEnd:()=>{const e=r.current;e.paused&&e.play().then((()=>{d(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)}))},focusThumbOnChange:!1,isDisabled:!i,className:"flex items-center w-full h-6 cursor-pointer",children:[e.jsx(u.SliderTrack,{className:"bg-surface-container-selected-hovered h-[2px]",children:e.jsx(u.SliderFilledTrack,{className:"bg-[var(--text)]"})}),e.jsx(u.SliderThumb,{className:"bg-[var(--text)] w-[7px] h-[7px] rounded-full"})]}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(m)})]})]}),e.jsx("audio",{ref:r,src:n,onLoadedData:()=>{const e=r.current;o(e.duration)},onEnded:function(){var e;r.current&&(r.current.currentTime=0,null===(e=r.current)||void 0===e||e.pause(),d(!1)),p(0)},onTimeUpdate:_,onError:()=>{g(!0)},autoPlay:!1})]})}));var Bm=a.memo((function(t){return function(){const e=$e.default();return e.apple.phone||e.apple.tablet||e.apple.ipod}()?e.jsx(Um,Object.assign({},t)):e.jsx(Fm,Object.assign({},t))})),Gm=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const zm=({className:t})=>e.jsx("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M2.25 6.375L5.25 9.375L9.75 2.625",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}),Ym=w.cva("peer w-5 h-5 shrink-0 border-[1.5px] border-pressed hover:border-depressed data-[state=checked]:border-surface-primary-default ring-offset-surface-default focus-visible:border-surface-primary-default focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 disabled:border-pressed disabled:cursor-not-allowed disabled:opacity-30 data-[state=checked]:bg-surface-primary-default data-[state=checked]:text-icon-static hover:data-[state=checked]:bg-surface-primary-hovered disabled:data-[state=checked]:text-disabled disabled:data-[state=checked]:border-none",{variants:{variant:{checkbox:"rounded-sm",circle:"rounded-full",radio:"rounded-full","circle-static":"rounded-full bg-beta-black-10 border-beta-white-100 hover:border-beta-white-100"}},defaultVariants:{variant:"checkbox"}}),Hm=Fe.forwardRef(((t,s)=>{var{className:a,variant:n,label:l}=t,r=Gm(t,["className","variant","label"]);return e.jsx(We.Root,Object.assign({ref:s,className:pn("rounded-sm overflow-hidden flex items-center justify-center text-current ",Ym({variant:n,className:a}))},r,{children:e.jsx(We.Indicator,{children:"radio"===n?e.jsx("div",{className:"w-2 h-2 bg-static rounded-full"}):e.jsx(zm,{className:"w-3 h-3"})})}))}));Hm.displayName=We.Root.displayName;const Vm=a.memo((function({url:t,imageModel:n,onViewImage:l,customClass:r,index:i}){const{message:o}=Am(),d=null==o?void 0:o.id,{imgGenerator:u,entityInfo:m}=a.useContext(jt),{editorMode:p,publish:f}=a.useContext(At),{id:h}=m,{selectedImg:g,everPublished:v,reachedLimitation:x,addImg:b,removeImg:E}=f||{},_=null==g?void 0:g.has(t),w=a.useRef(null),[T,N]=a.useState(!1),y=a.useRef(null),C=s.useTranslations(),S=xl((e=>e.isMobile)),j=()=>{N(!0)};c.useEffectOnce((()=>{const e=w.current;e&&e.addEventListener("load",j,{once:!0})}));const I=a.useCallback((()=>{var e,s;if(d&&h)if(null==g?void 0:g.has(t))null==E||E(t);else{if(x)return;null==b||b(t,{messageId:d,imageLink:t,naturalHeight:(null===(e=w.current)||void 0===e?void 0:e.naturalHeight)||0,naturalWidth:(null===(s=w.current)||void 0===s?void 0:s.naturalWidth)||0})}}),[d,h,g,t,E,x,b]);return e.jsxs("div",{className:Ge.default("relative w-full h-full",r),ref:y,children:[!T&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-[1] bg-[#00000033] backdrop-blur-2xl",children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",className:"text-white"})})}),e.jsx("img",{ref:w,alt:"image",src:t,width:1e3,height:1e3,className:Ge.default("w-full min-h-24 max-h-[301px] md:max-h-[536px] rounded-md cursor-pointer object-cover relative",r),onClick:e=>{"PUBLISH"===p?I():l()},"x-image-source":"embedObj","x-image-data":JSON.stringify({url:t,imageModel:n})}),"PUBLISH"===p&&(!x||x&&_)&&e.jsx("div",{className:"w-6 h-6 ml-0 flex justify-center items-center absolute right-3 top-3 z-[1]",children:e.jsx(Hm,{variant:"circle-static",checked:_,onCheckedChange:I})}),!v&&0===i&&u&&"PUBLISH"!==p&&"GREETING"!==(null==o?void 0:o.type)&&e.jsxs("div",{className:"absolute left-1 md:right-1 bottom-1 z-10 w-[150px] md:w-[220px] flex border-opaque rounded-lg bg-utility-sky-blue-500 py-2 pl-3 pr-5 text-wrap text-left",children:[e.jsx(Fl,{size:"lg",weight:"medium",color:"static",children:C(S?"chat.mob_publish_to_gallery":"chat.right_publish_to_gallery")}),e.jsx("span",{className:"absolute left-0 top-3 origin-center",style:{transformOrigin:"0px 0px",transform:"translateY(50%) rotate(90deg) translateX(-50%)"},children:e.jsx("svg",{className:"fill-utility-sky-blue-500 block",width:"10",height:"5",viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.jsx("polygon",{points:"0,0 30,0 15,10"})})})]})]})}));const $m=a.memo((function({url:t,onViewVideo:s,customClass:n,showPlayBtn:l=!0,showRadius:r=!0,showLoading:i=!0}){const o=a.useRef(null),[d,u]=a.useState(!1),m=()=>{u(!0)};return c.useEffectOnce((()=>{const e=o.current;e&&e.addEventListener("loadedmetadata",m,{once:!0})})),e.jsxs("div",{className:Ge.default("relative w-full h-full",n,r?"rounded-md overflow-hidden":""),children:[!d&&i&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-[1] bg-transparent backdrop-blur-2xl",children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})}),e.jsx("video",{ref:o,src:t,muted:!0,playsInline:!0,disablePictureInPicture:!0,className:"w-full h-full min-w-24 min-h-24 max-h-[301px] md:max-h-[536px] object-cover",preload:"metadata"}),l&&e.jsx("div",{className:"w-full h-full absolute top-0 left-0 flex justify-center items-center bg-transparent",children:e.jsx(ji,{className:"w-10 h-10 text-white cursor-pointer",onClick:()=>s&&s()})})]})})),Wm=ze.default((()=>Promise.resolve().then((function(){return rg}))),{ssr:!1}),Km=ze.default((()=>Promise.resolve().then((function(){return cg}))),{ssr:!1});function qm({imgVideoList:t,activeIndex:s,open:n,onClose:l}){var r,i;const o=hi(),{type:d,entityInfo:u}=a.useContext(jt),{id:m}=u,{message:p}=Am(),{publish:f}=a.useContext(At),{publishSingleImgToGallery:h,publishing:g,everPublished:v}=f||{},[x,b]=a.useState("info"),[E,_]=c.useBoolean(!1),w=a.useRef(),{isMobile:T}=No(),N=a.useCallback((()=>{var e,t;if("bot"===d){const s={bot_id:m,job_id:null===(e=null==p?void 0:p.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==p?void 0:p.id,file_url:null===(t=w.current)||void 0===t?void 0:t.imageLink};null==o||o.track("Chat_Publish_Gallery",s)}"info"!==x||v?(b("info"),_(!1),l()):b("success")}),[x,v,b,l]),y=a.useCallback((()=>{var e,t;if("success"===x){if("bot"===d){const s={bot_id:m,job_id:null===(e=null==p?void 0:p.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==p?void 0:p.id,file_url:null===(t=w.current)||void 0===t?void 0:t.imageLink};null==o||o.track("Chat_Publish_Gallery",s)}_(!1),l()}else w.current&&(null==h||h(w.current,N))}),[x,o,d,m,null===(r=null==p?void 0:p.asyncJobInfo)||void 0===r?void 0:r.jobId,null==p?void 0:p.id,l,h,N]),C=a.useCallback((e=>{var s,a,n,l;const r=t[e],i={imageLink:r.url,messageId:null!==(s=null==p?void 0:p.id)&&void 0!==s?s:"",naturalHeight:(null===(a=r.mediaFileMetadata)||void 0===a?void 0:a.height)||0,naturalWidth:(null===(n=r.mediaFileMetadata)||void 0===n?void 0:n.width)||0};if(v){if(null==h||h(i),"bot"===d){const e={bot_id:m,job_id:null===(l=null==p?void 0:p.asyncJobInfo)||void 0===l?void 0:l.jobId,message_id:null==p?void 0:p.id,file_url:r.url};null==o||o.track("Chat_Publish_Gallery",e)}}else _(!0),w.current=i}),[t,null==p?void 0:p.id,null===(i=null==p?void 0:p.asyncJobInfo)||void 0===i?void 0:i.jobId,v,h,N,o,d,m]);return t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Mr,{open:n,onClose:l,contentClassName:"w-full h-full max-h-none p-0 rounded-none bg-beta-black-10",hideClose:!0,children:e.jsx("div",{className:"overflow-hidden p-0",children:T?e.jsx(Wm,{imgVideoList:t,activeIndex:s,onClose:l,publishGalleryHandle:C,publishing:g}):e.jsx(Km,{imgVideoList:t,activeIndex:s,onClose:l,publishGalleryHandle:C,publishing:g})})}),e.jsx(ym,{open:E,onClose:()=>{_(!1),"success"===x&&l()},onConfirm:y,publishState:x,publishing:null!=g&&g})]})}const Qm=a.memo((function({type:t,url:s,imageModel:a,clickEvent:n,customClass:l,index:r}){return t===il.IMAGE?e.jsx(Vm,{url:s,imageModel:a,onViewImage:n,customClass:l,index:r}):e.jsx($m,{url:s,onViewVideo:n,customClass:l})})),Xm=a.memo((function({imgVideoList:t,driving:s}){var n,l,r,i,o,c,d,u,m,p;const f=!xl((e=>e.isMobile)),h=t.length,[g,v]=a.useState(!1),[x,b]=a.useState(0),E=e=>{s||(b(null!=e?e:0),v(!0))},_=a.useMemo((()=>{var e;const s=f?536:301,a=t[0];if((null===(e=a.mediaFileMetadata)||void 0===e?void 0:e.width)&&a.mediaFileMetadata.height){const e=a.mediaFileMetadata.width,t=a.mediaFileMetadata.height;if(e>s&&t>s)return e>t?{width:s,height:t*(s/e)}:{height:s,width:e*(s/t)};if(e>s)return{width:s,height:t*(s/e)};if(t>s)return{height:s,width:e*(s/t)}}return{width:"auto",height:"auto"}}),[t,f]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Ge.default("rounded-xl overflow-hidden max-w-full w-[1000px] min-w-24",1===h&&"max-w-fit max-h-fit"),style:1===h?{width:_.width,height:_.height}:{},children:1===h?e.jsx("div",{className:"rounded-xl overflow-hidden w-full h-full",children:e.jsx(Qm,{type:t[0].type,url:t[0].url,clickEvent:()=>E(),customClass:"w-auto h-auto",imageModel:null===(l=null===(n=t[0])||void 0===n?void 0:n.mediaFileMetadata)||void 0===l?void 0:l.generateModel,index:0})}):2===h||4===h?e.jsx("div",{className:"grid grid-cols-2 gap-1 w-full",children:t.map(((t,s)=>{var a;return e.jsx(Qm,{type:t.type,url:t.url,clickEvent:()=>E(s),customClass:"aspect-square w-full",imageModel:null===(a=null==t?void 0:t.mediaFileMetadata)||void 0===a?void 0:a.generateModel,index:s},t.url+s)}))}):3===h?e.jsxs("div",{className:"grid grid-cols-2 gap-1 w-full",children:[e.jsx(Qm,{type:t[0].type,url:t[0].url,clickEvent:()=>E(),customClass:"aspect-[5/4] md:aspect-[2] col-span-2 w-full",imageModel:null===(i=null===(r=t[0])||void 0===r?void 0:r.mediaFileMetadata)||void 0===i?void 0:i.generateModel,index:0}),t.slice(1).map(((t,s)=>{var a;return e.jsx(Qm,{type:t.type,url:t.url,clickEvent:()=>E(1+s),customClass:"aspect-square w-full",imageModel:null===(a=null==t?void 0:t.mediaFileMetadata)||void 0===a?void 0:a.generateModel,index:s},t.url+s)}))]}):5===h||8===h?e.jsxs("div",{className:"grid grid-cols-6 gap-1 w-full",children:[e.jsx(Qm,{type:t[0].type,url:t[0].url,clickEvent:()=>E(),customClass:"aspect-square col-span-3 w-full",imageModel:null===(c=null===(o=t[0])||void 0===o?void 0:o.mediaFileMetadata)||void 0===c?void 0:c.generateModel,index:0}),e.jsx(Qm,{type:t[1].type,url:t[1].url,clickEvent:()=>E(1),customClass:"aspect-square col-span-3 w-full",imageModel:null===(u=null===(d=t[1])||void 0===d?void 0:d.mediaFileMetadata)||void 0===u?void 0:u.generateModel,index:1}),t.slice(2).map(((t,s)=>{var a;return e.jsx(Qm,{type:t.type,url:t.url,clickEvent:()=>E(2+s),customClass:"col-span-2 aspect-square w-full",imageModel:null===(a=null==t?void 0:t.mediaFileMetadata)||void 0===a?void 0:a.generateModel,index:s},t.url+s)}))]}):6===h||9===h?e.jsx("div",{className:"grid grid-cols-3 gap-1 w-full",children:t.map(((t,s)=>{var a;return e.jsx(Qm,{type:t.type,url:t.url,clickEvent:()=>E(s),customClass:"aspect-square w-full",imageModel:null===(a=null==t?void 0:t.mediaFileMetadata)||void 0===a?void 0:a.generateModel,index:s},t.url+s)}))}):e.jsxs("div",{className:"flex flex-col space-y-1 w-full",children:[e.jsx(Qm,{type:t[0].type,url:t[0].url,clickEvent:()=>E(),customClass:Ge.default("w-full",7===h?"aspect-[2]":"aspect-[5/4] md:aspect-[2]"),imageModel:null===(p=null===(m=t[0])||void 0===m?void 0:m.mediaFileMetadata)||void 0===p?void 0:p.generateModel,index:0}),e.jsx("div",{className:"grid grid-cols-3 gap-1 w-full",children:t.slice(1).map(((t,s)=>{var a;return e.jsx(Qm,{type:t.type,url:t.url,clickEvent:()=>E(1+s),customClass:"aspect-square w-full",imageModel:null===(a=null==t?void 0:t.mediaFileMetadata)||void 0===a?void 0:a.generateModel,index:s},t.url+s)}))})]})}),e.jsx(qm,{open:g,onClose:()=>{b(0),v(!1)},imgVideoList:t,activeIndex:x})]})}));function Jm({embedObjs:t,mdImages:s=[],driving:n}){const l=a.useMemo((()=>[...s,...t].filter((e=>e.type!==il.UNKNOWN&&e.type!==il.AUDIO_CONTENT&&e.type!==il.TEXT_CONTENT))),[t,s]),r=a.useMemo((()=>l.filter((e=>e.type===il.IMAGE||e.type===il.VIDEO))),[l]),i=a.useMemo((()=>l.filter((e=>e.type===il.AUDIO||e.type===il.DOC))),[l]);return l.length?e.jsxs("div",{className:"flex flex-col gap-2 w-full overflow-hidden",children:[!!r.length&&e.jsx(Xm,{driving:n,imgVideoList:r}),!!i.length&&i.map((t=>t.type===il.DOC||t.type===il.TEXT_CONTENT?e.jsx(Dm,{doc:t},t.url):e.jsx(Bm,{title:t.title,url:t.url},t.url)))]}):null}var Zm=a.memo((function({reference:t}){return e.jsx(Kr,{href:t.link,target:"_blank",children:e.jsxs("div",{className:"p-1 flex items-center space-x-1.5 rounded-md bg-surface-accent-gray-subtler hover:bg-surface-accent-gray-subtle",children:[e.jsx("img",{src:`https://s2.googleusercontent.com/s2/favicons?domain=${t.displayLint}&sz=48`,alt:t.displayLint,className:"w-6 h-6 rounded-md"}),e.jsx("div",{className:"grow truncate text-subtle text-sm",children:t.title})]})})}));function ep({references:t,className:a}){const n=s.useTranslations("chat");return(null==t?void 0:t.length)?e.jsxs(e.Fragment,{children:[e.jsx(br,{className:"border-dashed"}),e.jsxs("div",{className:Ge.default("py-3 flex flex-col gap-1.5",a),children:[e.jsx("div",{className:"text-xs text-subtle font-medium",children:n("sources")}),e.jsx("div",{className:"flex flex-col gap-1.5",children:t.map((t=>e.jsx(Zm,{reference:t},t.link)))})]})]}):null}Ne.AUTO,ye.ONE;const tp={BOT_CHAT_SETTING_AUDIO_SPEED_ZERO_POINT_FIVE:.5,BOT_CHAT_SETTING_AUDIO_SPEED_ZERO_POINT_SEVEN_FIVE:.75,BOT_CHAT_SETTING_AUDIO_SPEED_ONE:1,BOT_CHAT_SETTING_AUDIO_SPEED_ONE_POINT_TWENTY_FIVE:1.25,BOT_CHAT_SETTING_AUDIO_SPEED_ONE_POINT_FIVE:1.5};function sp({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M6.3 2.84A1.5 1.5 0 0 0 4 4.11v11.78a1.5 1.5 0 0 0 2.3 1.27l9.344-5.891a1.5 1.5 0 0 0 0-2.538L6.3 2.841Z"}))}const ap=Fe.forwardRef(sp),np=a.forwardRef((({src:t,onManuallyInteracted:s,onEnded:n,serverDuration:l,onProgressUpdate:r,initialTime:i},o)=>{const d=So(),[u,m,p]=c.useAudio(e.jsx(d,{src:t,onTimeUpdate:()=>{null==r||r(m.time)},onEnded:()=>{p.seek(0),null==n||n()}})),{paused:f,time:h,playing:g}=m,v=m.duration||l||0;a.useImperativeHandle(o,(()=>({play:()=>{p.play()},pause:()=>{p.pause()}})));return c.useEffectOnce((()=>{i&&(m.time=i)})),e.jsxs("div",{className:"flex flex-col gap-1 w-full overflow-hidden",children:[e.jsx("div",{className:"bg-surface-primary-default h-px w-full items-start",style:{width:100*ms(h,v)+"%"}}),e.jsxs("div",{className:"flex items-center gap-[6px]",children:[e.jsx("div",{className:"size-6 flex justify-center items-center",children:e.jsx(Kl,{className:"size-5",size:"xs",onClick:()=>{if(f){const e=document.getElementsByTagName("audio");for(let t=0,s=e.length;t<s;t++)e[t].pause();0!==m.time&&p.seek(m.time),p.play(),null==s||s(!0)}else p.pause(),null==s||s(!1)},loading:!t||!v,children:f?e.jsx(ap,{className:"size-3 ml-0.5"}):e.jsx(jo,{})})}),e.jsx("div",{className:"flex flex-col grow overflow-hidden",children:e.jsx("div",{className:"text-sm text-brand truncate",children:cs((g||f)&&h||v)})})]}),u]})}));function lp(e,t,s,a,n,l){const[r,i]=c.useToggle(!1);return{generating:r,handleRegenerate:async(e,t)=>{try{i(!0);const{success:o,data:c,msg:d}=await(r=e,Os.post("/v1/bot/chat/regenerate_tts",{body:{msgId:r},isGoLang:!0,adapter:e=>({duration:e.audioFileDurationSeconds,audioSpeed:e.audioSpeed,audioUrl:e.voiceUrl,energyInfo:e.userEnergyInfo})}));if(o){const{audioUrl:r,audioSpeed:i,energyInfo:o,duration:d}=c;e===t?(null==s||s(e,{audioUrl:r,audioSpeed:tp[i],duration:d}),null==n||n(e)):(null==a||a(e,t,{audioUrl:r,audioSpeed:tp[i],duration:d}),null==n||n(t)),null==l||l(o)}else console.error(d)}catch(e){console.error(e)}finally{i(!1)}var r}}}function rp(){const{type:t,entityInfo:s,setEnergyInfo:n}=a.useContext(jt),{partialUpdateMessage:l,partialUpdateRegenMessage:r,enQueue:i}=a.useContext(At),{id:o}=s,{message:c,displayMessage:d,setAudioPlayProgress:u}=Am(),m=Ur((e=>e.isVisitor)),{generating:p,handleRegenerate:f}=lp(0,0,l,r,i,n),h=()=>{null==u||u(0),f(null==c?void 0:c.id,d.id)};return e.jsx("div",{className:"flex flex-col gap-1 w-full overflow-hidden",children:e.jsx("div",{className:"flex items-center gap-[6px]",children:m===Ft.YES?e.jsxs(e.Fragment,{children:[e.jsx(Kl,{className:"size-5",onClick:h,loading:p,children:e.jsx(ji,{className:"size-3 ml-0.5"})}),e.jsx("div",{className:"flex flex-col grow overflow-hidden",children:e.jsx("div",{className:"text-sm text-brand truncate",children:cs(0)})})]}):e.jsxs(Tr,{variant:"primary",size:"sm",color:"brand",className:"h-6 px-2",onClick:h,loading:p,children:[e.jsx("div",{className:"rounded-full bg-white size-[14px] flex justify-center items-center",children:e.jsx(ji,{className:"size-[10px] text-icon-brand ml-[1.5px]"})}),e.jsx(br,{orientation:"vertical",className:"h-3 border-beta-white-20 mx-[6px]"}),e.jsxs("div",{className:"flex gap-[2px] items-center",children:[e.jsx(Ye.default,{alt:"energy cost",src:"https://www.myshellstatic.com/image/chat/embed_obj/172/202405210853/icon-wrapper-16px@2x.png.png",width:16,height:16,className:"size-4 rounded-[4px]"}),e.jsx(Ul,{size:"xs",className:"text-inherit",children:"1"})]})]})})})}function ip({showAudio:t=!1}){const s=a.useRef(null),{audioPlayProgress:n,setAudioPlayProgress:l,displayMessage:r,prevMessageIndex:i,currentMessageIndex:o}=Am(),{chatSetting:c}=a.useContext(jt),{playingAudio:d,playNext:u,enQueue:m,clearQueue:p}=a.useContext(At),{audioUrl:f,status:h,id:g,source:v}=r,x=a.useMemo((()=>!(!t||"DONE"!==(null==r?void 0:r.status)||(null==r?void 0:r.audioUrl))||!(!(null==c?void 0:c.audioSpeed)||(null==r?void 0:r.audioSpeed)===tp[null==c?void 0:c.audioSpeed])),[t,null==r?void 0:r.status,null==r?void 0:r.audioUrl,null==r?void 0:r.audioSpeed,null==c?void 0:c.audioSpeed]);a.useEffect((()=>{var e,t;d===g&&f?null===(e=s.current)||void 0===e||e.play():null===(t=s.current)||void 0===t||t.pause()}),[d,f,h,g]),a.useEffect((()=>{i!==o&&(null==u||u(),null==l||l(0))}),[o]);const b=()=>{null==u||u()},E=e=>{null==p||p(),e&&(null==m||m(g))},_=e=>{null==l||l(e)};return"USER"!==v?t?x?e.jsx(rp,{}):e.jsx(np,{ref:s,src:null==r?void 0:r.audioUrl,onEnded:b,onManuallyInteracted:E,serverDuration:null==r?void 0:r.duration,initialTime:n,onProgressUpdate:_}):null:(null==r?void 0:r.audioUrl)?e.jsx(np,{src:null==r?void 0:r.audioUrl}):void 0}np.displayName="AudioPlayer";class op{constructor(){this.trackRecord=new Set}static getInstance(){return op.instance||(op.instance=new op),op.instance}shouldTrack(e){return!this.trackRecord.has(e)}recordTracked(e){this.trackRecord.add(e)}removeTracked(e){this.trackRecord.delete(e)}}const cp=op.getInstance();var dp={"hljs-comment":{color:"#776977"},"hljs-quote":{color:"#776977"},"hljs-variable":{color:"#ca402b"},"hljs-template-variable":{color:"#ca402b"},"hljs-attribute":{color:"#ca402b"},"hljs-tag":{color:"#ca402b"},"hljs-name":{color:"#ca402b"},"hljs-regexp":{color:"#ca402b"},"hljs-link":{color:"#ca402b"},"hljs-selector-id":{color:"#ca402b"},"hljs-selector-class":{color:"#ca402b"},"hljs-number":{color:"#a65926"},"hljs-meta":{color:"#a65926"},"hljs-built_in":{color:"#a65926"},"hljs-builtin-name":{color:"#a65926"},"hljs-literal":{color:"#a65926"},"hljs-type":{color:"#a65926"},"hljs-params":{color:"#a65926"},"hljs-string":{color:"#918b3b"},"hljs-symbol":{color:"#918b3b"},"hljs-bullet":{color:"#918b3b"},"hljs-title":{color:"#516aec"},"hljs-section":{color:"#516aec"},"hljs-keyword":{color:"#7b59c0"},"hljs-selector-tag":{color:"#7b59c0"},hljs:{display:"block",overflowX:"auto",background:"#f7f3f7",color:"#695d69",padding:"0.5em"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}},up=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const mp={sql:"SQL",javascript:"JavaScript",java:"Java",typescript:"TypeScript",vbscript:"VBScript",css:"CSS",html:"HTML",xml:"XML",php:"PHP",python:"Python",yaml:"Yaml",mermaid:"Mermaid",markdown:"MarkDown",makefile:"MakeFile",echarts:"ECharts",shell:"Shell",powershell:"PowerShell",json:"JSON",latex:"Latex",svg:"SVG"},pp={"，":",","；":";","。":".","：":":","！":"!","？":"?","“":'"',"”":'"',"‘":"'","’":"'","【":"[","】":"]","（":"(","）":")","《":"<","》":">","、":","},fp=({content:t})=>{const[s,n]=a.useState("");return a.useEffect((()=>{(async()=>{if(t)try{const e=t.replace(new RegExp(`[${Object.keys(pp).join("")}]`,"g"),(e=>pp[e])),{svg:s}=await tt.default.render(`mermaid-${Date.now()}`,e);n(s)}catch(e){console.log("Mermaid Render Error: ",null==e?void 0:e.message)}})()}),[t]),e.jsx("div",{className:"mermaid w-full h-full overflow-auto min-w-[500px]",dangerouslySetInnerHTML:{__html:s}})},hp=a.memo((t=>{var{inline:n,className:l,children:r}=t,o=up(t,["inline","className","children"]);const c=s.useTranslations("chat"),d=s.useTranslations("common"),{success:u,error:m}=Ql(),{resolvedTheme:p}=i.useTheme(),f="dark"===p,h=/language-(\w+)/.exec(l||""),g=null==h?void 0:h[1],v=(e=>e?e in mp?mp[e]:e.charAt(0).toUpperCase()+e.substring(1):"Plain")(g||""),x=String(r),b=a.useMemo((()=>{const t=x.replace(/\n$/,"");return e.jsx(st.default,Object.assign({},o,{style:dp,customStyle:{paddingLeft:12,backgroundColor:f?"#27282c":"#fff"},language:null==h?void 0:h[1],showLineNumbers:!0,PreTag:"div",children:t}))}),[g,h,o,x]);return"mermaid"===g?e.jsx(fp,{content:x}):!n&&h||x.includes("\n")?e.jsxs("div",{className:"marked-code-block",children:[e.jsxs("div",{className:"marked-code-header bg-surface-container-pressed alt-14 text-subtle",children:[e.jsx("span",{children:v}),e.jsx("button",{className:"copy-button text-brand",onClick:()=>{navigator.clipboard.writeText(r).then((()=>{u({content:d("code_copied")})})).catch((e=>{m({content:`${d("copy_failed")} ${e}`,id:`${d("copy_failed")} ${e}`})}))},children:c("copy_code")})]}),b]}):e.jsx("code",Object.assign({},o,{className:pn("px-1",l),children:r}))}));hp.displayName="CodeBlock";const gp=t=>e.jsx("div",{className:"marked-table-container",children:e.jsx("table",{children:t.children})});gp.displayName="Table";const vp=({src:t,alt:s,loadTracker:a})=>(null==a||a.onLoadStart(t),e.jsx("img",Object.assign({src:t,"x-intercept-click":"1"},s?{alt:s,title:s}:{},{onLoad:()=>{null==a||a.onLoaded(t)},onError:e=>{null==a||a.onLoadError(t)}})));vp.displayName="Image";const xp=({src:t,title:s,loadTracker:a})=>(null==a||a.onLoadStart(t),e.jsx("video",Object.assign({src:t},s?{title:s}:{},{onLoad:()=>{null==a||a.onLoaded(t)},onError:e=>{null==a||a.onLoadError(t)}})));xp.displayName="Video";const bp=({children:t,href:s})=>e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:t||s});var Ep=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const _p=e=>"string"!=typeof e?e:e.replace(/\\\[([\s\S]*?)\\\]/g,((e,t)=>`$$${t}$$`)).replace(/\\\(([\s\S]*?)\\\)/g,((e,t)=>`$$${t}$$`)).replace(/(^|[^\\])\$(.+?)\$/g,((e,t,s)=>`${t}$${s}$`));var wp=a.memo((function(t){const{hideMedia:s,mediaLoadTracker:n}=t,l={ALLOWED_ATTR:["width","height","color","src","alt","value","max","min","href","target","title","controls","type"],ALLOWED_TAGS:["p","li","strong","h1","h2","h3","h4","h5","h6","meter","ul","br","hr","center","td","b","a","tr","ol","blockquote","table","div","tbody","source","em","summary","progress","font","span",...s?[]:["img","video"]]},r=a.useRef(null),i=a.useRef(0);return e.jsx("div",{ref:r,children:e.jsx(Ke.default,{remarkPlugins:[et.default,[Ze.default,{singleTilde:!1}],Je.default],rehypePlugins:[Qe.default,[qe.default,{target:"_blank"}],...t.notParseHTML?[]:[Xe.default]],className:pn("md-viewer prose-base prose-pre:my-0 prose-pre:p-0 prose-headings:m-0 prose-hr:my-[1em] max-w-fit overflow-hidden",t.nouseProse?"":"prose dark:prose-invert",t.className),components:{code:hp,table:gp,img:t=>{var s=Ep(t,[]);return e.jsx(vp,Object.assign({},s,{src:s.src,alt:s.alt,loadTracker:n}))},video:t=>{var s=Ep(t,[]);return e.jsx(xp,Object.assign({},s,{src:s.src,title:s.title,loadTracker:n}))},a:bp},disallowedElements:["script","iframe","head","html","meta","link","style","body"],children:((e,t,s=!1)=>{const a=/!\[(.*?)\]$/,n=e||"";let r=n.trim(),o=!1,c=0;if(0!==i.current&&(c=performance.now(),o=(c-i.current)/1e3>3),!/!\[.*?\]\((.*?)\)/g.test(r)&&a.test(r)&&"DONE"!==t)if(o)0!==i.current&&(c-i.current)/1e3>6&&(i.current=0);else if(0===i.current)i.current=performance.now();else{const e=r.search(a);r=-1!==e?r.substring(0,e):n}else 0!==i.current&&(i.current=0);return s?_p(r):N.sanitize(_p(r),l)})(t.content,t.status,t.notParseHTML)})})})),Tp=Object.freeze({__proto__:null,default:wp});const Np=ze.default((()=>Promise.resolve().then((function(){return Tp}))),{loading:()=>e.jsx("div",{children:"loading..."}),ssr:!1});function yp(){const{translationStatus:t,translate:n}=a.useContext(At),{message:l}=Am(),r=s.useTranslations("chat"),i=()=>{null==n||n(null==l?void 0:l.id)},o=a.useMemo((()=>{let e;if(null==l?void 0:l.referenceText){e=`${l.referenceText.split("\n").map((e=>`> ${e}`)).join("\n")}\n\n`}return e}),[null==l?void 0:l.referenceText]);return c.useEffectOnce((()=>{(null==l?void 0:l.translation)||i()})),(null==l?void 0:l.translation)?e.jsx(Np,{content:`${null!=o?o:""}${l.translation}`,notParseHTML:l.isLlmBot}):"TRANSLATING"===t?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ul,{className:"leading-7",children:r("translating")}),e.jsx(qs,{className:"animate-spin size-[18px]"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ul,{className:"leading-7",children:r("translation_failed")}),e.jsx(qs,{className:"size-[18px] ",onClick:i})]})}const Cp=a.memo((function({type:t,id:s,displayText:n,messageId:l,jobId:r,messageType:i,status:o,referenceText:c,hideMedia:d,isLlmBot:u}){const m=hi(),p=a.useMemo((()=>{let e;if(c){e=`${c.split("\n").map((e=>`> ${e}`)).join("\n")}\n\n`}return e}),[c]),f=a.useCallback((e=>{if("bot"===t){const t=`${s}-${l}-${e}`;if(cp.shouldTrack(t)){const t={bot_id:s,message_id:l,job_id:r,message_type:i,file_url:e,time:(new Date).getTime()};null==m||m.track("Chat_Image_Render_Start",t)}}}),[s,r,l,i,t]),h=a.useCallback((e=>{if("bot"===t){const t=`${s}-${l}-${e}`;if(cp.shouldTrack(t)){const a={bot_id:s,message_id:l,job_id:r,message_type:i,file_url:e,time:(new Date).getTime()};null==m||m.track("Chat_Image_Render_Success",a),cp.recordTracked(t)}}}),[s,r,l,i,t]),g=a.useCallback((e=>{if("bot"===t){const t=`${s}-${l}-${e}`;if(cp.shouldTrack(t)){const a={bot_id:s,message_id:l,job_id:r,message_type:i,file_url:e,time:(new Date).getTime(),reason:"load failed"};null==m||m.track("Chat_Image_Render_Error",a),cp.recordTracked(t)}}}),[s,r,l,i,t]),v=a.useMemo((()=>({onLoadStart:f,onLoaded:h,onLoadError:g})),[g,f,h]);return e.jsx("div",{className:"relative",children:e.jsx(wp,{content:`${null!=p?p:""}${null!=n?n:""}`,status:o,notParseHTML:u,className:"leading-6",hideMedia:d,mediaLoadTracker:v})})}));function Sp({hideMedia:t=!1}){var s,n;const l=hi(),{message:r,displayMode:i,publishState:o,popupConfirmItem:c,popupConfirmVisible:d,setPopupConfirmItem:u,setPublishState:m,setPopupConfirmVisible:p,displayMessage:f}=Am(),{type:h,entityInfo:g,imgGenerator:v}=a.useContext(jt),{editorMode:x,publish:b}=a.useContext(At),{status:E,id:_}=g,{everPublished:w,publishing:T,publishSingleImgToGallery:N}=b||{},y=a.useRef(c);a.useEffect((()=>{y.current=c}),[c]);const C=a.useCallback((()=>{var e,t;if("bot"===h){const s={bot_id:_,job_id:null===(e=null==r?void 0:r.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==r?void 0:r.id,file_url:null===(t=y.current)||void 0===t?void 0:t.imageLink};null==l||l.track("Chat_Publish_Gallery",s)}"info"!==o||w?(null==m||m("info"),null==u||u(),null==p||p(!1)):null==m||m("success")}),[o,w,m,p]),S=a.useCallback((()=>{"success"===o?null==u||u():c&&(null==N||N(c,C))}),[o,u,c,N,C]);return"TRANSLATION"===i?e.jsx(yp,{}):(null===(s=null==r?void 0:r.slashCommandInput)||void 0===s?void 0:s.name)?e.jsxs("p",{children:[e.jsx(Ul,{color:"brand",children:r.slashCommandInput.name}),Object.entries(r.slashCommandInput.paramMap).map((([t,s])=>e.jsxs("p",{children:[e.jsx(Ul,{weight:"semibold",children:t}),": ",e.jsx(Ul,{children:s})]},t)))]}):(null==r?void 0:r.text)&&e.jsxs(e.Fragment,{children:[e.jsx(Cp,{type:h,id:_,displayText:null==f?void 0:f.text,messageId:r.id,jobId:null===(n=r.asyncJobInfo)||void 0===n?void 0:n.jobId,messageType:r.type,status:r.status,referenceText:r.referenceText,hideMedia:t,isLlmBot:r.isLlmBot}),e.jsx(am,{open:!!d,onClose:()=>{null==p||p(!1)},onConfirm:S,publishState:null!=o?o:"info",publishing:null!=T&&T})]})}const jp=({message:t,showText:s=!0,showAudio:a=!1})=>{var n;return"CANCELING"!==t.status&&"CANCELED"!==t.status||!s||t.text||!a||t.audioUrl?e.jsxs(e.Fragment,{children:[s&&e.jsx(Sp,{}),e.jsx(ep,{references:t.referenceSource}),s&&a&&e.jsx(br,{className:"border-dashed"}),e.jsx(ip,{showAudio:a}),e.jsx(Jm,{embedObjs:null!==(n=t.embedObjs)&&void 0!==n?n:[]})]}):e.jsx(Ga,{className:"w-6 h-6 text-icon"})},Ip=t=>e.jsxs(u.Icon,Object.assign({viewBox:"0 0 120 30",fill:"#fff",width:"30",height:"14",color:"#6D7175"},t,{w:6,h:6,children:[e.jsxs("circle",{cx:"15",cy:"15",r:"15",fill:"var(--surface-primary-default, red)",children:[e.jsx("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:"15",repeatCount:"indefinite",to:"15",values:"15;9;15"}),e.jsx("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:"1",repeatCount:"indefinite",to:"1",values:"1;.5;1"})]}),e.jsxs("circle",{cx:"60",cy:"15",r:"9",fill:"var(--surface-primary-default, red)",fillOpacity:".3",children:[e.jsx("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:"9",repeatCount:"indefinite",to:"9",values:"9;15;9"}),e.jsx("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:".5",repeatCount:"indefinite",to:".5",values:".5;1;.5"})]}),e.jsxs("circle",{cx:"105",cy:"15",r:"15",fill:"var(--surface-primary-default, red)",children:[e.jsx("animate",{attributeName:"r",begin:"0s",calcMode:"linear",dur:"0.8s",from:"15",repeatCount:"indefinite",to:"15",values:"15;9;15"}),e.jsx("animate",{attributeName:"fill-opacity",begin:"0s",calcMode:"linear",dur:"0.8s",from:"1",repeatCount:"indefinite",to:"1",values:"1;.5;1"})]})]}));var Op=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Ap=at.Root,Mp=at.Trigger;Fe.forwardRef(((s,a)=>{var{className:n,inset:l,children:r}=s,i=Op(s,["className","inset","children"]);return e.jsxs(at.SubTrigger,Object.assign({ref:a,className:pn("flex cursor-default select-none items-center rounded-lg py-1 px-2 text-sm outline-none hover:bg-surface-hovered data-[state=open]:bg-slate-100 data-[state=open]:text-slate-900 dark:focus:bg-slate-800 dark:focus:text-slate-50 dark:data-[state=open]:bg-slate-800 dark:data-[state=open]:text-slate-50",l&&"pl-8",n)},i,{children:[r,e.jsx(t.ChevronRight,{className:"ml-auto h-4 w-4"})]}))})).displayName=at.SubTrigger.displayName;Fe.forwardRef(((t,s)=>{var{className:a}=t,n=Op(t,["className"]);return e.jsx(at.SubContent,Object.assign({ref:s,className:pn("flex flex-col gap-y-1 z-50 overflow-hidden rounded-xl border border-opaque bg-surface-container-default p-2 text-default shadow-modal-default",a)},n))})).displayName=at.SubContent.displayName;const Pp=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=Op(t,["className"]);return e.jsx(at.Portal,{children:e.jsx(at.Content,Object.assign({ref:s,className:pn("z-50 min-w-[8rem] overflow-hidden rounded-xl border-none bg-surface-default p-1 text-default shadow-modal-default border border-opaque",a)},n))})}));Pp.displayName=at.Content.displayName;const Lp=Fe.forwardRef(((t,s)=>{var{className:a,inset:n}=t,l=Op(t,["className","inset"]);return e.jsx(at.Item,Object.assign({ref:s,className:pn("relative flex cursor-default select-none items-center rounded-lg py-1 px-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-30 focus:bg-surface-container-selected-default",n&&"pl-8",a)},l))}));Lp.displayName=at.Item.displayName;Fe.forwardRef(((s,a)=>{var{className:n,children:l,checked:r}=s,i=Op(s,["className","children","checked"]);return e.jsxs(at.CheckboxItem,Object.assign({ref:a,className:pn("relative flex cursor-default select-none items-center rounded-lg py-1 px-2 text-sm outline-none hover:bg-surface-hovered data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-800 dark:focus:text-slate-50",n),checked:r},i,{children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(at.ItemIndicator,{children:e.jsx(t.Check,{className:"h-4 w-4"})})}),l]}))})).displayName=at.CheckboxItem.displayName;Fe.forwardRef(((s,a)=>{var{className:n,children:l}=s,r=Op(s,["className","children"]);return e.jsxs(at.RadioItem,Object.assign({ref:a,className:pn("relative flex cursor-default select-none items-center rounded-lg py-1 px-2 text-sm outline-none hover:bg-surface-hovered data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},r,{children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(at.ItemIndicator,{children:e.jsx(t.Circle,{className:"h-2 w-2 fill-current"})})}),l]}))})).displayName=at.RadioItem.displayName;Fe.forwardRef(((t,s)=>{var{className:a,inset:n}=t,l=Op(t,["className","inset"]);return e.jsx(at.Label,Object.assign({ref:s,className:pn("px-2 py-1.5 text-sm font-semibold text-default",n&&"pl-8",a)},l))})).displayName=at.Label.displayName;const kp=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=Op(t,["className"]);return e.jsx(at.Separator,Object.assign({ref:s,className:pn("my-1 h-px bg-[var(--border)]",a)},n))}));kp.displayName=at.Separator.displayName;const Rp=a.forwardRef(((t,s)=>e.jsx(fr,Object.assign({},t,{children:e.jsxs("svg",{ref:s,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M16.5847 3.41529C15.3643 2.1949 13.3857 2.1949 12.1653 3.41529L8.41529 7.16529C7.1949 8.38568 7.1949 10.3643 8.41529 11.5847C8.67435 11.8438 8.96648 12.0471 9.27752 12.1957C9.58899 12.3445 9.72086 12.7176 9.57207 13.0291C9.42328 13.3405 9.05018 13.4724 8.73871 13.3236C8.30141 13.1147 7.89219 12.8294 7.53141 12.4686C5.82286 10.76 5.82286 7.98995 7.53141 6.28141L11.2814 2.53141C12.99 0.822864 15.76 0.822864 17.4686 2.53141C19.1771 4.23995 19.1771 7.01005 17.4686 8.71859L16.0044 10.1827C15.7604 10.4268 15.3646 10.4268 15.1206 10.1827C14.8765 9.93866 14.8765 9.54293 15.1206 9.29885L16.5847 7.83471C17.8051 6.61432 17.8051 4.63568 16.5847 3.41529Z"}),e.jsx("path",{d:"M10.4279 6.97094C10.5767 6.65948 10.9498 6.52761 11.2613 6.67639C11.6986 6.8853 12.1078 7.17062 12.4686 7.53141C14.1771 9.23995 14.1771 12.01 12.4686 13.7186L8.71859 17.4686C7.01005 19.1771 4.23995 19.1771 2.53141 17.4686C0.822864 15.76 0.822864 12.99 2.53141 11.2814L3.99555 9.81727C4.23963 9.57319 4.63536 9.57319 4.87943 9.81727C5.12351 10.0613 5.12351 10.4571 4.87943 10.7011L3.41529 12.1653C2.1949 13.3857 2.1949 15.3643 3.41529 16.5847C4.63568 17.8051 6.61432 17.8051 7.83471 16.5847L11.5847 12.8347C12.8051 11.6143 12.8051 9.63568 11.5847 8.41529C11.3257 8.15623 11.0335 7.95289 10.7225 7.80431C10.411 7.65552 10.2791 7.28241 10.4279 6.97094Z"})]})})))),Dp=a.forwardRef(((t,s)=>e.jsx(fr,Object.assign({},t,{children:e.jsxs("svg",{ref:s,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M10 1.25C10.3452 1.25 10.625 1.52982 10.625 1.875L10.625 10.9911L12.0581 9.55806C12.3021 9.31398 12.6979 9.31398 12.9419 9.55806C13.186 9.80214 13.186 10.1979 12.9419 10.4419L10.4419 12.9419C10.3247 13.0592 10.1658 13.125 10 13.125C9.83424 13.125 9.67527 13.0592 9.55806 12.9419L7.05806 10.4419C6.81398 10.1979 6.81398 9.80213 7.05806 9.55806C7.30214 9.31398 7.69786 9.31398 7.94194 9.55806L9.375 10.9911L9.375 1.875C9.375 1.52982 9.65482 1.25 10 1.25Z"}),e.jsx("path",{d:"M6.25 7.5C5.55964 7.5 5 8.05964 5 8.75V16.25C5 16.9404 5.55964 17.5 6.25 17.5H13.75C14.4404 17.5 15 16.9404 15 16.25V8.75C15 8.05964 14.4404 7.5 13.75 7.5H12.5C12.1548 7.5 11.875 7.22018 11.875 6.875C11.875 6.52982 12.1548 6.25 12.5 6.25H13.75C15.1307 6.25 16.25 7.36929 16.25 8.75V16.25C16.25 17.6307 15.1307 18.75 13.75 18.75H6.25C4.86929 18.75 3.75 17.6307 3.75 16.25V8.75C3.75 7.36929 4.86929 6.25 6.25 6.25H7.5C7.84518 6.25 8.125 6.52982 8.125 6.875C8.125 7.22018 7.84518 7.5 7.5 7.5H6.25Z"})]})})))),Up=a.forwardRef(((t,s)=>e.jsx(fr,Object.assign({},t,{children:e.jsx("svg",{ref:s,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.11 2H17.2727C17.958 1.99999 18.5147 1.99999 18.9662 2.03688C19.4324 2.07497 19.8477 2.15583 20.2338 2.35256C20.8425 2.66268 21.3373 3.15752 21.6474 3.76616C21.8442 4.15225 21.925 4.56757 21.9631 5.03376C22 5.48534 22 6.04197 22 6.72731V13.89C22 14.5754 22 15.132 21.9631 15.5836C21.925 16.0498 21.8442 16.4651 21.6474 16.8512C21.3373 17.4598 20.8425 17.9547 20.2338 18.2648C19.8905 18.4397 19.4704 18.3032 19.2955 17.9599C19.1205 17.6166 19.257 17.1964 19.6004 17.0215C19.9464 16.8452 20.2278 16.5638 20.4042 16.2177C20.484 16.0611 20.5414 15.8498 20.5724 15.4699C20.6041 15.0819 20.6046 14.5824 20.6046 13.8605V6.75687C20.6046 6.03493 20.6041 5.53544 20.5724 5.14739C20.5414 4.76748 20.484 4.55624 20.4042 4.39964C20.2278 4.05355 19.9464 3.77217 19.6004 3.59582C19.4438 3.51603 19.2325 3.45864 18.8526 3.4276C18.4646 3.39589 17.9651 3.39535 17.2431 3.39535H10.1395C9.41759 3.39535 8.9181 3.39589 8.53005 3.4276C8.15015 3.45864 7.9389 3.51603 7.7823 3.59582C7.43621 3.77217 7.15483 4.05355 6.97849 4.39964C6.80356 4.74295 6.38343 4.87946 6.04012 4.70453C5.6968 4.5296 5.56029 4.10948 5.73522 3.76616C6.04534 3.15752 6.54018 2.66268 7.14882 2.35256C7.53492 2.15583 7.95023 2.07497 8.41643 2.03688C8.868 1.99999 9.42464 1.99999 10.11 2ZM6.72733 5.38266H13.89C14.5753 5.38266 15.132 5.38265 15.5836 5.41955C16.0498 5.45763 16.4651 5.5385 16.8512 5.73522C17.4598 6.04534 17.9547 6.54018 18.2648 7.14882C18.4615 7.53492 18.5424 7.95023 18.5804 8.41643C18.6173 8.868 18.6173 9.42463 18.6173 10.11V17.2727C18.6173 17.958 18.6173 18.5147 18.5804 18.9662C18.5424 19.4324 18.4615 19.8477 18.2648 20.2338C17.9547 20.8425 17.4598 21.3373 16.8512 21.6474C16.4651 21.8442 16.0498 21.925 15.5836 21.9631C15.132 22 14.5754 22 13.89 22H6.72731C6.71085 22 6.69446 22 6.67815 22L5.99447 22C5.76242 22 5.54372 22 5.36953 21.9846C5.36199 21.9839 5.35414 21.9832 5.34601 21.9824C5.23672 21.9775 5.13272 21.9712 5.03376 21.9631C4.56757 21.925 4.15225 21.8442 3.76616 21.6474C3.15752 21.3373 2.66268 20.8425 2.35256 20.2338C2.15583 19.8477 2.07497 19.4324 2.03688 18.9662C1.99999 18.5147 1.99999 17.958 2 17.2727V10.11C1.99999 9.42464 1.99999 8.868 2.03688 8.41643C2.07497 7.95023 2.15583 7.53492 2.35256 7.14882C2.66268 6.54018 3.15752 6.04534 3.76616 5.73522C4.15225 5.5385 4.56757 5.45763 5.03376 5.41955C5.48534 5.38265 6.04198 5.38266 6.72733 5.38266ZM6.75687 20.6046H13.8605C14.5824 20.6046 15.0819 20.6041 15.4699 20.5724C15.8498 20.5414 16.0611 20.484 16.2177 20.4042C16.5638 20.2278 16.8452 19.9464 17.0215 19.6004C17.1013 19.4438 17.1587 19.2325 17.1897 18.8526C17.2214 18.4646 17.222 17.9651 17.222 17.2431V16.5173L14.1548 13.4501C13.9792 13.2745 13.8768 13.1729 13.7957 13.104C13.7586 13.0726 13.7376 13.0582 13.7288 13.0528C13.7043 13.0463 13.6784 13.0463 13.6538 13.0528C13.6451 13.0582 13.624 13.0726 13.587 13.104C13.5059 13.1729 13.4035 13.2745 13.2279 13.4501L6.07486 20.6031C6.27805 20.6046 6.50379 20.6046 6.75687 20.6046ZM13.6586 13.05C13.659 13.0498 13.6586 13.05 13.6586 13.05ZM17.222 14.544L15.1247 12.4467C14.9717 12.2937 14.8286 12.1506 14.6987 12.0403C14.5579 11.9207 14.3873 11.7993 14.1682 11.7281C13.8583 11.6274 13.5244 11.6274 13.2144 11.7281C12.9954 11.7993 12.8248 11.9207 12.6839 12.0403C12.554 12.1506 12.411 12.2937 12.258 12.4467L5.03094 19.6737C4.86683 19.8378 4.71216 19.9924 4.59989 20.1265C4.54589 20.191 4.46983 20.2861 4.40657 20.4077C4.40425 20.4065 4.40194 20.4053 4.39964 20.4042C4.05355 20.2278 3.77217 19.9464 3.59582 19.6004C3.51603 19.4438 3.45864 19.2325 3.4276 18.8526C3.39589 18.4646 3.39535 17.9651 3.39535 17.2431V10.1395C3.39535 9.41759 3.39589 8.9181 3.4276 8.53005C3.45864 8.15015 3.51603 7.9389 3.59582 7.7823C3.77217 7.43621 4.05355 7.15483 4.39964 6.97849C4.55624 6.89869 4.76748 6.8413 5.14739 6.81026C5.53544 6.77855 6.03493 6.77801 6.75687 6.77801H13.8605C14.5824 6.77801 15.0819 6.77855 15.4699 6.81026C15.8498 6.8413 16.0611 6.89869 16.2177 6.97849C16.5638 7.15483 16.8452 7.43621 17.0215 7.7823C17.1013 7.9389 17.1587 8.15015 17.1897 8.53005C17.2214 8.9181 17.222 9.41759 17.222 10.1395V14.544ZM7.34884 9.73784C6.80005 9.73784 6.35518 10.1827 6.35518 10.7315C6.35518 11.2803 6.80005 11.7252 7.34884 11.7252C7.89762 11.7252 8.34249 11.2803 8.34249 10.7315C8.34249 10.1827 7.89762 9.73784 7.34884 9.73784ZM4.95983 10.7315C4.95983 9.41209 6.02942 8.34249 7.34884 8.34249C8.66825 8.34249 9.73784 9.41209 9.73784 10.7315C9.73784 12.0509 8.66825 13.1205 7.34884 13.1205C6.02943 13.1205 4.95983 12.0509 4.95983 10.7315Z"})})}))));function Fp({url:t,imageModel:n,naturalHeight:l,naturalWidth:r,imageSource:i,source:o}){const d=hi(),{type:u,entityInfo:m}=a.useContext(jt),{id:p,name:f}=m,{message:h,setPopupConfirmVisible:g,setPopupConfirmItem:v}=Am(),x=Ur((e=>e.isVisitor)),b=xl((e=>e.toggleLoginModal)),{imgGenerator:E}=a.useContext(jt),{setEditorMode:_,publish:w}=a.useContext(At),{addImg:T,publishSingleImgToGallery:N,publishing:y,everPublished:C}=null!=w?w:{},S=s.useTranslations("chat"),{onCopy:j,onCopyImage:I}=ui(t),{onDownload:O,onImageDownload:A}=gu(),M=e=>{n?null==d||d.track("MessageAction",Object.assign(Object.assign({action_type:e,message_id:null==h?void 0:h.id},"widget"===u?{widget_id:p,widget_name:f}:{bot_id:p,bot_name:f}),{image_model:n})):zn({media_file_url:t}).then((t=>{var s;null==d||d.track("MessageAction",Object.assign(Object.assign({action_type:e,message_id:null==h?void 0:h.id},"widget"===u?{widget_id:p,widget_name:f}:{bot_id:p,bot_name:f}),{image_model:null===(s=null==t?void 0:t.meta)||void 0===s?void 0:s.generateModel}))})).catch((()=>{null==d||d.track("MessageAction",Object.assign(Object.assign({action_type:e,message_id:null==h?void 0:h.id},"widget"===u?{widget_id:p,widget_name:f}:{bot_id:p,bot_name:f}),{image_model:""}))}))};return c.useEffectOnce((()=>{if("bot"===u){const e={bot_id:p,message_id:null==h?void 0:h.id,file_url:t};null==d||d.track("Chat_Open_Menu",e)}})),e.jsxs(e.Fragment,{children:[e.jsxs(Lp,{onClick:()=>{var e;if("USER"===o?O(t,os()):A(t,os()),M(Se.Save_Image),"bot"===u){const s={bot_id:p,job_id:null===(e=null==h?void 0:h.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==h?void 0:h.id,file_url:t};null==d||d.track("Chat_Save_Image",s)}},children:[e.jsx(Dp,{className:"w-6 h-6 text-default flex items-center"}),e.jsx(Ul,{className:"text-default",children:S("save_image")})]}),e.jsxs(Lp,{onClick:()=>{var e;if(I(),M(Se.Copy_Image),"bot"===u){const s={bot_id:p,job_id:null===(e=null==h?void 0:h.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==h?void 0:h.id,file_url:t};null==d||d.track("Chat_Copy_Image",s)}},children:[e.jsx(Up,{size:"2xl",className:"flex items-center text-default"}),e.jsx(Ul,{className:"text-default",children:S("copy_image")})]}),E&&"OTHER"===(null==h?void 0:h.source)&&"GREETING"!==(null==h?void 0:h.type)&&e.jsxs(Lp,{onClick:()=>{var e;if(x===Ft.YES)b(!0);else if("markdown"===i){const s={messageId:h.id,imageLink:t,naturalHeight:l,naturalWidth:r};if(C){if(null==N||N(s),M(Se.Publish_To_Gallery),"bot"===u){const s={bot_id:p,job_id:null===(e=null==h?void 0:h.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==h?void 0:h.id,file_url:t};null==d||d.track("Chat_Publish_Gallery",s)}}else null==g||g(!0),null==v||v(s)}else null==_||_("PUBLISH"),null==T||T(t,{messageId:h.id,imageLink:t,naturalHeight:l,naturalWidth:r}),M(Se.Publish_To_Gallery)},disabled:y,children:[y?e.jsx(di,{}):e.jsx(_d,{size:"2xl",className:"flex items-center text-default"}),e.jsx(Ul,{className:"text-default",children:S("publish_to_gallery")})]}),e.jsxs(Lp,{onClick:()=>{var e;if(j(),M(Se.Copy_Image_Link),"bot"===u){const s={bot_id:p,job_id:null===(e=null==h?void 0:h.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==h?void 0:h.id,file_url:t};null==d||d.track("Chat_Copy_Image_Link",s)}},children:[e.jsx(Rp,{className:"w-6 h-6 text-default flex items-center"}),e.jsx(Ul,{className:"text-default",children:S("copy_image_link")})]})]})}function Bp(t){const{setEditorMode:n,share:l}=a.useContext(At),{add:r}=l||{},{message:i}=Am(),{source:o,asMenuItem:c=!1}=t,d=s.useTranslations("bot"),u=()=>{null==r||r(i.id),null==n||n("SHARE")};return"menubar"===o?c?e.jsxs(Ui,{onClick:u,children:[e.jsx(Zs,{className:"w-5 h-5"}),e.jsx(Ul,{className:"ml-2",children:d("share")})]}):e.jsx(Kl,{hoverText:d("share"),variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:u,icon:Zs}):e.jsxs(Lp,{onClick:u,children:[e.jsx(Zs,{className:"w-5 h-5"}),e.jsx(Ul,{className:"ml-2",children:d("share")})]})}const Gp=t=>e.jsxs(u.Icon,Object.assign({viewBox:"0 0 20 20",fill:"none"},t,{children:[e.jsx("path",{d:"M1.05412 8.20896C1.8842 4.11967 5.49857 1.04163 9.83325 1.04163C14.168 1.04163 17.7823 4.11967 18.6124 8.20896C18.6811 8.54724 18.4625 8.87713 18.1243 8.9458C17.786 9.01447 17.4561 8.79591 17.3874 8.45763C16.6732 4.93942 13.5618 2.29163 9.83325 2.29163C6.5008 2.29163 3.66124 4.4068 2.58571 7.36812L3.96898 6.90703C4.29645 6.79788 4.6504 6.97485 4.75955 7.30232C4.86871 7.62978 4.69173 7.98373 4.36427 8.09289L1.86427 8.92622C1.6526 8.99678 1.41938 8.94914 1.25233 8.80125C1.08528 8.65335 1.00973 8.42762 1.05412 8.20896Z",fill:"currentColor"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.99996 6.04163C10.2483 6.04163 10.473 6.18862 10.5726 6.41611L13.4892 13.0828C13.6276 13.399 13.4834 13.7675 13.1671 13.9059C12.8509 14.0442 12.4824 13.9 12.344 13.5838L11.5964 11.875H8.40351L7.65589 13.5838C7.51754 13.9 7.14902 14.0442 6.83278 13.9059C6.51654 13.7675 6.37234 13.399 6.51069 13.0828L9.42736 6.41611C9.52689 6.18862 9.75165 6.04163 9.99996 6.04163ZM11.0495 10.625L9.99996 8.22593L8.95039 10.625H11.0495Z",fill:"currentColor"}),e.jsx("path",{d:"M2.27913 11.5423C2.21047 11.204 1.88057 10.9855 1.54229 11.0541C1.20402 11.1228 0.985451 11.4527 1.05412 11.791C1.8842 15.8803 5.49857 18.9583 9.83325 18.9583C14.168 18.9583 17.7823 15.8803 18.6124 11.791C18.6578 11.5673 18.5777 11.3367 18.4035 11.1894C18.2292 11.042 17.9885 11.0014 17.7756 11.0833L15.6089 11.9166C15.2868 12.0405 15.126 12.4022 15.25 12.7243C15.3739 13.0465 15.7355 13.2072 16.0577 13.0833L17.0559 12.6993C15.962 15.6252 13.1404 17.7083 9.83325 17.7083C6.10476 17.7083 2.99329 15.0605 2.27913 11.5423Z",fill:"currentColor"})]}));function zp(t){const{addTextDisplayException:n}=a.useContext(At),{source:l,asMenuItem:r=!1}=t,i=s.useTranslations("chat"),{message:o}=Am(),c=()=>{null==n||n(null==o?void 0:o.id)};return"menubar"===l?r?e.jsxs(Ui,{onClick:c,children:[e.jsx(Gp,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:i("chat_setting.transcription")})]}):e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",hoverText:i("chat_setting.transcription"),onClick:c,icon:Gp}):e.jsxs(Lp,{onClick:c,children:[e.jsx(Gp,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:i("chat_setting.transcription")})]})}function Yp(e){const t=hi(),{type:s,entityInfo:n}=a.useContext(jt),{id:l,name:r}=n;return{onSendActionSensors:(a,n)=>{null==t||t.track("MessageAction",Object.assign(Object.assign({action_type:a,message_id:e},"widget"===s?{widget_id:l,widget_name:r}:{bot_id:l,bot_name:r}),n))}}}var Hp=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Vp=t=>{const s=Hp(t,["fillColor"]);return e.jsxs(u.Icon,Object.assign({viewBox:"0 0 24 24",fill:"none"},s,{children:[e.jsx("path",{d:"M1.26501 9.8508C2.26111 4.94365 6.59836 1.25 11.8 1.25C17.0016 1.25 21.3389 4.94365 22.335 9.8508C22.4174 10.2567 22.1551 10.6526 21.7492 10.735C21.3432 10.8174 20.9474 10.5551 20.865 10.1492C20.008 5.92735 16.2742 2.75 11.8 2.75C7.80103 2.75 4.39356 5.28821 3.10293 8.8418L4.76285 8.28849C5.15581 8.1575 5.58055 8.36987 5.71154 8.76283C5.84252 9.15579 5.63015 9.58053 5.2372 9.71151L2.2372 10.7115C1.9832 10.7962 1.70333 10.739 1.50287 10.5615C1.3024 10.3841 1.21175 10.1132 1.26501 9.8508Z",fill:"currentColor"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 7.25C12.298 7.25 12.5677 7.4264 12.6871 7.69939L16.1871 15.6994C16.3532 16.0789 16.1801 16.5211 15.8006 16.6871C15.4212 16.8531 14.9789 16.6801 14.8129 16.3006L13.9158 14.25H10.0843L9.18714 16.3006C9.02112 16.6801 8.5789 16.8531 8.19941 16.6871C7.81993 16.5211 7.64688 16.0789 7.81291 15.6994L11.3129 7.69939C11.4323 7.4264 11.7021 7.25 12 7.25ZM13.2595 12.75L12 9.87117L10.7405 12.75H13.2595Z",fill:"currentColor"}),e.jsx("path",{d:"M2.73503 13.8508C2.65263 13.4449 2.25676 13.1826 1.85083 13.265C1.44489 13.3474 1.18261 13.7433 1.26501 14.1492C2.26111 19.0564 6.59836 22.75 11.8 22.75C17.0016 22.75 21.3389 19.0564 22.335 14.1492C22.3895 13.8808 22.2933 13.6041 22.0843 13.4273C21.8752 13.2505 21.5863 13.2017 21.3307 13.3L18.7308 14.3C18.3442 14.4487 18.1513 14.8826 18.3 15.2692C18.4487 15.6558 18.8827 15.8487 19.2693 15.7L20.4672 15.2393C19.1545 18.7503 15.7685 21.25 11.8 21.25C7.32579 21.25 3.59202 18.0726 2.73503 13.8508Z",fill:"currentColor"})]}))};function $p(t){const{source:a,asMenuItem:n=!1}=t,l=s.useTranslations("chat"),{message:r,displayMode:i,setDisplayMode:o}=Am(),{onSendActionSensors:c}=Yp(r.id),d=()=>{"TRANSLATION"===i?o("NORMAL"):(o("TRANSLATION"),c(Se.Translate))};return"menubar"===a?n?e.jsxs(Ui,{onClick:d,className:Ge.default("TRANSLATION"===i&&"text-brand"),children:[e.jsx(Vp,{className:"size-5"}),e.jsx(Ul,{className:"ml-2 text-inherit",children:l("translate")})]}):e.jsx(Kl,{hoverText:l("translate"),variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:d,children:e.jsx(Vp,{className:Ge.default("size-[18px]","TRANSLATION"===i?"text-brand":"text-default")})}):e.jsxs(Lp,{onClick:d,className:Ge.default("TRANSLATION"===i&&"text-brand"),children:[e.jsx(Vp,{className:"size-5"}),e.jsx(Ul,{className:"ml-2 text-inherit",children:l("translate")})]})}function Wp(t){const{source:a,asMenuItem:n=!1}=t,l=s.useTranslations("common"),{message:r}=Am(),{onCopy:i}=ui(""),o=()=>{i(null==r?void 0:r.text)};return"menubar"===a?n?e.jsxs(Ui,{onClick:o,children:[e.jsx(va,{className:"w-5 h-5"}),e.jsx(Ul,{className:"ml-2",children:l("copy_message")})]}):e.jsx(Kl,{hoverText:l("copy_message"),variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:o,icon:va}):e.jsxs(Lp,{onClick:o,children:[e.jsx(va,{className:"w-5 h-5 text-default"}),e.jsx(Ul,{className:"ml-2 text-default",children:l("copy_message")})]})}function Kp(t){const{source:a,asMenuItem:n}=t,l=s.useTranslations("common"),{setDeleteConfirming:r}=Am(),i=()=>{null==r||r(!0)};return"menubar"===a?n?e.jsxs(Ui,{onClick:i,children:[e.jsx(an,{className:"size-5 text-critical"}),e.jsx(Ul,{className:"ml-2 text-critical",children:l("delete")})]}):e.jsx(Kl,{hoverText:l("delete"),variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:i,children:e.jsx(an,{className:"size-[18px] text-critical"})}):e.jsxs(Lp,{onClick:i,children:[e.jsx(an,{className:"size-5 text-critical"}),e.jsx(Ul,{className:"ml-2 text-critical",children:l("delete")})]})}function qp(t){const{source:n,asMenuItem:l=!1}=t,r=s.useTranslations("common"),{entityInfo:i}=a.useContext(jt),{name:o}=i,{message:c}=Am(),{downloading:d,onDownload:u}=gu(),m=async()=>{try{await u(null==c?void 0:c.audioUrl,`MyShell_chat_${Ve.default().format("YY-MM-DD_HH:mm:ss")}_${o}.mp3`)}catch(e){console.error(e)}};return"menubar"===n?l?e.jsxs(Ui,{disabled:d,onClick:()=>{m()},children:[d?e.jsx(di,{}):e.jsx(Ys,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:r("download_voice")})]}):e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",loading:d,hoverText:r("download_voice"),onClick:m,children:e.jsx(Ys,{className:"size-[18px] text-default"})}):e.jsxs(Lp,{onClick:m,disabled:d,children:[d?e.jsx(di,{size:"md"}):e.jsx(Ys,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:r("download_voice")})]})}function Qp(t){const{clearQueue:n}=a.useContext(At),l=s.useTranslations("workshop"),{source:r,asMenuItem:i=!1}=t,{setDisplayMode:o}=Am(),c=()=>{null==n||n(),o("EDIT")};return"menubar"===r?i?e.jsxs(Ui,{onClick:c,children:[e.jsx(Wa,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("edit")})]}):e.jsx(Kl,{hoverText:l("edit"),variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:c,icon:Wa}):e.jsxs(Lp,{onClick:c,children:[e.jsx(Wa,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("edit")})]})}function Xp({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M15.73 5.5h1.035A7.465 7.465 0 0 1 18 9.625a7.465 7.465 0 0 1-1.235 4.125h-.148c-.806 0-1.534.446-2.031 1.08a9.04 9.04 0 0 1-2.861 2.4c-.723.384-1.35.956-1.653 1.715a4.499 4.499 0 0 0-.322 1.672v.633A.75.75 0 0 1 9 22a2.25 2.25 0 0 1-2.25-2.25c0-1.152.26-2.243.723-3.218.266-.558-.107-1.282-.725-1.282H3.622c-1.026 0-1.945-.694-2.054-1.715A12.137 12.137 0 0 1 1.5 12.25c0-2.848.992-5.464 2.649-7.521C4.537 4.247 5.136 4 5.754 4H9.77a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23ZM21.669 14.023c.536-1.362.831-2.845.831-4.398 0-1.22-.182-2.398-.52-3.507-.26-.85-1.084-1.368-1.973-1.368H19.1c-.445 0-.72.498-.523.898.591 1.2.924 2.55.924 3.977a8.958 8.958 0 0 1-1.302 4.666c-.245.403.028.959.5.959h1.053c.832 0 1.612-.453 1.918-1.227Z"}))}const Jp=Fe.forwardRef(Xp);function Zp({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M7.493 18.5c-.425 0-.82-.236-.975-.632A7.48 7.48 0 0 1 6 15.125c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75A.75.75 0 0 1 15 2a2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23h-.777ZM2.331 10.727a11.969 11.969 0 0 0-.831 4.398 12 12 0 0 0 .52 3.507C2.28 19.482 3.105 20 3.994 20H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 0 1-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227Z"}))}const ef=Fe.forwardRef(Zp);var tf=function(e,t){for(var s={};e.length;){var a=e[0],n=a.code,l=a.message,r=a.path.join(".");if(!s[r])if("unionErrors"in a){var i=a.unionErrors[0].errors[0];s[r]={message:i.message,type:i.code}}else s[r]={message:l,type:n};if("unionErrors"in a&&a.unionErrors.forEach((function(t){return t.errors.forEach((function(t){return e.push(t)}))})),t){var o=s[r].types,c=o&&o[a.code];s[r]=R.appendErrors(r,t,s,n,c?[].concat(c,a.message):a.message)}e.shift()}return s},sf=function(e,t,s){return void 0===s&&(s={}),function(a,n,l){try{return Promise.resolve(function(n,r){try{var i=Promise.resolve(e["sync"===s.mode?"parse":"parseAsync"](a,t)).then((function(e){return l.shouldUseNativeValidation&&k.validateFieldsNatively({},l),{errors:{},values:s.raw?a:e}}))}catch(e){return r(e)}return i&&i.then?i.then(void 0,r):i}(0,(function(e){if(function(e){return Array.isArray(null==e?void 0:e.errors)}(e))return{values:{},errors:k.toNestErrors(tf(e.errors,!l.shouldUseNativeValidation&&"all"===l.criteriaMode),l)};throw e})))}catch(e){return Promise.reject(e)}}},af=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const nf=w.cva("text-sm font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-30"),lf=Fe.forwardRef(((t,s)=>{var{className:a}=t,n=af(t,["className"]);return e.jsx(nt.Root,Object.assign({ref:s,className:pn(nf(),a)},n))}));lf.displayName=nt.Root.displayName;var rf=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const of=R.FormProvider,cf=Fe.createContext({});function df(t){var s=rf(t,[]);return e.jsx(cf.Provider,{value:{name:s.name},children:e.jsx(R.Controller,Object.assign({},s))})}const uf=()=>{const e=Fe.useContext(cf),t=Fe.useContext(mf),{getFieldState:s,formState:a}=R.useFormContext(),n=s(e.name,a);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return Object.assign({id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`},n)},mf=Fe.createContext({}),pf=w.cva("",{variants:{layout:{Vertical:"space-y-1.5",Horizontal:"flex flex-row items-center space-x-3"}},defaultVariants:{layout:"Vertical"}}),ff=Fe.forwardRef(((t,s)=>{var{className:a,layout:n}=t,l=rf(t,["className","layout"]);const r=Fe.useId(),i=pn(a,pf({layout:n}));return e.jsx(mf.Provider,{value:{id:r},children:e.jsx("div",Object.assign({ref:s,className:i},l))})}));ff.displayName="FormItem";Fe.forwardRef(((t,s)=>{var{className:a,required:n,children:l}=t,r=rf(t,["className","required","children"]);const{formItemId:i}=uf();return e.jsxs(lf,Object.assign({ref:s,className:a,htmlFor:i},r,{children:[n?e.jsx("span",{className:"text-[#EC2F0D] mr-1",children:"*"}):null,l]}))})).displayName="FormLabel";const hf=Fe.forwardRef(((t,s)=>{var a=rf(t,[]);const{error:n,formItemId:l,formDescriptionId:r,formMessageId:i}=uf();return e.jsx(U.Slot,Object.assign({ref:s,id:l,"aria-describedby":n?`${r} ${i}`:`${r}`,"aria-invalid":!!n},a))}));hf.displayName="FormControl";Fe.forwardRef(((t,s)=>{var{className:a}=t,n=rf(t,["className"]);const{formDescriptionId:l}=uf();return e.jsx("p",Object.assign({ref:s,id:l,className:pn("text-sm text-subtler",a)},n))})).displayName="FormDescription";Fe.forwardRef(((t,s)=>{var{className:a,children:n}=t,l=rf(t,["className","children"]);const{error:r,formMessageId:i}=uf(),o=r?String(null==r?void 0:r.message):n;return o?e.jsx("p",Object.assign({ref:s,id:i,className:pn("text-sm font-medium text-critical",a)},l,{children:o})):null})).displayName="FormMessage";var gf=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const vf=Fe.forwardRef(((t,s)=>{var a,n,{className:l,maxLength:r,value:i,error:o}=t,c=gf(t,["className","maxLength","value","error"]);return e.jsxs("div",{children:[e.jsxs("div",{className:"relative",children:[e.jsx("textarea",Object.assign({className:pn("w-full min-h-[123px] p-3 pb-10 rounded-lg border border-default bg-surface-search-field ","shadow-background-default text-sm text-default ring-offset-surface-default  ","hover:border-hovered hover:bg-surface-subtle aria-[invalid=true]:border-critical aria-[invalid=true]:hover:border-surface-critical-hovered aria-[invalid=true]:hover:bg-surface-accent-red-subtlest ","aria-[invalid=true]:focus-visible:ring-error file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-subtler","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-30",r&&((null===(a=null==i?void 0:i.toString())||void 0===a?void 0:a.length)||0)>r||o?"border-critical hover:border-critical hover:bg-surface-accent-red-subtlest focus-visible:ring-error":"",l),ref:s,maxLength:r,value:i},c)),r?e.jsx("div",{className:"absolute text-right bottom-5 right-4 border-default",children:e.jsx(Ul,{size:"sm",color:"subtlest",children:`${(null===(n=null==i?void 0:i.toString())||void 0===n?void 0:n.length)||0}/${r}`})}):null]}),o&&e.jsx("div",{className:"w-full",children:e.jsx(Ul,{className:"text-wrap",size:"sm",weight:"regular",color:"critical",children:o})})]})}));vf.displayName="Textarea";const xf=[{label:"boring",value:"Boring"},{label:"out_of_character",value:"Out of Character"},{label:"inaccurate",value:"Inaccurate"},{label:"incorrect_voice_generation",value:"Incorrect Voice Generation"},{label:"long_waiting_time",value:"Long Waiting Time"},{label:"offensive",value:"Offensive"},{label:"repetitive",value:"Repetitive"},{label:"incorrect_translation",value:"Incorrect Translation"}];function bf({open:t,onClose:n,onRemoveDislike:l,onSendFeedback:r}){const i=s.useTranslations("report"),o=s.useTranslations("common"),c=D.z.object({issues:D.z.array(D.z.string()),other:D.z.string()}),d=R.useForm({defaultValues:{issues:[],other:""},resolver:sf(c)}),{watch:u}=d,m=u("issues"),p=u("other"),f=a.useMemo((()=>!(m.length||p.length)),[m.length,p.length]);return e.jsxs(Mr,{contentClassName:"w-[620px]",open:t,onClose:n,children:[e.jsxs(Pr,{className:"p-4 md:p-5",children:[e.jsx(Rl,{size:"h2",children:i("tell_us_more")}),e.jsx(Ul,{color:"subtle",size:"sm",children:i("report_msg_tips")})]}),e.jsx(kr,{className:"py-3 px-4 md:px-5",children:e.jsx(of,Object.assign({},d,{children:e.jsx("form",{className:"flex flex-col gap-3",children:e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsx(df,{control:d.control,name:"issues",render:({field:t})=>e.jsx(ff,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:xf.map((s=>{const a=t.value.includes(s.value);return e.jsxs("button",{type:"button",role:"checkbox","aria-checked":a,className:Ge.default("flex items-center justify-center gap-1 rounded-lg h-7 px-3 cursor-pointer",a?"bg-surface-primary-default text-white":"bg-surface-accent-gray-subtlest text-default"),onClick:()=>{a?t.onChange(t.value.filter((e=>e!==s.value))):t.onChange([...t.value,s.value])},children:[e.jsx(Ul,{className:"text-sm text-inherit",children:i(s.label)}),a&&e.jsx(ca,{className:"size-4 text-white"})]},s.value)}))})})}),e.jsx(Rl,{size:"h5",children:i("others_that_apply")}),e.jsx(df,{control:d.control,name:"other",render:({field:t})=>e.jsx(ff,{children:e.jsx(hf,{children:e.jsx(vf,Object.assign({placeholder:i("placeholder_tips"),autoFocus:!1,className:"h-[138px] px-3 py-2 text-sm resize-none"},t))})})})]})})}))}),e.jsxs(Lr,{className:"p-4 md:p-5 flex items-center gap-4",children:[e.jsx(Tr,{variant:"outline",color:"default",onClick:n,children:o("cancel")}),e.jsx(Tr,{variant:"primary",color:"brand",disabled:f,onClick:async()=>{r(m,p),n()},children:i("send_feedback")})]})]})}function Ef(e,t,s,a){const{onSendActionSensors:n}=Yp(t);return{reportMessage:async(e,l)=>{n(l===Te.LIKED?Se.Like:Se.Dislike);try{s(l);const{success:n}=await(()=>{let e;return e=Gi,e})()(l,t);n?e===Te.DISLIKE&&l===Te.NORMAL&&a([]):s(e)}catch(t){s(e),console.error(t)}},sendMessageFeedback:async(e,s)=>{n(Se.Feedback,{feedback_detail:e});try{a([...e,s]);const{success:n}=await(()=>{let e;return e=zi,e})()("msg_feedback",t,e,s);n||a([])}catch(e){a([]),console.error(e)}}}}const _f={Boring:"boring","Out of Character":"out_of_character",Inaccurate:"inaccurate",Offensive:"offensive",Repetitive:"repetitive","Incorrect Voice Generation":"incorrect_voice_generation","Long Waiting Time":"long_waiting_time","Incorrect Translation":"incorrect_translation",Others:"others"};function wf({source:t,asMenuItem:a,onReport:n}){const l=s.useTranslations("report");return"menubar"===t?a?e.jsxs(e.Fragment,{children:[e.jsxs(Ui,{onClick:()=>n(Te.LIKED),children:[e.jsx(Ia,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("like")})]}),e.jsxs(Ui,{onClick:()=>n(Te.DISLIKE),children:[e.jsx(Sa,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("dislike")})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",hoverText:l("like"),onClick:()=>n(Te.LIKED),icon:Ia}),e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",hoverText:l("dislike"),onClick:()=>n(Te.DISLIKE),icon:Sa})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Lp,{onClick:()=>n(Te.LIKED),children:[e.jsx(Ia,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("like")})]}),e.jsxs(Lp,{onClick:()=>n(Te.DISLIKE),children:[e.jsx(Sa,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:l("dislike")})]})]})}function Tf({source:t,asMenuItem:a,onReport:n}){const l=s.useTranslations("report");return"menubar"===t?a?e.jsxs(Ui,{onClick:()=>n(Te.NORMAL),children:[e.jsx(ef,{className:"size-5 text-brand"}),e.jsx(Ul,{className:"ml-2",children:l("like")})]}):e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",hoverText:l("like"),onClick:()=>n(Te.NORMAL),icon:ef}):e.jsxs(Lp,{onClick:()=>n(Te.NORMAL),children:[e.jsx(ef,{className:"size-5 text-brand"}),e.jsx(Ul,{className:"ml-2",children:l("like")})]})}function Nf({source:t,asMenuItem:n,onReport:l,feedbackIssues:r,sendFeedback:i}){const o=s.useTranslations("chat"),d=s.useTranslations("report"),[u,m]=c.useToggle(!1),p=a.useMemo((()=>{var e,t;return null!==(t=null===(e=(null!=r?r:[]).filter((e=>!!e)).map((e=>_f[e]?d(_f[e]):e)))||void 0===e?void 0:e.join(", "))&&void 0!==t?t:""}),[r,d]),f=()=>{(null==r?void 0:r.length)?l(Te.NORMAL):m(!0)};return e.jsxs(e.Fragment,{children:["menubar"===t?n?e.jsxs(Ui,{onClick:f,children:[e.jsx(Jp,{className:"size-5 text-critical"}),e.jsx(Ul,{color:"critical",className:"ml-2",children:p?p.slice(0,8):o("feedback")})]}):e.jsx(Hl,{size:"md",description:d("dislike"),side:"top",align:"center",children:e.jsx(Tr,{variant:"outline",size:"sm",color:"default",className:"rounded-lg text-critical",onClick:f,icon:Jp,iconClassName:"size-[18px] !text-icon-critical",children:p?p.slice(0,8):o("feedback")})}):e.jsxs(Lp,{onClick:f,children:[e.jsx(Jp,{className:"size-5 text-critical"}),e.jsx(Ul,{color:"critical",className:"ml-2",children:p?p.slice(0,8):o("feedback")})]}),e.jsx(bf,{open:u,onClose:()=>m(!1),onRemoveDislike:()=>{l(Te.NORMAL)},onSendFeedback:i})]})}function yf(t){const{source:s,asMenuItem:n}=t,{type:l}=a.useContext(jt),{partialUpdateMessage:r}=a.useContext(At),{message:i}=Am(),o=null==i?void 0:i.feedbackState,c=null==i?void 0:i.feedbackIssues,{reportMessage:d,sendMessageFeedback:u}=Ef(0,i.id,(e=>{null==r||r(i.id,{feedbackState:e})}),(e=>{null==r||r(i.id,{feedbackIssues:e})})),m=(null==i?void 0:i.feedbackState)===Te.LIKED?Tf:(null==i?void 0:i.feedbackState)===Te.DISLIKE?Nf:wf;return e.jsx(m,{source:s,onReport:e=>{d(null!=o?o:Te.NORMAL,e)},feedbackIssues:c,sendFeedback:u,asMenuItem:n})}function Cf({source:t,asMenuItem:s}){return"contextmenu"===t?e.jsx(kp,{}):s?e.jsx(Fi,{}):null}function Sf(t){var n,l,r,i,o,c;const{message:d,replyOriginMessage:u}=Am(),m=s.useTranslations("chat"),{regenerateMessage:p}=a.useContext(At),{source:f,asMenuItem:h=!1}=t,g=()=>{null==p||p(d,u)};return"menubar"===f?h?e.jsxs(Ui,{onClick:g,children:[e.jsx(qs,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:m("Regenerate")}),!!(null===(n=null==d?void 0:d.extraInfo)||void 0===n?void 0:n.consumeEnergy)&&e.jsxs(e.Fragment,{children:[e.jsx(br,{orientation:"vertical",className:"h-3 bg-alpha-facetime-white mx-[6px]"}),e.jsxs("div",{className:"flex gap-[2px] items-center",children:[e.jsx(Ye.default,{alt:"energy cost",src:"https://www.myshellstatic.com/image/chat/embed_obj/172/202405210853/icon-wrapper-16px@2x.png.png",width:16,height:16,className:"size-4 rounded-[4px]"}),e.jsx(Ul,{size:"xs",className:"text-inherit",children:null===(l=null==d?void 0:d.extraInfo)||void 0===l?void 0:l.consumeEnergy})]})]})]}):e.jsx(Hl,{size:"md",description:m("Regenerate"),side:"top",align:"center",children:(null===(r=null==d?void 0:d.extraInfo)||void 0===r?void 0:r.consumeEnergy)?e.jsxs(Tr,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg px-3 text-default",onClick:g,children:[e.jsx(qs,{className:"size-[18px] !text-default"}),e.jsx(br,{orientation:"vertical",className:"h-3 bg-alpha-facetime-white mx-[6px]"}),e.jsxs("div",{className:"flex gap-[2px] items-center",children:[e.jsx(Ye.default,{alt:"energy cost",src:"https://www.myshellstatic.com/image/chat/embed_obj/172/202405210853/icon-wrapper-16px@2x.png.png",width:16,height:16,className:"size-4 rounded-[4px]"}),e.jsx(Ul,{size:"xs",className:"text-inherit",children:null===(i=null==d?void 0:d.extraInfo)||void 0===i?void 0:i.consumeEnergy})]})]}):e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:g,children:e.jsx(qs,{className:"size-[18px] !text-default"})})}):e.jsxs(Lp,{onClick:g,children:[e.jsx(qs,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:m("Regenerate")}),!!(null===(o=null==d?void 0:d.extraInfo)||void 0===o?void 0:o.consumeEnergy)&&e.jsxs(e.Fragment,{children:[e.jsx(br,{orientation:"vertical",className:"h-3 bg-alpha-facetime-white mx-[6px]"}),e.jsxs("div",{className:"flex gap-[2px] items-center",children:[e.jsx(Ye.default,{alt:"energy cost",src:"https://www.myshellstatic.com/image/chat/embed_obj/172/202405210853/icon-wrapper-16px@2x.png.png",width:16,height:16,className:"size-4 rounded-[4px]"}),e.jsx(Ul,{size:"xs",className:"text-inherit",children:null===(c=null==d?void 0:d.extraInfo)||void 0===c?void 0:c.consumeEnergy})]})]})]})}var jf=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const If=t=>{const s=jf(t,["fillColor"]);return e.jsxs(u.Icon,Object.assign({viewBox:"0 0 20 20",fill:"none"},s,{children:[e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.8251 2.20003V13.6C4.8251 13.9176 5.08254 14.175 5.4001 14.175H15.0001V15.425H5.4001C4.39218 15.425 3.5751 14.608 3.5751 13.6V2.20003H4.8251Z",fill:"currentColor"}),e.jsx("path",{d:"M5.5 2.25C5.5 2.94036 4.94036 3.5 4.25 3.5C3.55964 3.5 3 2.94036 3 2.25C3 1.55964 3.55964 1 4.25 1C4.94036 1 5.5 1.55964 5.5 2.25Z",fill:"currentColor"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.3751 17.8001V6.40013C14.3751 6.08257 14.1177 5.82513 13.8001 5.82513H4.2001V4.57513H13.8001C14.808 4.57513 15.6251 5.39221 15.6251 6.40013V17.8001H14.3751Z",fill:"currentColor"}),e.jsx("path",{d:"M13.7001 17.7501C13.7001 17.0597 14.2597 16.5001 14.9501 16.5001C15.6405 16.5001 16.2001 17.0597 16.2001 17.7501C16.2001 18.4404 15.6405 19.0001 14.9501 19.0001C14.2597 19.0001 13.7001 18.4404 13.7001 17.7501Z",fill:"currentColor"})]}))};function Of(t){const a=xl((e=>e.isMobile)),{source:n,asMenuItem:l=!1}=t,r=s.useTranslations("common"),{setSelectTextVisible:i}=Am(),o=()=>{null==i||i(!0)};return a?"menubar"===n?l?e.jsxs(Ui,{onClick:o,children:[e.jsx(If,{className:"size-5"}),e.jsx(Ul,{className:"ml-2",children:r("select_text")})]}):e.jsx(Hl,{description:r("select_text"),side:"top",align:"center",children:e.jsx(Kl,{variant:"primary",size:"sm",color:"gray",className:"rounded-lg",onClick:o,children:e.jsx(If,{className:"size-5"})})}):e.jsxs(Lp,{onClick:o,children:[e.jsx(If,{className:"size-5"}),e.jsx(Ul,{className:"ml-2 text-default",children:r("select_text")})]}):null}function Af({specifiedActions:t,source:s,asMenuItem:n}){const{actions:l}=Am(),r=t||l,i=a.useCallback((({action_type:t})=>{switch(t){case Se.Copy_Message:return e.jsx(Wp,{source:s,asMenuItem:n});case Se.Delete:return e.jsx(Kp,{source:s,asMenuItem:n});case Se.Download_Voice:return e.jsx(qp,{source:s,asMenuItem:n});case Se.Edit:return e.jsx(Qp,{source:s,asMenuItem:n});case Se.Regenerate:return e.jsx(Sf,{source:s,asMenuItem:n});case Se.Feedback:return e.jsx(yf,{source:s,asMenuItem:n});case Se.Show_Text:return e.jsx(zp,{source:s,asMenuItem:n});case Se.Translate:return e.jsx($p,{source:s,asMenuItem:n});case Se.Share:return e.jsx(Bp,{source:s,asMenuItem:n});case Se.Select_Text:return e.jsx(Of,{source:s,asMenuItem:n});case Se.Divider:return e.jsx(Cf,{source:s,asMenuItem:n});default:console.error(`${t}类型的组件不存在`)}}),[n,s]);return r.map(((t,s)=>e.jsx(i,{action_type:t},`${t}-${s}`)))}function Mf(){return e.jsx(Af,{source:"contextmenu"})}const Pf=({children:t,source:s})=>{const n=ls()?document.getElementById("renderer-container"):null,{actions:l,contextMenuDisabled:r}=Am(),[i,o]=a.useState(),[c,d]=a.useState(!1),[u,m]=a.useState(!1),[p,f]=a.useState();xl((e=>e.isMobile));const{isIos:h}=No(),g=e=>{var t,s,a,n,r;const i="IMG"===(null===(s=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.tagName)||void 0===s?void 0:s.toUpperCase());if(m(i),i){const t=null===(a=null==e?void 0:e.target)||void 0===a?void 0:a.getAttribute("x-image-source"),s=Object.assign(Object.assign({url:null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.getAttribute("src")},null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.getAttribute("x-image-data")),{naturalHeight:e.target.naturalHeight,naturalWidth:e.target.naturalWidth,source:t||"markdown"});f(s)}b.isEmpty(l)&&!i&&e.preventDefault()},v=e=>{var t,s,a,n,l;"IMG"===(null===(s=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.tagName)||void 0===s?void 0:s.toUpperCase())&&"1"===(null===(a=null==e?void 0:e.target)||void 0===a?void 0:a.getAttribute("x-intercept-click"))&&(o({url:null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.getAttribute("src"),title:null===(l=null==e?void 0:e.target)||void 0===l?void 0:l.getAttribute("alt"),type:il.IMAGE,status:ol.DONE,extensionName:"",iconUrl:""}),d(!0))},[x,E]=a.useState(0),[_,w]=a.useState(null);return e.jsxs(e.Fragment,{children:[e.jsxs(Ap,{children:[e.jsx(Mp,Object.assign({disabled:r,className:"select-none md:select-auto"},h?{onTouchStart:e=>{E(Date.now());const t=setTimeout((()=>{(e=>{const{target:t}=e;Date.now()-x>=500&&(e.preventDefault(),g({target:t}))})(e)}),500);w(t)},onTouchEnd:()=>{_&&clearTimeout(_)},onClick:v}:{onContextMenu:g,onClick:v},{children:t})),e.jsx(Pp,{collisionBoundary:[n],children:u?e.jsx(Fp,{url:p.url,imageModel:null==p?void 0:p.imageModel,naturalHeight:p.naturalHeight,naturalWidth:p.naturalWidth,imageSource:p.source,source:s}):e.jsx(Mf,{})})]}),e.jsx(qm,{open:c,onClose:()=>{d(!1)},imgVideoList:i?[i]:[],activeIndex:0})]})};function Lf({position:t,className:a}){const n=s.useTranslations(),l=xl((e=>e.isMobile));return e.jsxs("div",{className:pn("absolute left-4 bottom-1 z-10 w-[150px] md:w-[220px] h-fit flex border-opaque rounded-lg bg-utility-sky-blue-500 py-2 pl-3 pr-5 text-wrap text-left",a),style:Object.assign({},t&&{left:t.x,top:t.y}),children:[e.jsx(Fl,{size:"lg",weight:"medium",color:"static",children:n(l?"chat.mob_publish_to_gallery":"chat.right_publish_to_gallery")}),e.jsx("span",{className:"absolute left-0 top-3 origin-center",style:{transformOrigin:"0px 0px",transform:"translateY(50%) rotate(90deg) translateX(-50%)"},children:e.jsx("svg",{className:"fill-utility-sky-blue-500 block",width:"10",height:"5",viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.jsx("polygon",{points:"0,0 30,0 15,10"})})})]})}function kf({className:t}){return e.jsx("svg",{className:t,width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("g",{id:"Icon/44/fail",children:e.jsxs("g",{id:"Vector",children:[e.jsx("path",{d:"M13.0372 12.2075C13.0372 11.7648 12.9059 11.332 12.66 10.9639C12.414 10.5958 12.0644 10.3089 11.6554 10.1395C11.2464 9.97007 10.7963 9.92574 10.3621 10.0121C9.92794 10.0985 9.52909 10.3117 9.21605 10.6247C8.903 10.9378 8.68982 11.3366 8.60345 11.7708C8.51708 12.205 8.56141 12.6551 8.73083 13.0641C8.90024 13.4731 9.18714 13.8227 9.55525 14.0687C9.92335 14.3147 10.3561 14.4459 10.7988 14.4459C11.3925 14.4459 11.9618 14.2101 12.3816 13.7903C12.8014 13.3705 13.0372 12.8012 13.0372 12.2075Z",fill:"#C9CCD0"}),e.jsx("path",{d:"M12.9854 19.5906C12.2801 18.5247 10.74 18.4578 9.94495 19.4584L5.62815 24.8919V6.98455H14.9058C15.8034 6.98455 16.4979 6.19785 16.3866 5.30718C16.2932 4.56041 15.6584 4 14.9058 4H6.42672C4.34974 4 2.66602 5.68372 2.66602 7.7607V24.1157C2.66602 26.1927 4.34974 27.8764 6.42672 27.8764H16.9208L14.5183 21.9073L12.9854 19.5906ZM20.8774 4C19.9805 4 19.2863 4.78547 19.3964 5.67554C19.4889 6.42313 20.1241 6.98455 20.8774 6.98455H26.3705V21.9073L22.4818 17.01C21.5852 15.8809 19.8038 16.1394 19.2651 17.4768L17.4804 21.9073L19.8829 27.8764H25.572C27.649 27.8764 29.3327 26.1927 29.3327 24.1157V7.76071C29.3327 5.68373 27.649 4 25.572 4H20.8774Z",fill:"#C9CCD0"})]})})})}var Rf=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Df=t=>{var{src:n,alt:l,placeholder:r,errorMessage:o="Failed",className:c="",style:d,aspectRatio:u,status:m,index:p,imageLoadCallback:f}=t,h=Rf(t,["src","alt","placeholder","errorMessage","className","style","aspectRatio","status","index","imageLoadCallback"]);const[g,v]=a.useState(!0),[x,b]=a.useState(!1),{resolvedTheme:E}=i.useTheme(),_=s.useTranslations("chat"),w="ERROR"===m||x||"DONE"===m&&!n;return e.jsxs("div",{className:Ge.default("w-full h-full relative bg-surface-container-default overflow-hidden",c),children:[g&&!w&&e.jsxs("div",{className:"inset-0 flex items-center justify-center text-white bg-surface-container-default dark:bg-[#202126]",children:[e.jsx("img",{src:`/images/${E}.gif`,className:"w-full h-full object-contain",style:d}),"PROCESSING"===m&&"5/1"!==String(u)&&e.jsx("div",{className:"text-subtle text-sm absolute z-2 bottom-[22%]",children:_("generating")})]}),!w&&!!n&&e.jsx("img",Object.assign({src:n,alt:l,onLoad:()=>{v(!1),null==f||f()},onError:()=>{v(!1),b(!0)},className:"w-full h-full transition-opacity duration-300 "+(g?"opacity-60":"opacity-100")},h)),w&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white ",children:e.jsx(fr,{component:kf,className:"bg-[#C9CCD0] w-8 h-8"})})]})},Uf={left:e.jsx("polyline",{points:"15 18 9 12 15 6"}),right:e.jsx("polyline",{points:"9 18 15 12 9 6"}),maximize:e.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"}),minimize:e.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"}),play:e.jsx("polygon",{points:"5 3 19 12 5 21 5 3"}),pause:e.jsxs(Fe.default.Fragment,{children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})},Ff={strokeWidth:1,viewBox:"0 0 24 24"},Bf=t=>{const{strokeWidth:s,viewBox:a,icon:n}=Object.assign(Object.assign({},Ff),t);return e.jsx("svg",{className:"image-gallery-svg w-[16px] h-[16px] md:w-[28px] md:h-[28px] focus:outline-none",xmlns:"http://www.w3.org/2000/svg",viewBox:a,fill:"none",stroke:"currentColor",strokeWidth:s,strokeLinecap:"round",strokeLinejoin:"round",children:Uf[n]})},Gf=Fe.default.memo((({isFullscreen:t,onClick:s})=>e.jsx("button",{type:"button",className:"appearance-none absolute right-0 bottom-0 p-5 text-white bg-transparent border-0 cursor-pointer z-[4] drop-shadow-md",onClick:s,"aria-label":"Open Fullscreen",children:e.jsx(Bf,{strokeWidth:2,icon:t?"minimize":"maximize"})}))),zf={fullscreen:"",isFullscreen:!1,originalAlt:"",originalHeight:"",originalWidth:"",sizes:"",srcSet:"",loading:"eager",original:"",handleImageLoaded:()=>{}},Yf=Fe.default.memo((t=>{const{fullscreen:s,handleImageLoaded:a,isFullscreen:n,onImageError:l,original:r,originalAlt:i,originalHeight:o,originalWidth:c,sizes:d,srcSet:u,loading:m}=Object.assign(Object.assign({},zf),t),p=n&&s||r,f=o?`${o}px`:"auto",h=c?`${c}px`:"auto",g=c?`max-w-[${c}px]`:"max-w-full";return e.jsx("img",{"data-source":"gallery",className:Ge.default("image-gallery-image w-full object-contain h-full max-h-[calc(100vh-180px)]",g),src:p,alt:i,srcSet:u,height:f,width:h,sizes:d,onLoad:e=>a(e,r),onError:l,loading:m})})),Hf={className:"",delta:0,onSwiping:()=>{},onSwiped:()=>{}},Vf=t=>{const{children:s,className:a,delta:n,onSwiping:l,onSwiped:r}=Object.assign(Object.assign({},Hf),t),i=B.useSwipeable({delta:n,onSwiping:l,onSwiped:r});return e.jsx("div",Object.assign({},i,{className:a,children:s}))};var $f=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Wf=["fullscreenchange","MSFullscreenChange","mozfullscreenchange","webkitfullscreenchange"],Kf={onErrorImageURL:"",additionalClass:"",showNav:!0,lazyLoad:!1,infinite:!0,showIndex:!1,showBullets:!1,bulltetPosition:"inside",slideWrapperClass:"",showThumbnails:!1,showFullscreenButton:!1,disableThumbnailScroll:!1,disableKeyDown:!1,disableSwipe:!1,disableThumbnailSwipe:!1,useTranslate3D:!0,useBrowserFullscreen:!0,flickThreshold:.4,stopPropagation:!1,indexSeparator:" / ",startIndex:0,slideDuration:450,swipingTransitionDuration:0,swipingThumbnailTransitionDuration:0,onSlide:null,onBeforeSlide:null,onScreenChange:null,onPause:null,onPlay:null,onClick:()=>{},onImageLoad:()=>{},onImageError:()=>{},onTouchMove:()=>{},onTouchEnd:()=>{},onTouchStart:()=>{},onMouseOver:()=>{},onMouseLeave:()=>{},onBulletClick:()=>{},onThumbnailError:()=>{},onThumbnailClick:()=>{},onContainerClick:()=>{},renderCustomControls:null,renderThumbInner:null,renderItem:null,slideInterval:3e3,slideOnThumbnailOver:!1,swipeThreshold:30,renderLeftNav:(t,s)=>e.jsx("div",{className:Ge.default("hidden w-6 h-6 rounded-full bg-white absolute left-1 z-10 top-1/2  -translate-y-1/2  justify-center items-center",{hidden:s,"group-hover:flex":!s}),children:e.jsx(ua,{onClick:t,className:"w-4 h-4 text-black cursor-pointer"})}),renderRightNav:(t,s)=>e.jsx("div",{className:Ge.default("hidden w-6 h-6 rounded-full bg-white absolute right-1 z-10 top-1/2 -translate-y-1/2 justify-center items-center",{hidden:s,"group-hover:flex":!s}),children:e.jsx(pa,{onClick:t,className:"w-4 h-4 text-black  cursor-pointer"})}),renderFullscreenButton:(t,s)=>e.jsx(Gf,{onClick:t,isFullscreen:s}),useWindowKeyDown:!0},qf={currentIndex:0,previousIndex:0,isTransitioning:!1,currentSlideOffset:0,slideStyle:{transition:"all 500ms ease-out"},thumbsStyle:{transition:"all 500ms ease-out"},galleryWidth:0,thumbnailsWrapperWidth:0,thumbnailsWrapperHeight:0,thumbsTranslate:0,thumbsSwipedTranslate:0,isFullscreen:!1,isSwipingThumbnail:!1,isModalFullscreen:!1,swipingUpDown:!1,swipingLeftRight:!1,resetStyleIndex:-9999},Qf=(e,t)=>"SetState"===t.type?Object.assign(Object.assign({},e),t.payload):e,Xf=t=>{const s=Object.assign(Object.assign({},Kf),t),{images:n,infinite:l,slideDuration:r,useBrowserFullscreen:i,disableKeyDown:o,useTranslate3D:c,disableSwipe:d,disableThumbnailScroll:u,stopPropagation:m,swipingTransitionDuration:p,swipingThumbnailTransitionDuration:f,swipeThreshold:h,flickThreshold:g,useWindowKeyDown:v,startIndex:x,onContainerClick:b}=s,E=$f(s,["images","infinite","slideDuration","useBrowserFullscreen","disableKeyDown","useTranslate3D","disableSwipe","disableThumbnailScroll","stopPropagation","swipingTransitionDuration","swipingThumbnailTransitionDuration","swipeThreshold","flickThreshold","useWindowKeyDown","startIndex","onContainerClick"]),[_,w]=a.useReducer(Qf,Object.assign(Object.assign({},qf),{currentIndex:x})),T=a.useRef({}),N=a.useRef(null),y=a.useRef(null),C=a.useRef(null),S=a.useRef(null),j=a.useRef(0),I=a.useRef(!1);a.useRef(null);const O=a.useRef(null),A=a.useRef(null),M=a.useRef([]),P=a.useRef(""),L=n.length,k=L>=2,R=_.currentIndex>0,D=l||R,U=_.currentIndex<L-1,F=l||U,G=a.useCallback((e=>e===n.length-1||0===e),[n.length]),z=a.useCallback((()=>{const{previousIndex:e,currentIndex:t}=_,s=n.length-1;return Math.abs(e-t)>1&&!(0===e&&t===s)&&!(e===s&&0===t)}),[_.currentIndex,_.previousIndex,n.length]),Y=a.useCallback((e=>{const{previousIndex:t,currentIndex:s}=_,a=!(e===t||e===s);return I.current&&a}),[I.current,_.previousIndex,_.currentIndex]),H=a.useCallback((e=>!Y(e)||z()&&!G(e)),[Y,z,G]);a.useEffect((()=>{j.current=window.setTimeout((()=>{I.current&&(I.current=!1,w({type:"SetState",payload:{isSwipingThumbnail:!1}}),clearTimeout(j.current))}),r+50)}),[r,I.current]);const V=a.useCallback((e=>{w({type:"SetState",payload:{thumbsTranslate:e}})}),[]);a.useCallback((e=>!!T.current[e.original]||(T.current[e.original]=!0,!1)),[]);const $=(e,s)=>{!T.current[s]&&t.onImageLoad&&(T.current[s]=!0,t.onImageLoad())},W=e=>{},K=a.useCallback((()=>{Wf.forEach((e=>{document.addEventListener(e,Z)}))}),[]),q=a.useCallback((()=>{Wf.forEach((e=>{document.removeEventListener(e,Z)}))}),[]),Q=a.useCallback((()=>{const e=N.current;i?e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():w({type:"SetState",payload:{isModalFullScreen:!0,isFullscreen:!0}}):w({type:"SetState",payload:{isModalFullScreen:!0,isFullscreen:!0}})}),[]),X=a.useCallback((e=>{w({type:"SetState",payload:{isFullscreen:!_.isFullscreen}}),E.onScreenChange}),[_.isFullscreen]),J=a.useCallback((()=>{_.isFullscreen&&(i?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():X(!1):X(!1),w({type:"SetState",payload:{isFullscreen:!1}}))}),[_.isFullscreen,i,X]),Z=a.useCallback((()=>{const e=document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,t=N.current===e;E.onScreenChange,i&&w({type:"SetState",payload:{isFullscreen:t}})}),[i]);a.useCallback((()=>{_.isFullscreen?J():Q()}),[_.isFullscreen,J,Q]);const ee=a.useCallback(((e,t)=>{if(!I.current){const t=n.length-1;let s=e;e<0?s=t:e>t&&(s=0),E.onBeforeSlide&&_.currentIndex,I.current=s!==_.currentIndex,w({type:"SetState",payload:{previousIndex:_.currentIndex,currentIndex:s,isTransitioning:s!==_.currentIndex,currentSlideOffset:0,slideStyle:{transition:`all ${r}ms ease-out`}}})}}),[n.length,_.currentIndex,I.current]),te=a.useMemo((()=>pu(ee,r,{trailing:!1})),[r,ee]),se=a.useCallback(((e,t)=>{const{currentIndex:s,currentSlideOffset:a}=_;w({type:"SetState",payload:{currentSlideOffset:a+(s>e?.001:-.001),slideStyle:{transition:"none"},resetStyleIndex:e}})}),[_.currentIndex,_.currentSlideOffset]),ae=a.useCallback(((e,t)=>{const s=_.currentIndex+("left"===t?-1:1);I.current||(2===n.length?se(s,e):te(s,e))}),[n.length,_.currentIndex,se,te]),ne=a.useCallback((e=>{e.stopPropagation(),ae(e,"left")}),[ae]),le=a.useCallback((e=>{e.stopPropagation(),ae(e,"right")}),[ae]),re=a.useCallback(((e,t)=>{e.stopPropagation(),e.target.blur(),_.currentIndex!==t&&(2===n.length?se(t,e):te(t,e))}),[n.length,_.currentIndex,te,se]),ie=a.useCallback(((e,t)=>{e.stopPropagation(),e.target.parentNode.parentNode.blur(),_.currentIndex!==t&&(2===n.length?se(t,e):te(t,e))}),[se,te,_.currentIndex,n.length]),oe=a.useCallback((({event:e,absX:t,dir:s})=>{const{galleryWidth:a,swipingUpDown:n,swipingLeftRight:l}=_;if(s!==B.UP&&s!==B.DOWN&&!n||l){if(s!==B.LEFT&&s!==B.RIGHT||l||w({type:"SetState",payload:{swipingLeftRight:!0}}),!d)if(m&&e.preventDefault(),I.current)w({type:"SetState",payload:{currentSlideOffset:0}});else{const e=s===B.RIGHT?1:-1;let n=t/a*100;Math.abs(n)>=100&&(n=100);w({type:"SetState",payload:{currentSlideOffset:e*n,slideStyle:{transition:`transform ${p}ms ease-out`}}})}}else n||w({type:"SetState",payload:{swipingUpDown:!0}})}),[_]),ce=a.useCallback((({event:e,absX:t,absY:s,dir:a})=>{if(E.disableThumbnailSwipe)return;const{thumbsSwipedTranslate:n,thumbnailsWrapperHeight:l,thumbnailsWrapperWidth:r,swipingUpDown:i,swipingLeftRight:o}=_;if((a===B.UP||a===B.DOWN||i)&&!o&&!i)return void w({type:"SetState",payload:{cswipingUpDown:!0}});a!==B.LEFT&&a!==B.RIGHT||o||w({type:"SetState",payload:{swipingLeftRight:!0}});const c=C.current;let d,u,p,h,g;if(c){d=n+(a===B.RIGHT?t||0:-(t||0)),u=c.scrollWidth-r+20,p=Math.abs(d)>u,h=d>20,g=c.scrollWidth<=r}if(g)return;if((a===B.LEFT||a===B.UP)&&p)return;if((a===B.RIGHT||a===B.DOWN)&&h)return;m&&e.stopPropagation();w({type:"SetState",payload:{thumbsTranslate:d,thumbsStyle:{transition:`transform ${f}ms ease-out`}}})}),[E.disableThumbnailSwipe,_]),de=a.useCallback((()=>{const{currentSlideOffset:e}=_;return Math.abs(e)>h}),[_.currentSlideOffset,h]),ue=a.useCallback((()=>{const{swipingUpDown:e,swipingLeftRight:t}=_;e&&w({type:"SetState",payload:{swipingUpDown:!1}}),t&&w({type:"SetState",payload:{swipingLeftRight:!1}})}),[_.swipingLeftRight,_.swipingUpDown]),me=a.useCallback((()=>{if(E.disableThumbnailSwipe)return;const{thumbsTranslate:e}=_;ue(),w({type:"SetState",payload:{isSwipingThumbnail:!0,thumbsSwipedTranslate:e,thumbsStyle:{transition:`all ${r}ms ease-out`}}})}),[ue,_.thumbsTranslate,r]),pe=a.useCallback(((e,t)=>{const{currentIndex:s}=_;if(I.current)return;let a=s;!de()&&!t||I.current||(a+=e),(-1===e&&!D||1===e&&!F)&&(a=s),ee(a,"")}),[ee,_.currentIndex,de]),fe=a.useCallback((({event:e,dir:t,velocity:s})=>{if(d||I.current)return;m&&e.stopPropagation(),ue();const a=t===B.LEFT?1:-1,n=t===B.UP||t===B.DOWN;pe(a,s>g&&!n)}),[g,d,pe,ue]),he=a.useCallback((e=>{const{isFullscreen:t}=_;if(o)return;switch(parseInt(e.keyCode||e.which||0,10)){case 37:D&&ne(e);break;case 39:F&&le(e);break;case 27:t&&!i&&J()}}),[o,_.isFullscreen,D,F,ne,le,J]),ge=a.useCallback((e=>{const{swipingLeftRight:t}=_;t&&e.preventDefault()}),[_.swipingLeftRight]),ve=a.useCallback((e=>{const{thumbnailsWrapperWidth:t}=_;let s;const a=C.current;if(u)return 0;if(a){if(a.scrollWidth<=t||t<=0)return 0;s=a.scrollWidth-t;return e*(s/(n.length-1))}return 0}),[u,_.thumbnailsWrapperWidth]),xe=a.useCallback((()=>{const{currentIndex:e}=_;N.current&&(N.current&&w({type:"SetState",payload:{galleryWidth:N.current.offsetWidth}}),S.current&&w({type:"SetState",payload:{gallerySlideWrapperHeight:S.current.offsetHeight}}),V(-ve(e)))}),[_.currentIndex,ve,V]),be=a.useCallback((e=>{e&&!e.current||(O.current=new ResizeObserver(uu((e=>{e&&e.forEach((e=>{w({type:"SetState",payload:{thumbnailsWrapperWidth:e.contentRect.width}})}))}),50)),O.current.observe(e.current))}),[]),Ee=a.useCallback((()=>{A.current&&y&&y.current&&(A.current.unobserve(y.current),A.current=null)}),[]),_e=a.useCallback((()=>{O.current&&S&&S.current&&(O.current.unobserve(S.current),O.current=null),Ee()}),[Ee]),we=a.useCallback((e=>{e&&!e.current||(A.current=new ResizeObserver(uu((e=>{e&&e.forEach((e=>{w({type:"SetState",payload:{thumbnailsWrapperHeight:e.contentRect.height}})}))}),50)),A.current.observe(e.current))}),[]);a.useEffect((()=>{(_.thumbnailsWrapperWidth>0||_.thumbnailsWrapperHeight>0)&&xe()}),[_.thumbnailsWrapperWidth,_.thumbnailsWrapperHeight,xe]),a.useEffect((()=>{_.resetStyleIndex>-9999&&te(_.resetStyleIndex,"")}),[_.resetStyleIndex]),a.useEffect((()=>(v?window.addEventListener("keydown",he):N.current&&N.current.addEventListener("keydown",he),window.addEventListener("touchmove",ge,{passive:!1}),be(S),we(y),K(),()=>{window.removeEventListener("touchmove",ge),q(),_e(),v?window.removeEventListener("keydown",he):N.current&&N.current.removeEventListener("keydown",he)})),[v,he,K,ge]);const Te=e=>{const{currentIndex:t,currentSlideOffset:s,slideStyle:a}=_,r=-100*t,i=n.length-1;let o=r+100*e+s;l&&n.length>2&&(0===t&&e===i?o=-100+s:t===i&&0===e&&(o=100+s)),l&&2===n.length&&(o=(e=>{const{currentIndex:t,currentSlideOffset:s,previousIndex:a}=_,n=t!==a,l=0===e&&0===a,r=1===e&&1===a,i=0===e&&1===t,o=1===e&&0===t,c=0===s;let d=-100*t+100*e+s;return s>0?P.current="left":s<0&&(P.current="right"),o&&s>0&&(d=-100+s),i&&s<0&&(d=100+s),n?l&&c&&"left"===P.current?d=100:r&&c&&"right"===P.current&&(d=-100):(o&&c&&"left"===P.current&&(d=-100),i&&c&&"right"===P.current&&(d=100)),d})(e));let d=`translate(${o}%, 0)`;c&&(d=`translate3d(${o}%, 0, 0)`);const u=H(e);return Object.assign({display:u?"inherit":"none",WebkitTransform:d,MozTransform:d,msTransform:d,OTransform:d,transform:d},a)},Ne=t=>{const{isFullscreen:s}=_,{onImageError:a}=E,n=a||W;if(!Array.isArray(t))return e.jsx(Yf,{fullscreen:t.fullscreen,handleImageLoaded:$,isFullscreen:s,onImageError:n,original:t.original,originalAlt:t.originalAlt,originalHeight:String(t.originalHeight),originalWidth:String(t.originalWidth),sizes:t.sizes,loading:t.loading,srcSet:t.srcSet})},ye=t=>{const s=E.onThumbnailError||W;return e.jsx("div",{className:"image-gallery-thumbnail-inner block relative w-full h-full",children:e.jsx("img",{className:"image-gallery-thumbnail-image align-middle leading-0 w-full h-full",src:t.thumbnail,height:t.thumbnailHeight,width:t.thumbnailWidth,alt:t.thumbnailAlt,loading:t.thumbnailLoading,onError:s})})},{currentIndex:Ce,isFullscreen:Se,isModalFullscreen:je}=_,Ie=(()=>{let e;const{thumbsTranslate:t,thumbsStyle:s}=_;return e=`translate(${t}px, 0)`,c&&(e=`translate3d(${t}px, 0, 0)`),Object.assign({WebkitTransform:e,MozTransform:e,msTransform:e,OTransform:e,transform:e},s)})(),Oe=(()=>{const{currentIndex:t}=_,s=[],a=[],r=[];return n.forEach(((i,o)=>{const c=(e=>{const{currentIndex:t}=_;let s="";const a="image-gallery-left",r="image-gallery-right";switch(e){case t-1:s=` ${a}`;break;case t:s=" image-gallery-center relative";break;case t+1:s=` ${r}`}return n.length>=3&&l&&(0===e&&t===n.length-1?s=` ${r}`:e===n.length-1&&0===t&&(s=` ${a}`)),s})(o),d=Array.isArray(i),u=!d&&i.originalClass?` ${i.originalClass}`:"",m=!d&&i.thumbnailClass?` ${i.thumbnailClass}`:"",p=!d&&i.renderItem||E.renderItem||Ne,f=!d&&i.renderThumbInner||E.renderThumbInner||ye,h=!E.lazyLoad||c||M.current[o];h&&E.lazyLoad&&!M.current[o]&&(M.current[o]=!0);const g=Te(o),v=e.jsx("div",{"aria-label":`Go to Slide ${o+1}`,tabIndex:-1,className:`image-gallery-slide absolute left-0 top-0 w-full ${c} ${u}`,style:g,onClick:E.onClick,onTouchMove:E.onTouchMove,onTouchEnd:E.onTouchEnd,onTouchStart:E.onTouchStart,role:"button",children:h?p(i)||null:e.jsx("div",{style:{height:"100%"}})},`slide-${o}`);if(s.push(v),E.showThumbnails&&!d&&i.thumbnail){const s=Ge.default("image-gallery-thumbnail inline-block transition-all w-10 h-10 bg-transparent p-0 rounded-[6px] overflow-hidden",m,{"opacity-20":t!==o});a.push(e.jsx("button",{type:"button",tabIndex:0,"aria-pressed":t===o?"true":"false","aria-label":`Go to Slide ${o+1}`,className:s,onClick:e=>ie(e,o),children:f(i)},`thumbnail-${o}`))}if(E.showBullets){const s=Ge.default("appearance-none bg-[#DBDDDF] rounded-full cursor-pointer inline-block  w-2 h-2 outline-none transition-all",d?"":i.bulletClass,{"bg-surface-primary-default":t===o});r.push(e.jsx("button",{type:"button",className:s,onClick:e=>re(e,o),"aria-pressed":t===o?"true":"false","aria-label":`Go to Slide ${o+1}`},`bullet-${o}`))}})),{slides:s,thumbnails:a,bullets:r}})(),Ae=Ge.default("image-gallery-slide-wrapper relative overflow-hidden w-full flex-1 flex justify-center group",E.slideWrapperClass,"image-gallery-thumbnails-bottom"),Me=e.jsxs("div",{ref:S,className:Ae,children:[E.renderCustomControls&&E.renderCustomControls(),k?e.jsx("div",{className:"relative overflow-hidden w-fit flex items-center justify-center",children:e.jsx(Vf,{className:"image-gallery-swipe",delta:0,onSwiping:oe,onSwiped:fe,children:e.jsx("div",{className:"image-gallery-slides leading-[0] w-full overflow-hidden relative whitespace-nowrap text-center",children:Oe.slides})})}):e.jsx("div",{className:"image-gallery-slides leading-[0] overflow-hidden w-full relative whitespace-nowrap text-center flex items-center justify-center",children:Oe.slides}),E.showBullets&&"inside"===E.bulltetPosition&&e.jsx("div",{className:Ge.default("absolute left-0 right-0 w-[80%] z-[4] mx-auto"),children:e.jsx("div",{className:"m-0 p-0 text-center space-x-2",role:"navigation","aria-label":"Bullet Navigation",children:Oe.bullets})}),k&&E.showNav&&e.jsxs(e.Fragment,{children:[E.renderLeftNav(ne,!D),E.renderRightNav(le,!F)]}),E.showFullscreenButton&&E.renderFullscreenButton(X,Se)]}),Pe=Ge.default("image-gallery relative select-none tap-higtlight h-full",E.additionalClass),Le=Ge.default("relative top-0 leading-[0] h-full flex justify-center items-center flex-col",{"bg-surface-container-default":Se}),ke=Ge.default("relative ","image-gallery-thumbnails-bottom",{"thumbnails-swipe-horizontal touch-pan-y":!E.disableThumbnailSwipe});return e.jsx("div",{ref:N,className:Pe,"aria-live":"polite",onClick:()=>{b()},children:e.jsxs("div",{className:Le,children:[Me,E.showBullets&&"inside"!==E.bulltetPosition&&e.jsx("div",{className:Ge.default("w-[80%] z-[4] mx-auto mt-3"),children:e.jsx("div",{className:"m-0 p-0 text-center space-x-2",role:"navigation","aria-label":"Bullet Navigation",children:Oe.bullets})}),E.showThumbnails&&Oe.thumbnails.length>1?e.jsx(Vf,{className:ke,delta:0,onSwiping:ce,onSwiped:me,children:e.jsx("div",{className:"image-gallery-thumbnails overflow-y-hidden overflow-x-scroll py-1 md:py-3",ref:y,style:{},children:e.jsx("nav",{ref:C,className:"image-gallery-thumbnails-container w-full cursor-pointer whitespace-nowrap text-center space-x-2",style:Ie,"aria-label":"Thumbnail Navigation",children:Oe.thumbnails})})}):null,E.renderBottom&&E.renderBottom(_.currentIndex)]})})};function Jf({message:t,showAudio:n,showText:l}){const r=hi(),{editorMode:i,publish:o}=a.useContext(At),{type:c,entityInfo:d,imgGenerator:u}=a.useContext(jt),{selectedImg:m,everPublished:p,addImg:f,removeImg:h,reachedLimitation:g}=o||{},{id:v,status:x}=d,{imageGenMessageResponse:b}=t,{imgBatch:E,metadata:_,genStatus:w}=b||{},T=Array.isArray(E)&&E.length>0,N=s.useTranslations(),[y,C]=a.useState({isPreview:!1,startIndex:0}),S=function(e,t){const s=function e(t,s){return 0===s?t:e(s,t%s)}(e,t),a=e/s,n=t/s;return{numerator:a,denominator:n,text:`${a}/${n}`}}(Number((null==_?void 0:_.width)||1),Number((null==_?void 0:_.height)||1)).text,j=T?{aspectRatio:S}:{},I=a.useCallback((e=>{if(null==m?void 0:m.has(e.original))null==h||h(e.original);else{if(g)return;null==f||f(e.original,{messageId:t.id,imageLink:e.original,naturalHeight:e.originalHeight,naturalWidth:e.originalWidth})}}),[f,t.id,g,h,m]),O=a.useMemo((()=>(T?E:[]).map(((e,t)=>e.img.map(((e,s)=>{var a,n;return{original:e,thumbnail:e,batchIndex:t,index:s,originalHeight:String(null!==(a=null==_?void 0:_.height)&&void 0!==a?a:""),originalWidth:String(null!==(n=null==_?void 0:_.width)&&void 0!==n?n:"")}}))))),[T,E,_]),A=a.useMemo((()=>O.flat()),[O]),{publishing:M,publishGalleryList:P}=Nm(),[L,k]=a.useState(null),[R,D]=a.useState("info"),[U,F]=a.useState(!1),B=a.useCallback(((e,s)=>{if("PUBLISH"===i)if(null==m?void 0:m.has(s.original))null==h||h(s.original);else{if(g)return;null==f||f(s.original,{messageId:t.id,imageLink:s.original,naturalHeight:s.originalHeight,naturalWidth:s.originalWidth})}else C({isPreview:!0,startIndex:4*s.batchIndex+s.index})}),[i,m,h,g,f,t.id]),G=a.useCallback((()=>{C({isPreview:!1,startIndex:0})}),[]),{success:z}=Ql(),Y=a.useCallback((()=>{var e;if("bot"===c){const s={bot_id:v,job_id:null===(e=null==t?void 0:t.asyncJobInfo)||void 0===e?void 0:e.jobId,message_id:null==t?void 0:t.id,file_url:null==L?void 0:L.imageLink};null==r||r.track("Chat_Publish_Gallery",s)}"info"!==R||p?(z({content:N("chat.suc_send")}),D("info"),G()):D("success")}),[k]),H=a.useCallback((()=>{"success"===R?(k(null),D("info"),G()):L&&P(Y,[L])}),[R,P,Y]),V=a.useCallback((t=>{if(!Array.isArray(t))return null;let s="";switch(t.length){case 1:s="grid-cols-1 grid-rows-1";break;case 2:s="grid-cols-2 grid-rows-1";break;default:s="grid-cols-2 grid-rows-2"}return e.jsx("div",{className:Ge.default("grid gap-x-px gap-y-px",s),children:t.map(((t,s)=>{const a=null==m?void 0:m.has(t.original);return e.jsxs("div",{className:Ge.default("relative","group/item"),style:j,children:[e.jsx(Df,{"x-image-source":"gallery",style:j,alt:"",src:t.original,index:s,status:w,aspectRatio:S,onClick:e=>B(e,t),imageLoadCallback:()=>{(e=>{0===e&&F(!0)})(s)}}),"PUBLISH"===i&&t.original&&(!g||g&&a)&&e.jsx("div",{className:"w-6 h-6 ml-0 flex justify-center items-center absolute right-3 top-3 z-[1]",children:e.jsx(Hm,{variant:"circle-static",checked:a,onCheckedChange:()=>{I(t)}})}),!p&&0===s&&u&&U&&"PUBLISH"!==i&&x===Gu.Public&&e.jsx(Lf,{className:"absolute -right-10 -bottom-2"})]},s)}))})}),[w,S,j]);return e.jsxs(e.Fragment,{children:[e.jsx(jp,{message:t,showAudio:n,showText:l}),e.jsx("div",{className:"mx-3",style:j,children:e.jsx(Xf,{images:O,renderItem:V,showBullets:O.length>1,showNav:O.length>1,bulltetPosition:"outside",slideWrapperClass:"overflow-hidden rounded-xl",showFullscreenButton:!1})}),e.jsx(Mr,{open:y.isPreview,onClose:G,contentClassName:"w-full h-full max-h-full rounded-none z-[100] bg-beta-black-10",iconClassName:"text-static bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40",fullScreen:!0,children:e.jsx("div",{className:"relative bg-beta-black-10 xxxx overflow-hidden w-full h-full px-4 md:px-0",children:e.jsx("div",{className:"w-full h-full relative overflow-hidden",children:e.jsx(Xf,{images:A,startIndex:y.startIndex,showThumbnails:!0,showBullets:!1,showNav:A.length>1,showFullscreenButton:!1,onContainerClick:G})})})}),e.jsx(am,{publishing:M,publishState:R,open:!!(null==L?void 0:L.botId),onClose:()=>{k(null),D("info"),"success"===R&&G()},onConfirm:H})]})}const Zf=({message:n})=>{var l,r,i,o,c,d,u;const{partialUpdateMessage:m}=a.useContext(At),{onMarked:p}=km(n,void 0,m),f=s.useTranslations("chat"),h=s.useTranslations("request.error"),[g,v]=a.useState(!1),{onCopy:x}=ui((null===(l=null==n?void 0:n.runningError)||void 0===l?void 0:l.errorDetail)||""),b=Ur((e=>e.isVisitor)),E=Ur((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.level})),_=Ur((e=>e.energy)),w=()=>{p()},T=a.useMemo((()=>{var e;return((e,t)=>{switch(t){case je.ENGINE_ERROR:return e("chat_error_tip");case je.INNER_COMPONENT_ERROR:return e("inner_component_error_tip");case je.LLM_TOKEN_TOO_LONG:return e("exceeded_token_error_tip");default:return""}})(h,null===(e=null==n?void 0:n.runningError)||void 0===e?void 0:e.errorType)}),[null===(r=null==n?void 0:n.runningError)||void 0===r?void 0:r.errorType]);if((null===(i=null==n?void 0:n.runningError)||void 0===i?void 0:i.errorType)===je.ENERGY_INSUFFICIANT)return _>((null===(o=null==n?void 0:n.runningError)||void 0===o?void 0:o.requireEnergyToUse)||0)?null:2===b&&1===E?e.jsx("li",{className:"last:animate-slideIn list-none",children:e.jsx($r,{type:"action",onClose:w})}):e.jsx("li",{className:"last:animate-slideIn list-none",children:e.jsx(Zr,{type:"action",onClose:w})});const N=(null===(c=n.runningError)||void 0===c?void 0:c.errorType)===je.LLM_TOKEN_TOO_LONG;return n.handled?null:e.jsxs(e.Fragment,{children:[e.jsxs(Hr,{variant:"error",className:"flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{children:e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(_a,{className:"hidden md:block shrink-0 size-6 text-icon-critical"}),e.jsx(Ul,{children:T})]})}),e.jsxs("div",{className:"w-full gap-x-2 md:w-auto flex justify-center self-end lg:self-auto",children:[N?null:e.jsx(Tr,{className:"flex-1 md:flex-none",color:"error",size:"md",onClick:()=>{v(!0)},children:f("view_details")}),e.jsx(Tr,{className:"flex-1 md:flex-none",color:"error",size:"md",variant:N?void 0:"outline",onClick:w,children:f("ignore")})]})]}),e.jsx(ti,{open:g,children:e.jsxs(ni,{className:"w-310px md:w-[380px]",onClose:()=>{v(!1)},maskClosable:!1,children:[e.jsx(li,{className:"px-5 h-[68px] flex justify-center",children:e.jsx(ii,{children:e.jsx(Rl,{size:"h2",children:f("error_detail")})})}),e.jsx(oi,{className:"px-5 pt-1 pb-3 grid gap-y-1.5 overflow-y-auto",children:e.jsx(Ul,{className:"break-all max-h-[400px]",dangerous:!0,children:(null===(u=null===(d=n.runningError)||void 0===d?void 0:d.errorDetail)||void 0===u?void 0:u.replaceAll("\n","<br />"))||""})}),e.jsx(ri,{className:"gap-x-5 min-h-[76px]",children:e.jsxs(Tr,{className:"w-full",onClick:()=>{x(),v(!1)},color:"error",children:[e.jsx(t.Copy,{className:"w-[20px] h-[20px] mr-1.5 mt-0.5"}),f("copy_error_message")]})})]})})]})};function eh({list:t}){const s={PROCESSING:e.jsx(di,{size:"sm",className:"text-brand"}),ERROR:e.jsx(kt,{width:"20px",color:"var(--red-40)"}),DONE:e.jsx(Pt,{width:"20px",color:"var(--green-30)"})};return e.jsx("div",{className:"w-auto flex flex-col gap-2",children:t.map((t=>e.jsxs("div",{className:"flex items-center",children:[s[t.status],e.jsx("p",{className:"text-subtle text-sm ml-2",children:mi(t)})]},t.widgetName)))})}const th=ze.default((()=>Promise.resolve().then((function(){return Tp}))),{loading:()=>e.jsx("div",{children:"loading..."}),ssr:!1});function sh({message:t,showText:n,showAudio:l}){var r,i,o,d,u,m;const{getJobInfo:p}=a.useContext(At),f=a.useRef(null),h=a.useRef(t);a.useEffect((()=>{h.current=t}),[t]);const g=()=>{var e,s,a;(null===(e=t.asyncJobInfo)||void 0===e?void 0:e.status)!==_e.PENDING&&(null===(s=t.asyncJobInfo)||void 0===s?void 0:s.status)!==_e.PROCESSING&&(null===(a=t.asyncJobInfo)||void 0===a?void 0:a.status)!==_e.QUEUEING||"CANCELING"===(null==t?void 0:t.status)||"CANCELED"===(null==t?void 0:t.status)?f.current&&(clearInterval(f.current),f.current=null):(f.current&&(clearInterval(f.current),f.current=null),f.current=setInterval((async()=>{const e=await(async()=>{var e;const s=h.current;if((null===(e=s.asyncJobInfo)||void 0===e?void 0:e.jobId)&&"CANCELING"!==s.status&&"CANCELED"!==s.status)return await(null==p?void 0:p(s.asyncJobInfo.jobId,t.id));return!1})();e||f.current&&(clearInterval(f.current),f.current=null)}),2e3))};c.useEffectOnce((()=>{g()}));const v=s.useTranslations("chat");return"CANCELED"===t.status?e.jsx("p",{children:v("job_terminated")}):(null===(r=t.imageGenMessageResponse)||void 0===r?void 0:r.jobId)?e.jsx(Jf,{message:t,showText:n,showAudio:l}):(null===(i=t.asyncJobInfo)||void 0===i?void 0:i.status)===_e.DONE||(null===(o=t.asyncJobInfo)||void 0===o?void 0:o.status)===_e.UNKNOWN?t.runningError?e.jsx(Zf,{message:t}):e.jsx(jp,{message:t,showText:n,showAudio:l}):(null===(d=t.asyncJobInfo)||void 0===d?void 0:d.status)===_e.ERROR?e.jsx(th,{className:"text-critical text-[14px]",content:null!==(u=t.text)&&void 0!==u?u:"",notParseHTML:t.isLlmBot}):(null===(m=t.runningWidgetInfo)||void 0===m?void 0:m.length)?e.jsx(eh,{list:t.runningWidgetInfo}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(di,{size:"xs",className:"text-brand"}),e.jsx(Ul,{size:"sm",color:"subtle",className:"ml-2",children:t.text})]})}function ah({message:t,showText:s=!0,showAudio:n=!1,latest:l,source:r}){var i;const o=a.useMemo((()=>{var e;return"PENDING_FOR_RESPONSE"===t.type?Ip:"GREETING"!==t.type&&(t.asyncJobInfo&&t.asyncJobInfo.jobId&&t.asyncJobInfo.status!==_e.UNKNOWN||(null===(e=t.imageGenMessageResponse)||void 0===e?void 0:e.jobId))?sh:jp}),[t.asyncJobInfo,null===(i=t.imageGenMessageResponse)||void 0===i?void 0:i.jobId,t.type]);return e.jsx(Pf,{source:r,children:e.jsx("div",{className:"flex gap-3 flex-col",children:e.jsx(o,{message:t,showText:s,showAudio:n,latest:l})})})}function nh({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z",clipRule:"evenodd"}))}const lh=Fe.forwardRef(nh);function rh(e,t,a,n){const l=s.useTranslations("workshop"),[r,i]=c.useToggle(!1),{success:o,error:d}=Ql();return{deleting:r,deleteMessage:async t=>{try{i(!0);const{success:s}=await function(e,t){return Os.post("/v1/chat/deleteHistoryByMsgId",{body:{msgIdList:[t],bizType:"widget"===e?"HISTORY_OPERATION_BIZ_TYPE_WIDGET":"HISTORY_OPERATION_BIZ_TYPE_BOT"},isGoLang:!0})}(e,t);s?(o({content:l("delete_widget_success")}),a(),null==n||n(t)):d({content:l("delete_widget_error")})}catch(e){console.error(e),d({content:l("delete_widget_error")})}finally{i(!1)}}}}function ih({visible:t,onClose:a}){const n=s.useTranslations("common");return e.jsx(Mr,{contentClassName:"min-h-[85vh]",title:n("select_text"),modalOnly:!1,open:t,onClose:a,children:e.jsx("div",{className:"p-3",children:e.jsx(Sp,{hideMedia:!0})})})}function oh(t){const n=s.useTranslations(),l=s.useTranslations("chat"),{type:r,entityInfo:i,getList:o}=a.useContext(jt),{id:c}=i,{deleteSpecifiedMessageId:d}=a.useContext(At),{actions:u,message:m,latest:p,deleteConfirming:f,setDeleteConfirming:h,selectTextVisible:g,setSelectTextVisible:v}=Am(),{className:x}=t,b=ls()?document.getElementById("renderer-container"):null,{deleting:E,deleteMessage:_}=rh(r,0,o,d),w=u.filter((e=>e===Se.Feedback)),T=u.filter((e=>e===Se.Share)),N=u.filter((e=>e===Se.Copy_Message)),y=u.filter((e=>e===Se.Regenerate)),C=u.filter((e=>e===Se.Edit)),S=a.useMemo((()=>"OTHER"===(null==m?void 0:m.source)?w.length?w:N:[...T,...N]),[N,w,null==m?void 0:m.source,T]),j=a.useMemo((()=>"OTHER"===(null==m?void 0:m.source)?[...w,...y,...C,...N]:[...T,...N]),[N,C,w,null==m?void 0:m.source,y,T]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:pn("mt-2.5 mx-0.5 h-fit",x),children:[e.jsx("div",{className:"lg:hidden",children:e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{size:"sm",variant:"primary",color:"gray",icon:lh,hoverText:n("more"),className:"rounded-lg text-default"})}),e.jsx(Di,{collisionBoundary:[b],children:e.jsx(Af,{source:"menubar",asMenuItem:!0})})]})}),e.jsx("div",{className:"hidden lg:flex large:hidden gap-1",children:"USER"===(null==m?void 0:m.source)?e.jsxs(e.Fragment,{children:[e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{size:"sm",variant:"primary",color:"gray",icon:lh,hoverText:n("more"),className:"rounded-lg text-default"})}),e.jsx(Di,{collisionBoundary:[b],children:e.jsx(Af,{specifiedActions:u,source:"menubar",asMenuItem:!0})})]}),e.jsx(Af,{specifiedActions:S,source:"menubar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Af,{specifiedActions:S,source:"menubar"}),e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{size:"sm",variant:"primary",color:"gray",icon:lh,hoverText:n("more"),className:"rounded-lg text-default"})}),e.jsx(Di,{collisionBoundary:[b],children:e.jsx(Af,{specifiedActions:u,source:"menubar",asMenuItem:!0})})]})]})}),e.jsx("div",{className:"hidden large:flex gap-1",children:"USER"===(null==m?void 0:m.source)?e.jsxs(e.Fragment,{children:[e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{size:"sm",variant:"primary",color:"gray",icon:lh,hoverText:n("more"),className:"rounded-lg text-default"})}),e.jsx(Di,{collisionBoundary:[b],children:e.jsx(Af,{specifiedActions:u,source:"menubar",asMenuItem:!0})})]}),e.jsx(Af,{specifiedActions:j,source:"menubar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Af,{specifiedActions:j,source:"menubar"}),e.jsxs(ki,{children:[e.jsx(Ri,{asChild:!0,children:e.jsx(Kl,{size:"sm",variant:"primary",color:"gray",icon:lh,hoverText:n("more"),className:"rounded-lg text-default"})}),e.jsx(Di,{collisionBoundary:[b],children:e.jsx(Af,{specifiedActions:u,source:"menubar",asMenuItem:!0})})]})]})})]}),f&&e.jsx(Mr,{state:"warning",isNotification:!0,open:f,onClose:()=>null==h?void 0:h(!1),onConfirm:async()=>{try{await _(m.id)}catch(e){console.error(e)}},title:l("delete_confirmation.header"),description:l("delete_confirmation.delete_part_content",{num:1,entity:r}),confirmLoading:E}),g&&e.jsx(ih,{visible:g,onClose:()=>{null==v||v(!1)}})]})}function ch(){const t=s.useTranslations("chat"),n=s.useTranslations("request.error"),{editorMode:l,share:r,errorMessageRetry:i}=a.useContext(At),{idSet:o,add:c,remove:d}=r||{},{message:u,contextMenuDisabled:m}=Am();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-[calc(100%-38px)] ml-[38px] flex gap-1.5",children:[e.jsxs("div",{className:"grow group/menu gap-1.5 flex justify-end",children:[!m&&e.jsx(oh,{className:Ge.default("hidden md:flex md:invisible md:group-hover/menu:visible md:group-focus-within/menu:visible")}),e.jsx("div",{className:"max-w-[303px] md:max-w-[420px] lg:max-w-[476px] large:max-w-[480px] overflow-hidden rounded-2xl rounded-tr-sm min-h-11 py-3 px-4 bg-surface-primary-subtle-hovered",children:e.jsx(ah,{message:u,source:"USER"})})]}),"SHARE"===l&&e.jsx("div",{className:"shrink-0 size-8 flex justify-center items-center",children:e.jsx(Hm,{variant:"circle",checked:null==o?void 0:o.has(u.id),onCheckedChange:e=>{e?null==c||c(u.id):null==d||d(u.id)}})})]}),("LOCAL_ERROR"===(null==u?void 0:u.status)||"NETWORK_ERROR"===(null==u?void 0:u.status))&&e.jsxs(Hr,{variant:"error",className:"w-full mt-4 md:mt-5 flex-col md:flex-col lg:flex-row",children:[e.jsx(Vr,{children:e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(_a,{className:"hidden md:block shrink-0 size-6 text-icon-critical"}),e.jsx(Ul,{children:"LOCAL_ERROR"===(null==u?void 0:u.status)?n("common"):n("network")})]})}),e.jsx(Tr,{size:"md",color:"error",className:"shrink-0 w-full md:w-fit self-end lg:self-auto",onClick:()=>{null==i||i(u)},children:t("retry")})]})]})}function dh(){const{sendCustomRequest:e}=a.useContext(At);return{promptAction:a.useCallback((t=>{null==e||e({messageType:"BUTTON_INTERACTION",button_id:"unlock_prompt_widget"},t)}),[e])}}function uh(){const e=Ur((e=>e.shellCoins)),t=kn((e=>e.exchangePoints)),s=Ur((e=>e.setShellCoins)),n=Ur((e=>e.setFrozenShellCoins)),l=kn((e=>e.setHoldBadges)),r=kn((e=>e.setExchangePoints)),[i,o]=a.useState(!1),[c,d]=a.useState(!1),[u,m]=a.useState(!1);return{shellCoins:e,exchangePoints:t,queryShellCoins:async()=>{try{const{success:e,data:t}=await Os.post("/v1/shell_coins/get_account",{isGoLang:!0,adapter:e=>e.account});e&&(s(Number(t.balance)),n(Number(t.frozenBalance)))}catch(e){}},queryExchange:async()=>{try{const{success:e,data:t}=await Os.post("/v1/season/reward/get_season_point_to_shell_coin_exchange_info",{isGoLang:!0,adapter:e=>e.exchangeRatios.map((({point:e,pointText:t,pointType:s,ratio:a,targetAmount:n,targetAmountText:l})=>({point:e,text:t,type:s,ratio:a,targetAmount:n,targetAmountText:l})))});e&&r(t)}catch(e){}},exchanging:i,exchange:async()=>{try{return o(!0),await Os.post("/v1/season/reward/exchange_shell_coin_with_season_points",{isGoLang:!0,withMyShellSecurityToken:!0,adapter:e=>e.order})}catch(e){return{success:!1}}finally{o(!1)}},badgeToCoinExchanging:c,badgeToCoin:async(e,t)=>{try{d(!0);const{data:a}=await(s=e.map((e=>({badgeType:e.userBackpackItem.item.subType,badgeCount:e.userBackpackItem.count}))),Os.post("/v1/shell_coins/exchange_shell_coin_with_badges",{body:{wantExchangeBadgeInfos:s},isGoLang:!0,withMyShellSecurityToken:!0,adapter:e=>e.orders}));t&&t(ps(a.map((e=>Number(e.amount)))))}catch(e){}finally{d(!1)}var s},querying:u,getHoldBadges:async()=>{try{m(!0);const{data:e}=await Os.post("/v1/shell_coins/get_badge_exchange_shell_coin_info",{isGoLang:!0,adapter:e=>e.badgeShellCoinExchangeInfo});l(e)}catch(e){}finally{m(!1)}},getCoinRecords:Fs}}function mh(){const{entityInfo:t,partialUpdateDetail:n}=a.useContext(jt),{sellPrice:l}=t,r=Ur((e=>e.shellCoins)),i=Ur((e=>e.setShellCoins)),o=s.useTranslations("workshop"),c=xl((e=>e.toggleLoginModal)),d=Ur((e=>e.isVisitor))===Ft.YES,{queryShellCoins:u}=uh();a.useEffect((()=>{is(r)&&u()}),[r]);const{promptAction:m}=dh(),p=a.useCallback((()=>{d?c(!0):m((()=>{null==n||n({hasUnlocked:!0}),0!==Number(l)&&i(null!=r?r:0-Number(l))}))}),[d,n,m,l,i,r,c]);return e.jsx(Tr,{variant:"primary",color:"chat",size:"md",className:"w-fit",onClick:p,children:o("unlock_prompt")})}function ph(){const{promptAction:t}=dh(),a=s.useTranslations("workshop");return e.jsx(Tr,{variant:"primary",color:"chat",size:"md",className:"w-fit",onClick:()=>{t()},children:a("view_prompt")})}const fh={luiButtonGuideClicked:!1},hh={name:"flag-storage",storage:bn((()=>localStorage)),partialize:e=>({luiButtonGuideClicked:e.luiButtonGuideClicked}),merge:(e,t)=>Object.assign(Object.assign({},t),{luiButtonGuideClicked:e.luiButtonGuideClicked})},gh=n.create()(wn(vn(_n(((e,t)=>Object.assign(Object.assign({},fh),{setLuiButtonGuideClicked(t){e((e=>{e.luiButtonGuideClicked=t}))}})),hh),{store:"flag"}))),vh=a.createContext({clickFn:async()=>{},msgId:"",interactionTraceId:void 0,setInteractionTraceId:()=>{},executeTracker:()=>{}}),xh=()=>a.useContext(vh);function bh({clickFn:t,msgId:s,type:n,id:l,children:r}){const i=hi(),[o,c]=a.useState(),d=a.useCallback((e=>{const t=os();if(c(t),"bot"===n){const s={trace_id:t,bot_id:l,action_type:e.join(","),time:(new Date).getTime()};null==i||i.track("Chat_LUI_Click",s)}}),[l,i,n]),u=a.useMemo((()=>({clickFn:t,executeTracker:d,msgId:s,interactionTraceId:o,setInteractionTraceId:c})),[t,d,o,s]);return e.jsx(vh.Provider,{value:u,children:r})}var Eh=a.memo((function({children:t,title:n,description:l,onConfirm:r,clicked:i}){const[o,d]=c.useToggle(!1),[m,p]=c.useToggle(!1),f=a.useRef(null),h=s.useTranslations("common");return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>{d(!0),i()},children:t}),e.jsx(u.AlertDialog,{isOpen:o,leastDestructiveRef:f,onClose:()=>d(!1),isCentered:!0,children:e.jsx(u.AlertDialogOverlay,{className:"shadow-modal-default",children:e.jsxs(u.AlertDialogContent,{className:"bg-surface-container-default text-default",children:[e.jsx(u.AlertDialogHeader,{fontSize:"2xl",fontWeight:"bold",padding:"20px",children:n}),e.jsx(u.Divider,{className:"border-default"}),e.jsx(u.AlertDialogBody,{px:"20px",py:"16px",fontSize:"16px",lineHeight:"24px",children:l}),e.jsx(u.Divider,{className:"border-default"}),e.jsxs(u.AlertDialogFooter,{p:"16px",display:"flex",gap:"16px",children:[e.jsx(u.Button,{ref:f,onClick:()=>d(!1),width:"100%",h:"36px",px:"12px",py:"8px",borderRadius:"full",color:"var(--text-brand)",border:"1px solid var(--text-brand)",_hover:{backgroundColor:"transparent"},children:h("cancel")}),e.jsx(u.Button,{onClick:async()=>{try{p(!0),await r(),d(!1)}catch(e){console.error(e)}finally{p(!1)}},width:"100%",h:"36px",px:"12px",py:"8px",borderRadius:"full",backgroundColor:"var(--text-brand)",className:"bg-surface-primary-default",color:"white",_hover:{backgroundColor:"var(--text-brand)"},isLoading:m,children:h("confirm")})]})]})})})]})}));function _h({content:t,style:a,disabled:n,loading:l=!1,onClick:r,energy:o}){var c,d;const{resolvedTheme:u}=i.useTheme();s.useTranslations("common"),Ql();const m="dark"===u;Number((null===(c=t.iconLabel)||void 0===c?void 0:c.replace("+",""))||0);return e.jsx("button",{type:"button",disabled:n||l,className:"min-w-9 shadow-button_shadow rounded-3xl px-4 py-2 flex space-x-1.5 justify-center items-center disabled:cursor-not-allowed disabled:opacity-70",style:{background:m?a.darkModeBackgroundColorHex:a.backgroundColorHex,color:m?a.darkModeFontColorHex:a.fontColorHex,borderWidth:a.borderColorHex?"1px":"none",borderStyle:"solid",borderColor:m?a.darkModeBorderColorHex:a.borderColorHex},onClick:()=>{r&&r()},children:l?e.jsx(Ip,{}):e.jsxs(e.Fragment,{children:[t.direction&&t.direction===Le.LEFT&&e.jsx(Ws,{className:"w-5 h-5 shrink-0"}),e.jsx("span",{className:"text-sm text-left",children:t.text}),t.iconUrl&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 border-r-[0.5px] shrink-0 pl-0.5",style:{borderColor:m?a.darkModeIconLineColorHex:a.iconLineColorHex}}),e.jsxs("div",{className:"flex space-x-0.5 items-center shrink-0 text-xs font-medium",children:[e.jsx(Ye.default,{alt:"button icon",src:t.iconUrl,width:16,height:16,className:"w-4 h-4 rounded-[4px]"}),e.jsx("span",{className:"tracking-widest",children:null!==(d=t.iconLabel)&&void 0!==d?d:""})]})]}),t.direction&&t.direction===Le.RIGHT&&e.jsx(Xs,{className:"w-5 h-5 shrink-0"})]})})}function wh(t){const{content:s}=t;return s.description?e.jsx(Hl,{showArrow:!1,description:s.description,children:e.jsx(_h,Object.assign({},t))}):e.jsx(_h,Object.assign({},t))}function Th({isOpen:t,onClose:a,onConfirmed:n}){const l=s.useTranslations("chat.replicate");return e.jsx(Mr,{overlayClassName:"z-[100]",contentClassName:"z-[110]",state:"warning",isNotification:!0,open:t,onClose:a,title:l("save_tip_title"),description:l("save_tip_content"),onConfirm:()=>{n((()=>{}))}})}function Nh({column:t=2}){return e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs("div",{className:"w-full flex flex-col h-full",children:[e.jsx(Id,{className:"w-1/3 h-5 mt-4 rounded-lg"}),e.jsx(Id,{className:"w-wull h-[46px] mt-1.5 rounded-lg"}),e.jsx(Id,{className:"w-1/3 h-5 mt-4 rounded-lg"}),e.jsx(Id,{className:"w-wull h-[96px] mt-1.5 rounded-lg"})]})})}const yh=ze.default((()=>Promise.resolve().then((function(){return zg}))),{loading:()=>e.jsx(Nh,{}),ssr:!1});var Ch=a.memo((function({type:t,id:n,params:l,isOpen:r,setOpen:i,isMobile:o,onSubmit:d,loading:m,formSubmitError:p,setFormSubmitError:f,formTraceId:h}){const g=a.useMemo((()=>{var e;return Object.assign(Object.assign({},l),{componentsInput:null===(e=l.componentsInput)||void 0===e?void 0:e.map((e=>{var t,s;let a="",n="",l=[];const r={};let i=[];switch(e.type){case"BOT_IM_COMPONENT_INPUT_TYPE_FILE_UPLOAD":a="upload",i=e.supportedFileTypes;break;case"BOT_IM_COMPONENT_INPUT_TYPE_AUDIO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_AUDIO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_VIDEO_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_VIDEO_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_IMAGE_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_IMAGE_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_UPLOAD":a="upload",i=["MESSAGE_METADATA_TYPE_TEXT_FILE"];break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_INPUT":a="textarea",n=e.stringDefault,r.maxLength=e.stringCharLengthLimitation||1500;break;case"BOT_IM_COMPONENT_INPUT_TYPE_TEXT_SELECTOR":a="select",n=e.textSelectorDefault,l=null===(t=e.textSelectorAllOf)||void 0===t?void 0:t.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_INPUT":a=e.hasNumberLimitation?"numberSlider":"numberInput",n=e.numberDefault,r.maxLength=e.numberMax,r.minLength=e.numberMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_INTEGER_INPUT":a=e.hasIntegerLimitation?"interSlider":"interInput",n=e.integerDefault,r.maxLength=e.integerMax,r.minLength=e.integerMin;break;case"BOT_IM_COMPONENT_INPUT_TYPE_CHECKBOX":a="checkbox",n=e.booleanDefault;break;case"BOT_IM_COMPONENT_INPUT_TYPE_NUMBER_SELECTOR":a="numberSelect",n=e.numberSelectorDefault,l=null===(s=e.numberSelectorAllOf)||void 0===s?void 0:s.map((e=>({label:e.label||e.value,value:e.value,iconUrl:e.iconUrl})));break;case"BOT_IM_COMPONENT_INPUT_TYPE_CODE_EDITOR":a="codeEditor",n=e.stringDefault}return Object.assign(Object.assign({},e),{id:e.fieldName,serverType:e.type,props:r,rules:r,type:a,defaultValue:n,options:l,supportedFileTypes:i})}))})}),[l]),v=Ur((e=>e.energy)),x=Ur((e=>e.isVisitor)),b=l.energyConsumePerUse,E=2===x&&v<b,_=s.useTranslations("chat"),[w,T]=a.useState(!1),N=a.useRef(!1),[y,C]=a.useState(!0),[S,j]=a.useState(!1),[I,O]=c.useToggle(!1),A=g.componentsFunction||[],M=hi(),P=a.useMemo((()=>g.componentsInput||[]),[g.componentsInput]),L=a.useMemo((()=>{const e={};return null==P||P.forEach((t=>{var s,a;e[t.fieldName]=null!==(s=t.defaultValue)&&void 0!==s?s:"","upload"===t.type&&(e[t.fieldName]=null!==(a=t.fileDefaultParam)&&void 0!==a?a:"",e[`x_ms_name_${t.fieldName}`]="",e[`x_ms_size_${t.fieldName}`]="")})),e}),[P]),{control:k,setValue:D,watch:U,reset:F,register:B,getValues:G,clearErrors:z,setError:Y,handleSubmit:H,formState:{errors:V,isSubmitting:$}}=R.useForm({defaultValues:L});a.useEffect((()=>{const e=U(((e,{name:t,type:s})=>{const a=!ot.default(L,e);N.current=a;let n=!0;null==P||P.forEach((t=>{n&&t.isRequired&&!e[t.id]&&(n=!1)})),C(n)}));return()=>e.unsubscribe()}),[U]);const W=a.useRef(null);c.useEffectOnce((()=>((()=>{let e=!0;null==P||P.forEach((t=>{e&&t.isRequired&&(t.defaultValue||(e=!1))})),C(e)})(),W.current&&clearTimeout(W.current),()=>{W.current&&clearTimeout(W.current)})));const K=()=>{N.current&&y?T(!0):i(!1),f(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(u.Modal,{isOpen:r,isCentered:!0,onClose:K,size:o?"full":"",children:e.jsx(u.ModalOverlay,{className:"bg-alpha-mask-desktop z-[49]",children:e.jsxs(u.ModalContent,{className:Ge.default("max-w-[768px] max-h-[620px] m-0 bg-surface-default rounded-[24px] flex items-center z-[49]",o?"rounded-none":""),style:{boxShadow:"0px 0px 40px 0px rgba(0, 0, 0, 0.10)"},children:[!o&&e.jsx(Kl,{icon:on,size:"md",variant:"ghost",color:"default",className:"absolute top-4 right-4 text-subtle",onClick:K}),e.jsxs("div",{className:Ge.default("py-4 px-6 border-b border-default text-default w-full",o?"flex flex-row justify-between items-center":""),children:[e.jsx("h1",{className:Ge.default("text-2xl line-clamp-1",o?"max-w-[80%]":""),children:l.name}),o&&(null==A?void 0:A.map((t=>{if("getImageInfo"===t.functionName)return e.jsxs(Tr,{variant:"outline",color:"brand",className:"ml-1 grow shrink-0 flex justify-end self-end flex-row flex-nowrap",onClick:()=>j(!0),children:[e.jsx(ta,{className:"w-5 h-5 text-brand mr-1.5"})," ",_("panel.get_imginfo")]},`mob_btn_${t.functionName}`)}))),!o&&e.jsx("p",{className:"text-sm",children:l.description})]}),e.jsx("div",{className:"w-full px-6 py-3 overflow-y-auto text-default flex-grow",children:e.jsx("form",{onSubmit:H((async e=>{if("bot"===t){const e={trace_id:h,bot_id:n};null==M||M.track("Chat_Run_Click",e)}const s={};null==P||P.map((t=>{s[t.fieldName]="checkbox"===t.type?!1!==e[t.fieldName]:e[t.fieldName],"upload"===t.type&&(e[t.fieldName]?(s[`x_ms_name_${t.fieldName}`]=e[`x_ms_name_${t.fieldName}`],s[`x_ms_size_${t.fieldName}`]=e[`x_ms_size_${t.fieldName}`]):delete s[t.fieldName])})),i(!1),O(!0);try{await d(s)}catch(e){f(!0)}finally{O(!1)}})),id:"hook-form",className:"space-y-4",children:P.map(((s,a)=>{const l=V;return s.isRequired&&""==s.value&&Y(s.id,{type:"required"}),e.jsx(yh,{type:t,id:n,defaultValues:L,formEle:s,control:k,errors:l[s.id],setFormValue:D,register:B,clearErrors:z,formTraceId:h},s.id)}))})}),e.jsxs(u.ModalFooter,{className:"border-t border-default flex  items-center py-4 px-6 w-full justify-between",children:[e.jsxs("div",{className:"flex",children:[!o&&(null==A?void 0:A.map((t=>{if("getImageInfo"===t.functionName)return e.jsxs(Tr,{variant:"outline",color:"brand",onClick:()=>j(!0),children:[e.jsx(ta,{className:"w-5 h-5 text-brand mr-1.5"})," ",_("panel.get_imginfo")]},`btn_${t.functionName}`)}))),o&&e.jsx(u.Button,{variant:"outline",className:"border-default rounded-full text-default font-normal px-6",onClick:K,children:_("cancel")})]}),e.jsxs(Tr,{variant:"primary",className:Ge.default("min-w-[158px]",o?"grow shrink-0 ml-3":"",y?"":"opacity-70"),type:"submit",form:"hook-form",disabled:E,children:[l.saveButtonContent,!!l.energyConsumePerUse&&e.jsxs("div",{className:"ml-1.5 flex flex-row justify-center items-center",children:[e.jsx(Ye.default,{src:ns("image/website/icon/20240826/energy.png"),alt:"energy",width:16,height:16,className:"size-4 shrink-0"}),e.jsx("span",{className:"text-xs font-semibold text-white ml-[2px]",children:l.energyConsumePerUse})]})]})]})]})})}),w&&e.jsx(Th,{isOpen:w,onClose:()=>{T(!1)},onConfirmed:()=>{T(!1),i(!1)}})]})}));function Sh({buttonProps:t,index:n,rowIndex:l,latest:r,disabled:i}){const{type:o,entityInfo:u}=a.useContext(jt),{id:m,name:p,tagList:f}=u,{buttonId:g,actions:v,doubleCheck:x}=t,{isMobile:b}=so(),{value:E,setTrue:_,setValue:w}=h.useBoolean(!1),[T,N]=a.useState(),[y,C]=a.useState(),S=xl((e=>e.toggleLoginModal)),j=Ur((e=>e.isVisitor)),I=gh((e=>e.luiButtonGuideClicked)),O=gh((e=>e.setLuiButtonGuideClicked)),A=Ur((e=>e.isVisitor)),[M,P]=a.useState(!1),L=Ur((e=>e.energy)),k=s.useTranslations("chat"),R=ls()?document.getElementById("message-box"):null,D=ls()?document.getElementById("renderer-container"):null,{clickFn:U,msgId:F,interactionTraceId:B,executeTracker:G}=xh(),{loading:z,handleClick:Y,handleFormSubmit:H,formInteracting:V,formSubmitError:$,setFormSubmitError:W}=function(e){const{type:t,id:s,name:n,tagList:l,actions:r,btnId:i,msgId:o,setFormModalVisible:u,clickHandler:m,buttonContent:p,executeTracker:f}=e,g=hi(),v=Ur((e=>e.isVisitor)),x=Ur((e=>e.user)),{value:b,setTrue:E,setFalse:_}=h.useBoolean(!1),[w,T]=c.useToggle(!1),[N,y]=c.useToggle(!1),{onCopy:C}=ui(""),S=d.useRouter(),j=a.useCallback((e=>async()=>{try{return S.push(e),await Promise.resolve()}catch(e){return Promise.reject(e)}}),[S]),I=a.useCallback((e=>async()=>{C(e)}),[S]),O=a.useCallback((()=>{const e=(null==l?void 0:l.map((e=>`${e.label}`)))||[];null==g||g.track("UserSendMessage",Object.assign(Object.assign(Object.assign(Object.assign({message_type:"buttonclick",button_name:null==p?void 0:p.text},"widget"===t?{widget_id:s,widget_name:n}:{bot_id:s,bot_name:n}),{chat_platform:"web2"}),(null==e?void 0:e.length)>0&&{tag_name:e}),{bot_battery_cost:parseInt((null==p?void 0:p.iconLabel)||"")||0,user_membership_type:v?"0":(null==x?void 0:x.isGenesisPasscard)||(null==x?void 0:x.isPasscard)?"3":`${null==x?void 0:x.level}`}))}),[null==p?void 0:p.iconLabel,null==p?void 0:p.text,s,v,n,g,l,t,null==x?void 0:x.isGenesisPasscard,null==x?void 0:x.isPasscard,null==x?void 0:x.level]),A=a.useCallback(((e,t)=>async()=>{var t,s,a,n,l,r;try{return(null===(t=e.interactionInput)||void 0===t?void 0:t.displayType)===Re.NOTHING&&E(),O(),null==m||m({actionType:e.action,buttonId:i,msgId:o,text:(null===(s=e.interactionInput)||void 0===s?void 0:s.displayType)===Re.NOTHING?void 0:null!==(n=null===(a=e.interactionInput)||void 0===a?void 0:a.content)&&void 0!==n?n:null===(l=e.interactionInput)||void 0===l?void 0:l.slashCommandInput.name,imSlashCommandInput:null===(r=e.interactionInput)||void 0===r?void 0:r.slashCommandInput}),await Promise.resolve()}catch(e){return _(),Promise.reject(e)}}),[O,m,i,o,_,E]),M=a.useCallback((e=>async()=>{try{return u(e),await Promise.resolve()}catch(e){return Promise.reject(e)}}),[u]);a.useCallback((()=>{_(),T(!1)}),[_,T]),a.useCallback((()=>{_(),T(!1),y(!0)}),[_,T,y]);const P=a.useCallback(((e,t,s)=>{var a;try{return E(),T(!0),O(),null==m||m({actionType:e.action,buttonId:i,msgId:o,text:null===(a=e.componentInput)||void 0===a?void 0:a.name,componentInputMessage:JSON.stringify(null!=t?t:{})},s),Promise.resolve()}catch(e){return _(),T(!1),Promise.reject(e)}finally{_()}}),[i,m,o,O,_,T,E]),L=a.useCallback((e=>{switch(e.action){case ke.JUMP_LINK:return j(e.actionLink);case ke.INTERACTION:return A(e);case ke.CLIPBOARD:return I(e.clipboardContent);case ke.POP_UP_FORM:return null==g||g.track("Close_Button_PopUp",Object.assign({button_name:null==p?void 0:p.text},"widget"===t?{widget_id:s,widget_name:n}:{bot_id:s,bot_name:n})),M(e);default:return async()=>Promise.reject("no matched branch")}}),[j,A,I,g,null==p?void 0:p.text,t,s,n,M]),k=a.useCallback((async e=>{if(0===e.length)return;const t=e.shift();try{const s=L(t);await s(),k(e)}catch(e){console.error("Error executing action: ",e)}}),[L]);return{loading:b,handleClick:a.useCallback((async()=>{"bot"===t&&f(r.map((e=>e.action))),await k([...r])}),[r,k]),handleFormSubmit:P,formInteracting:w,formSubmitError:N,setFormSubmitError:y}}({type:o,id:m,name:p,tagList:f,actions:v,btnId:g,msgId:F,setFormModalVisible:e=>{C(e),N(e.componentInput),_()},clickHandler:U,buttonContent:t.content,executeTracker:G}),K=a.useCallback((async(e,t)=>H(y,e,t)),[y,H]),q=async()=>{P(!0),A===Ft.NO?await Y():S(!0),P(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Tl,{variant:"message",content:e.jsxs("div",{className:"flex flex-col gap-1 relative",children:[e.jsx(on,{onClick:()=>O(!0),className:"absolute top-0 right-0 size-[18px] text-[var(--white-70)] cursor-pointer"}),e.jsx("p",{className:"text-base",children:k("guidance.title")}),e.jsx("p",{className:"text-sm",children:k("guidance.content")})]}),open:!I,showArrow:!0,side:"bottom",align:"start",className:"mx-0 w-[320px]",container:R,collisionBoundary:[D],disabled:!(!I&&r&&0===n&&0===l&&j===Ft.NO),children:x.isNeedDoubleCheck?e.jsx(Eh,{onConfirm:q,title:x.title,description:x.description,clicked:()=>O(!0),children:e.jsx(wh,{content:t.content,style:t.style,disabled:i||t.disabled,loading:z||M,energy:L})}):e.jsx(wh,{content:t.content,style:t.style,disabled:i||t.disabled,onClick:()=>{O(!0),q()},loading:z||M,energy:L})}),E&&T&&e.jsx(Ch,{type:o,id:m,isOpen:E,setOpen:w,params:T,isMobile:b,onSubmit:K,loading:V,formSubmitError:$,setFormSubmitError:W,formTraceId:B})]})}function jh({row:t,rowIndex:s,latest:a,disabled:n}){return e.jsx("div",{className:"w-full flex flex-wrap gap-3",children:t.components.map(((t,l)=>t.button&&e.jsx(Sh,{rowIndex:s,buttonProps:t.button,index:l,latest:a,disabled:n},l)))})}function Ih({rows:t,latest:s,disabled:a}){return e.jsx("div",{className:"space-y-3",children:t.map(((t,n)=>e.jsx(jh,{row:t,rowIndex:n,latest:s,disabled:a},n)))})}function Oh({latest:t,component:s,disabled:a=!1}){return s?e.jsx(Ih,{rows:s.components,latest:t,disabled:a}):null}function Ah(e){const{partialUpdateMessage:t}=a.useContext(At),[s,n]=c.useBoolean(!1),{error:l}=Ql();return{updating:s,onEditMessage:async(s,a)=>{try{n(!0);const{success:r,msg:i}=await function(e,t){return Os.post("/v1/bot/chat/edit_message",{body:{msgId:e,content:t},isGoLang:!0})}(e,s);r?(null==t||t(e,{text:s,audioUrl:""}),a()):l({content:null!=i?i:""})}catch(e){}finally{n(!1)}}}}function Mh({message:t,virtuosoRef:n}){var l;const r=a.useRef(null),{entityInfo:i,chatSetting:o}=a.useContext(jt),{maxTokens:d}=i,{scrollToBottom:u}=a.useContext(At),m=!xl((e=>e.isMobile)),p=a.useRef(u),f=s.useTranslations("common"),{setDisplayMode:h,isTextDisplayException:g}=Am(),[v,x]=a.useState(null!==(l=t.text)&&void 0!==l?l:""),{updating:b,onEditMessage:E}=Ah(t.id),[_,w]=a.useState(0),T=a.useMemo((()=>_>(d||1500)),[d,_]),N=a.useMemo((()=>v===(null==t?void 0:t.text)),[null==t?void 0:t.text,v]),y=()=>{h("NORMAL")},C=(e=!0)=>{var t,s;const a=null===(t=n.current)||void 0===t?void 0:t.getScrollLocation();if(a){const{bottomOffset:t,listOffset:l,scrollHeight:r,visibleListHeight:i}=a;r-i+t+l>0&&(null===(s=n.current)||void 0===s||s.scrollIntoView({index:"LAST",align:"end",behavior:e?"smooth":"auto"}))}};return a.useEffect((()=>{p.current!==u&&y()}),[u]),a.useEffect((()=>{!1!==(null==o?void 0:o.isTranscriptionOn)||g||y()}),[null==o?void 0:o.isTranscriptionOn]),a.useEffect((()=>{(async e=>{fi(e).then((e=>w(e)))})(v)}),[v]),c.useEffectOnce((()=>{var e;null===(e=r.current)||void 0===e||e.setSelectionRange(v.length,v.length),setTimeout((()=>{C(!1)}),100)})),e.jsxs("div",{className:"min-w-12 w-[560px] max-w-full md:max-w-[460px] lg:max-w-[476px] large:max-w-[560px] overflow-hidden flex flex-col gap-3 p-1",children:[e.jsxs("div",{className:"w-full relative",children:[e.jsx(He.default,{ref:r,rows:1,value:v,onChange:e=>x(e.target.value),autoFocus:!0,className:Ge.default("min-h-[69px] max-h-[226px] resize-none w-full p-3 pb-10 rounded-lg rounded-tl-sm border border-default bg-surface-search-field shadow-background-default text-sm text-default","ring-offset-surface-default hover:border-hovered hover:bg-surface-subtle","aria-[invalid=true]:border-critical aria-[invalid=true]:hover:border-surface-critical-hovered aria-[invalid=true]:hover:bg-surface-accent-red-subtlest aria-[invalid=true]:focus-visible:ring-error","file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-subtler focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-30",T&&"border-critical hover:border-critical hover:bg-surface-accent-red-subtlest focus-visible:ring-error"),onHeightChange:()=>C()}),e.jsx("div",{className:"absolute right-3 bottom-3",children:e.jsxs(Ul,{size:"xs",color:"subtlest",className:"bg-surface-default px-2 py-1 rounded-xl",children:[_,"/",d||1500," Tokens"]})})]}),e.jsxs("div",{className:"w-full flex justify-end gap-3",children:[e.jsx(Tr,{variant:"outline",color:"default",size:m?"sm":"md",disabled:b,onClick:y,children:f("cancel")}),e.jsx(Tr,{variant:"primary",color:"brand",size:m?"sm":"md",onClick:()=>{E(v,y)},disabled:!v||T||N,loading:b,children:f("confirm")})]})]})}function Ph({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const Lh=Fe.forwardRef(Ph);function kh({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{fillRule:"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Rh=Fe.forwardRef(kh);function Dh({width:t,customClass:s}){var a,n;const{message:l,totalMessages:r,currentMessageIndex:i,setCurrentMessageIndex:o,displayMode:c}=Am(),d=(null!==(n=null===(a=null==l?void 0:l.regeneratedMessages)||void 0===a?void 0:a.length)&&void 0!==n?n:0)+1,u=1===i,m=i===d;return 1===r||"REGENERATING"===(null==l?void 0:l.status)||"REGENERATE_ERROR"===(null==l?void 0:l.status)||"EDIT"===c?null:e.jsxs("div",{style:{maxWidth:t+32+6},className:pn("w-full flex justify-end items-center gap-1",s),children:[e.jsx(Kl,{icon:Lh,variant:"ghost",color:"default",size:"sm",disabled:u,onClick:()=>{u||null==o||o(i-1)}}),e.jsxs(Ul,{size:"sm",color:"subtle",children:[i,"/",d]}),e.jsx(Kl,{icon:Rh,variant:"ghost",color:"default",size:"sm",disabled:m,onClick:()=>{m||null==o||o(i+1)}})]})}function Uh({virtuosoRef:t}){var n,l,r,i,o,c;const d=a.useRef(null),{type:u,chatSetting:m,entityInfo:p,entitySetting:f,showReplyName:h,CustomErrorMessage:g}=a.useContext(jt),{id:v,hasUnlocked:x,chatCallerType:E,needShowUnlock:_}=p,{outputVoice:w}=null!=f?f:{},{exceptionsForTextDisplay:T,sendButtonInteractionMessage:N,share:y,editorMode:C}=a.useContext(At),{idSet:S,add:j,remove:I}=y||{},{message:O,displayMode:A,latest:M,contextMenuDisabled:P}=Am(),L=s.useTranslations("chat"),k=(e=>{const[t,s]=a.useState(0);return a.useEffect((()=>{const t=new ResizeObserver((e=>{for(const t of e)s(t.contentRect.width)})),a=e.current;return a&&t.observe(a),()=>{a&&t.unobserve(a)}}),[e,A]),t})(d),R=a.useMemo((()=>{var e,t;const s=null!==(e=(null!=T?T:{})[`${u}-${v}`])&&void 0!==e?e:[];return null===(t=null==m?void 0:m.isTranscriptionOn)||void 0===t||t||!(null==m?void 0:m.isTranscriptionOn)&&s.includes(null==O?void 0:O.id)}),[null==m?void 0:m.isTranscriptionOn,T,v,null==O?void 0:O.id,u]),D=a.useMemo((()=>{var e,t;return null!==(t=(null==w||w)&&(null===(e=null==m?void 0:m.isAudioOn)||void 0===e||e))&&void 0!==t&&t}),[null==m?void 0:m.isAudioOn,w]);return(null===(n=null==O?void 0:O.asyncJobInfo)||void 0===n?void 0:n.status)!==_e.DONE&&(null===(l=null==O?void 0:O.asyncJobInfo)||void 0===l?void 0:l.status)!==_e.UNKNOWN||!(null==O?void 0:O.runningError)?e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx(Dh,{width:k,customClass:"hidden md:flex mb-1"}),e.jsxs("div",{className:"w-full flex gap-1.5",children:[e.jsxs("div",{className:"grow overflow-hidden self-start flex items-start gap-1.5 group/menu",children:[e.jsx($o,{size:"md",variant:"USER"===(null==O?void 0:O.source)?"user":"bot",src:(null==O?void 0:O.avatar)||"https://www.myshellstatic.com/cdn-cgi/image/quality=40,format=webp/image/bot/logo/20240106/default.png"}),e.jsxs("div",{className:"flex flex-col gap-[2px] max-w-full overflow-hidden",children:[R&&h&&(null==O?void 0:O.name)&&e.jsx(Ul,{size:"sm",color:"subtler",children:null==O?void 0:O.name}),e.jsx("div",{className:"w-full flex gap-1.5",children:e.jsx("div",{className:"w-full flex flex-col gap-3",children:"EDIT"===A?e.jsx(Mh,{message:O,virtuosoRef:t}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{ref:d,className:"min-w-12 md:max-w-[460px] lg:max-w-[476px] large:max-w-[560px] overflow-hidden flex flex-col gap-3",children:e.jsx("div",{className:"min-h-11 w-fit py-3 px-4 bg-surface-special rounded-2xl rounded-tl-sm gap-3 max-w-full",children:"REGENERATING"===(null==O?void 0:O.status)?e.jsx(Ip,{}):e.jsxs(e.Fragment,{children:[R&&(null==O?void 0:O.replyTo)&&e.jsx(Ul,{size:"xs",color:"subtler",children:L("reply_to",{name:(null===(r=null==O?void 0:O.replyTo)||void 0===r?void 0:r.isVisitor)?`${L("visitor")}${null===(i=null==O?void 0:O.replyTo)||void 0===i?void 0:i.nameTag}`:null===(o=null==O?void 0:O.replyTo)||void 0===o?void 0:o.name})}),e.jsx(ah,{message:O,showText:R,showAudio:D,latest:M})]})})}),!P&&e.jsx(oh,{className:Ge.default("hidden md:flex md:invisible md:group-hover/menu:visible md:group-focus-within/menu:visible")})]}),"REGENERATING"!==(null==O?void 0:O.status)&&((null==O?void 0:O.componentContainer)||!b.isEmpty(null==O?void 0:O.buttons)||"widget"===u&&E===el.WIDGET_CHAT_CALLER_TYPE_PROMPT&&M&&!x&&_||"widget"===u&&E===el.WIDGET_CHAT_CALLER_TYPE_PROMPT&&"GREETING"===(null==O?void 0:O.type)&&x)&&e.jsxs("div",{className:"min-w-12 md:max-w-[460px] lg:max-w-[476px] large:max-w-[560px] flex flex-col gap-3",children:[e.jsx(bh,{clickFn:N,msgId:null!==(c=null==O?void 0:O.id)&&void 0!==c?c:"",type:u,id:v,children:e.jsx(Oh,{component:null==O?void 0:O.componentContainer,latest:M})}),b.isEmpty(null==O?void 0:O.buttons)?null:null==O?void 0:O.buttons,"widget"===u&&E===el.WIDGET_CHAT_CALLER_TYPE_PROMPT&&M&&!x&&_&&e.jsx(mh,{}),"widget"===u&&E===el.WIDGET_CHAT_CALLER_TYPE_PROMPT&&"GREETING"===(null==O?void 0:O.type)&&x&&e.jsx(ph,{})]})]})})})]})]}),"SHARE"===C&&e.jsx("div",{className:Ge.default("shrink-0 size-8 flex justify-center items-center"),children:e.jsx(Hm,{variant:"circle",checked:null==S?void 0:S.has(O.id),onCheckedChange:e=>{e?null==j||j(O.id):null==I||I(O.id)}})})]})]}):e.jsx("div",{className:"w-full px-0 md:pl-[38px]",children:g?e.jsx(g,{message:O}):e.jsx(Zf,{message:O})})}function Fh({msgDisplayType:t,source:s,virtuosoRef:n,latest:l}){const r=hi(),{type:i,entityInfo:o}=a.useContext(jt),{id:c}=o,d=xl((e=>e.traceId)),u=xl((e=>e.setTraceId));a.useEffect((()=>{if(l&&"bot"===i&&cp.shouldTrack(c)&&d){const e={trace_id:d,page:"chat",bot_id:c,time:(new Date).getTime()};null==r||r.track("Page_Render_Success",e),cp.recordTracked(c),u()}}),[d]);const m=a.useMemo((()=>"NORMAL"===t?"USER"===s?e.jsx(ch,{}):e.jsx(Uh,{virtuosoRef:n}):e.jsx(Rm,{})),[t,s]);return e.jsx(e.Fragment,{children:m})}const Bh=({loading:t})=>t?e.jsx("div",{className:"w-full flex justify-center absolute bottom-1 md:bottom-6 left-1/2 -translate-x-1/2",children:e.jsx(di,{color:"brand"})}):null,Gh=({context:t})=>e.jsx(Pm,{loading:t.gettingHistory&&!t.initializingHistory}),zh=({context:t})=>e.jsx(Bh,{loading:t.initializingHistory}),Yh=()=>{const t=_.useVirtuosoLocation(),s=_.useVirtuosoMethods();return e.jsx("div",{className:"relative hidden md:block",children:e.jsx("div",{className:"absolute w-fit right-4 md:right-6 bottom-3 md:bottom-6 mx-auto flex justify-end transition-transform duration-1000 ease-in-out",children:!t.isAtBottom&&e.jsx(Kl,{size:"md",variant:"outline",color:"default",className:"bg-surface-default text-icon-brand",icon:Vs,onClick:()=>{s.scrollIntoView({index:"LAST",align:"end",behavior:"auto"})}})})})},Hh=({data:t,index:s,context:n})=>{const{virtuosoRef:l}=n,{messageList:r,messageToDisplay:i}=a.useContext(At),o=i(t);return(null==t?void 0:t.handled)?null:e.jsx("div",{className:Ge.default("flex flex-col items-center pb-4 md:pb-5 mx-4 md:mx-6",0===s&&"md:pt-[80px]"),children:e.jsx(Mm,{message:o,latest:s===r.length-1,children:e.jsx(Fh,{source:o.source,msgDisplayType:o.msgDisplayType,virtuosoRef:l,latest:s===r.length-1})})})};var Vh=Object.freeze({__proto__:null,default:function({virtuosoRef:t}){const s=hi(),{type:n,entityInfo:l,setAtBottom:r,chatSetting:i}=a.useContext(jt),o=c.usePrevious(i),d=xl((e=>e.traceId)),u=xl((e=>e.setTraceId)),{id:m}=l,{messageList:p,hasMore:f,gettingHistory:h,initializingHistory:g,getHistoryMessage:v,markAsRead:x,scrollToBottom:E,interacting:w,scrolled:T,setScrolled:N,lastUserInteractionMsgId:y}=a.useContext(At),C=a.useCallback((e=>{0===e.listOffset&&f&&v(),r(e.isAtBottom)}),[v,f,r]);return a.useEffect((()=>{if(null==x||x(),0===p.length&&d&&"bot"===n&&cp.shouldTrack(m)){const e={trace_id:d,page:"chat",bot_id:m,time:(new Date).getTime()};null==s||s.track("Page_Render_Success",e),cp.recordTracked(m),u()}return()=>{cp.removeTracked(m)}}),[d]),a.useEffect((()=>{b.isEqual(null==i?void 0:i.isAudioOn,null==o?void 0:o.isAudioOn)&&b.isEqual(null==i?void 0:i.isTranscriptionOn,null==o?void 0:o.isTranscriptionOn)||setTimeout((()=>{var e;null===(e=t.current)||void 0===e||e.scrollIntoView({index:"LAST",align:"start-no-overflow",behavior:"auto"})}))}),[i]),Go({callback:e=>{e||T||setTimeout((()=>{var e,s;const a=null===(e=t.current)||void 0===e?void 0:e.data.findIndex((e=>e.id===y));a&&(null===(s=t.current)||void 0===s||s.data.append([],(({scrollInProgress:e,atBottom:t})=>({index:a,align:"start",behavior:t||e?"smooth":"auto",done:()=>null==N?void 0:N(!0)}))))}),300)}}),e.jsx("div",{className:"h-full w-full relative",id:"message-box",children:e.jsx(_.VirtuosoMessageListLicense,{licenseKey:null!=Zt?Zt:"",children:e.jsx(_.VirtuosoMessageList,{height:"100%",className:"h-full w-full overflow-x-hidden overscroll-contain",ref:t,initialData:p,computeItemKey:({data:e})=>`message-${e.id}`,context:{gettingHistory:h,initializingHistory:g,virtuosoRef:t},onScroll:C,Header:Gh,Footer:zh,StickyFooter:Yh,initialLocation:{index:"LAST",align:"end"},ItemContent:Hh})})})}});var $h=Object.freeze({__proto__:null,default:function({open:t}){const a=s.useTranslations("chat"),n=s.useTranslations("profile"),l=xl((e=>e.toggleLoginModal));return e.jsx(Mr,{open:t,hideClose:!0,overlayClassName:"z-[111]",contentClassName:"md:w-[500px] z-[112]",children:e.jsxs("div",{className:"px-5 py-[30px] flex flex-col items-center gap-10",children:[e.jsx(Ul,{weight:"semibold",children:a("login_popup_tips")}),e.jsxs("div",{className:"w-full flex justify-evenly",children:[e.jsxs("div",{className:"flex w-full mt-3 rounded-xl overflow-hidden flex-col justify-center items-center gap-[10px]",children:[e.jsx(Ye.default,{alt:"circle",src:"/images/free_premuium_membership.png",width:90,height:90,className:"size-[90px]"}),e.jsx(Ul,{size:"sm",weight:"regular",className:"min-w-[45px] md:min-w-[60px]",children:a("free_premium_membership_card")})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center gap-[10px] w-full mt-3 rounded-xl overflow-hidden",children:[e.jsx(Ye.default,{alt:"circle",src:"/images/rewards.png",width:90,height:90,className:"size-[90px]"}),e.jsx(Ul,{size:"sm",weight:"regular",className:"min-w-[45px] md:min-w-[60px]",children:a("more_conversations")})]}),e.jsxs("div",{className:"w-full mt-3 rounded-xl overflow-hidden flex flex-col justify-center items-center gap-[10px]",children:[e.jsx(Ye.default,{alt:"circle",src:"/images/gpt4.png",width:90,height:90,className:"size-[90px]"}),e.jsx(Ul,{size:"sm",weight:"regular",className:"min-w-[45px] md:min-w-[60px]",children:a("chat_with_gpt4")})]})]}),e.jsxs(Tr,{variant:"primary",color:"brand",size:"lg",className:"w-fit",onClick:()=>{l(!0)},children:[e.jsx(Ul,{className:"text-inherit",children:n("login_sign_up")}),e.jsx(pa,{className:"size-5"})]})]})})}});function Wh({imgObj:t,onPinchStart:s,onPinchEnd:n}){var l,r,i,o;const c=a.useRef(null),[d,u]=a.useState(1),m=a.useRef(1),p=a.useRef(null),[f,g]=a.useState(!1),v=()=>{g(!0)};return h.useEffectOnce((()=>{const e=p.current;e&&e.addEventListener("load",v,{once:!0})})),a.useEffect((()=>{if(c.current){const e=new ct.default(c.current);return e.get("pinch").set({enable:!0}),e.on("pinchstart",(()=>{s()})),e.on("pinch",(e=>{e.srcEvent.stopPropagation();const t=Math.min(3,Math.max(.5,m.current*e.scale));u(t)})),e.on("pinchend",(e=>{n(),m.current*=e.scale})),()=>{e.destroy()}}}),[]),e.jsxs("div",{style:{scale:d},ref:c,className:"w-full h-full relative flex justify-center items-center",children:[!f&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10 bg-[#00000033] backdrop-blur-2xl",children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})}),e.jsx("img",{ref:p,alt:"image",src:t.url,width:(null===(l=t.mediaFileMetadata)||void 0===l?void 0:l.width)||9999,height:(null===(r=t.mediaFileMetadata)||void 0===r?void 0:r.height)||9999,className:Ge.default("h-auto max-w-full max-h-full object-scale-down touch-none z-20",(null===(i=t.mediaFileMetadata)||void 0===i?void 0:i.width)?`w-[${t.mediaFileMetadata.width}px]`:"w-auto",(null===(o=t.mediaFileMetadata)||void 0===o?void 0:o.height)?`h-[${t.mediaFileMetadata.height}px]`:"h-auto")})]})}const Kh=a.memo((function({src:t,triggerPlay:s}){return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx("video",{src:t,className:"w-auto h-auto max-w-full max-h-full object-scale-down",disablePictureInPicture:!0,controls:!0,controlsList:"nodownload",autoPlay:s})})}));const qh=a.memo((function({url:t,onViewVideo:s,customClass:n,showPlayBtn:l=!0,showRadius:r=!0,showLoading:i=!0}){const o=a.useRef(null),[c,d]=a.useState(!1),u=()=>{d(!0)};return h.useEffectOnce((()=>{const e=o.current;e&&e.addEventListener("loadedmetadata",u,{once:!0})})),e.jsxs("div",{className:Ge.default("relative w-full h-full",n,r?"rounded-md overflow-hidden":""),children:[!c&&i&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-[1] bg-[#00000033] backdrop-blur-2xl",children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})}),e.jsxs("div",{className:"relative w-full h-full min-h-[240px]",children:[e.jsx("video",{ref:o,src:t,muted:!0,playsInline:!0,disablePictureInPicture:!0,className:"w-full h-full object-cover",preload:"metadata"}),l&&e.jsx("div",{className:"w-full h-full absolute top-0 left-0 flex justify-center items-center bg-[#00000033]",children:e.jsx(ji,{className:"w-10 h-10 text-white cursor-pointer",onClick:()=>s&&s()})})]})]})}));var Qh=Object.freeze({__proto__:null,default:function({imgVideoList:t,activeIndex:n,publishing:l,isGreeting:r,onClose:i,publishGalleryHandle:o}){const[c,d]=a.useState(n),[u,m]=a.useState(!1),{downloading:p,onImageDownload:f}=gu(),[h,g]=a.useState(null),[v,x]=a.useState(0),b=a.useRef(null),E=hi();s.useTranslations("common"),Ql();const{msgId:_,selectedBot:w,widgetInfo:T}=a.useContext(_m),N=e=>{const t=b.current;t&&t.slideTo(e),d(e)},y=()=>{m(!0)},C=()=>{m(!1)};return e.jsxs("div",{className:"flex flex-col w-full h-[100svh] bg-black overflow-hidden ease-in-out",style:{transform:`translateY(${v>0?v:0}px)`},children:[e.jsxs("div",{className:"flex px-4 md:px-[6px] py-4 justify-between shrink-0",onTouchStart:e=>{e.stopPropagation(),e.touches.length>1||g(e.touches[0].clientY)},onTouchMove:e=>{if(e.stopPropagation(),null===h)return;const t=e.touches[0].clientY;x(t-h)},onTouchEnd:()=>{v>100&&i(),x(0)},children:[e.jsxs("div",{className:"flex justify-start",children:[e.jsx(Kl,{icon:Ys,variant:"ghost",color:"static","aria-label":"download file",loading:p,onClick:()=>{var e,s;console.log("aaaaaa3"),f(t[c].url,t[c].title||`Myshell_${null==w?void 0:w.name}_${Ve.default().format("YYMMDD_HHmmss")}`),E&&E.track&&(null==E||E.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:_},(null==T?void 0:T.id)?{widget_id:null==T?void 0:T.id,widget_name:null==T?void 0:T.name}:{bot_id:null==w?void 0:w.id,bot_name:null==w?void 0:w.name}),{image_model:null===(s=null===(e=t[c])||void 0===e?void 0:e.mediaFileMetadata)||void 0===s?void 0:s.generateModel})))},size:"md",className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center data-[loading]:text-white",children:e.jsx(Ys,{className:"w-6 h-6 text-white"})}),(null==w?void 0:w.isImageGenerator)&&!r&&(null==w?void 0:w.status)===Gu.Public&&e.jsx(Kl,{icon:_d,variant:"ghost",color:"static","aria-label":"download file",loading:l,onClick:e=>{e.stopPropagation(),e.preventDefault(),null==o||o(c)},size:"md",className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center data-[loading]:text-white"})]}),e.jsx(Kl,{variant:"primary",size:"md","aria-label":"close modal",icon:on,onClick:i,className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center border-none text-static bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 shadow-none"})]}),e.jsx("div",{style:{height:t.length>1?"calc(100% - 120px)":"calc(100% - 56px)"},children:e.jsx(hd,{spaceBetween:100,slidesPerView:1,initialSlide:n,onSwiper:e=>{b.current=e},onSlideChange:e=>{(e=>{d(e)})(e.realIndex)},className:"grow w-full h-full",enabled:!u,loop:t.length>1,children:t.map(((t,s)=>e.jsx(gd,{children:e.jsx("div",{className:Ge.default("touch-none",t.type===il.VIDEO?"w-full h-full overflow-hidden justify-center items-center relative z-10":"absolute w-full h-full flex justify-center items-center z-10",s===c?"visible":" invisible w-0 h-0"),children:t.type===il.VIDEO?e.jsx(Kh,{src:t.url,triggerPlay:s===c}):e.jsx(Wh,{imgObj:t,onPinchStart:y,onPinchEnd:C})})},t.url)))})}),t.length>1&&e.jsx("div",{className:"flex justify-center items-center px-[6px] py-3 space-x-2 shrink-0",children:t.length<=4?t.map(((t,s)=>e.jsx(a.Fragment,{children:t.type===il.VIDEO?e.jsx("div",{className:Ge.default("rounded-md overflow-hidden h-10 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",c===s?"w-10":"w-7"),onClick:()=>N(s),children:e.jsx(qh,{url:t.url,showPlayBtn:!1,showRadius:!1,showLoading:!1},t.url)}):e.jsx("img",{alt:"thumbnail image",src:t.url,width:56,height:56,className:Ge.default("rounded-md h-10 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",c===s?"w-10":"w-7"),onClick:()=>N(s)})},t.url))):e.jsx("div",{className:"flex space-x-2",children:t.map(((t,s)=>e.jsx("div",{className:Ge.default("rounded-full w-2 h-2",c===s?"bg-white":"bg-[#FFFFFF33]"),onClick:()=>N(s)},t.url)))})})]})}});function Xh({imgObj:t,handleZoomIn:s,handleZoomOut:n,resetScaleValue:l,onClose:r}){var i,o;const c=a.useRef(null),[d,u]=a.useState(!1),[m,p]=a.useState({x:0,y:0}),[f,g]=a.useState({x:0,y:0}),[v,x]=a.useState(!1),{width:b,height:E}=h.useWindowSize(),_=a.useRef(null),[w,T]=a.useState(!1),N=()=>{x(!0)};a.useEffect((()=>{const e=c.current,t=e=>{if(!d)return;const t=e.clientX-f.x,s=e.clientY-f.y;p({x:t,y:s}),T(!0)},s=()=>{u(!1)};return e&&e.addEventListener("load",N,{once:!0}),document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)}}),[d,f]);const y=a.useMemo((()=>{var e,s,a,n;return function(e,t){let s=t.width,a=t.height;if(0===t.width||0===t.height)return e;if(t.width<=e.width&&t.height<=e.height)return t;const n=e.width/t.width,l=e.height/t.height,r=Math.min(n,l);return s=t.width*r,a=t.height*r,{width:s,height:a}}({width:b,height:E-80},{width:null!==(s=null===(e=t.mediaFileMetadata)||void 0===e?void 0:e.width)&&void 0!==s?s:0,height:null!==(n=null===(a=t.mediaFileMetadata)||void 0===a?void 0:a.height)&&void 0!==n?n:0})}),[E,null===(i=t.mediaFileMetadata)||void 0===i?void 0:i.height,null===(o=t.mediaFileMetadata)||void 0===o?void 0:o.width,b]);return e.jsxs("div",{className:Ge.default("w-full h-full relative flex justify-center items-center"),children:[!v&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10",children:e.jsx("div",{className:"flex justify-center items-center bg-[#00000033] backdrop-blur-2xl",style:Object.assign({},y),children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})})}),e.jsx("div",{className:"image-item absolute w-full h-full top-0 left-0 z-[1]",onClick:r}),e.jsx("img",{ref:c,alt:"image",src:t.url,width:y.width||9999,height:y.height||9999,draggable:!0,className:Ge.default("object-scale-down z-20",d?"cursor-grabbing":"cursor-grab"),style:{transform:`translate(${m.x}px, ${m.y}px)`,maxHeight:y.height||"80vh"},onMouseDown:e=>{2!==e.button&&(e.stopPropagation(),u(!0),T(!1),g({x:e.clientX-m.x,y:e.clientY-m.y}))},onDragStart:e=>e.preventDefault(),onWheel:e=>{0!==e.deltaY&&(e.deltaY<0?s():n())},onClick:()=>{w?T(!1):(_.current&&clearTimeout(_.current),_.current=setTimeout((()=>{r()}),200))},onDoubleClick:()=>{_.current&&(clearTimeout(_.current),l())}})]})}function Jh({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM18.584 5.106a.75.75 0 0 1 1.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 0 1-1.06-1.06 8.25 8.25 0 0 0 0-11.668.75.75 0 0 1 0-1.06Z"}),Fe.createElement("path",{d:"M15.932 7.757a.75.75 0 0 1 1.061 0 6 6 0 0 1 0 8.486.75.75 0 0 1-1.06-1.061 4.5 4.5 0 0 0 0-6.364.75.75 0 0 1 0-1.06Z"}))}const Zh=Fe.forwardRef(Jh);function eg({title:e,titleId:t,...s},a){return Fe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?Fe.createElement("title",{id:t},e):null,Fe.createElement("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 0 0 1.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06ZM17.78 9.22a.75.75 0 1 0-1.06 1.06L18.44 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06l1.72-1.72 1.72 1.72a.75.75 0 1 0 1.06-1.06L20.56 12l1.72-1.72a.75.75 0 1 0-1.06-1.06l-1.72 1.72-1.72-1.72Z"}))}const tg=Fe.forwardRef(eg);const sg=a.memo((function({videoObj:t,onClose:s,triggerPlay:n}){var l,r,i,o;const c=a.useRef(null),[d,m]=a.useState(0),[p,f]=a.useState(!1),[g,v]=a.useState(0),[x,b]=a.useState(!1),[E,_]=a.useState(!1),[w,T]=a.useState(.5),{isMobile:N}=No(),[y,C]=a.useState(.5),[S,j]=a.useState(!1),{width:I,height:O}=h.useWindowSize(),A=a.useRef(null),M=h.useHover(A);a.useEffect((()=>{f(!1),v(0),m(0)}),[null==t?void 0:t.url]),h.useEffectOnce((()=>{const e=c.current;e&&(e.volume=.5)}));const P=()=>{const e=c.current;e&&(v(e.currentTime),e.paused||requestAnimationFrame(P))},L=e=>{_(e);const t=c.current;e&&t&&(C(w),T(0),t.volume=0),e||(0!==y?t&&(T(y),t.volume=y):t&&(T(.1),t.volume=.1))},k=()=>{f(!0)},R=()=>{(()=>{const e=c.current;m(e.duration)})(),j(!0)};a.useEffect((()=>{const e=c.current;return null==e||e.addEventListener("play",k),null==e||e.addEventListener("canplay",R),null==e||e.addEventListener("canplaythrough",R),(null==e?void 0:e.readyState)&&(null==e?void 0:e.readyState)>=2&&R(),()=>{null==e||e.removeEventListener("play",k),null==e||e.removeEventListener("canplay",R),null==e||e.removeEventListener("canplaythrough",R)}}),[]),a.useEffect((()=>{const e=c.current;e&&(n?e.readyState>=4?e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)})):e.addEventListener("canplaythrough",(()=>{e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)}))}),{once:!0}):(e.pause(),e.currentTime=0,v(0)))}),[n]);const D=a.useMemo((()=>{var e,s,a,n;return function(e,t){let s=t.width,a=t.height;if(0===t.width||0===t.height)return e;if(t.width<=e.width&&t.height<=e.height)return t;const n=e.width/t.width,l=e.height/t.height,r=Math.min(n,l);return s=t.width*r,a=t.height*r,{width:s,height:a}}({width:I,height:O-80},{width:null!==(s=null===(e=t.mediaFileMetadata)||void 0===e?void 0:e.width)&&void 0!==s?s:0,height:null!==(n=null===(a=t.mediaFileMetadata)||void 0===a?void 0:a.height)&&void 0!==n?n:0})}),[O,null===(l=t.mediaFileMetadata)||void 0===l?void 0:l.height,null===(r=t.mediaFileMetadata)||void 0===r?void 0:r.width,I]);return e.jsxs("div",{className:"w-full h-full relative flex justify-center items-center",ref:A,children:[!S&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10",children:e.jsx("div",{className:"flex justify-center items-center bg-[#00000033] backdrop-blur-2xl",style:Object.assign({},D),children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})})}),e.jsx("div",{className:"absolute w-full h-full top-0 left-0 z-[1]",onClick:s}),e.jsx("video",{src:t.url,className:"object-scale-down",width:null!==(i=D.width)&&void 0!==i?i:9999,height:null!==(o=D.height)&&void 0!==o?o:9999,ref:c,onEnded:function(){c.current&&(c.current.currentTime=0,c.current.pause(),f(!1)),v(0)},onTimeUpdate:P,onError:()=>{b(!0)},muted:E,style:Object.assign({},D)}),M&&S&&e.jsx("div",{className:"absolute bottom-9 w-full flex justify-center z-10",children:e.jsxs("div",{className:"w-[480px] h-[56px] flex space-x-2 justify-center items-center border border-default rounded-xl p-4 bg-surface-container-default text-default shadow-[0_0_2px_0_#0000001A]",children:[e.jsx(u.Button,{variant:"unstyled",onClick:()=>{const e=c.current;e&&(e.paused?e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)})):(e.pause(),f(!1)))},borderRadius:"full","aria-label":"audio control button",isDisabled:!t.url||!S,_disabled:{opacity:.3,cursor:"not-allowed"},size:"sm",className:"!flex !items-center !justify-center text-default w-9 h-9",children:p?e.jsx(Ci,{className:"w-6 h-6"}):e.jsx(ji,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(g)}),e.jsxs(u.Slider,{min:0,max:d,value:g,onChangeStart:()=>{const e=c.current;e&&(e.paused||(e.pause(),f(!1)))},onChange:e=>(e=>{const t=c.current;t&&(t.currentTime=e,v(t.currentTime))})(e),onChangeEnd:()=>{const e=c.current;e&&e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)}))},focusThumbOnChange:!1,isDisabled:!S,className:"flex items-center w-full h-6 cursor-pointer",children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-white"})]}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(d)}),e.jsxs(u.Popover,{placement:"top",trigger:N?"click":"hover",offset:[0,8],closeOnBlur:!0,openDelay:100,children:[e.jsx(u.PopoverTrigger,{children:e.jsx("div",{children:E?e.jsx(tg,{className:"w-5 h-5 text-default cursor-pointer",onClick:()=>L(!1)}):e.jsx(Zh,{className:"w-5 h-5 text-default cursor-pointer",onClick:()=>L(!0)})})}),e.jsx(u.PopoverContent,{className:"rounded-lg p-3 border border-default w-8 h-[121px] bg-surface-container-default text-default shadow-lg",children:e.jsx(u.PopoverBody,{className:"p-0 flex justify-center items-center",children:e.jsxs(u.Slider,{orientation:"vertical",min:0,max:1,step:.01,value:w,onChange:e=>{const t=c.current;t&&(T(e),t.volume=e,0===e?(_(!0),C(0)):E&&_(!1))},focusThumbOnChange:!1,className:"h-[97px]",children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E] w-[2px]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-surface-container-default"})]})})})]})]})})]})}));var ag=Object.freeze({__proto__:null,default:function({imgVideoList:t,activeIndex:n,publishing:l,isGreeting:r,onClose:i,publishGalleryHandle:o}){const[c,d]=a.useState(n),[m,p]=a.useState(1);s.useTranslations("common");const h=s.useTranslations("chat"),g=hi(),{downloading:v,onImageDownload:x}=gu();Ql();const{msgId:b,selectedBot:E,widgetInfo:_}=a.useContext(_m),w=Ur((e=>e.flagUserFirstPublishGallery)),T=a.useMemo((()=>t[c]),[t,c]);a.useEffect((()=>{const e=e=>{switch(e.key){case"ArrowLeft":S();break;case"ArrowRight":j();break;case"ArrowUp":y();break;case"ArrowDown":C()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]);const N=()=>{p(1)};a.useEffect((()=>{p(1)}),[c]);const y=a.useCallback((()=>{m>=3||p(m+.1)}),[m]),C=a.useCallback((()=>{m<=.5||p(m-.1)}),[m]),S=a.useCallback((e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),d(c<1?t.length-1:c-1)}),[t.length,c]),j=a.useCallback((e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),d(c===t.length-1?0:c+1)}),[t.length,c]);return e.jsxs("div",{className:"w-full h-screen overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"relative flex justify-center w-full",style:{height:"calc(100vh - 80px)"},children:[e.jsx(Kl,{icon:on,size:"md",className:"flex justify-center items-center w-9 h-9 absolute top-6 right-6 z-50 cursor-pointer rounded-full border border-none text-static bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 shadow-none",onClick:i}),e.jsx("div",{className:"img-video-index absolute w-full h-full top-0 left-0 z-[1]",onClick:i}),t.length>1&&e.jsx(Kl,{onClick:S,variant:"primary",color:"brand",size:"md","aria-label":"go to prev",className:"absolute left-6 md:left-6 top-1/2 -translate-y-1/2 z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none",icon:ua}),e.jsx(f.AnimatePresence,{mode:"popLayout",children:t.map(((t,s)=>e.jsx(f.motion.div,{initial:{opacity:0},animate:{opacity:s===c?1:0},exit:{opacity:0},transition:{duration:.2},className:Ge.default(t.type===il.VIDEO?"max-w-3/4 h-full overflow-hidden justify-center items-center relative z-10":"absolute w-full h-full flex justify-center items-center z-10",s===c?"visible":" invisible w-0 h-0"),style:{scale:m},children:t.type===il.VIDEO?e.jsx(sg,{videoObj:t,triggerPlay:s===c,onClose:i}):e.jsx(Xh,{imgObj:t,handleZoomIn:y,handleZoomOut:C,resetScaleValue:N,onClose:i})},t.url)))}),t.length>1&&e.jsx(Kl,{onClick:j,variant:"primary",color:"brand",size:"md","aria-label":"go to next",className:"absolute right-6 md:right-11 top-1/2 -translate-y-1/2 z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none",icon:pa})]}),e.jsxs("div",{className:"h-20 w-full px-6 py-3 flex justify-between items-center shrink-0 relative z-20",children:[e.jsx("div",{className:"absolute w-full h-full top-0 left-0 z-30",onClick:i}),T.type===il.IMAGE?e.jsx("div",{className:"flex justify-end items-center space-x-2",children:e.jsxs("div",{className:"rounded-xl bg-beta-black-20 px-3 flex space-x-[6px] items-center h-[38px] relative z-50",style:{backdropFilter:"blur(12px)"},children:[e.jsx(Fa,{className:"w-5 h-5 text-beta-white-70 cursor-pointer",onClick:C}),e.jsxs(u.Slider,{width:"72px",value:m,min:.5,max:3,step:.1,onChange:e=>{p(e)},focusThumbOnChange:!1,children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-surface-container-default",zIndex:0})]}),e.jsx(Za,{className:"w-5 h-5 text-beta-white-70 cursor-pointer",onClick:y})]})}):e.jsx("div",{className:"w-[150px]",onClick:i}),t.length>1&&e.jsx("div",{className:"flex space-x-2 relative z-50",children:t.map(((t,s)=>e.jsx(a.Fragment,{children:t.type===il.VIDEO?e.jsx("div",{className:Ge.default("rounded-md overflow-hidden h-14 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",c===s?"w-14":"w-7"),onClick:()=>d(s),children:e.jsx(qh,{url:t.url,showPlayBtn:!1,showRadius:!1,showLoading:!1},t.url)}):e.jsx("img",{alt:"thumbnail image",src:t.url,className:Ge.default("rounded-md h-14 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",c===s?"w-14":"w-7"),onClick:()=>d(s)})},t.url)))}),e.jsxs("div",{className:"min-w-[150px] flex justify-end relative z-50",children:[(null==E?void 0:E.isImageGenerator)&&!r&&(null==E?void 0:E.status)===Gu.Public&&e.jsx(Hl,{open:!w||void 0,description:h(w?"publish_to_gallery":"publish_battery"),variant:w?"default":"message",children:e.jsx(Kl,{icon:_d,loading:l,onClick:e=>{e.stopPropagation(),e.preventDefault(),null==o||o(c)},variant:"primary",color:"brand",size:"md",className:"relative z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none"})}),e.jsx("div",{className:"absolute w-full h-full top-0 left-0",onClick:i}),e.jsx(Kl,{variant:"primary",color:"brand",size:"md","aria-label":"download file",loading:v,onClick:()=>{var e;console.log("aaaaaa4");const s=t[c].url;if(x(s,t[c].title||`Myshell_${(null==E?void 0:E.name)||(null==_?void 0:_.name)}_${Ve.default().format("YYMMDD_HHmmss")}`),g&&g.track){const a=null===(e=t[c].mediaFileMetadata)||void 0===e?void 0:e.generateModel;a?null==g||g.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:b},(null==_?void 0:_.id)?{widget_id:null==_?void 0:_.id,widget_name:null==_?void 0:_.name}:{bot_id:null==E?void 0:E.id,bot_name:null==E?void 0:E.name}),{image_model:a})):zn({media_file_url:s}).then((e=>{var t;null==g||g.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:b},(null==_?void 0:_.id)?{widget_id:null==_?void 0:_.id,widget_name:null==_?void 0:_.name}:{bot_id:null==E?void 0:E.id,bot_name:null==E?void 0:E.name}),{image_model:null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.generateModel}))})).catch((()=>{null==g||g.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:b},(null==_?void 0:_.id)?{widget_id:null==_?void 0:_.id,widget_name:null==_?void 0:_.name}:{bot_id:null==E?void 0:E.id,bot_name:null==E?void 0:E.name}),{image_model:""}))}))}},className:"relative z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none",icon:Ys})]})]})]})}});function ng({imgObj:t,onPinchStart:s,onPinchEnd:n}){var l,r,i,o;const c=a.useRef(null),[d,u]=a.useState(1),m=a.useRef(1),p=a.useRef(null),[f,g]=a.useState(!1),v=()=>{g(!0)};return h.useEffectOnce((()=>{const e=p.current;e&&e.addEventListener("load",v,{once:!0})})),a.useEffect((()=>{if(c.current){const e=new ct.default(c.current);return e.get("pinch").set({enable:!0}),e.on("pinchstart",(()=>{s()})),e.on("pinch",(e=>{e.srcEvent.stopPropagation();const t=Math.min(3,Math.max(.5,m.current*e.scale));u(t)})),e.on("pinchend",(e=>{n(),m.current*=e.scale})),()=>{e.destroy()}}}),[]),e.jsxs("div",{style:{scale:d},ref:c,className:"w-full h-full relative flex justify-center items-center",children:[!f&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10 bg-[#00000033] backdrop-blur-2xl",children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})}),e.jsx("img",{ref:p,alt:"image",src:t.url,width:(null===(l=t.mediaFileMetadata)||void 0===l?void 0:l.width)||9999,height:(null===(r=t.mediaFileMetadata)||void 0===r?void 0:r.height)||9999,className:Ge.default("h-auto max-w-full max-h-full object-scale-down touch-none z-20",(null===(i=t.mediaFileMetadata)||void 0===i?void 0:i.width)?`w-[${t.mediaFileMetadata.width}px]`:"w-auto",(null===(o=t.mediaFileMetadata)||void 0===o?void 0:o.height)?`h-[${t.mediaFileMetadata.height}px]`:"h-auto")})]})}const lg=a.memo((function({src:t,triggerPlay:s}){return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx("video",{src:t,className:"w-auto h-auto max-w-full max-h-full object-scale-down",disablePictureInPicture:!0,controls:!0,controlsList:"nodownload",autoPlay:s})})}));var rg=Object.freeze({__proto__:null,default:function({imgVideoList:t,activeIndex:n,publishing:l,onClose:r,publishGalleryHandle:i}){const{type:o,entityInfo:d,imgGenerator:u}=a.useContext(jt),{id:m,name:p}=d,{message:f}=Am(),h="GREETING"===(null==f?void 0:f.type),[g,v]=a.useState(n),[x,b]=a.useState(!1),{downloading:E,onDownload:_,onImageDownload:w}=gu(),[T,N]=a.useState(null),[y,C]=a.useState(0),S=a.useRef(null),j=hi();s.useTranslations("common"),Ql();const I=e=>{const t=S.current;t&&t.slideTo(e),v(e)},O=()=>{b(!0)},A=()=>{b(!1)};return c.useEffectOnce((()=>{if("bot"===o){const e={bot_id:m,message_id:null==f?void 0:f.id,file_url:t[g].url};null==j||j.track("Chat_Open_Photo",e)}})),e.jsxs("div",{className:"flex flex-col w-full h-[100svh] bg-black overflow-hidden ease-in-out",style:{transform:`translateY(${y>0?y:0}px)`},children:[e.jsxs("div",{className:"flex px-4 md:px-[6px] py-4 justify-between shrink-0",onTouchStart:e=>{e.stopPropagation(),e.touches.length>1||N(e.touches[0].clientY)},onTouchMove:e=>{if(e.stopPropagation(),null===T)return;const t=e.touches[0].clientY;C(t-T)},onTouchEnd:()=>{y>100&&r(),C(0)},children:[e.jsxs("div",{className:"flex justify-start",children:[e.jsx(Kl,{icon:Ys,variant:"ghost",color:"static","aria-label":"download file",loading:E,onClick:()=>{var e,s,a;if("REPLY"===(null==f?void 0:f.type)||h?w(t[g].url,t[g].title||`Myshell_${p}_${Ve.default().format("YYMMDD_HHmmss")}`):_(t[g].url,t[g].title||`Myshell_${p}_${Ve.default().format("YYMMDD_HHmmss")}`),null==j||j.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:null==f?void 0:f.id},"widget"===o?{widget_id:m,widget_name:p}:{bot_id:m,bot_name:p}),{image_model:null===(s=null===(e=t[g])||void 0===e?void 0:e.mediaFileMetadata)||void 0===s?void 0:s.generateModel})),"bot"===o){const e={bot_id:m,job_id:null===(a=null==f?void 0:f.asyncJobInfo)||void 0===a?void 0:a.jobId,message_id:null==f?void 0:f.id,file_url:t[g].url};null==j||j.track("Chat_Save_Image",e)}},size:"md",className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center data-[loading]:text-white",children:e.jsx(Ys,{className:"w-6 h-6 text-white"})}),u&&!h&&e.jsx(Kl,{variant:"ghost",color:"static","aria-label":"download file",loading:l,onClick:e=>{e.stopPropagation(),e.preventDefault(),null==i||i(g)},size:"md",className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center data-[loading]:text-white",children:e.jsx(_d,{className:"size-6 text-white"})})]}),e.jsx(Kl,{variant:"primary",size:"md","aria-label":"close modal",icon:on,onClick:r,className:"min-w-fit w-9 h-9 rounded-full flex justify-center items-center border-none text-static bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 shadow-none"})]}),e.jsx("div",{style:{height:t.length>1?"calc(100% - 120px)":"calc(100% - 56px)"},children:e.jsx(hd,{spaceBetween:100,slidesPerView:1,initialSlide:n,onSwiper:e=>{S.current=e},onSlideChange:e=>{(e=>{v(e)})(e.realIndex)},className:"grow w-full h-full",enabled:!x,loop:t.length>1,children:t.map(((t,s)=>e.jsx(gd,{children:e.jsx("div",{className:Ge.default("touch-none",t.type===il.VIDEO?"w-full h-full overflow-hidden justify-center items-center relative z-10":"absolute w-full h-full flex justify-center items-center z-10",s===g?"visible":" invisible w-0 h-0"),children:t.type===il.VIDEO?e.jsx(lg,{src:t.url,triggerPlay:s===g}):e.jsx(ng,{imgObj:t,onPinchStart:O,onPinchEnd:A})})},t.url)))})}),t.length>1&&e.jsx("div",{className:"flex justify-center items-center px-[6px] py-3 space-x-2 shrink-0",children:t.length<=4?t.map(((t,s)=>e.jsx(a.Fragment,{children:t.type===il.VIDEO?e.jsx("div",{className:Ge.default("rounded-md overflow-hidden h-10 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",g===s?"w-10":"w-7"),onClick:()=>I(s),children:e.jsx($m,{url:t.url,showPlayBtn:!1,showRadius:!1,showLoading:!1},t.url)}):e.jsx("img",{alt:"thumbnail image",src:t.url,className:Ge.default("rounded-md h-10 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",g===s?"w-10":"w-7"),onClick:()=>I(s)})},t.url))):e.jsx("div",{className:"flex space-x-2",children:t.map(((t,s)=>e.jsx("div",{className:Ge.default("rounded-full w-2 h-2",g===s?"bg-white":"bg-[#FFFFFF33]"),onClick:()=>I(s)},t.url)))})})]})}});function ig({imgObj:t,handleZoomIn:s,handleZoomOut:n,resetScaleValue:l,onClose:r}){var i,o;const c=a.useRef(null),[d,u]=a.useState(!1),[m,p]=a.useState({x:0,y:0}),[f,g]=a.useState({x:0,y:0}),[v,x]=a.useState(!1),{width:b,height:E}=h.useWindowSize(),_=a.useRef(null),[w,T]=a.useState(!1),N=()=>{x(!0)};a.useEffect((()=>{const e=c.current,t=e=>{if(!d)return;const t=e.clientX-f.x,s=e.clientY-f.y;p({x:t,y:s}),T(!0)},s=()=>{u(!1)};return e&&e.addEventListener("load",N,{once:!0}),document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)}}),[d,f]);const y=a.useMemo((()=>{var e,s,a,n;return function(e,t){let s=t.width,a=t.height;if(0===t.width||0===t.height)return e;if(t.width<=e.width&&t.height<=e.height)return t;const n=e.width/t.width,l=e.height/t.height,r=Math.min(n,l);return s=t.width*r,a=t.height*r,{width:s,height:a}}({width:b,height:E-80},{width:null!==(s=null===(e=t.mediaFileMetadata)||void 0===e?void 0:e.width)&&void 0!==s?s:0,height:null!==(n=null===(a=t.mediaFileMetadata)||void 0===a?void 0:a.height)&&void 0!==n?n:0})}),[E,null===(i=t.mediaFileMetadata)||void 0===i?void 0:i.height,null===(o=t.mediaFileMetadata)||void 0===o?void 0:o.width,b]);return e.jsxs("div",{className:Ge.default("w-full h-full relative flex justify-center items-center"),children:[!v&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10",children:e.jsx("div",{className:"flex justify-center items-center bg-[#00000033] backdrop-blur-2xl",style:Object.assign({},y),children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})})}),e.jsx("div",{className:"image-item absolute w-full h-full top-0 left-0 z-[1]",onClick:r}),e.jsx("img",{ref:c,alt:"image",src:t.url,width:y.width||9999,height:y.height||9999,draggable:!0,className:Ge.default("object-scale-down z-20",d?"cursor-grabbing":"cursor-grab"),style:{transform:`translate(${m.x}px, ${m.y}px)`,maxHeight:y.height||"80vh"},onMouseDown:e=>{2!==e.button&&(e.stopPropagation(),u(!0),T(!1),g({x:e.clientX-m.x,y:e.clientY-m.y}))},onDragStart:e=>e.preventDefault(),onWheel:e=>{0!==e.deltaY&&(e.deltaY<0?s():n())},onClick:()=>{w?T(!1):(_.current&&clearTimeout(_.current),_.current=setTimeout((()=>{r()}),200))},onDoubleClick:()=>{_.current&&(clearTimeout(_.current),l())}})]})}const og=a.memo((function({videoObj:t,onClose:s,triggerPlay:n}){var l,r,i,o;const c=a.useRef(null),[d,m]=a.useState(0),[p,f]=a.useState(!1),[g,v]=a.useState(0),[x,b]=a.useState(!1),[E,_]=a.useState(!1),[w,T]=a.useState(.5),{isMobile:N}=No(),[y,C]=a.useState(.5),[S,j]=a.useState(!1),{width:I,height:O}=h.useWindowSize(),A=a.useRef(null),M=h.useHover(A);a.useEffect((()=>{f(!1),v(0),m(0)}),[null==t?void 0:t.url]),h.useEffectOnce((()=>{const e=c.current;e&&(e.volume=.5)}));const P=()=>{const e=c.current;e&&(v(e.currentTime),e.paused||requestAnimationFrame(P))},L=e=>{_(e);const t=c.current;e&&t&&(C(w),T(0),t.volume=0),e||(0!==y?t&&(T(y),t.volume=y):t&&(T(.1),t.volume=.1))},k=()=>{f(!0)},R=()=>{(()=>{const e=c.current;m(e.duration)})(),j(!0)};a.useEffect((()=>{const e=c.current;return null==e||e.addEventListener("play",k),null==e||e.addEventListener("canplay",R),null==e||e.addEventListener("canplaythrough",R),(null==e?void 0:e.readyState)&&(null==e?void 0:e.readyState)>=2&&R(),()=>{null==e||e.removeEventListener("play",k),null==e||e.removeEventListener("canplay",R),null==e||e.removeEventListener("canplaythrough",R)}}),[]),a.useEffect((()=>{const e=c.current;e&&(n?e.readyState>=4?e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)})):e.addEventListener("canplaythrough",(()=>{e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)}))}),{once:!0}):(e.pause(),e.currentTime=0,v(0)))}),[n]);const D=a.useMemo((()=>{var e,s,a,n;return function(e,t){let s=t.width,a=t.height;if(0===t.width||0===t.height)return e;if(t.width<=e.width&&t.height<=e.height)return t;const n=e.width/t.width,l=e.height/t.height,r=Math.min(n,l);return s=t.width*r,a=t.height*r,{width:s,height:a}}({width:I,height:O-80},{width:null!==(s=null===(e=t.mediaFileMetadata)||void 0===e?void 0:e.width)&&void 0!==s?s:0,height:null!==(n=null===(a=t.mediaFileMetadata)||void 0===a?void 0:a.height)&&void 0!==n?n:0})}),[O,null===(l=t.mediaFileMetadata)||void 0===l?void 0:l.height,null===(r=t.mediaFileMetadata)||void 0===r?void 0:r.width,I]);return e.jsxs("div",{className:"w-full h-full relative flex justify-center items-center",ref:A,children:[!S&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-10",children:e.jsx("div",{className:"flex justify-center items-center bg-[#00000033] backdrop-blur-2xl",style:Object.assign({},D),children:e.jsx("div",{className:"w-10 h-10 p-[6px] flex justify-center items-center",children:e.jsx(di,{size:"md",speed:"slow",className:"text-white"})})})}),e.jsx("div",{className:"absolute w-full h-full top-0 left-0 z-[1]",onClick:s}),e.jsx("video",{src:t.url,className:"object-scale-down",width:null!==(i=D.width)&&void 0!==i?i:9999,height:null!==(o=D.height)&&void 0!==o?o:9999,ref:c,onEnded:function(){c.current&&(c.current.currentTime=0,c.current.pause(),f(!1)),v(0)},onTimeUpdate:P,onError:()=>{b(!0)},muted:E,style:Object.assign({},D)}),M&&S&&e.jsx("div",{className:"absolute bottom-9 w-full flex justify-center z-10",children:e.jsxs("div",{className:"w-[480px] h-[56px] flex space-x-2 justify-center items-center border border-default rounded-xl p-4 bg-surface-container-default text-default shadow-[0_0_2px_0_#0000001A]",children:[e.jsx(u.Button,{variant:"unstyled",onClick:()=>{const e=c.current;e&&(e.paused?e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)})):(e.pause(),f(!1)))},borderRadius:"full","aria-label":"audio control button",isDisabled:!t.url||!S,_disabled:{opacity:.3,cursor:"not-allowed"},size:"sm",className:"!flex !items-center !justify-center text-default w-9 h-9",children:p?e.jsx(Ci,{className:"w-6 h-6"}):e.jsx(ji,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(g)}),e.jsxs(u.Slider,{min:0,max:d,value:g,onChangeStart:()=>{const e=c.current;e&&(e.paused||(e.pause(),f(!1)))},onChange:e=>(e=>{const t=c.current;t&&(t.currentTime=e,v(t.currentTime))})(e),onChangeEnd:()=>{const e=c.current;e&&e.paused&&e.play().catch((e=>{console.error(e,null==e?void 0:e.stack)}))},focusThumbOnChange:!1,isDisabled:!S,className:"flex items-center w-full h-6 cursor-pointer",children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-white"})]}),e.jsx("span",{className:"text-subtle text-xs shrink-0",children:cs(d)}),e.jsxs(u.Popover,{placement:"top",trigger:N?"click":"hover",offset:[0,8],closeOnBlur:!0,openDelay:100,children:[e.jsx(u.PopoverTrigger,{children:e.jsx("div",{children:E?e.jsx(tg,{className:"w-5 h-5 text-default cursor-pointer",onClick:()=>L(!1)}):e.jsx(Zh,{className:"w-5 h-5 text-default cursor-pointer",onClick:()=>L(!0)})})}),e.jsx(u.PopoverContent,{className:"rounded-lg p-3 border border-default w-8 h-[121px] bg-surface-container-default text-default shadow-lg",children:e.jsx(u.PopoverBody,{className:"p-0 flex justify-center items-center",children:e.jsxs(u.Slider,{orientation:"vertical",min:0,max:1,step:.01,value:w,onChange:e=>{const t=c.current;t&&(T(e),t.volume=e,0===e?(_(!0),C(0)):E&&_(!1))},focusThumbOnChange:!1,className:"h-[97px]",children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E] w-[2px]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-surface-container-default"})]})})})]})]})})]})}));var cg=Object.freeze({__proto__:null,default:function({imgVideoList:t,activeIndex:n,publishing:l,onClose:r,publishGalleryHandle:i}){const{message:o}=Am(),{imgGenerator:d,entityInfo:m,type:p}=a.useContext(jt),{id:h,name:g}=m,v="GREETING"===(null==o?void 0:o.type),[x,b]=a.useState(n),[E,_]=a.useState(1),w=s.useTranslations("chat"),T=hi(),{downloading:N,onDownload:y,onImageDownload:C}=gu(),S=Ur((e=>e.flagUserFirstPublishGallery)),j=a.useMemo((()=>t[x]),[t,x]);a.useEffect((()=>{const e=e=>{switch(e.key){case"ArrowLeft":M();break;case"ArrowRight":P();break;case"ArrowUp":O();break;case"ArrowDown":A()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]);const I=()=>{_(1)};a.useEffect((()=>{_(1)}),[x]);const O=a.useCallback((()=>{E>=3||_(E+.1)}),[E]),A=a.useCallback((()=>{E<=.5||_(E-.1)}),[E]),M=a.useCallback((()=>{b(x<1?t.length-1:x-1)}),[t.length,x]),P=a.useCallback((()=>{b(x===t.length-1?0:x+1)}),[t.length,x]);return c.useEffectOnce((()=>{if("bot"===p){const e={bot_id:h,message_id:null==o?void 0:o.id,file_url:t[x].url};null==T||T.track("Chat_Open_Photo",e)}})),e.jsxs("div",{className:"w-full h-screen overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"relative flex justify-center w-full",style:{height:"calc(100vh - 80px)"},children:[e.jsx(Kl,{icon:on,size:"md",className:"flex justify-center items-center w-9 h-9 absolute top-6 right-6 z-50 cursor-pointer rounded-full border border-none text-static bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 shadow-none",onClick:r}),e.jsx("div",{className:"img-video-index absolute w-full h-full top-0 left-0 z-[1]"}),t.length>1&&e.jsx("div",{onClick:M,className:"flex justify-center items-center w-9 h-9 rounded-full absolute left-6 md:left-6 top-1/2 -translate-y-1/2 bg-surface-container-default cursor-pointer z-20 shadow-button-basic border border-default",children:e.jsx(ua,{className:"text-subtle w-6 h-6"})}),e.jsx(f.AnimatePresence,{mode:"popLayout",children:t.map(((t,s)=>e.jsx(f.motion.div,{initial:{opacity:0},animate:{opacity:s===x?1:0},exit:{opacity:0},transition:{duration:.2},className:Ge.default(t.type===il.VIDEO?"max-w-3/4 h-full overflow-hidden justify-center items-center relative z-10":"absolute w-full h-full flex justify-center items-center z-10",s===x?"visible":" invisible w-0 h-0"),style:{scale:E},children:t.type===il.VIDEO?e.jsx(og,{videoObj:t,triggerPlay:s===x,onClose:r}):e.jsx(ig,{imgObj:t,handleZoomIn:O,handleZoomOut:A,resetScaleValue:I,onClose:r})},t.url)))}),t.length>1&&e.jsx("div",{onClick:P,className:"flex justify-center items-center w-9 h-9 rounded-full absolute right-6 md:right-11 top-1/2 -translate-y-1/2 bg-surface-container-default cursor-pointer z-20 shadow-button-basic border border-default",children:e.jsx(pa,{className:"text-subtle w-6 h-6"})})]}),e.jsxs("div",{className:"h-20 w-full px-6 py-3 flex justify-between items-center shrink-0 relative z-20",children:[e.jsx("div",{className:"absolute w-full h-full top-0 left-0 z-30",onClick:r}),j.type===il.IMAGE?e.jsx("div",{className:"flex justify-end items-center space-x-2",children:e.jsxs("div",{className:"rounded-xl bg-beta-black-20 px-3 flex space-x-[6px] items-center h-[38px] relative z-50",style:{backdropFilter:"blur(12px)"},children:[e.jsx(Fa,{className:"w-5 h-5 text-beta-white-70 cursor-pointer",onClick:A}),e.jsxs(u.Slider,{width:"72px",value:E,min:.5,max:3,step:.1,onChange:e=>{_(e)},focusThumbOnChange:!1,children:[e.jsx(u.SliderTrack,{className:"bg-[#EDF0F5] dark:bg-[#22242E]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-primary-default border-[2px] border-surface-container-default",zIndex:0})]}),e.jsx(Za,{className:"w-5 h-5 text-beta-white-70 cursor-pointer",onClick:O})]})}):e.jsx("div",{className:"w-[150px]",onClick:r}),t.length>1&&e.jsx("div",{className:"flex space-x-2 relative z-50",children:t.map(((t,s)=>e.jsx(a.Fragment,{children:t.type===il.VIDEO?e.jsx("div",{className:Ge.default("rounded-md overflow-hidden h-14 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",x===s?"w-14":"w-7"),onClick:()=>b(s),children:e.jsx($m,{url:t.url,showPlayBtn:!1,showRadius:!1,showLoading:!1},t.url)}):e.jsx("img",{alt:"thumbnail image",src:t.url,className:Ge.default("rounded-md h-14 object-cover cursor-pointer ease-linear duration-200 transition-[width] select-none",x===s?"w-14":"w-7"),onClick:()=>b(s)})},t.url)))}),e.jsxs("div",{className:"flex justify-end relative z-50",children:[d&&!v&&e.jsx(Hl,{open:!S||void 0,description:w(S?"publish_to_gallery":"publish_battery"),variant:S?"default":"message",children:e.jsx(Kl,{loading:l,onClick:e=>{e.stopPropagation(),e.preventDefault(),null==i||i(x)},variant:"primary",color:"brand",size:"md",className:"relative z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none text-inherit",children:e.jsx(_d,{className:"size-5.5 text-icon-static"})})}),e.jsx("div",{className:"absolute w-full h-full top-0 left-0",onClick:r}),e.jsx(Kl,{variant:"primary",color:"brand",size:"md","aria-label":"download file",loading:N,onClick:()=>{var e,s;const a=t[x].url;if("REPLY"===(null==o?void 0:o.type)||v?C(a,t[x].title||`Myshell_${g}_${Ve.default().format("YYMMDD_HHmmss")}`):y(a,t[x].title||`Myshell_${g}_${Ve.default().format("YYMMDD_HHmmss")}`),T&&T.track){const s=null===(e=t[x].mediaFileMetadata)||void 0===e?void 0:e.generateModel;s?null==T||T.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:null==o?void 0:o.id},"widget"===p?{widget_id:h,widget_name:g}:{bot_id:h,bot_name:g}),{image_model:s})):zn({media_file_url:a}).then((e=>{var t;null==T||T.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:null==o?void 0:o.id},"widget"===p?{widget_id:h,widget_name:g}:{bot_id:h,bot_name:g}),{image_model:null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.generateModel}))})).catch((()=>{null==T||T.track("MessageAction",Object.assign(Object.assign({action_type:"Save Image",message_id:null==o?void 0:o.id},"widget"===p?{widget_id:h,widget_name:g}:{bot_id:h,bot_name:g}),{image_model:""}))}))}if("bot"===p){const e={bot_id:h,job_id:null===(s=null==o?void 0:o.asyncJobInfo)||void 0===s?void 0:s.jobId,message_id:null==o?void 0:o.id,file_url:t[x].url};null==T||T.track("Chat_Save_Image",e)}},className:"relative z-30 bg-beta-black-20 hover:bg-beta-black-40 active:bg-beta-black-40 ml-2 shadow-none",icon:Ys})]})]})]})}});const dg=a.forwardRef(((t,s)=>{const{name:a,setFormValue:n}=t;return e.jsx(u.Checkbox,Object.assign({},t,{ref:s,colorScheme:"brand",className:"square-checkbox ml-2 text-default",size:"lg",isChecked:t.default,onChange:e=>{const t=e.target.checked;n(a,t)},children:t.name}))})),ug=a.forwardRef(((t,n)=>{const{minLength:l,maxLength:r,value:i,name:o,setFormValue:c,errors:d,setError:m,type:p}=t,f="required"===(null==d?void 0:d.type),h=s.useTranslations("chat"),[g,v]=a.useState(""),x={};return null!=l&&(x.min=l),null!=r&&(x.max=r),a.useEffect((()=>{var e;null===(e=document.getElementById(`component_bot_numberinput_${o}`))||void 0===e||e.blur()}),[]),e.jsxs("div",{className:"w-full",children:[e.jsxs(u.NumberInput,Object.assign({},x,{precision:"interInput"===p?0:2,step:"interInput"===p?1:.01,defaultValue:i,onFocus:!1,onChange:e=>{const t=Number(e);isNaN(t)||"number"!=typeof t||c(o,t)},onBlur:e=>{const t=e;null!=l&&t<l?(c(o,l),v(h("replicate.input_min_tip",{num:l}))):null!=r&&t>r?(c(o,r),v(h("replicate.input_max_tip",{num:r}))):Number.isNaN(t)||v("")},ref:n,className:"w-full",children:[e.jsx(u.NumberInputField,{tabIndex:-1,id:`component_bot_numberinput_${o}`,className:"h-[44px] rounded-[12px] border-default hover:border-hovered focus:outline focus:outline-none focus-visible:border-pressed focus-visible:outline-offset-0 focus-visible:outline-utility-sky-blue-500 focus-visible:shadow-none"}),e.jsxs(u.NumberInputStepper,{className:"space-y-[2px] py-1 mr-2",children:[e.jsx(u.NumberIncrementStepper,{className:"text-default rounded-[6px] w-5 h-3 bg-[#EDEEEF] dark:bg-[#6D7175] border-none"}),e.jsx(u.NumberDecrementStepper,{className:"text-default rounded-[6px] w-5 h-3 bg-[#EDEEEF] dark:bg-[#6D7175] border-none"})]})]})),""!=g&&e.jsx("p",{className:"text-[#D72C0D] text-[14px] mt-1.5",children:g}),f&&e.jsx("p",{className:"text-[#D72C0D] text-[14px] mt-1.5",children:h("replicate.input_required_tip",{fieldName:o})})]})}));var mg=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function pg(t){var{children:s}=t,a=mg(t,["children"]);const{className:n}=a,l=mg(a,["className"]),{selectProps:r}=a,i=r.errors;return e.jsx($.components.Control,Object.assign({},l,{className:Ge.default("bg-surface-default rounded-xl shadow-none px-3 py-1",n,i?"border-[#D72C0D]":"border-default border-hovered"),children:s}))}function fg(t){var{children:s}=t,a=mg(t,["children"]);return e.jsx($.components.Menu,Object.assign({},a,{className:"p-2 bg-surface-default overflow-hidden rounded-xl shadow-md z-[99] pb-4 dark:border dark:border-default",children:s}))}function hg(t){var{children:s}=t,a=mg(t,["children"]);return e.jsx($.components.MenuList,Object.assign({},a,{children:s}))}function gg(t){var{children:s}=t,a=mg(t,["children"]);return e.jsx($.components.Option,Object.assign({},a,{children:s}))}function vg(t){var{children:s}=t,a=mg(t,["children"]);return e.jsx($.components.ValueContainer,Object.assign({},a,{children:s}))}function xg(e){return mg(e,[]),null}function bg(t){var{children:s}=t,a=mg(t,["children"]);return e.jsx($.components.DropdownIndicator,Object.assign({},a,{className:"text-default",children:s}))}function Eg({item:t,className:s}){return e.jsxs("div",{className:Ge.default("flex flex-row justify-start cursor-pointer",s),children:[(null==t?void 0:t.iconUrl)?e.jsx("div",{className:"aspect-[24/24] w-6 h-6 relative bg-cover bg-no-repeat rounded-full overflow-hidden mr-2",style:Object.assign({},(null==t?void 0:t.iconUrl)&&{backgroundImage:`url('${null==t?void 0:t.iconUrl}')`})}):null,e.jsx("span",{className:"text-[14px]",children:null==t?void 0:t.label})]})}const _g=a.forwardRef(((t,s)=>{const{components:a={},options:n=[],name:l,setFormValue:r,value:i,type:o}=t,c=mg(t,["components","options","name","setFormValue","value","type"]);return e.jsx(dt.default,Object.assign({},c,{ref:s,options:n,menuPlacement:"auto",isSearchable:!1,defaultValue:i,placeholder:i,onChange:e=>{r(l,"numberCheckbox"===o?Number(e.value):e.value)},components:{Control:a.Control?a.Control:pg,Menu:fg,MenuList:hg,ValueContainer:vg,IndicatorSeparator:xg,DropdownIndicator:bg,Option:t=>{var s=mg(t,["children"]);const{data:a}=s;return e.jsx(gg,Object.assign({},s,{children:e.jsx(Eg,{item:a,className:pn("option",(null==a?void 0:a.value)===i?"text-static":"")})}))},Placeholder:t=>{var s=mg(t,["children"]);const{options:a}=s,n=a.find((e=>`${e.value}`.toLowerCase()==`${i}`.toLowerCase()));return e.jsx(Eg,{item:n,className:"placeholder"})},SingleValue:t=>{var s=mg(t,["children"]);const{data:a}=s;return e.jsx(Eg,{item:a,className:"single"})}},classNames:{placeholder:()=>"text-default",valueContainer:()=>"p-0 flex",option:e=>pn("relative cursor-pointer py-1.5 px-2 rounded-md mt-1",(null==e?void 0:e.value)===i?"":"hover:bg-surface-pressed")},menuPosition:"fixed",styles:{control:e=>Object.assign(Object.assign({},e),{background:"bg-surface-default"}),menu:e=>Object.assign(Object.assign({},e),{zIndex:"999",marginBottom:"40px"}),option:(e,{data:t,isDisabled:s,isFocused:a,isSelected:n})=>{const l=t,r=n||(null==l?void 0:l.value)===i;return Object.assign(Object.assign({},e),{backgroundColor:r?"var(--surface-primary-default)":"var(--surface-default)",color:r&&!a?"white":"var(--text)"})}}}))}));var wg=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const Tg=a.forwardRef(((t,n)=>{const{className:l,value:r,setFormValue:i,name:o,errors:c,clearErrors:d}=t,m=wg(t,["className","value","setFormValue","name","errors","clearErrors"]),p="required"===(null==c?void 0:c.type),f=s.useTranslations("chat");return a.useEffect((()=>{var e;null===(e=document.getElementById(`component_bot_textarea_${o}`))||void 0===e||e.blur()}),[]),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full relative",children:[e.jsx(u.Textarea,Object.assign({},m,{id:`component_bot_textarea_${o}`,onFocus:!1,defaultValue:r,tabIndex:-1,onChange:e=>{""!=e.target.value&&d(o),i(o,e.target.value)},ref:n,className:Ge.default("w-full",p?"border-[#D72C0D]":"border-default hover:border-hovered")})),m.maxLength?e.jsxs("span",{className:"absolute right-3 bottom-3 text-subtlest text-xs",children:[(null!=r?r:"").length,"/",m.maxLength]}):null]}),p&&e.jsx("p",{className:"text-[#D72C0D] text-[14px] mt-1.5",children:f("replicate.input_required_tip",{fieldName:o})})]})})),Ng=t=>{const s=a.useRef(null),[n,l]=a.useState(0),[r,i]=a.useState(!1),[o,c]=a.useState(0),[d,u]=a.useState(!1),m=t.preview,{status:p,file:f}=t.data,h="completed"===p;const g=So(),v=()=>{const e=s.current;e&&(c(e.currentTime),e.paused||requestAnimationFrame(v))},x=n,b=cs(x?x<1?1:x:0);return e.jsxs("div",{className:Ge.default("audio-player flex flex-col justify-start items-start w-full"),children:[e.jsxs("div",{className:"w-full flex flex-col items-start justify-start space-y-3 text-xs",children:[h&&e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:Ge.default("w-9 h-9 rounded-full flex justify-center items-center mr-3",r?"bg-surface-primary-default":"bg-surface-container-selected-hovered"),onClick:()=>{var e;s.current&&(s.current.paused?s.current.play().then((()=>{i(!0)})).catch((e=>{console.error(e,null==e?void 0:e.stack)})):(null===(e=s.current)||void 0===e||e.pause(),i(!1)))},children:r?e.jsx(jo,{}):e.jsx(ji,{className:"ml-[2px] fill-surface-primary-default w-[16px] h-[16px]"})}),e.jsxs("div",{className:"flex flex-col justify-center items-start space-y-1",children:[e.jsx("p",{className:"mr-5 text-[14px] font-semibold text-default",children:null==f?void 0:f.name}),(null==f?void 0:f.size)>0&&e.jsxs("p",{className:"text-[12px] text-subtle",children:[e.jsx("span",{className:"mr-1",children:b}),"(",Math.ceil(f.size/1e3),"KB)"]})]})]}),e.jsxs("div",{className:"w-full flex justify-center items-center space-x-2",children:[e.jsxs("div",{className:"relative flex flex-col justify-center items-start h-[8px] w-full",children:[e.jsx("div",{className:"relative w-full h-[2px] bg-[#DADFE5] dark:bg-[#383C52]"}),e.jsxs("div",{className:"absolute w-full flex flex-row justify-start items-center",children:[e.jsx("div",{className:"bg-[var(--text)] h-[2px] w-full items-start",style:{width:100*ms(o,x)+"%"}}),e.jsx("div",{className:"w-[7px] h-[7px] rounded-full bg-[var(--text)]"})]})]}),e.jsx("div",{className:"text-default text-sm dark:text-brand text-right",children:r?cs(o):b})]})]}),e.jsx(g,{ref:s,src:m,onLoadedData:()=>{URL.revokeObjectURL(m);const e=null==s?void 0:s.current;l(e.duration)},onEnded:function(){s.current&&(s.current.currentTime=0),i(!1)},onTimeUpdate:v,onError:()=>{u(!0)},autoPlay:!1})]})},yg=({data:t,onDelete:s})=>{var n,l,r;const{status:i,uiData:o}=t,c="completed"===i,d="application"===o.mimeType||"text"===o.mimeType||"other"===o.mimeType,u="image"===o.mimeType,m="audio"===o.mimeType,p="video"===o.mimeType,{iconUrl:f}=o,[h,g]=a.useState(!1),v=a.useMemo((()=>(null==t?void 0:t.defaultUrl)?null==t?void 0:t.defaultUrl:t.file&&["image","audio","video"].includes(null==o?void 0:o.mimeType)?URL.createObjectURL(t.file):""),[]),{isMobile:x}=so(),b=null===(n=null==t?void 0:t.file)||void 0===n?void 0:n.name;let E=b;const _=b.split("."),w=x?20:60;if(b.length>w&&_.length>1){const e=_[_.length-1];E=`${b.slice(0,w)}...${e}`}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative cursor-default w-full flex justify-start items-center",onClick:e=>{e.preventDefault();const t=document.getElementById("mobileInput");t&&t.focus()},children:[d&&e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"flex-shrink-0 w-[60px] h-[60px] rounded-[8px] mr-3",children:e.jsx("img",{src:f,className:"w-[60px] h-[60px]"})}),e.jsxs("div",{className:"w-full flex flex-col justify-center items-start space-y-1",children:[e.jsx("span",{className:"text-[14px] text-default line-clamp-1 break-all font-medium",children:t.file.name}),e.jsxs("span",{className:"text-[12px] text-subtle line-clamp-1 break-all",children:["(",Math.ceil((null==t?void 0:t.file.size)/1e3),"KB)"]})]})]}),u&&e.jsxs("div",{className:"w-full flex justify-start items-center cursor-pointer",onClick:()=>{g(!0)},children:[e.jsx("img",{src:v,className:"flex-shrink-0 w-[60px] h-[60px] object-cover rounded-[8px] overflow-hidden mr-2",onLoad:()=>{URL.revokeObjectURL(v)},alt:"preview image"}),e.jsxs("div",{className:"flex flex-col justify-center items-start space-y-1",children:[e.jsx("p",{className:"mr-4 text-[14px] font-medium text-default",children:E}),(null===(l=null==t?void 0:t.file)||void 0===l?void 0:l.size)>0&&e.jsxs("p",{className:"text-[12px] text-subtle",children:["(",Math.ceil((null==t?void 0:t.file.size)/1e3),"KB)"]})]})]}),p&&e.jsxs("div",{className:Ge.default("relative w-full flex overflow-hidden cursor-pointer"),onClick:()=>{g(!0)},children:[e.jsx("video",{src:(null==t?void 0:t.url)||v,className:"flex-shrink-0 w-[60px] h-[60px] rounded-[8px] mr-2 object-fill overflow-hidden",onLoad:()=>{URL.revokeObjectURL(v)}}),e.jsxs("div",{className:"flex flex-col justify-center items-start space-y-1",children:[e.jsx("p",{className:"mr-4 text-[14px] font-medium text-default",children:E}),(null===(r=null==t?void 0:t.file)||void 0===r?void 0:r.size)>0&&e.jsxs("p",{className:"text-[12px] text-subtle",children:["(",Math.ceil((null==t?void 0:t.file.size)/1e3),"KB)"]})]})]}),m&&e.jsx(Ng,{data:t,preview:v}),e.jsx("button",{className:Ge.default("w-5 h-5 justify-center items-center",m?"absolute z-[1] right-0 top-[10px]":""),onClick:e=>(e=>{e.stopPropagation(),e.preventDefault();const t=document.getElementById("mobileInput");t&&t.focus(),s()})(e),children:e.jsx(Mi,{className:"w-5 h-5 text-subtle"})})]}),h&&e.jsx(jm,{open:h,onClose:()=>{g(!1)},imgVideoList:[{type:p?il.VIDEO:u?il.IMAGE:il.DOC,status:ol.DONE,iconUrl:"",url:v,title:"",extensionName:""}],activeIndex:0})]})},Cg={audio:{".mp3":"audio/mpeg",".wav":"audio/wav",".ogg":"audio/ogg",".wma":"audio/x-ms-wma",".flac":"audio/flac",".ape":"audio/ape"},video:{".mp4":"video/mp4",".avi":"video/x-msvideo",".mov":"video/quicktime",".wmv":"video/x-ms-wmv",".flv":"video/x-flv"},other:{".rtf":"application/rtf",".md":"text/markdown",".markdown":"text/markdown",".pdf":"application/pdf",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".doc":"application/msword",".txt":"text/plain",".csv":"text/csv"},image:{".png":"image/png",".jpeg":"image/jpeg",".jpg":"image/jpg"},all:{"*":"*/*"}},Sg=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cg.audio),Cg.video),Cg.other),Cg.image),Cg.all),jg={md:{icon:"other",type:"Markdown File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"},markdown:{icon:"other",type:"Markdown File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"},pdf:{icon:"PDF",type:"PDF",bg:"#EA3434",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/PDF.svg"},docx:{icon:"W",type:"Word File",bg:"#2684FF",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Word.svg"},doc:{icon:"W",type:"Word File",bg:"#2684FF",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Word.svg"},txt:{icon:"T",type:"TXT",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/TXT.svg"},csv:{icon:"CSV",type:"CSV",bg:"#079455",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2024053011/embed_icon/CSV.svg"},other:{icon:"other",type:"Rich Text File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"},all:{icon:"all",type:"All File",bg:"#6F8BB5",iconUrl:"https://www.myshellstatic.com/image/bot/icon/2023112610/embed_icon/Other.svg"}},Ig=Object.values(Cg).flatMap((e=>Object.keys(e))),Og={audio:"MESSAGE_METADATA_TYPE_AUDIO_FILE",image:"MESSAGE_METADATA_TYPE_IMAGE_FILE",other:"MESSAGE_METADATA_TYPE_TEXT_FILE",video:"MESSAGE_METADATA_TYPE_VIDEO_FILE",all:"MESSAGE_METADATA_TYPE_ALL_FILE"},Ag=Object.fromEntries(Object.entries(Og).map((([e,t])=>[t,e]))),Mg=e=>{const t=e.name.split(".");if(t.length>1){const s=t[t.length-1],a=`.${s.toLowerCase()}`,n=e.type,l=(n||Sg[a]).split("/")[0],r=jg[s.toLowerCase()],i=["text","application","other"].includes(l)?r||jg.other:{},o=s.toUpperCase();return Object.assign({mimeType:l,orginnalMIMEType:n,contentType:rl[o],name:e.name,ex:s,serverType:"text"===l?Og.other:Og[l]},i)}},Pg=async e=>{const t=(s=e.file,URL.createObjectURL(s));var s;let a=null;return"image"===e.uiData.mimeType&&(a=await(async e=>new Promise(((t,s)=>{const a=new Image;a.onload=()=>{t({width:a.width,height:a.height}),URL.revokeObjectURL(e)},a.onerror=()=>{s(new Error("Failed to load image.")),URL.revokeObjectURL(e)},a.src=e})))(t)),"video"===e.uiData.mimeType&&(a=await(async e=>new Promise(((t,s)=>{const a=document.createElement("video");a.onloadedmetadata=()=>{t({width:a.videoWidth,height:a.videoHeight}),URL.revokeObjectURL(e)},a.onerror=()=>{s(new Error("Failed to load video.")),URL.revokeObjectURL(e)},a.src=e})))(t)),a},Lg=({onFileChange:e,from:t,botId:n,isChoosingFile:l,types:r,setFile:i,fileMaxSize:o,onFileDialogOpen:c})=>{const d=Hn((e=>e.showDragModal)),u=Hn((e=>(e.fileUpload.filesMap[n]||[]).length)),{warning:m}=Ql(),p=s.useTranslations("chat"),f=a.useMemo((()=>(e=>{const t={};for(const s of e){const e=Ag[s];if(e){const s=Cg[e],a=Object.keys(s);for(const e of a)t[s[e]]?t[s[e]]=[...t[s[e]],e]:t[s[e]]=[e]}}return t})(Array.isArray(r)?r:["MESSAGE_METADATA_TYPE_IMAGE_FILE"])),[]),h=o||52428800,{getRootProps:g,getInputProps:v}=E.useDropzone({accept:f,maxFiles:1,noKeyboard:!0,disabled:0===Object.keys(f).length,maxSize:h,onDragOver:e=>{d(!0)},onDragLeave:e=>{d(!1)},validator:e=>{const t=e.name?e.name.split("."):[];if(e.size>h)return i({status:"error",type:"filesize"}),{code:"401",message:`Size is larger than ${h}!`};if(t.length>1){const e=t[t.length-1];return Ig.includes(`.${e.toLowerCase()}`)||f["*/*"]?null:{code:"402",message:`${e} is not support yet!`}}return{code:"402",message:`${e.type} is not support yet!`}},onDrop:t=>{l&&(l.current=!1),d(!1);u+t.length<=1?e(t):m({content:p("replicate.maxfiles")})},onDropRejected:e=>{const t=e.every((e=>"too-many-files"===e.errors[0].code)),s=e.every((e=>"file-invalid-type"===e.errors[0].code)),a=e.every((e=>"file-too-large"===e.errors[0].code));t?i({status:"error",type:"maxfiles"}):s?i({status:"error",type:"invalid"}):a&&i({status:"error",type:"filesize"})},onFileDialogOpen:c});return{getRootProps:g,getInputProps:v}};var kg=a.memo((function(t){var n,l,r,i;const o=hi(),c=a.useRef(),d=a.useRef(null),{chatType:u,id:m,name:p="",setFormValue:f,value:h,errors:g,clearErrors:v,supportedFileTypes:x,fileUploadSizeMaximum:b,formTraceId:E}=t;let _=null==t?void 0:t[`x_ms_name_${p}`];if(!_){const e=h.split("/");_=(null===(n=e[e.length-1])||void 0===n?void 0:n.split("."))[0]}let w=jg.other,T="";if(h){const e=h.split(".");if(e.length>1){const t=e[e.length-1],s=`.${t.toLowerCase()}`;T=null===(r=null===(l=Sg[s])||void 0===l?void 0:l.split("/"))||void 0===r?void 0:r[0],w=jg[t]}}const[N,y]=a.useState(h?{status:"completed",defaultUrl:h,file:{name:_,size:null!==(i=null==t?void 0:t[`x_ms_size_${p}`])&&void 0!==i?i:""},uiData:{iconUrl:null==w?void 0:w.iconUrl,mimeType:T}}:void 0),C=a.useRef(!1),{file:S}=a.useContext(At),j=a.useCallback((async e=>{if("bot"===u){let e;c.current?e=c.current:(e=os(),c.current=e);const t={trace_id:e,formTraceId:E,bot_id:m,time:(new Date).getTime()};null==o||o.track("Chat_Form_Upload_Start",t)}try{const t=await(async(e,t)=>{const s=t.map((t=>({file:t,status:"pending",id:os(),botId:e,uiData:Mg(t),cancelToken:{}}))),a=[];for(const e of s)try{const t=await Pg(e);a.push(Object.assign(Object.assign({},e),{meta:Object.assign(Object.assign({},t||{}),{thumbnail:""})}))}catch(t){console.error(t),a.push(e)}return a})(m,e);(async e=>{var t,s;for(const a of e){let n;if(y(Object.assign(Object.assign({},a),{status:"pending"})),n="function"==typeof(null==S?void 0:S.overrideUploadFileToS3WithProgress)?await S.overrideUploadFileToS3WithProgress(a.file):await ml({scenario:ll.SCENARIO_IM_CHAT,contentType:a.uiData.contentType,onProgress:e=>{y(Object.assign(Object.assign({},a),{status:"pending"}))},file:a.file,cancelToken:e=>{}}),n.success){if(y(Object.assign(Object.assign({},a),{status:(null==n?void 0:n.objectAccessUrl)?"completed":"error",url:null==n?void 0:n.objectAccessUrl,defaultUrl:null==n?void 0:n.objectAccessUrl})),f(p,null==n?void 0:n.objectAccessUrl),f(`x_ms_name_${p}`,null===(t=a.file)||void 0===t?void 0:t.name),f(`x_ms_size_${p}`,null===(s=a.file)||void 0===s?void 0:s.size),v(p),"bot"===u){const t={trace_id:c.current,formTraceId:E,bot_id:m,file_type:e[0].file.type,time:(new Date).getTime()};null==o||o.track("Chat_Form_Upload_Success",t)}}else if(y({status:"error",type:"network"}),"bot"===u){const t={trace_id:c.current,formTraceId:E,bot_id:m,file_type:e[0].file.type,time:(new Date).getTime(),reason:"network error"};null==o||o.track("Chat_Form_Upload_Error",t)}}})(t)}catch(t){if("bot"===u){const t={trace_id:c.current,formTraceId:E,bot_id:m,file_type:e[0].type,time:(new Date).getTime(),reason:"network error"};null==o||o.track("Chat_Form_Upload_Error",t)}y({status:"error",type:"network"})}}),[]),{getRootProps:I,getInputProps:O}=Lg({onFileChange:j,from:"input",botId:m,isChoosingFile:C,types:x,setFile:y,fileMaxSize:b,onFileDialogOpen:()=>{const e=os();if(c.current=e,"bot"===u){const t={trace_id:e,formTraceId:E,bot_id:m,time:(new Date).getTime()};null==o||o.track("Chat_Form_Upload_Click",t)}}}),A=s.useTranslations("chat"),M=N&&"error"===(null==N?void 0:N.status)?A("replicate.maxfiles"):"",P="required"===(null==g?void 0:g.type);return e.jsxs("div",{className:"relative w-full overflow-hidden",children:[e.jsx("div",{className:Ge.default("w-full flex flex-col items-center justify-center p-3 border-[1px] bg-surface-default min-h-[96px] rounded-[12px]",P||M?"border-critical":"border-default"),ref:d,style:{boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.10)"},children:N&&!M?"pending"===(null==N?void 0:N.status)?e.jsxs("div",{className:"flex flex-col justify-center items-center w-full",children:[e.jsx("div",{className:"w-10 h-10 px-2 rounded-[8px] bg-surface-container-hovered mb-2 flex flex-col items-center justify-center",children:e.jsx(di,{size:"sm",className:"text-brand"})}),e.jsx("p",{className:"text-default text-[16px] leading-[1] font-medium",children:A("replicate.uploading")})]}):e.jsx(yg,{data:N,onDelete:()=>{y(void 0),f(p,void 0),f(`x_ms_name_${p}`,void 0),f(`x_ms_size_${p}`,void 0)}}):e.jsxs("div",Object.assign({className:Ge.default("w-full flex flex-col justify-center items-center cursor-pointer")},I(),{children:[e.jsxs("div",{className:Ge.default("rounded-[8px] w-10 h-10 bg-surface-hovered mb-2"),children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-lg",children:e.jsx(ta,{className:"w-6 h-6 storke-[var(--text)]"})}),e.jsx("input",Object.assign({name:"file-upload",className:"sr-only hidden",multiple:!1},O()))]}),e.jsx("p",{className:"text-subtle text-[14px]",children:A("replicate.tip")})]}))}),M?e.jsxs("p",{className:"text-critical text-[14px] mt-1.5",children:["maxfiles"==N.type&&A("replicate.maxfiles"),"filesize"==N.type&&A("replicate.upload_filesize_tip",{maxSize:`${Math.ceil((b||52428800)/1048576)}M`}),"network"==N.type&&A("replicate.upload_network_tip"),"invalid"==N.type&&A("replicate.invalid_tip")]}):P&&e.jsx("p",{className:"text-critical text-[14px] mt-1.5",children:A("replicate.upload_required_tip",{fieldName:p})})]})}));const Rg=a.forwardRef(((t,n)=>{const{minLength:l,maxLength:r,value:i,name:o,type:c,setFormValue:d,errors:m}=t,p="required"===(null==m?void 0:m.type),[f,h]=a.useState(""),[g,v]=a.useState(""),x=s.useTranslations("chat");return a.useEffect((()=>{var e;null===(e=document.getElementById(`component_bot_sliderinput_${o}`))||void 0===e||e.blur()}),[]),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex w-full space-x-1.5",children:[e.jsx("div",{className:"w-full h-[36px] flex justify-center items-center rounded-[12px] border-[1px] border-default p-3",children:e.jsxs(u.Slider,{"aria-label":"slider-ex-1",max:r,min:l,value:i,step:"interSlider"===c?1:.01,onChange:e=>{v(`${e}`),d(o,Number(e)),h("")},ref:n,focusThumbOnChange:!1,children:[e.jsx(u.SliderTrack,{className:"bg-[#EDEEEF] h-[6px]",children:e.jsx(u.SliderFilledTrack,{className:"bg-surface-primary-default"})}),e.jsx(u.SliderThumb,{className:"bg-surface-container-default border-brand border-[2px] z-0"})]})}),e.jsx("div",{className:"flex-shrink-0 w-[60px] h-[36px] flex justify-center items-center rounded-[12px] border-[1px] border-default p-3",children:e.jsx(u.NumberInput,Object.assign({},{},{max:r,min:l,value:g||t.value,precision:"interSlider"===c?0:2,step:"interSlider"===c?1:.01,onChange:e=>{v(e);const t=Number(e);isNaN(t)||"number"!=typeof t||d(o,t)},onBlur:e=>{const t=e.currentTarget.value;null!=l&&t<l?(h(x("replicate.input_min_tip",{num:l})),d(o,l),v(l)):null!=r&&t>r?(h(x("replicate.input_max_tip",{num:r})),d(o,r),v(r)):Number.isNaN(t)||h("")},ref:n,children:e.jsx(u.NumberInputField,{tabIndex:-1,id:`component_bot_sliderinput_${o}`,className:"text-center h-[44px] rounded-[12px] border-none hover:border-none focus:outline focus:outline-none focus-visible:border-none focus-visible:outline-offset-0 focus-visible:outline-none focus-visible:shadow-none px-0"})}))})]}),""!=f&&e.jsx("p",{className:"text-[#D72C0D] text-[14px] mt-1.5",children:f}),p&&e.jsx("p",{className:"text-[#D72C0D] text-[14px] mt-1.5",children:x("replicate.input_required_tip",{fieldName:o})})]})}));const Dg=e=>{try{return e()}catch(e){return}};function Ug({disabled:t=!1,value:s,onValueChange:n,language:l,className:r,foldField:o="",jsonPath:c="",errorMsg:d}){const[u,m]=a.useState(null!=l?l:"json"),{resolvedTheme:p}=i.useTheme(),f="dark"===p,h=a.useRef(),g=me.useMonaco(),[v,x]=a.useState([]);a.useEffect((()=>{const e=(Dg((()=>JSON.parse(c||"[]")))||[]).map((e=>function(e,t){if(!e)return-1;try{const s=Ct.default.parse(e),a=yt.default.stringify(s,null,2);if(0===he.JSONPath({json:s,path:t}).length)return-1;const n=he.JSONPath({json:s,path:t,resultType:"pointer"})[0];if(n in a.pointers){const e=a.pointers[n];return(e.key?e.key.line:e.value.line)+1}}catch(e){console.error("Get Jsonpath Line Error:",e)}return-1}(s,e)));x(e)}),[c,s]);a.useEffect((()=>{if(g&&h.current){const e=h.current;g.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[],enableSchemaRequest:!0,comments:"ignore"});const t=e.getModel();if(t)if(v.length>0){v[0]>0&&e.revealLineInCenter(v[0]);const s=v.map((e=>({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:99999,message:(null==d?void 0:d.msg)||"",severity:g.MarkerSeverity.Error})));g.editor.setModelMarkers(t,"proconfig",s)}else g.editor.setModelMarkers(t,"proconfig",[])}}),[v,g,d]);const E=b.debounce(((e,t)=>{requestAnimationFrame((()=>n(e)))}),500);return e.jsx(Nt.default,{language:u,theme:f?"vs-dark":"light",value:s,onChange:E,onValidate:e=>{e.forEach((e=>console.log("onValidate:",e.message)))},onMount:(e,t)=>{if(h.current=e,o){const t=(e=>{const t=h.current;if(!t)return-1;const s=t.getModel();if(!s)return-1;const a=s.findMatches(e,!1,!0,!1,null,!0);return a.length>0?a[0].range.startLineNumber:-1})(o||""),s=e.getValue();let a={};try{a=JSON.parse(s||"{}")}catch(e){}if(t>0){if(b.isArray(null==a?void 0:a[o])&&!(null==a?void 0:a[o].length))return;e.setSelection({startLineNumber:t,startColumn:1,endLineNumber:t,endColumn:1}),e.trigger("fold","editor.fold",{selectionLines:[t]})}}t.languages.json.jsonDefaults.setDiagnosticsOptions({comments:"ignore"})},className:r,options:{lineNumbersMinChars:6,readOnly:t,minimap:{enabled:!1},contextmenu:!1,fontSize:16,fontWeight:"500"}})}me.loader.config({paths:{vs:"//myshellstatic.com/js/monaco-editor/min/vs"}});var Fg=a.memo((function({code:t}){const a=s.useTranslations("common"),{onCopy:n}=ui(JSON.stringify(null!=t?t:""));return e.jsx(Tr,{variant:"outline",size:"md",disabled:!t,onClick:e=>{e.preventDefault(),n()},children:a("copy")})}));function Bg(t){const{name:s,setFormValue:a,value:n}=t;return e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx("div",{className:"shrink-0 flex items-center p-4 space-x-4",children:e.jsx("div",{className:"grow flex justify-end",children:e.jsx(Fg,{code:n})})}),e.jsx("div",{className:"w-full h-[200px]",children:e.jsx(Ug,{language:"javascript",value:n,onValueChange:e=>{a(s,e)}})})]})}var Gg=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};var zg=Object.freeze({__proto__:null,default:function(t){var s,a;const{type:n,id:l,formTraceId:r,formEle:i,control:o,setFormValue:c,errors:d,register:m,defaultValues:p,clearErrors:f}=t;let h=null;if("textarea"===i.type&&(h=Tg),"input"===i.type&&(h=u.Input),"select"!==i.type&&"numberSelect"!==i.type||(h=_g),"numberSlider"!==i.type&&"interSlider"!==i.type||(h=Rg),"numberInput"!==i.type&&"interInput"!==i.type||(h=ug),"checkbox"===i.type&&(h=dg),"upload"===i.type&&(h=kg),"codeEditor"===i.type&&(h=Bg),h){const t="select"!==i.type&&"numberSelect"!==i.type||!i.options?{}:{options:i.options},g={};if("upload"===i.type){const e=i.id;g[`x_ms_name_${e}`]=null!==(s=null==p?void 0:p[`x_ms_name_${e}`])&&void 0!==s?s:"",g[`x_ms_size_${e}`]=null!==(a=null==p?void 0:p[`x_ms_size_${e}`])&&void 0!==a?a:""}return e.jsxs(u.FormControl,{className:Ge.default("relative",i.wrapperClass),children:[i.name&&e.jsxs(u.FormLabel,{htmlFor:i.id,className:"mb-1.5 text-[14px]",children:[i.isRequired&&e.jsx("span",{className:"text-[#EC2F0D] mr-[2px]",children:"*"}),i.name]}),i.description&&e.jsx(u.FormLabel,{htmlFor:i.id,className:"mb-1.5 text-[14px] text-subtle",children:i.description}),e.jsx("div",{className:Ge.default("flex flex-row justify-between items-center"),children:e.jsx(R.Controller,{name:i.id,control:o,rules:i.rules,render:({field:s})=>{const{ref:a,onChange:o}=s,u=Gg(s,["ref","onChange"]),p=e=>{let t=e;"checkbox"===i.type?t=e.target.checked:e.target&&(t=e.target.value),o(t),(e=>{c&&c(i.fieldName,e)})(t),i.onChange&&i.onChange(t)};return e.jsx(h,Object.assign({},u,(null==i?void 0:i.props)||{},t,g,{chatType:n,id:l,formTraceId:r,type:i.type,supportedFileTypes:i.supportedFileTypes,fileUploadSizeMaximum:(null==i?void 0:i.fileUploadSizeMaximum)||5242880,ref:a,onChange:e=>{p(e)},setFormValue:c,errors:d,clearErrors:f,isInvalid:!!d},m(i.fieldName,{required:i.isRequired}),{className:Ge.default("checkbox"!==i.type&&"w-full border-default hover:border-hovered focus:outline focus:outline-none focus-visible:border-pressed focus-visible:outline-offset-0 focus-visible:outline-utility-sky-blue-500 focus-visible:shadow-none rounded-[12px]",i.class)}))}})})]},i.id)}return null}});exports.ChatModule=function({bgUrl:t,editorAnchorRef:s,editorContainerRef:n,textareaRef:l,virtuosoRef:r,topActionsSlot:o,scrollLayoutToTop:d,showMobileDetail:u}){const[m,p]=c.useToggle(!1),{forceToLogin:f}=a.useContext(jt),{getDragRootProps:h,editorMode:g}=a.useContext(At),{resolvedTheme:v}=i.useTheme();return e.jsxs(e.Fragment,{children:[e.jsxs("section",Object.assign({className:Ge.default("w-full h-full flex flex-col bg-cover bg-center bg-no-repeat bg-origin-border relative",!(t&&m)&&"bg-surface-default"),style:{backgroundImage:t&&m?`url('${t}')`:"none"}},null==h?void 0:h(),{children:["SHARE"===g?e.jsx(Ed,{}):o,e.jsxs("div",{id:"renderer-container",className:"grow h-full overflow-y-auto no-scrollbar scroll-smooth py-0 relative z-10",children:[e.jsx("div",{className:"absolute w-full hidden md:block md:rounded-t-3xl top-0 z-20 h-[20px]",style:{backgroundImage:"linear-gradient(to bottom, var(--surface-default) 0, transparent 20px)"}}),e.jsx(dm,{virtuosoRef:r}),m&&e.jsx("div",{style:{backgroundImage:"dark"===v?"linear-gradient(179.98deg, rgba(28, 30, 38, 0) 0.81%, #1C1E26 99.99%)":"linear-gradient(179.98deg, rgba(255, 255, 255, 0) 0.81%, #FFFFFF 99.99%)"},className:"absolute w-full bottom-0 -z-[1] h-[348px] pointer-events-none"})]}),"SHARE"===g?e.jsx("div",{className:"w-full z-10 border-t border-default",children:e.jsx(om,{})}):null,"NORMAL"===g?e.jsx(bd,{editorContainerRef:n,editorAnchorRef:s,textareaRef:l,scrollLayoutToTop:d,showMobileDetail:u}):null,e.jsx(nm,{})]})),t&&e.jsx("img",{src:t,width:1,height:1,className:"hidden",alt:"Background Image",onLoad:()=>{p(!0)},fetchPriority:"high"}),f&&e.jsx(um,{open:f})]})},exports.ChatStoreProvider=({children:t,type:s,id:n,messages:l})=>{const r=a.useRef();return r.current||(r.current=Ei(s&&n&&(null==l?void 0:l.length)?{[`${s}-${n}`]:l}:void 0),wi=r.current),e.jsx(_i.Provider,{value:r.current,children:t})},exports.GlobalStoreProvider=({children:t,nonce:s,isMobile:l,traceId:r})=>{const i=a.useRef(),o=c.useMedia("(max-width: 768px)",l);var d;return i.current||(i.current=(d={nonce:s,isMobile:o,traceId:r},n.createStore()(Be.default(wn(vn((e=>Object.assign(Object.assign(Object.assign({},Tn),d),{setIsMobile(t){e({isMobile:t},!1,"setIsMobile")},setTraceId(t){e({traceId:t},!1,"traceId")},setIsFirstLoad(t){e({isFirstLoad:t},!1,"setIsFirstLoad")},goToInviteArea(t){e({isToInviteArea:t},!1,"goToInviteArea")},globalLoading(){e((e=>{e.loadingCount++}),!1,"globalLoading")},globalLoaded(){e((e=>{const t=e.loadingCount-1;e.loadingCount=t<0?0:t}),!1,"globalLoaded")},toggleLoginModal(t){e((e=>{e.isOpenLoginModal=t,t||(e.cantCloseLogin=!1)}),!1,"toggleLoginModal")},setGuiding(t){e({guiding:t},!1,"setGuiding")},setOpenLevelBenefitModal(t){e((e=>{e.isOpenLevelBenefitModal=t}),!1,"setOpenLevelBenefitModal")},setShowChatBotRecommend(t){e({showChatBotRecommend:t},!1,"setShowChatBotRecommend")},toggleInvitecodeModal(t){e({isOpenInviteCodeModal:t},!1,"toggleInvitecodeModal")},setInviteCodeStep(t){e({inviteCodeStep:t},!1,"setInviteCodeStep")},setAutoPromptTaskResult(t){e({createAutoPromptTaskResult:t},!1,"setAutoPromptTaskResult")},setNoEnergyWithUsablePropModalVisible(t){e((e=>{e.noEnergyWithUsablePropModalVisible=t}),!1,"setNoEnergyWithUsablePropModalVisible")},showOnboarding(t){e((e=>{e.onboarding=t}),!1,"showOnboarding")},setSumUnread(t){e((e=>{e.sumUnread=t}),!1,"setSumUnread")}})),{store:"user"})),Nn)))),a.useEffect((()=>{var e;null===(e=i.current)||void 0===e||e.getState().setIsMobile(o)}),[o]),e.jsx(vl.Provider,{value:i.current,children:t})},exports.MessageContext=At,exports.MessageToDisplayParser=function e(t,s,a,n=!1,l){var r;return Object.assign(Object.assign({},t),{avatar:qi(t,a),name:Qi(t,a,l),replyTo:n?Xi(t,a):void 0,source:Ki(t.userId,s,t.type),msgDisplayType:Vi(t.type),regeneratedMessages:(null!==(r=t.regeneratedMessages)&&void 0!==r?r:[]).map((t=>e(t,s,a,n,l)))})},exports.RunningError=({chat:n})=>{var l,r,i,o,c,d,u;const m=s.useTranslations("chat"),p=s.useTranslations("request.error"),[f,h]=a.useState(!1),g=Hn((e=>e.setMessageHandled)),{onCopy:v}=ui((null===(l=null==n?void 0:n.runningError)||void 0===l?void 0:l.errorDetail)||""),x=Ur((e=>e.isVisitor)),b=Ur((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.level})),E=Ur((e=>e.energy)),_=()=>{g({botId:n.botId,msgId:n.id})},w=a.useMemo((()=>{var e;return((e,t)=>{switch(t){case es.RUNNING_ERROR_TYPE_ENGINE_ERROR:return e("chat_error_tip");case es.RUNNING_ERROR_TYPE_INNER_COMPONENT_ERROR:return e("inner_component_error_tip");case es.RUNNING_ERROR_TYPE_LLM_TOKEN_TOO_LONG:return e("exceeded_token_error_tip");default:return""}})(p,null===(e=null==n?void 0:n.runningError)||void 0===e?void 0:e.errorType)}),[null===(r=null==n?void 0:n.runningError)||void 0===r?void 0:r.errorType]);if((null===(i=null==n?void 0:n.runningError)||void 0===i?void 0:i.errorType)===es.RUNNING_ERROR_TYPE_ENERGY_INSUFFICIANT)return E>((null===(o=null==n?void 0:n.runningError)||void 0===o?void 0:o.requireEnergyToUse)||0)?null:2===x&&1===b?e.jsx("li",{className:"last:animate-slideIn list-none",children:e.jsx($r,{type:"action",onClose:_})}):e.jsx("li",{className:"last:animate-slideIn list-none",children:e.jsx(Zr,{type:"action",onClose:_})});const T=(null===(c=n.runningError)||void 0===c?void 0:c.errorType)===es.RUNNING_ERROR_TYPE_LLM_TOKEN_TOO_LONG;return n.handled?null:e.jsxs("div",{className:"mt-4 md:mt-6 md:mx-10",children:[e.jsxs(Hr,{variant:"error",children:[e.jsx(Vr,{children:w}),e.jsxs("div",{className:"w-full gap-x-2 md:w-auto flex justify-center",children:[T?null:e.jsx(Tr,{className:"flex-1 md:flex-none",color:"error",size:"md",onClick:()=>{h(!0)},children:m("view_details")}),e.jsx(Tr,{className:"flex-1 md:flex-none",color:"error",size:"md",variant:T?void 0:"outline",onClick:_,children:m("ignore")})]})]}),e.jsx(ti,{open:f,children:e.jsxs(ni,{className:"w-310px md:w-[380px]",onClose:()=>{h(!1)},maskClosable:!1,children:[e.jsx(li,{className:"px-5 h-[68px] flex justify-center",children:e.jsx(ii,{children:e.jsx(Rl,{size:"h2",children:m("error_detail")})})}),e.jsx(oi,{className:"px-5 pt-1 pb-3 grid gap-y-1.5 overflow-y-auto max-h-96",children:e.jsx(Ul,{className:"break-all",dangerous:!0,children:(null===(u=null===(d=n.runningError)||void 0===d?void 0:d.errorDetail)||void 0===u?void 0:u.replaceAll("\n","<br />"))||""})}),e.jsx(ri,{className:"gap-x-5 min-h-[76px]",children:e.jsxs(Tr,{className:"w-full",onClick:()=>{v(),h(!1)},color:"error",children:[e.jsx(t.Copy,{className:"w-5 h-5 mr-1.5 mt-0.5"}),m("copy_error_message")]})})]})})]})},exports.StaticContext=jt,exports.UserStoreProvider=({children:t,user:s,isLogin:l,language:r})=>{const i=a.useRef();var o;return i.current||(i.current=(o={user:s||null,isLogin:l,language:r},n.createStore()(Be.default(wn(vn((e=>Object.assign(Object.assign(Object.assign({},Rn),o),{setUser(t){e({user:t},!1,"setUser")},setUserInviteCode(t){e({inviteCode:t},!1,"setUserInviteCode")},setInvitationCount(t){e({invitationCount:t},!1,"setInvitationCount")},setValidInvitationCount(t){e({validInvitationCount:t},!1,"setValidInvitationCount")},setTgValidInvitationCount(t){e({tgValidInvitationCount:t},!1,"setTgValidInvitationCount")},setInviteLink(t){e({inviteLink:t},!1,"setInviteLink")},setEnergyInfo(t){e((e=>{e.energy=t.energy,e.dailyEnergy=t.dailyEnergy||e.dailyEnergy,e.retriveEnergySuccess=!0}),!1,"setEnergyInfo")},setTgInfo(t){e({tgInfo:t},!1,"setTgInfo")},setConnectedAccounts(t){e({connectedAccounts:t},!1,"setConnectedAccounts")},setUserSettingsInfo(t){e({userSettingsInfo:t},!1,"setUserSettingsInfo")},clearUser(){e(Rn,!1,"clearUser")},setShowNsfw(t){e({showNsfw:t},!1,"setShowNsfw")},setShellCoins(t){e((e=>{e.shellCoins=t}),!1,"setShellCoins")},setFrozenShellCoins(t){e((e=>{e.frozenShellCoins=t}),!1,"setFrozenShellCoins")},setLoginMethod(t){e({loginMethod:t},!1,"setLoginMethod")},setIsLogin(t){e({isLogin:t},!1,"setIsLogin")},setLoginTimestamp(t){e({loginTimestamp:t},!1,"setLoginTimestamp")},setLanguage(t){e({language:t},!1,"setLanguage")},setLoginPopVisible(t){e({loginPopVisible:t},!1,"setLoginPopVisible")}})),{store:"user"})),Dn))),Dr=i.current),e.jsxs(Rr.Provider,{value:i.current,children:[t,e.jsx(gt.default,{strategy:"afterInteractive",children:`\n          window.$global.userId = '${null==s?void 0:s.id}';\n        `})]})},exports.useAtBottom=function(){const[e,t]=c.useBoolean(!0);return{atBottom:e,setAtBottom:t}},exports.useChatLayout=function(){const e=a.useRef(null),t=a.useRef(null),s=a.useRef(null),n=a.useRef(null),l=a.useRef(null),r=a.useRef(null),i=a.useRef(null),{y:o}=c.useScroll(i),[d,u]=c.useToggle(!1),[m,p]=c.useToggle(!0),f=a.useCallback((()=>{e.current&&(e.current.scrollTop=0)}),[]),h=a.useCallback((()=>{if(!t.current||!e.current)return;const s=t.current.getBoundingClientRect(),a=e.current.getBoundingClientRect(),n=s.top-a.top;e.current.scrollTop=Math.ceil(e.current.scrollTop+n)}),[t,e]),g=a.useCallback((()=>{p(!1)}),[p]);return a.useEffect((()=>{let a;const l=e.current,r=()=>{cancelAnimationFrame(a),a=requestAnimationFrame((()=>{var e;if(l&&t.current&&s.current){const a=l.getBoundingClientRect(),r=s.current.getBoundingClientRect().top-a.top<=0;if(r!==d)if(u(r),r){const a=t.current.offsetHeight;s.current.style.height=`${a}px`,t.current.style.position="fixed",t.current.style.borderTop="1px solid var(--border)",t.current.style.borderBottom="1px solid var(--border)",t.current.style.boxShadow="0px 20px 20px -10px var(--shadow-modal-bolder)",null===(e=n.current)||void 0===e||e.blur()}else s.current.style.height="auto",t.current.style.position="static",t.current.style.borderTop="none",t.current.style.borderBottom="none",t.current.style.boxShadow="none"}}))};return l&&l.addEventListener("scroll",r),()=>{l&&l.removeEventListener("scroll",r),cancelAnimationFrame(a)}}),[d]),{scrollContainerRef:e,editorContainerRef:t,editorAnchorRef:s,textareaRef:n,chatContainerRef:l,detailContainerRef:r,detailScrollRef:i,scrollLayoutToTop:f,manuallyScrollDetailToTop:h,isEditorSticky:d,contentActive:m,setContentActive:p,detailScrollY:o,showMobileDetail:g}},exports.useEditorMode=function(){const[e,t]=a.useState("TEXT"),[s,n]=a.useState("NORMAL");return{inputMode:e,setInputMode:t,editorMode:s,setEditorMode:n}},exports.useMessageParams=function(e){var t,s,n,l,r;const i=hi(),[o,d]=a.useState(),{type:u,id:m,entityId:p,showMockReply:f=!1,initMessages:h,virtuosoMessageApi:g}=e,{onSendMessage:v,onAppendMessages:x,onUpdateMessage:b,onPartialUpdateMessage:E,onTextStream:_,onAudioStream:w,onTranslationStream:T,onPrependMessages:N,onDeleteMessage:y,onRemoveDraftReplyIfExist:C,onVirtuosoRegen:S,onPartialUpdateRegenMessage:j,onMixMessages:I}=g,O=`${u}-${m}`,[A,M]=c.useBoolean(!1),P=a.useRef(0),L=Ur((e=>e.userId)),k=Ti((e=>e.messageListMap)),R=Ti((e=>e.localDraftMessageMap)),D=Ti((e=>e.localFiles)),U=Ti((e=>e.lastMsgIdMap)),F=Ti((e=>e.lastUserInteractionMsgIdMap)),B=Ti((e=>e.exceptionsForTextDisplay)),G=Ti((e=>e.localErrorMessageMap)),z=Ti((e=>e.addTextDisplayException)),Y=Ti((e=>e.setLocalDraftMessage)),H=Ti((e=>e.sendDraftMessage)),V=Ti((e=>e.replaceDraftMessage)),$=Ti((e=>e.replaceMessage)),W=Ti((e=>e.updateReply)),K=Ti((e=>e.appendMessages)),q=Ti((e=>e.prependMessages)),Q=Ti((e=>e.updateMessage)),X=Ti((e=>e.addTextStream)),J=Ti((e=>e.addAudioStream)),Z=Ti((e=>e.addTranslationStream)),ee=Ti((e=>e.deleteSpecifiedMessage)),te=Ti((e=>e.partialUpdateMessage)),se=Ti((e=>e.partialUpdateRegenMessage)),ae=Ti((e=>e.handleInteractionError)),ne=Ti((e=>e.removeLocalErrorMessage)),le=Ti((e=>e.clearDraftMessage)),re=Ti((e=>e.mixMessages)),ie=k[O],oe=null!==(t=ie||h)&&void 0!==t?t:[];a.useEffect((()=>{!(null==ie?void 0:ie.length)&&(null==h?void 0:h.length)&&K(u,m,h)}),[ie,h]);const ce=R[O],de=D[O],ue=null!==(s=U[O])&&void 0!==s?s:"",me=F[O],pe=()=>Ti.getState().lastUserInteractionMsgIdMap[O],fe=()=>Ti.getState().draftReplyMessageMap[O],he=oe.find((e=>e.id===ue)),ge=oe.reduceRight(((e,t)=>e||("REPLY"!==t.type&&"GREETING"!==t.type||"DONE"!==t.status?null:t)),null),ve=null===(n=null==he?void 0:he.recommendatioQuestions)||void 0===n?void 0:n.question,xe="DRAFT"===(null==he?void 0:he.status)||"PENDING"===(null==he?void 0:he.status)||"PENDING_FOR_RESPONSE"===(null==he?void 0:he.type)&&"CANCELED"!==(null==he?void 0:he.status),be=a.useMemo((()=>{var e,t,s;return xe||("PENDING"===(null==he?void 0:he.status)||"PROCESSING"===(null==he?void 0:he.status)||(null===(e=null==he?void 0:he.asyncJobInfo)||void 0===e?void 0:e.status)===_e.PENDING||(null===(t=null==he?void 0:he.asyncJobInfo)||void 0===t?void 0:t.status)===_e.PROCESSING||(null===(s=null==he?void 0:he.asyncJobInfo)||void 0===s?void 0:s.status)===_e.QUEUEING)&&"REPLY"===(null==he?void 0:he.type)&&"CANCELED"!==(null==he?void 0:he.status)}),[null===(l=null==he?void 0:he.asyncJobInfo)||void 0===l?void 0:l.status,null==he?void 0:he.status,null==he?void 0:he.type,xe]),Ee=a.useMemo((()=>{var e,t,s;return("PENDING"===(null==he?void 0:he.status)||"PROCESSING"===(null==he?void 0:he.status)||(null===(e=null==he?void 0:he.asyncJobInfo)||void 0===e?void 0:e.status)===_e.PENDING||(null===(t=null==he?void 0:he.asyncJobInfo)||void 0===t?void 0:t.status)===_e.PROCESSING||(null===(s=null==he?void 0:he.asyncJobInfo)||void 0===s?void 0:s.status)===_e.QUEUEING)&&"REPLY"===(null==he?void 0:he.type)&&"CANCELED"!==(null==he?void 0:he.status)}),[null===(r=null==he?void 0:he.asyncJobInfo)||void 0===r?void 0:r.status,null==he?void 0:he.status,null==he?void 0:he.type]),we="CANCELING"===(null==he?void 0:he.status),{playingAudio:Te,autoPlayIdQueue:Ne,enQueue:ye,clearQueue:Ce,playNext:Se}=function(){const[e,t]=a.useState([]),s=a.useMemo((()=>e[0]),[e]),n=()=>{t((e=>e.slice(1)))};return{playingAudio:s,autoPlayIdQueue:e,enQueue:s=>{e.includes(s)||t((e=>[...e,s]))},deQueue:n,clearQueue:()=>{t([])},playNext:()=>{s&&n()}}}(),je=(e,t)=>{E(e,t),te(u,m,e,t)},Ie=(e,t=!1)=>{(e=>{if("bot"===u){const t=os();d(t);const s={trace_id:t,bot_id:m,time:(new Date).getTime(),message_type:e.type};null==i||i.track("Chat_Send_Message_Start",s)}})(e);const s=Wi(e,u);if(v(s,t),H(u,m,s),f){const e={id:`draft-reply-${Date.now()}`,userId:null!=L?L:"",entityId:p||m,type:"PENDING_FOR_RESPONSE",status:"PENDING",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString()};x(e),K(u,m,e)}P.current=Date.now()},Oe=(e,t=!1)=>{I(e,t),re(u,m,e)};return c.useEffectOnce((()=>Ce())),a.useEffect((()=>{var e;const t=(null!==(e=G[O])&&void 0!==e?e:[]).filter((e=>e.userId===L));A||(Oe(t,!0),M(!0))}),[m,A,G,O,u,L]),{messageList:oe,lastMessageInfo:he,lastValidReplyMessage:ge,questions:ve,lastUserInteractionMsgId:me,draftMessage:ce,sending:xe,interacting:be,scrollToBottom:P.current,exceptionsForTextDisplay:B,getLatestLastMessageInfo:()=>Ti.getState().messageListMap[O].find((e=>e.id===ue)),addTextDisplayException:e=>{z(u,m,e)},setDraftMessage:e=>{Y(u,m,e)},sendTextMessage:(e,t,s)=>{const a={id:`draft-send-${Date.now()}`,entityId:p||m,text:e,embedObjs:t?t.map((e=>({url:e.url,type:e.uiData.serverType,title:e.uiData.name,mediaFileMetadata:e.mediaFileMetadata,iconUrl:e.uiData.iconUrl}))):void 0,userId:null!=L?L:"",type:"TEXT",status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),requestParams:s};Ie(a)},sendAudioMessage:(e,t)=>{const s={id:`draft-send-${Date.now()}`,entityId:p||m,audioUrl:e,userId:null!=L?L:"",type:"VOICE",status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),requestParams:t};Ie(s)},sendButtonInteractionMessage:(e,t)=>{const{imSlashCommandInput:s,text:a,componentInputMessage:n}=e,l={id:`draft-send-${Date.now()}`,entityId:p||m,userId:null!=L?L:"",type:"BUTTON_INTERACTION",status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),slashCommandInput:s||{name:null!=a?a:"",paramMap:n?JSON.parse(n):{}},text:a,requestParams:t};Ie(l,!0)},onRetry:e=>{const t=`draft-send-${Date.now()}`;let s;s="TEXT"===e.type?{id:t,entityId:p||m,text:e.text,embedObjs:e.embedObjs,userId:null!=L?L:"",type:e.type,status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),requestParams:e.requestParams}:"VOICE"===e.type?{id:t,entityId:p||m,audioUrl:e.audioUrl,userId:null!=L?L:"",type:"VOICE",status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),requestParams:e.requestParams}:{id:t,entityId:p||m,userId:null!=L?L:"",type:"TEXT",status:"DRAFT",createdDateUnix:Date.now().toString(),updatedDateUnix:Date.now().toString(),slashCommandInput:e.slashCommandInput,text:e.text,requestParams:e.requestParams},y(e.id),ne(u,m,e.id),Ie(s)},onRegen:(e,t)=>{S(t),je(e,{status:"REGENERATING"})},replaceDraftMessage:e=>{let t;t="DRAFT"===e.status||"LOCAL_ERROR"===e.status||"NETWORK_ERROR"===e.status?Wi(e,u):e;const s=pe();s?b(s,t):x(t),V(u,m,t)},prependMessages:e=>{N(e),q(u,m,e)},appendMessages:(e,t=!1)=>{x(e,t),K(u,m,e)},updateMessage:e=>{let t;t="DRAFT"===e.status||"LOCAL_ERROR"===e.status||"NETWORK_ERROR"===e.status?Wi(e,u):e;const s=(()=>{var e;return null!==(e=Ti.getState().messageListMap[O])&&void 0!==e?e:[]})(),a=s.find((t=>t.id===e.id));a&&("CANCELING"===a.status&&"CANCELED"!==e.status||"CANCELED"===a.status||b(t.id,t)),Q(u,m,t)},replaceMessage:(e,t)=>{b(e,t),$(u,m,e,t)},onMessageReply:e=>{const t=fe();b(t||e.id,e),W(u,m,e)},mixMessages:Oe,addTextStream:(e,t,s)=>{_(e,t),X(u,m,e,t,s)},addAudioStream:(e,t)=>{w(e,t),J(u,m,e,t)},addTranslationStream:(e,t)=>{T(e,t),Z(u,m,e,t)},deleteSpecifiedMessageId:e=>{y(e),ee(u,m,e)},partialUpdateMsg:je,partialUpdateRegenMsg:(e,t,s)=>{j(e,t,s),se(u,m,e,t,s)},onInteractionError:e=>{const t=pe(),s=fe();t&&E(t,{status:e}),s&&C(s),ae(u,m,e)},clearDraft:()=>{const e=pe();e&&y(e);const t=fe();t&&y(t),le(u,m)},audioQueue:{playingAudio:Te,queue:Ne,enQueue:ye,clearQueue:Ce,playNext:Se},file:{uploadedFiles:de},showTerminate:Ee,terminating:we,interactionTraceId:o}},exports.useUploadFiles=function({panelSettings:e,uploadedFiles:t=[],messageSettings:n,type:l,id:r,name:i,disabled:o=!1,dragDisabled:d,scrollLayoutToTop:u,textareaRef:m,overrideUploadFileToS3WithProgress:p}){var f,h,g,v;const x=hi(),[b,_]=c.useToggle(!1),w=a.useRef(!1),T=Ti((e=>e.uploadFiles)),N=Ti((e=>e.deleteUploadFile)),y=Ti((e=>e.setFileAlert)),{warning:C}=Ql(),S=s.useTranslations("chat"),j=(null!==(h=null===(f=null==n?void 0:n.supportedFileInfos)||void 0===f?void 0:f.length)&&void 0!==h?h:0)+(null!==(v=null===(g=null==e?void 0:e.supportedFileInfos)||void 0===g?void 0:g.length)&&void 0!==v?v:0)===0,I=a.useMemo((()=>{var t;return null!==(t=null==n?void 0:n.supportedFileInfos)&&void 0!==t?t:null==e?void 0:e.supportedFileInfos}),[e,n]),O=a.useMemo((()=>(null!=I?I:[]).reduce(((e,t)=>e+t.maxUploadNum),0)),[I]),A=a.useMemo((()=>(null!=I?I:[]).reduce(((e,t)=>[...e,t.type]),[])),[I]),M=a.useMemo((()=>(e=>{const t={};return e.forEach((e=>{const s=gm[e];if(s){const e=pm[s];Object.keys(e).forEach((s=>{t[e[s]]?t[e[s]]=[...t[e[s]],s]:t[e[s]]=[s]}))}})),t})(A)),[A]),P=a.useMemo((()=>A.flatMap((e=>{const t=gm[e];return t?Object.keys(pm[t]):[]}))),[A]),L=a.useCallback(((e,t)=>{T(l,r,e,t,p)}),[r,l,T,p]),k=a.useCallback((async e=>{const t=await(e=>xm(e))(e);L(t)}),[L]),R=a.useCallback((e=>{if(w.current=!1,_(!1),!e.length)return;const s={},a={};t.forEach((e=>{var t;const s=(null===(t=e.uiData)||void 0===t?void 0:t.serverType)||Me.ALL;a[s]||(a[s]=[]),a[s].push(e)})),e.forEach((e=>{var t;const a=(null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase())||"",n=bm(`.${a}`);s[n]||(s[n]=[]),s[n].push(e)}));const n=[];if(null==I||I.forEach((e=>{const t=a[e.type]||[],l=s[e.type]||[],r=[...t.map((e=>e.file)),...l];r.length>e.maxUploadNum&&n.push(S("panel.maxTypeFiles",{type:e.type,number:e.maxUploadNum}));r.reduce(((e,t)=>e+t.size),0)>e.maxTotalBytes&&n.push(S("panel.maxTypeFileSize",{type:e.type,size:Em(e.maxTotalBytes)}))})),n.length>0?C({content:n.join("\n")}):k(e),"bot"===l){const t=e[0].name,s=t.substring(t.lastIndexOf(".")+1);null==x||x.track("UploadFile",{item_type:"bot",item_id:r,item_name:i,file_type:s,file_size:e[0].size.toString()})}}),[S,I,r,i,k,x,_,l,t,C]),D=a.useCallback((e=>{const t=e.filter((e=>e.errors[0].code===E.ErrorCode.FileInvalidType)).map((e=>({code:e.errors[0].code,name:e.file.name}))),s=e.filter((e=>e.errors[0].code===E.ErrorCode.FileTooLarge)).map((e=>({code:e.errors[0].code,name:e.file.name})));y({visible:!0,data:[t,s]})}),[y]),U=a.useCallback((e=>{var t,s;const a=e.name?e.name.split(".")[1]:e.type?e.type.split("/")[1]:"",n=bm(`.${a}`),l=null==I?void 0:I.find((e=>e.type===n)),r=null!==(t=null==l?void 0:l.maxSingleBytes)&&void 0!==t?t:mm;if(e.size>r){const e=Em(r);return{code:E.ErrorCode.FileTooLarge,message:`Size is larger than ${e} mb!`}}return((null===(s=null==l?void 0:l.fileExtensions)||void 0===s?void 0:s.length)?null==l?void 0:l.fileExtensions:P).includes(`.${a.toLowerCase()}`)||P.includes("*")?null:{code:E.ErrorCode.FileInvalidType,message:`${a} is not support yet!`}}),[I,P]),F={accept:M,maxFiles:O,noKeyboard:!0,maxSize:mm,onDragOver:()=>_(!0),onDragLeave:()=>_(!1),validator:U,onDrop:R,onDropRejected:D,onFileDialogOpen:()=>{w.current=!0,null==u||u()},onFileDialogCancel:()=>{var e;w.current=!1,null===(e=null==m?void 0:m.current)||void 0===e||e.focus()}},B=Object.assign(Object.assign({},F),{noClick:!1,noDrag:!0,disabled:o||j}),G=Object.assign(Object.assign({},F),{noClick:!0,noDrag:!1,disabled:o||j||d}),z=a.useCallback((e=>{N(l,r,e)}),[N,r,l]),Y=a.useCallback((e=>{const t=[],s=[];e.forEach((e=>{const a=U(e);a?s.push({file:e,errors:[a]}):t.push(e)})),t.length>0&&R(t),s.length>0&&D(s)}),[U,R,D]),{getRootProps:H}=E.useDropzone(G),{getRootProps:V,getInputProps:$}=E.useDropzone(B);return{dragMaskVisible:b,uploadedFiles:t,noValidLimitations:j,handleUpload:L,handleDelete:z,getDragRootProps:H,getClickRootProps:V,getInputProps:$,handlePastedFiles:Y,isChoosingFile:w}},exports.useVirtuosoMessageListApi=function(e=!0){const[t,s]=c.useBoolean(!0),n=xl((e=>e.isMobile)),l=a.useRef(null);return{scrolled:t,setScrolled:s,virtuosoRef:l,onSendMessage:(t,a=!1)=>{var r;null===(r=l.current)||void 0===r||r.data.append([t],(({scrollInProgress:t,atBottom:l})=>n?a?{index:e?-1:"LAST",align:"start",behavior:l||t?"smooth":"auto"}:(s(!1),!1):{index:e?-1:"LAST",align:"start",offset:-60,behavior:l||t?"smooth":"auto"}))},onAppendMessages:(e,t)=>{var s,a;null===(s=l.current)||void 0===s||s.data.append(Array.isArray(e)?e:[e]),t&&(null===(a=l.current)||void 0===a||a.data.append([],(({scrollInProgress:e,atBottom:t})=>({index:"LAST",align:"start",offset:n?0:-60,behavior:t||e?"smooth":"auto"}))))},onUpdateMessage:(e,t)=>{var s;null===(s=l.current)||void 0===s||s.data.map((s=>s.id===e?t:s))},onPartialUpdateMessage:(e,t)=>{var s;null===(s=l.current)||void 0===s||s.data.map((s=>s.id===e?Object.assign(Object.assign({},s),t):s))},onPartialUpdateRegenMessage:(e,t,s)=>{var a;null===(a=l.current)||void 0===a||a.data.map((a=>a.id===e?Object.assign(Object.assign({},a),{regeneratedMessages:(a.regeneratedMessages||[]).map((e=>e.id===t?Object.assign(Object.assign({},e),s):e))}):a))},onTextStream:(e,t)=>{var s;null===(s=l.current)||void 0===s||s.data.map((s=>s.id===e?Object.assign(Object.assign({},s),{text:(s.text||"")+t}):s))},onAudioStream:(e,t)=>{var s;null===(s=l.current)||void 0===s||s.data.map((s=>s.id===e?Object.assign(Object.assign({},s),{audioBuffer:[...s.audioBuffer||[],t]}):s))},onTranslationStream:(e,t)=>{var s;null===(s=l.current)||void 0===s||s.data.map((s=>s.id===e?Object.assign(Object.assign({},s),{translation:(s.translation||"")+t}):s))},onPrependMessages:e=>{var t;null===(t=l.current)||void 0===t||t.data.prepend(e)},onDeleteMessage:e=>{var t,s;e?null===(t=l.current)||void 0===t||t.data.findAndDelete((t=>t.id===e)):null===(s=l.current)||void 0===s||s.data.replace([])},onRemoveDraftReplyIfExist:e=>{var t,s;const a=null===(t=l.current)||void 0===t?void 0:t.data.find((t=>t.id===e));a&&"PENDING_FOR_RESPONSE"===a.type&&(null===(s=l.current)||void 0===s||s.data.findAndDelete((t=>t.id===e)))},onVirtuosoRegen:e=>{var t,s;const a=null===(t=l.current)||void 0===t?void 0:t.data.findIndex((t=>t.id===e));null===(s=l.current)||void 0===s||s.data.append([],(({scrollInProgress:e,atBottom:t})=>({index:null!=a?a:"LAST",align:"start",offset:n?0:-60,behavior:t||e?"smooth":"auto"})))},onMixMessages:(e,t=!1)=>{var s,a,n,r,i;const o=Array.isArray(e)?e:[e],c=null!==(a=null===(s=l.current)||void 0===s?void 0:s.data.get())&&void 0!==a?a:[];if(0===c.length)return void(null===(n=l.current)||void 0===n||n.data.append(o,(({scrollInProgress:e,atBottom:s})=>!!t&&{index:"LAST",align:"end",offset:0,behavior:"auto"})));const d=Math.max(...c.map((e=>Number(e.createdDateUnix)))),u=Math.min(...c.map((e=>Number(e.createdDateUnix)))),m=Math.min(...o.map((e=>Number(e.createdDateUnix)))),p=Math.max(...o.map((e=>Number(e.createdDateUnix))));if(m>d)return void(null===(r=l.current)||void 0===r||r.data.append(o,(({scrollInProgress:e,atBottom:s})=>!!t&&{index:"LAST",align:"end",offset:0,behavior:"auto"})));if(u>p)return void(null===(i=l.current)||void 0===i||i.data.prepend(o));const f=o.filter((e=>{const t=c.find((t=>t.id===e.id));return!t||!b.isEqual(t,e)}));0!==f.length&&(f.forEach((e=>{var t,s,a,n,r;const i=null!==(s=null===(t=l.current)||void 0===t?void 0:t.data.get())&&void 0!==s?s:[];if(i.find((t=>t.id===e.id)))null===(a=l.current)||void 0===a||a.data.map((t=>t.id===e.id?e:t));else{const t=i.findIndex((t=>Number(t.createdDateUnix)>Number(e.createdDateUnix)));-1===t?null===(n=l.current)||void 0===n||n.data.append([e]):null===(r=l.current)||void 0===r||r.data.insert([e],t)}})),t&&setTimeout((()=>{var e;null===(e=l.current)||void 0===e||e.scrollIntoView({index:"LAST",align:"end",offset:0,behavior:"auto"})})))}}};
